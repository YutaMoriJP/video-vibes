(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&r(f)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function lm(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var dg={exports:{}},kc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vy;function NT(){if(vy)return kc;vy=1;var h=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,o,l){var f=null;if(l!==void 0&&(f=""+l),o.key!==void 0&&(f=""+o.key),"key"in o){l={};for(var y in o)y!=="key"&&(l[y]=o[y])}else l=o;return o=l.ref,{$$typeof:h,type:r,key:f,ref:o!==void 0?o:null,props:l}}return kc.Fragment=e,kc.jsx=t,kc.jsxs=t,kc}var Ey;function wT(){return Ey||(Ey=1,dg.exports=NT()),dg.exports}var Dt=wT(),hg={exports:{}},rr={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty;function OT(){if(Ty)return rr;Ty=1;var h=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),f=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),u=Symbol.for("react.activity"),d=Symbol.iterator;function S(ee){return ee===null||typeof ee!="object"?null:(ee=d&&ee[d]||ee["@@iterator"],typeof ee=="function"?ee:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,b={};function I(ee,_e,Ze){this.props=ee,this.context=_e,this.refs=b,this.updater=Ze||_}I.prototype.isReactComponent={},I.prototype.setState=function(ee,_e){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,_e,"setState")},I.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function T(){}T.prototype=I.prototype;function A(ee,_e,Ze){this.props=ee,this.context=_e,this.refs=b,this.updater=Ze||_}var R=A.prototype=new T;R.constructor=A,E(R,I.prototype),R.isPureReactComponent=!0;var O=Array.isArray;function H(){}var U={H:null,A:null,T:null,S:null},Z=Object.prototype.hasOwnProperty;function $(ee,_e,Ze){var Ke=Ze.ref;return{$$typeof:h,type:ee,key:_e,ref:Ke!==void 0?Ke:null,props:Ze}}function F(ee,_e){return $(ee.type,_e,ee.props)}function W(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===h}function fe(ee){var _e={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(Ze){return _e[Ze]})}var ne=/\/+/g;function de(ee,_e){return typeof ee=="object"&&ee!==null&&ee.key!=null?fe(""+ee.key):_e.toString(36)}function Te(ee){switch(ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:switch(typeof ee.status=="string"?ee.then(H,H):(ee.status="pending",ee.then(function(_e){ee.status==="pending"&&(ee.status="fulfilled",ee.value=_e)},function(_e){ee.status==="pending"&&(ee.status="rejected",ee.reason=_e)})),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}}throw ee}function me(ee,_e,Ze,Ke,De){var Ge=typeof ee;(Ge==="undefined"||Ge==="boolean")&&(ee=null);var Et=!1;if(ee===null)Et=!0;else switch(Ge){case"bigint":case"string":case"number":Et=!0;break;case"object":switch(ee.$$typeof){case h:case e:Et=!0;break;case m:return Et=ee._init,me(Et(ee._payload),_e,Ze,Ke,De)}}if(Et)return De=De(ee),Et=Ke===""?"."+de(ee,0):Ke,O(De)?(Ze="",Et!=null&&(Ze=Et.replace(ne,"$&/")+"/"),me(De,_e,Ze,"",function(gt){return gt})):De!=null&&(W(De)&&(De=F(De,Ze+(De.key==null||ee&&ee.key===De.key?"":(""+De.key).replace(ne,"$&/")+"/")+Et)),_e.push(De)),1;Et=0;var vt=Ke===""?".":Ke+":";if(O(ee))for(var et=0;et<ee.length;et++)Ke=ee[et],Ge=vt+de(Ke,et),Et+=me(Ke,_e,Ze,Ge,De);else if(et=S(ee),typeof et=="function")for(ee=et.call(ee),et=0;!(Ke=ee.next()).done;)Ke=Ke.value,Ge=vt+de(Ke,et++),Et+=me(Ke,_e,Ze,Ge,De);else if(Ge==="object"){if(typeof ee.then=="function")return me(Te(ee),_e,Ze,Ke,De);throw _e=String(ee),Error("Objects are not valid as a React child (found: "+(_e==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":_e)+"). If you meant to render a collection of children, use an array instead.")}return Et}function X(ee,_e,Ze){if(ee==null)return ee;var Ke=[],De=0;return me(ee,Ke,"","",function(Ge){return _e.call(Ze,Ge,De++)}),Ke}function Ie(ee){if(ee._status===-1){var _e=ee._result;_e=_e(),_e.then(function(Ze){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=Ze)},function(Ze){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=Ze)}),ee._status===-1&&(ee._status=0,ee._result=_e)}if(ee._status===1)return ee._result.default;throw ee._result}var Be=typeof reportError=="function"?reportError:function(ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ee=="object"&&ee!==null&&typeof ee.message=="string"?String(ee.message):String(ee),error:ee});if(!window.dispatchEvent(_e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ee);return}console.error(ee)},qe={map:X,forEach:function(ee,_e,Ze){X(ee,function(){_e.apply(this,arguments)},Ze)},count:function(ee){var _e=0;return X(ee,function(){_e++}),_e},toArray:function(ee){return X(ee,function(_e){return _e})||[]},only:function(ee){if(!W(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}};return rr.Activity=u,rr.Children=qe,rr.Component=I,rr.Fragment=t,rr.Profiler=o,rr.PureComponent=A,rr.StrictMode=r,rr.Suspense=g,rr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,rr.__COMPILER_RUNTIME={__proto__:null,c:function(ee){return U.H.useMemoCache(ee)}},rr.cache=function(ee){return function(){return ee.apply(null,arguments)}},rr.cacheSignal=function(){return null},rr.cloneElement=function(ee,_e,Ze){if(ee==null)throw Error("The argument must be a React element, but you passed "+ee+".");var Ke=E({},ee.props),De=ee.key;if(_e!=null)for(Ge in _e.key!==void 0&&(De=""+_e.key),_e)!Z.call(_e,Ge)||Ge==="key"||Ge==="__self"||Ge==="__source"||Ge==="ref"&&_e.ref===void 0||(Ke[Ge]=_e[Ge]);var Ge=arguments.length-2;if(Ge===1)Ke.children=Ze;else if(1<Ge){for(var Et=Array(Ge),vt=0;vt<Ge;vt++)Et[vt]=arguments[vt+2];Ke.children=Et}return $(ee.type,De,Ke)},rr.createContext=function(ee){return ee={$$typeof:f,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null},ee.Provider=ee,ee.Consumer={$$typeof:l,_context:ee},ee},rr.createElement=function(ee,_e,Ze){var Ke,De={},Ge=null;if(_e!=null)for(Ke in _e.key!==void 0&&(Ge=""+_e.key),_e)Z.call(_e,Ke)&&Ke!=="key"&&Ke!=="__self"&&Ke!=="__source"&&(De[Ke]=_e[Ke]);var Et=arguments.length-2;if(Et===1)De.children=Ze;else if(1<Et){for(var vt=Array(Et),et=0;et<Et;et++)vt[et]=arguments[et+2];De.children=vt}if(ee&&ee.defaultProps)for(Ke in Et=ee.defaultProps,Et)De[Ke]===void 0&&(De[Ke]=Et[Ke]);return $(ee,Ge,De)},rr.createRef=function(){return{current:null}},rr.forwardRef=function(ee){return{$$typeof:y,render:ee}},rr.isValidElement=W,rr.lazy=function(ee){return{$$typeof:m,_payload:{_status:-1,_result:ee},_init:Ie}},rr.memo=function(ee,_e){return{$$typeof:p,type:ee,compare:_e===void 0?null:_e}},rr.startTransition=function(ee){var _e=U.T,Ze={};U.T=Ze;try{var Ke=ee(),De=U.S;De!==null&&De(Ze,Ke),typeof Ke=="object"&&Ke!==null&&typeof Ke.then=="function"&&Ke.then(H,Be)}catch(Ge){Be(Ge)}finally{_e!==null&&Ze.types!==null&&(_e.types=Ze.types),U.T=_e}},rr.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},rr.use=function(ee){return U.H.use(ee)},rr.useActionState=function(ee,_e,Ze){return U.H.useActionState(ee,_e,Ze)},rr.useCallback=function(ee,_e){return U.H.useCallback(ee,_e)},rr.useContext=function(ee){return U.H.useContext(ee)},rr.useDebugValue=function(){},rr.useDeferredValue=function(ee,_e){return U.H.useDeferredValue(ee,_e)},rr.useEffect=function(ee,_e){return U.H.useEffect(ee,_e)},rr.useEffectEvent=function(ee){return U.H.useEffectEvent(ee)},rr.useId=function(){return U.H.useId()},rr.useImperativeHandle=function(ee,_e,Ze){return U.H.useImperativeHandle(ee,_e,Ze)},rr.useInsertionEffect=function(ee,_e){return U.H.useInsertionEffect(ee,_e)},rr.useLayoutEffect=function(ee,_e){return U.H.useLayoutEffect(ee,_e)},rr.useMemo=function(ee,_e){return U.H.useMemo(ee,_e)},rr.useOptimistic=function(ee,_e){return U.H.useOptimistic(ee,_e)},rr.useReducer=function(ee,_e,Ze){return U.H.useReducer(ee,_e,Ze)},rr.useRef=function(ee){return U.H.useRef(ee)},rr.useState=function(ee){return U.H.useState(ee)},rr.useSyncExternalStore=function(ee,_e,Ze){return U.H.useSyncExternalStore(ee,_e,Ze)},rr.useTransition=function(){return U.H.useTransition()},rr.version="19.2.4",rr}var Sy;function um(){return Sy||(Sy=1,hg.exports=OT()),hg.exports}var wn=um();const MT=lm(wn);var gg={exports:{}},Fc={},mg={exports:{}},pg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _y;function PT(){return _y||(_y=1,(function(h){function e(me,X){var Ie=me.length;me.push(X);e:for(;0<Ie;){var Be=Ie-1>>>1,qe=me[Be];if(0<o(qe,X))me[Be]=X,me[Ie]=qe,Ie=Be;else break e}}function t(me){return me.length===0?null:me[0]}function r(me){if(me.length===0)return null;var X=me[0],Ie=me.pop();if(Ie!==X){me[0]=Ie;e:for(var Be=0,qe=me.length,ee=qe>>>1;Be<ee;){var _e=2*(Be+1)-1,Ze=me[_e],Ke=_e+1,De=me[Ke];if(0>o(Ze,Ie))Ke<qe&&0>o(De,Ze)?(me[Be]=De,me[Ke]=Ie,Be=Ke):(me[Be]=Ze,me[_e]=Ie,Be=_e);else if(Ke<qe&&0>o(De,Ie))me[Be]=De,me[Ke]=Ie,Be=Ke;else break e}}return X}function o(me,X){var Ie=me.sortIndex-X.sortIndex;return Ie!==0?Ie:me.id-X.id}if(h.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;h.unstable_now=function(){return l.now()}}else{var f=Date,y=f.now();h.unstable_now=function(){return f.now()-y}}var g=[],p=[],m=1,u=null,d=3,S=!1,_=!1,E=!1,b=!1,I=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function R(me){for(var X=t(p);X!==null;){if(X.callback===null)r(p);else if(X.startTime<=me)r(p),X.sortIndex=X.expirationTime,e(g,X);else break;X=t(p)}}function O(me){if(E=!1,R(me),!_)if(t(g)!==null)_=!0,H||(H=!0,fe());else{var X=t(p);X!==null&&Te(O,X.startTime-me)}}var H=!1,U=-1,Z=5,$=-1;function F(){return b?!0:!(h.unstable_now()-$<Z)}function W(){if(b=!1,H){var me=h.unstable_now();$=me;var X=!0;try{e:{_=!1,E&&(E=!1,T(U),U=-1),S=!0;var Ie=d;try{t:{for(R(me),u=t(g);u!==null&&!(u.expirationTime>me&&F());){var Be=u.callback;if(typeof Be=="function"){u.callback=null,d=u.priorityLevel;var qe=Be(u.expirationTime<=me);if(me=h.unstable_now(),typeof qe=="function"){u.callback=qe,R(me),X=!0;break t}u===t(g)&&r(g),R(me)}else r(g);u=t(g)}if(u!==null)X=!0;else{var ee=t(p);ee!==null&&Te(O,ee.startTime-me),X=!1}}break e}finally{u=null,d=Ie,S=!1}X=void 0}}finally{X?fe():H=!1}}}var fe;if(typeof A=="function")fe=function(){A(W)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,de=ne.port2;ne.port1.onmessage=W,fe=function(){de.postMessage(null)}}else fe=function(){I(W,0)};function Te(me,X){U=I(function(){me(h.unstable_now())},X)}h.unstable_IdlePriority=5,h.unstable_ImmediatePriority=1,h.unstable_LowPriority=4,h.unstable_NormalPriority=3,h.unstable_Profiling=null,h.unstable_UserBlockingPriority=2,h.unstable_cancelCallback=function(me){me.callback=null},h.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<me?Math.floor(1e3/me):5},h.unstable_getCurrentPriorityLevel=function(){return d},h.unstable_next=function(me){switch(d){case 1:case 2:case 3:var X=3;break;default:X=d}var Ie=d;d=X;try{return me()}finally{d=Ie}},h.unstable_requestPaint=function(){b=!0},h.unstable_runWithPriority=function(me,X){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var Ie=d;d=me;try{return X()}finally{d=Ie}},h.unstable_scheduleCallback=function(me,X,Ie){var Be=h.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?Be+Ie:Be):Ie=Be,me){case 1:var qe=-1;break;case 2:qe=250;break;case 5:qe=1073741823;break;case 4:qe=1e4;break;default:qe=5e3}return qe=Ie+qe,me={id:m++,callback:X,priorityLevel:me,startTime:Ie,expirationTime:qe,sortIndex:-1},Ie>Be?(me.sortIndex=Ie,e(p,me),t(g)===null&&me===t(p)&&(E?(T(U),U=-1):E=!0,Te(O,Ie-Be))):(me.sortIndex=qe,e(g,me),_||S||(_=!0,H||(H=!0,fe()))),me},h.unstable_shouldYield=F,h.unstable_wrapCallback=function(me){var X=d;return function(){var Ie=d;d=X;try{return me.apply(this,arguments)}finally{d=Ie}}}})(pg)),pg}var Ay;function kT(){return Ay||(Ay=1,mg.exports=PT()),mg.exports}var yg={exports:{}},Ui={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var by;function FT(){if(by)return Ui;by=1;var h=um();function e(g){var p="https://react.dev/errors/"+g;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)p+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+g+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(g,p,m){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:u==null?null:""+u,children:g,containerInfo:p,implementation:m}}var f=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function y(g,p){if(g==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Ui.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ui.createPortal=function(g,p){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(g,p,null,m)},Ui.flushSync=function(g){var p=f.T,m=r.p;try{if(f.T=null,r.p=2,g)return g()}finally{f.T=p,r.p=m,r.d.f()}},Ui.preconnect=function(g,p){typeof g=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,r.d.C(g,p))},Ui.prefetchDNS=function(g){typeof g=="string"&&r.d.D(g)},Ui.preinit=function(g,p){if(typeof g=="string"&&p&&typeof p.as=="string"){var m=p.as,u=y(m,p.crossOrigin),d=typeof p.integrity=="string"?p.integrity:void 0,S=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;m==="style"?r.d.S(g,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:u,integrity:d,fetchPriority:S}):m==="script"&&r.d.X(g,{crossOrigin:u,integrity:d,fetchPriority:S,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Ui.preinitModule=function(g,p){if(typeof g=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var m=y(p.as,p.crossOrigin);r.d.M(g,{crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&r.d.M(g)},Ui.preload=function(g,p){if(typeof g=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var m=p.as,u=y(m,p.crossOrigin);r.d.L(g,m,{crossOrigin:u,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Ui.preloadModule=function(g,p){if(typeof g=="string")if(p){var m=y(p.as,p.crossOrigin);r.d.m(g,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else r.d.m(g)},Ui.requestFormReset=function(g){r.d.r(g)},Ui.unstable_batchedUpdates=function(g,p){return g(p)},Ui.useFormState=function(g,p,m){return f.H.useFormState(g,p,m)},Ui.useFormStatus=function(){return f.H.useHostTransitionStatus()},Ui.version="19.2.4",Ui}var Ry;function UT(){if(Ry)return yg.exports;Ry=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(e){console.error(e)}}return h(),yg.exports=FT(),yg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iy;function BT(){if(Iy)return Fc;Iy=1;var h=kT(),e=um(),t=UT();function r(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,c=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(c=i.return),n=i.return;while(n)}return i.tag===3?c:null}function f(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function y(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function g(n){if(l(n)!==n)throw Error(r(188))}function p(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(r(188));return i!==n?null:n}for(var c=n,v=i;;){var L=c.return;if(L===null)break;var M=L.alternate;if(M===null){if(v=L.return,v!==null){c=v;continue}break}if(L.child===M.child){for(M=L.child;M;){if(M===c)return g(L),n;if(M===v)return g(L),i;M=M.sibling}throw Error(r(188))}if(c.return!==v.return)c=L,v=M;else{for(var ce=!1,ke=L.child;ke;){if(ke===c){ce=!0,c=L,v=M;break}if(ke===v){ce=!0,v=L,c=M;break}ke=ke.sibling}if(!ce){for(ke=M.child;ke;){if(ke===c){ce=!0,c=M,v=L;break}if(ke===v){ce=!0,v=M,c=L;break}ke=ke.sibling}if(!ce)throw Error(r(189))}}if(c.alternate!==v)throw Error(r(190))}if(c.tag!==3)throw Error(r(188));return c.stateNode.current===c?n:i}function m(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=m(n),i!==null)return i;n=n.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),A=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function fe(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var ne=Symbol.for("react.client.reference");function de(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===ne?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case E:return"Fragment";case I:return"Profiler";case b:return"StrictMode";case O:return"Suspense";case H:return"SuspenseList";case $:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case _:return"Portal";case A:return n.displayName||"Context";case T:return(n._context.displayName||"Context")+".Consumer";case R:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case U:return i=n.displayName||null,i!==null?i:de(n.type)||"Memo";case Z:i=n._payload,n=n._init;try{return de(n(i))}catch{}}return null}var Te=Array.isArray,me=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie={pending:!1,data:null,method:null,action:null},Be=[],qe=-1;function ee(n){return{current:n}}function _e(n){0>qe||(n.current=Be[qe],Be[qe]=null,qe--)}function Ze(n,i){qe++,Be[qe]=n.current,n.current=i}var Ke=ee(null),De=ee(null),Ge=ee(null),Et=ee(null);function vt(n,i){switch(Ze(Ge,i),Ze(De,n),Ze(Ke,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?Zp(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=Zp(i),n=Hp(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}_e(Ke),Ze(Ke,n)}function et(){_e(Ke),_e(De),_e(Ge)}function gt(n){n.memoizedState!==null&&Ze(Et,n);var i=Ke.current,c=Hp(i,n.type);i!==c&&(Ze(De,n),Ze(Ke,c))}function Oe(n){De.current===n&&(_e(Ke),_e(De)),Et.current===n&&(_e(Et),wc._currentValue=Ie)}var Fe,it;function w(n){if(Fe===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);Fe=i&&i[1]||"",it=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Fe+n+it}var N=!1;function G(n,i){if(!n||N)return"";N=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(i){var dn=function(){throw Error()};if(Object.defineProperty(dn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(dn,[])}catch($t){var Zt=$t}Reflect.construct(n,[],dn)}else{try{dn.call()}catch($t){Zt=$t}n.call(dn.prototype)}}else{try{throw Error()}catch($t){Zt=$t}(dn=n())&&typeof dn.catch=="function"&&dn.catch(function(){})}}catch($t){if($t&&Zt&&typeof $t.stack=="string")return[$t.stack,Zt.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var L=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");L&&L.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var M=v.DetermineComponentFrameRoot(),ce=M[0],ke=M[1];if(ce&&ke){var rt=ce.split(`
`),Ut=ke.split(`
`);for(L=v=0;v<rt.length&&!rt[v].includes("DetermineComponentFrameRoot");)v++;for(;L<Ut.length&&!Ut[L].includes("DetermineComponentFrameRoot");)L++;if(v===rt.length||L===Ut.length)for(v=rt.length-1,L=Ut.length-1;1<=v&&0<=L&&rt[v]!==Ut[L];)L--;for(;1<=v&&0<=L;v--,L--)if(rt[v]!==Ut[L]){if(v!==1||L!==1)do if(v--,L--,0>L||rt[v]!==Ut[L]){var Qt=`
`+rt[v].replace(" at new "," at ");return n.displayName&&Qt.includes("<anonymous>")&&(Qt=Qt.replace("<anonymous>",n.displayName)),Qt}while(1<=v&&0<=L);break}}}finally{N=!1,Error.prepareStackTrace=c}return(c=n?n.displayName||n.name:"")?w(c):""}function V(n,i){switch(n.tag){case 26:case 27:case 5:return w(n.type);case 16:return w("Lazy");case 13:return n.child!==i&&i!==null?w("Suspense Fallback"):w("Suspense");case 19:return w("SuspenseList");case 0:case 15:return G(n.type,!1);case 11:return G(n.type.render,!1);case 1:return G(n.type,!0);case 31:return w("Activity");default:return""}}function ye(n){try{var i="",c=null;do i+=V(n,c),c=n,n=n.return;while(n);return i}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}var he=Object.prototype.hasOwnProperty,He=h.unstable_scheduleCallback,ut=h.unstable_cancelCallback,Je=h.unstable_shouldYield,Qe=h.unstable_requestPaint,Ye=h.unstable_now,nt=h.unstable_getCurrentPriorityLevel,mt=h.unstable_ImmediatePriority,Gt=h.unstable_UserBlockingPriority,_t=h.unstable_NormalPriority,gn=h.unstable_LowPriority,Wt=h.unstable_IdlePriority,ln=h.log,cn=h.unstable_setDisableYieldValue,On=null,zn=null;function ar(n){if(typeof ln=="function"&&cn(n),zn&&typeof zn.setStrictMode=="function")try{zn.setStrictMode(On,n)}catch{}}var er=Math.clz32?Math.clz32:gr,Rr=Math.log,li=Math.LN2;function gr(n){return n>>>=0,n===0?32:31-(Rr(n)/li|0)|0}var gi=256,Zr=262144,ri=4194304;function ui(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function ii(n,i,c){var v=n.pendingLanes;if(v===0)return 0;var L=0,M=n.suspendedLanes,ce=n.pingedLanes;n=n.warmLanes;var ke=v&134217727;return ke!==0?(v=ke&~M,v!==0?L=ui(v):(ce&=ke,ce!==0?L=ui(ce):c||(c=ke&~n,c!==0&&(L=ui(c))))):(ke=v&~M,ke!==0?L=ui(ke):ce!==0?L=ui(ce):c||(c=v&~n,c!==0&&(L=ui(c)))),L===0?0:i!==0&&i!==L&&(i&M)===0&&(M=L&-L,c=i&-i,M>=c||M===32&&(c&4194048)!==0)?i:L}function bi(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function zi(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Us(){var n=ri;return ri<<=1,(ri&62914560)===0&&(ri=4194304),n}function qt(n){for(var i=[],c=0;31>c;c++)i.push(n);return i}function Vt(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Kt(n,i,c,v,L,M){var ce=n.pendingLanes;n.pendingLanes=c,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=c,n.entangledLanes&=c,n.errorRecoveryDisabledLanes&=c,n.shellSuspendCounter=0;var ke=n.entanglements,rt=n.expirationTimes,Ut=n.hiddenUpdates;for(c=ce&~c;0<c;){var Qt=31-er(c),dn=1<<Qt;ke[Qt]=0,rt[Qt]=-1;var Zt=Ut[Qt];if(Zt!==null)for(Ut[Qt]=null,Qt=0;Qt<Zt.length;Qt++){var $t=Zt[Qt];$t!==null&&($t.lane&=-536870913)}c&=~dn}v!==0&&at(n,v,0),M!==0&&L===0&&n.tag!==0&&(n.suspendedLanes|=M&~(ce&~i))}function at(n,i,c){n.pendingLanes|=i,n.suspendedLanes&=~i;var v=31-er(i);n.entangledLanes|=i,n.entanglements[v]=n.entanglements[v]|1073741824|c&261930}function Ot(n,i){var c=n.entangledLanes|=i;for(n=n.entanglements;c;){var v=31-er(c),L=1<<v;L&i|n[v]&i&&(n[v]|=i),c&=~L}}function ct(n,i){var c=i&-i;return c=(c&42)!==0?1:It(c),(c&(n.suspendedLanes|i))!==0?0:c}function It(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function sn(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function fn(){var n=X.p;return n!==0?n:(n=window.event,n===void 0?32:fy(n.type))}function Rn(n,i){var c=X.p;try{return X.p=n,i()}finally{X.p=c}}var In=Math.random().toString(36).slice(2),Jt="__reactFiber$"+In,Pt="__reactProps$"+In,bn="__reactContainer$"+In,Sn="__reactEvents$"+In,Gn="__reactListeners$"+In,tr="__reactHandles$"+In,mr="__reactResources$"+In,xn="__reactMarker$"+In;function Ht(n){delete n[Jt],delete n[Pt],delete n[Sn],delete n[Gn],delete n[tr]}function Yt(n){var i=n[Jt];if(i)return i;for(var c=n.parentNode;c;){if(i=c[bn]||c[Jt]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(n=$p(n);n!==null;){if(c=n[Jt])return c;n=$p(n)}return i}n=c,c=n.parentNode}return null}function hn(n){if(n=n[Jt]||n[bn]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function Mn(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(r(33))}function kn(n){var i=n[mr];return i||(i=n[mr]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function $n(n){n[xn]=!0}var lr=new Set,ci={};function Kr(n,i){Er(n,i),Er(n+"Capture",i)}function Er(n,i){for(ci[n]=i,n=0;n<i.length;n++)lr.add(i[n])}var Jr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pr={},fi={};function cs(n){return he.call(fi,n)?!0:he.call(Pr,n)?!1:Jr.test(n)?fi[n]=!0:(Pr[n]=!0,!1)}function Di(n,i,c){if(cs(i))if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var v=i.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+c)}}function Pi(n,i,c){if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+c)}}function zr(n,i,c,v){if(v===null)n.removeAttribute(c);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(c);return}n.setAttributeNS(i,c,""+v)}}function Li(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Bs(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Pl(n,i,c){var v=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var L=v.get,M=v.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return L.call(this)},set:function(ce){c=""+ce,M.call(this,ce)}}),Object.defineProperty(n,i,{enumerable:v.enumerable}),{getValue:function(){return c},setValue:function(ce){c=""+ce},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function po(n){if(!n._valueTracker){var i=Bs(n)?"checked":"value";n._valueTracker=Pl(n,i,""+n[i])}}function rl(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var c=i.getValue(),v="";return n&&(v=Bs(n)?n.checked?"true":"false":n.value),n=v,n!==c?(i.setValue(n),!0):!1}function Ga(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var rn=/[\n"\\]/g;function Cn(n){return n.replace(rn,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Xn(n,i,c,v,L,M,ce,ke){n.name="",ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?n.type=ce:n.removeAttribute("type"),i!=null?ce==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+Li(i)):n.value!==""+Li(i)&&(n.value=""+Li(i)):ce!=="submit"&&ce!=="reset"||n.removeAttribute("value"),i!=null?pr(n,ce,Li(i)):c!=null?pr(n,ce,Li(c)):v!=null&&n.removeAttribute("value"),L==null&&M!=null&&(n.defaultChecked=!!M),L!=null&&(n.checked=L&&typeof L!="function"&&typeof L!="symbol"),ke!=null&&typeof ke!="function"&&typeof ke!="symbol"&&typeof ke!="boolean"?n.name=""+Li(ke):n.removeAttribute("name")}function kr(n,i,c,v,L,M,ce,ke){if(M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(n.type=M),i!=null||c!=null){if(!(M!=="submit"&&M!=="reset"||i!=null)){po(n);return}c=c!=null?""+Li(c):"",i=i!=null?""+Li(i):c,ke||i===n.value||(n.value=i),n.defaultValue=i}v=v??L,v=typeof v!="function"&&typeof v!="symbol"&&!!v,n.checked=ke?n.checked:!!v,n.defaultChecked=!!v,ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"&&(n.name=ce),po(n)}function pr(n,i,c){i==="number"&&Ga(n.ownerDocument)===n||n.defaultValue===""+c||(n.defaultValue=""+c)}function Fr(n,i,c,v){if(n=n.options,i){i={};for(var L=0;L<c.length;L++)i["$"+c[L]]=!0;for(c=0;c<n.length;c++)L=i.hasOwnProperty("$"+n[c].value),n[c].selected!==L&&(n[c].selected=L),L&&v&&(n[c].defaultSelected=!0)}else{for(c=""+Li(c),i=null,L=0;L<n.length;L++){if(n[L].value===c){n[L].selected=!0,v&&(n[L].defaultSelected=!0);return}i!==null||n[L].disabled||(i=n[L])}i!==null&&(i.selected=!0)}}function _r(n,i,c){if(i!=null&&(i=""+Li(i),i!==n.value&&(n.value=i),c==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=c!=null?""+Li(c):""}function ki(n,i,c,v){if(i==null){if(v!=null){if(c!=null)throw Error(r(92));if(Te(v)){if(1<v.length)throw Error(r(93));v=v[0]}c=v}c==null&&(c=""),i=c}c=Li(i),n.defaultValue=c,v=n.textContent,v===c&&v!==""&&v!==null&&(n.value=v),po(n)}function xr(n,i){if(i){var c=n.firstChild;if(c&&c===n.lastChild&&c.nodeType===3){c.nodeValue=i;return}}n.textContent=i}var Lr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function vi(n,i,c){var v=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?v?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":v?n.setProperty(i,c):typeof c!="number"||c===0||Lr.has(i)?i==="float"?n.cssFloat=c:n[i]=(""+c).trim():n[i]=c+"px"}function Ei(n,i,c){if(i!=null&&typeof i!="object")throw Error(r(62));if(n=n.style,c!=null){for(var v in c)!c.hasOwnProperty(v)||i!=null&&i.hasOwnProperty(v)||(v.indexOf("--")===0?n.setProperty(v,""):v==="float"?n.cssFloat="":n[v]="");for(var L in i)v=i[L],i.hasOwnProperty(L)&&c[L]!==v&&vi(n,L,v)}else for(var M in i)i.hasOwnProperty(M)&&vi(n,M,i[M])}function Bi(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $i=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ua=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ca(n){return ua.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Gi(){}var fs=null;function ds(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Za=null,Ha=null;function kl(n){var i=hn(n);if(i&&(n=i.stateNode)){var c=n[Pt]||null;e:switch(n=i.stateNode,i.type){case"input":if(Xn(n,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=n;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Cn(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var v=c[i];if(v!==n&&v.form===n.form){var L=v[Pt]||null;if(!L)throw Error(r(90));Xn(v,L.value,L.defaultValue,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name)}}for(i=0;i<c.length;i++)v=c[i],v.form===n.form&&rl(v)}break e;case"textarea":_r(n,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&Fr(n,!!c.multiple,i,!1)}}}var il=!1;function al(n,i,c){if(il)return n(i,c);il=!0;try{var v=n(i);return v}finally{if(il=!1,(Za!==null||Ha!==null)&&(qf(),Za&&(i=Za,n=Ha,Ha=Za=null,kl(i),n)))for(i=0;i<n.length;i++)kl(n[i])}}function hs(n,i){var c=n.stateNode;if(c===null)return null;var v=c[Pt]||null;if(v===null)return null;c=v[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(n=n.type,v=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!v;break e;default:n=!1}if(n)return null;if(c&&typeof c!="function")throw Error(r(231,i,typeof c));return c}var fa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gs=!1;if(fa)try{var gs={};Object.defineProperty(gs,"passive",{get:function(){Gs=!0}}),window.addEventListener("test",gs,gs),window.removeEventListener("test",gs,gs)}catch{Gs=!1}var Zi=null,sl=null,Tr=null;function ms(){if(Tr)return Tr;var n,i=sl,c=i.length,v,L="value"in Zi?Zi.value:Zi.textContent,M=L.length;for(n=0;n<c&&i[n]===L[n];n++);var ce=c-n;for(v=1;v<=ce&&i[c-v]===L[M-v];v++);return Tr=L.slice(n,1<v?1-v:void 0)}function Va(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Ra(){return!0}function ol(){return!1}function Hr(n){function i(c,v,L,M,ce){this._reactName=c,this._targetInst=L,this.type=v,this.nativeEvent=M,this.target=ce,this.currentTarget=null;for(var ke in n)n.hasOwnProperty(ke)&&(c=n[ke],this[ke]=c?c(M):M[ke]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Ra:ol,this.isPropagationStopped=ol,this}return u(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ra)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ra)},persist:function(){},isPersistent:Ra}),i}var Ia={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},da=Hr(Ia),ps=u({},Ia,{view:0,detail:0}),Xc=Hr(ps),ll,ul,cl,fl=u({},ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uu,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==cl&&(cl&&n.type==="mousemove"?(ll=n.screenX-cl.screenX,ul=n.screenY-cl.screenY):ul=ll=0,cl=n),ll)},movementY:function(n){return"movementY"in n?n.movementY:ul}}),Qc=Hr(fl),Jc=u({},fl,{dataTransfer:0}),Xd=Hr(Jc),yo=u({},ps,{relatedTarget:0}),dl=Hr(yo),ef=u({},Ia,{animationName:0,elapsedTime:0,pseudoElement:0}),tf=Hr(ef),nf=u({},Ia,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Qd=Hr(nf),rf=u({},Ia,{data:0}),af=Hr(rf),Jd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},of={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lf(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=of[n])?!!i[n]:!1}function Uu(){return lf}var eh=u({},ps,{key:function(n){if(n.key){var i=Jd[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Va(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?sf[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uu,charCode:function(n){return n.type==="keypress"?Va(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Va(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Fl=Hr(eh),uf=u({},fl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ul=Hr(uf),cf=u({},ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uu}),th=Hr(cf),Bl=u({},Ia,{propertyName:0,elapsedTime:0,pseudoElement:0}),ff=Hr(Bl),df=u({},fl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),nh=Hr(df),hf=u({},Ia,{newState:0,oldState:0}),rh=Hr(hf),gf=[9,13,27,32],Bu=fa&&"CompositionEvent"in window,vo=null;fa&&"documentMode"in document&&(vo=document.documentMode);var ih=fa&&"TextEvent"in window&&!vo,Gu=fa&&(!Bu||vo&&8<vo&&11>=vo),mf=" ",Zu=!1;function pf(n,i){switch(n){case"keyup":return gf.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gl(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ys=!1;function ah(n,i){switch(n){case"compositionend":return Gl(i);case"keypress":return i.which!==32?null:(Zu=!0,mf);case"textInput":return n=i.data,n===mf&&Zu?null:n;default:return null}}function Zl(n,i){if(ys)return n==="compositionend"||!Bu&&pf(n,i)?(n=ms(),Tr=sl=Zi=null,ys=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Gu&&i.locale!=="ko"?null:i.data;default:return null}}var yf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hu(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!yf[n.type]:i==="textarea"}function vf(n,i,c,v){Za?Ha?Ha.push(v):Ha=[v]:Za=v,i=Jf(i,"onChange"),0<i.length&&(c=new da("onChange","change",null,c,v),n.push({event:c,listeners:i}))}var Eo=null,Ca=null;function Ef(n){Pp(n,0)}function Hl(n){var i=Mn(n);if(rl(i))return n}function To(n,i){if(n==="change")return i}var Vu=!1;if(fa){var Yu;if(fa){var ju="oninput"in document;if(!ju){var So=document.createElement("div");So.setAttribute("oninput","return;"),ju=typeof So.oninput=="function"}Yu=ju}else Yu=!1;Vu=Yu&&(!document.documentMode||9<document.documentMode)}function Vl(){Eo&&(Eo.detachEvent("onpropertychange",Ir),Ca=Eo=null)}function Ir(n){if(n.propertyName==="value"&&Hl(Ca)){var i=[];vf(i,Ca,n,ds(n)),al(Ef,i)}}function qu(n,i,c){n==="focusin"?(Vl(),Eo=i,Ca=c,Eo.attachEvent("onpropertychange",Ir)):n==="focusout"&&Vl()}function sh(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Hl(Ca)}function Yl(n,i){if(n==="click")return Hl(i)}function oh(n,i){if(n==="input"||n==="change")return Hl(i)}function Ku(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var xi=typeof Object.is=="function"?Object.is:Ku;function hl(n,i){if(xi(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var c=Object.keys(n),v=Object.keys(i);if(c.length!==v.length)return!1;for(v=0;v<c.length;v++){var L=c[v];if(!he.call(i,L)||!xi(n[L],i[L]))return!1}return!0}function gl(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function zu(n,i){var c=gl(n);n=0;for(var v;c;){if(c.nodeType===3){if(v=n+c.textContent.length,n<=i&&v>=i)return{node:c,offset:i-n};n=v}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=gl(c)}}function Tf(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Tf(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function jl(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Ga(n.document);i instanceof n.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)n=i.contentWindow;else break;i=Ga(n.document)}return i}function ml(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var lh=fa&&"documentMode"in document&&11>=document.documentMode,Ya=null,ql=null,pl=null,yl=!1;function Kl(n,i,c){var v=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;yl||Ya==null||Ya!==Ga(v)||(v=Ya,"selectionStart"in v&&ml(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),pl&&hl(pl,v)||(pl=v,v=Jf(ql,"onSelect"),0<v.length&&(i=new da("onSelect","select",null,i,c),n.push({event:i,listeners:v}),i.target=Ya)))}function Zs(n,i){var c={};return c[n.toLowerCase()]=i.toLowerCase(),c["Webkit"+n]="webkit"+i,c["Moz"+n]="moz"+i,c}var ja={animationend:Zs("Animation","AnimationEnd"),animationiteration:Zs("Animation","AnimationIteration"),animationstart:Zs("Animation","AnimationStart"),transitionrun:Zs("Transition","TransitionRun"),transitionstart:Zs("Transition","TransitionStart"),transitioncancel:Zs("Transition","TransitionCancel"),transitionend:Zs("Transition","TransitionEnd")},$u={},Sf={};fa&&(Sf=document.createElement("div").style,"AnimationEvent"in window||(delete ja.animationend.animation,delete ja.animationiteration.animation,delete ja.animationstart.animation),"TransitionEvent"in window||delete ja.transitionend.transition);function qa(n){if($u[n])return $u[n];if(!ja[n])return n;var i=ja[n],c;for(c in i)if(i.hasOwnProperty(c)&&c in Sf)return $u[n]=i[c];return n}var _o=qa("animationend"),zl=qa("animationiteration"),_f=qa("animationstart"),$l=qa("transitionrun"),uh=qa("transitionstart"),ch=qa("transitioncancel"),Af=qa("transitionend"),bf=new Map,vs="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");vs.push("scrollEnd");function Hi(n,i){bf.set(n,i),Kr(i,[n])}var Ao=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Wi=[],Ka=0,Wu=0;function bo(){for(var n=Ka,i=Wu=Ka=0;i<n;){var c=Wi[i];Wi[i++]=null;var v=Wi[i];Wi[i++]=null;var L=Wi[i];Wi[i++]=null;var M=Wi[i];if(Wi[i++]=null,v!==null&&L!==null){var ce=v.pending;ce===null?L.next=L:(L.next=ce.next,ce.next=L),v.pending=L}M!==0&&Rf(c,L,M)}}function Ro(n,i,c,v){Wi[Ka++]=n,Wi[Ka++]=i,Wi[Ka++]=c,Wi[Ka++]=v,Wu|=v,n.lanes|=v,n=n.alternate,n!==null&&(n.lanes|=v)}function Xu(n,i,c,v){return Ro(n,i,c,v),vl(n)}function Da(n,i){return Ro(n,null,null,i),vl(n)}function Rf(n,i,c){n.lanes|=c;var v=n.alternate;v!==null&&(v.lanes|=c);for(var L=!1,M=n.return;M!==null;)M.childLanes|=c,v=M.alternate,v!==null&&(v.childLanes|=c),M.tag===22&&(n=M.stateNode,n===null||n._visibility&1||(L=!0)),n=M,M=M.return;return n.tag===3?(M=n.stateNode,L&&i!==null&&(L=31-er(c),n=M.hiddenUpdates,v=n[L],v===null?n[L]=[i]:v.push(i),i.lane=c|536870912),M):null}function vl(n){if(50<Rc)throw Rc=0,kh=null,Error(r(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Io={};function If(n,i,c,v){this.tag=n,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vi(n,i,c,v){return new If(n,i,c,v)}function Wl(n){return n=n.prototype,!(!n||!n.isReactComponent)}function za(n,i){var c=n.alternate;return c===null?(c=Vi(n.tag,i,n.key,n.mode),c.elementType=n.elementType,c.type=n.type,c.stateNode=n.stateNode,c.alternate=n,n.alternate=c):(c.pendingProps=i,c.type=n.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=n.flags&65011712,c.childLanes=n.childLanes,c.lanes=n.lanes,c.child=n.child,c.memoizedProps=n.memoizedProps,c.memoizedState=n.memoizedState,c.updateQueue=n.updateQueue,i=n.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=n.sibling,c.index=n.index,c.ref=n.ref,c.refCleanup=n.refCleanup,c}function Qu(n,i){n.flags&=65011714;var c=n.alternate;return c===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=c.childLanes,n.lanes=c.lanes,n.child=c.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=c.memoizedProps,n.memoizedState=c.memoizedState,n.updateQueue=c.updateQueue,n.type=c.type,i=c.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function El(n,i,c,v,L,M){var ce=0;if(v=n,typeof n=="function")Wl(n)&&(ce=1);else if(typeof n=="string")ce=ET(n,c,Ke.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case $:return n=Vi(31,c,i,L),n.elementType=$,n.lanes=M,n;case E:return Hs(c.children,L,M,i);case b:ce=8,L|=24;break;case I:return n=Vi(12,c,i,L|2),n.elementType=I,n.lanes=M,n;case O:return n=Vi(13,c,i,L),n.elementType=O,n.lanes=M,n;case H:return n=Vi(19,c,i,L),n.elementType=H,n.lanes=M,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case A:ce=10;break e;case T:ce=9;break e;case R:ce=11;break e;case U:ce=14;break e;case Z:ce=16,v=null;break e}ce=29,c=Error(r(130,n===null?"null":typeof n,"")),v=null}return i=Vi(ce,c,i,L),i.elementType=n,i.type=v,i.lanes=M,i}function Hs(n,i,c,v){return n=Vi(7,n,v,i),n.lanes=c,n}function Ju(n,i,c){return n=Vi(6,n,null,i),n.lanes=c,n}function ec(n){var i=Vi(18,null,null,0);return i.stateNode=n,i}function tc(n,i,c){return i=Vi(4,n.children!==null?n.children:[],n.key,i),i.lanes=c,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var nc=new WeakMap;function Xi(n,i){if(typeof n=="object"&&n!==null){var c=nc.get(n);return c!==void 0?c:(i={value:n,source:i,stack:ye(i)},nc.set(n,i),i)}return{value:n,source:i,stack:ye(i)}}var Es=[],Vs=0,Xl=null,Tl=0,Yi=[],ji=0,ha=null,ga=1,La="";function xa(n,i){Es[Vs++]=Tl,Es[Vs++]=Xl,Xl=n,Tl=i}function Cf(n,i,c){Yi[ji++]=ga,Yi[ji++]=La,Yi[ji++]=ha,ha=n;var v=ga;n=La;var L=32-er(v)-1;v&=~(1<<L),c+=1;var M=32-er(i)+L;if(30<M){var ce=L-L%5;M=(v&(1<<ce)-1).toString(32),v>>=ce,L-=ce,ga=1<<32-er(i)+L|c<<L|v,La=M+n}else ga=1<<M|c<<L|v,La=n}function Ql(n){n.return!==null&&(xa(n,1),Cf(n,1,0))}function rc(n){for(;n===Xl;)Xl=Es[--Vs],Es[Vs]=null,Tl=Es[--Vs],Es[Vs]=null;for(;n===ha;)ha=Yi[--ji],Yi[ji]=null,La=Yi[--ji],Yi[ji]=null,ga=Yi[--ji],Yi[ji]=null}function Jl(n,i){Yi[ji++]=ga,Yi[ji++]=La,Yi[ji++]=ha,ga=i.id,La=i.overflow,ha=n}var di=null,Vr=null,ur=!1,$a=null,Qi=!1,ic=Error(r(519));function Wa(n){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Sl(Xi(i,n)),ic}function ac(n){var i=n.stateNode,c=n.type,v=n.memoizedProps;switch(i[Jt]=n,i[Pt]=v,c){case"dialog":hr("cancel",i),hr("close",i);break;case"iframe":case"object":case"embed":hr("load",i);break;case"video":case"audio":for(c=0;c<Cc.length;c++)hr(Cc[c],i);break;case"source":hr("error",i);break;case"img":case"image":case"link":hr("error",i),hr("load",i);break;case"details":hr("toggle",i);break;case"input":hr("invalid",i),kr(i,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0);break;case"select":hr("invalid",i);break;case"textarea":hr("invalid",i),ki(i,v.value,v.defaultValue,v.children)}c=v.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||v.suppressHydrationWarning===!0||Bp(i.textContent,c)?(v.popover!=null&&(hr("beforetoggle",i),hr("toggle",i)),v.onScroll!=null&&hr("scroll",i),v.onScrollEnd!=null&&hr("scrollend",i),v.onClick!=null&&(i.onclick=Gi),i=!0):i=!1,i||Wa(n,!0)}function Ys(n){for(di=n.return;di;)switch(di.tag){case 5:case 31:case 13:Qi=!1;return;case 27:case 3:Qi=!0;return;default:di=di.return}}function js(n){if(n!==di)return!1;if(!ur)return Ys(n),ur=!0,!1;var i=n.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=n.type,c=!(c!=="form"&&c!=="button")||Xh(n.type,n.memoizedProps)),c=!c),c&&Vr&&Wa(n),Ys(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Vr=zp(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Vr=zp(n)}else i===27?(i=Vr,Yo(n.type)?(n=ng,ng=null,Vr=n):Vr=i):Vr=di?ka(n.stateNode.nextSibling):null;return!0}function Ts(){Vr=di=null,ur=!1}function eu(){var n=$a;return n!==null&&(aa===null?aa=n:aa.push.apply(aa,n),$a=null),n}function Sl(n){$a===null?$a=[n]:$a.push(n)}var sc=ee(null),Ss=null,Na=null;function _s(n,i,c){Ze(sc,i._currentValue),i._currentValue=c}function wa(n){n._currentValue=sc.current,_e(sc)}function tu(n,i,c){for(;n!==null;){var v=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,v!==null&&(v.childLanes|=i)):v!==null&&(v.childLanes&i)!==i&&(v.childLanes|=i),n===c)break;n=n.return}}function nu(n,i,c,v){var L=n.child;for(L!==null&&(L.return=n);L!==null;){var M=L.dependencies;if(M!==null){var ce=L.child;M=M.firstContext;e:for(;M!==null;){var ke=M;M=L;for(var rt=0;rt<i.length;rt++)if(ke.context===i[rt]){M.lanes|=c,ke=M.alternate,ke!==null&&(ke.lanes|=c),tu(M.return,c,n),v||(ce=null);break e}M=ke.next}}else if(L.tag===18){if(ce=L.return,ce===null)throw Error(r(341));ce.lanes|=c,M=ce.alternate,M!==null&&(M.lanes|=c),tu(ce,c,n),ce=null}else ce=L.child;if(ce!==null)ce.return=L;else for(ce=L;ce!==null;){if(ce===n){ce=null;break}if(L=ce.sibling,L!==null){L.return=ce.return,ce=L;break}ce=ce.return}L=ce}}function Co(n,i,c,v){n=null;for(var L=i,M=!1;L!==null;){if(!M){if((L.flags&524288)!==0)M=!0;else if((L.flags&262144)!==0)break}if(L.tag===10){var ce=L.alternate;if(ce===null)throw Error(r(387));if(ce=ce.memoizedProps,ce!==null){var ke=L.type;xi(L.pendingProps.value,ce.value)||(n!==null?n.push(ke):n=[ke])}}else if(L===Et.current){if(ce=L.alternate,ce===null)throw Error(r(387));ce.memoizedState.memoizedState!==L.memoizedState.memoizedState&&(n!==null?n.push(wc):n=[wc])}L=L.return}n!==null&&nu(i,n,c,v),i.flags|=262144}function _l(n){for(n=n.firstContext;n!==null;){if(!xi(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function qs(n){Ss=n,Na=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function mi(n){return oc(Ss,n)}function Do(n,i){return Ss===null&&qs(n),oc(n,i)}function oc(n,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},Na===null){if(n===null)throw Error(r(308));Na=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Na=Na.next=i;return c}var fh=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(c,v){n.push(v)}};this.abort=function(){i.aborted=!0,n.forEach(function(c){return c()})}},dh=h.unstable_scheduleCallback,hh=h.unstable_NormalPriority,ai={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lc(){return{controller:new fh,data:new Map,refCount:0}}function Lo(n){n.refCount--,n.refCount===0&&dh(hh,function(){n.controller.abort()})}var Al=null,ru=0,xo=0,No=null;function gh(n,i){if(Al===null){var c=Al=[];ru=0,xo=Hh(),No={status:"pending",value:void 0,then:function(v){c.push(v)}}}return ru++,i.then(Df,Df),i}function Df(){if(--ru===0&&Al!==null){No!==null&&(No.status="fulfilled");var n=Al;Al=null,xo=0,No=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function mh(n,i){var c=[],v={status:"pending",value:null,reason:null,then:function(L){c.push(L)}};return n.then(function(){v.status="fulfilled",v.value=i;for(var L=0;L<c.length;L++)(0,c[L])(i)},function(L){for(v.status="rejected",v.reason=L,L=0;L<c.length;L++)(0,c[L])(void 0)}),v}var Lf=me.S;me.S=function(n,i){up=Ye(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&gh(n,i),Lf!==null&&Lf(n,i)};var Ks=ee(null);function uc(){var n=Ks.current;return n!==null?n:Yr.pooledCache}function iu(n,i){i===null?Ze(Ks,Ks.current):Ze(Ks,i.pool)}function au(){var n=uc();return n===null?null:{parent:ai._currentValue,pool:n}}var wo=Error(r(460)),cc=Error(r(474)),su=Error(r(542)),ou={then:function(){}};function xf(n){return n=n.status,n==="fulfilled"||n==="rejected"}function fc(n,i,c){switch(c=n[c],c===void 0?n.push(i):c!==i&&(i.then(Gi,Gi),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,dc(n),n;default:if(typeof i.status=="string")i.then(Gi,Gi);else{if(n=Yr,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=i,n.status="pending",n.then(function(v){if(i.status==="pending"){var L=i;L.status="fulfilled",L.value=v}},function(v){if(i.status==="pending"){var L=i;L.status="rejected",L.reason=v}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,dc(n),n}throw As=i,wo}}function zs(n){try{var i=n._init;return i(n._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(As=c,wo):c}}var As=null;function Nf(){if(As===null)throw Error(r(459));var n=As;return As=null,n}function dc(n){if(n===wo||n===su)throw Error(r(483))}var Oo=null,$s=0;function Ws(n){var i=$s;return $s+=1,Oo===null&&(Oo=[]),fc(Oo,n,i)}function Xs(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function Mo(n,i){throw i.$$typeof===d?Error(r(525)):(n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function wf(n){function i(Rt,ht){if(n){var kt=Rt.deletions;kt===null?(Rt.deletions=[ht],Rt.flags|=16):kt.push(ht)}}function c(Rt,ht){if(!n)return null;for(;ht!==null;)i(Rt,ht),ht=ht.sibling;return null}function v(Rt){for(var ht=new Map;Rt!==null;)Rt.key!==null?ht.set(Rt.key,Rt):ht.set(Rt.index,Rt),Rt=Rt.sibling;return ht}function L(Rt,ht){return Rt=za(Rt,ht),Rt.index=0,Rt.sibling=null,Rt}function M(Rt,ht,kt){return Rt.index=kt,n?(kt=Rt.alternate,kt!==null?(kt=kt.index,kt<ht?(Rt.flags|=67108866,ht):kt):(Rt.flags|=67108866,ht)):(Rt.flags|=1048576,ht)}function ce(Rt){return n&&Rt.alternate===null&&(Rt.flags|=67108866),Rt}function ke(Rt,ht,kt,on){return ht===null||ht.tag!==6?(ht=Ju(kt,Rt.mode,on),ht.return=Rt,ht):(ht=L(ht,kt),ht.return=Rt,ht)}function rt(Rt,ht,kt,on){var Wn=kt.type;return Wn===E?Qt(Rt,ht,kt.props.children,on,kt.key):ht!==null&&(ht.elementType===Wn||typeof Wn=="object"&&Wn!==null&&Wn.$$typeof===Z&&zs(Wn)===ht.type)?(ht=L(ht,kt.props),Xs(ht,kt),ht.return=Rt,ht):(ht=El(kt.type,kt.key,kt.props,null,Rt.mode,on),Xs(ht,kt),ht.return=Rt,ht)}function Ut(Rt,ht,kt,on){return ht===null||ht.tag!==4||ht.stateNode.containerInfo!==kt.containerInfo||ht.stateNode.implementation!==kt.implementation?(ht=tc(kt,Rt.mode,on),ht.return=Rt,ht):(ht=L(ht,kt.children||[]),ht.return=Rt,ht)}function Qt(Rt,ht,kt,on,Wn){return ht===null||ht.tag!==7?(ht=Hs(kt,Rt.mode,on,Wn),ht.return=Rt,ht):(ht=L(ht,kt),ht.return=Rt,ht)}function dn(Rt,ht,kt){if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return ht=Ju(""+ht,Rt.mode,kt),ht.return=Rt,ht;if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case S:return kt=El(ht.type,ht.key,ht.props,null,Rt.mode,kt),Xs(kt,ht),kt.return=Rt,kt;case _:return ht=tc(ht,Rt.mode,kt),ht.return=Rt,ht;case Z:return ht=zs(ht),dn(Rt,ht,kt)}if(Te(ht)||fe(ht))return ht=Hs(ht,Rt.mode,kt,null),ht.return=Rt,ht;if(typeof ht.then=="function")return dn(Rt,Ws(ht),kt);if(ht.$$typeof===A)return dn(Rt,Do(Rt,ht),kt);Mo(Rt,ht)}return null}function Zt(Rt,ht,kt,on){var Wn=ht!==null?ht.key:null;if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return Wn!==null?null:ke(Rt,ht,""+kt,on);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case S:return kt.key===Wn?rt(Rt,ht,kt,on):null;case _:return kt.key===Wn?Ut(Rt,ht,kt,on):null;case Z:return kt=zs(kt),Zt(Rt,ht,kt,on)}if(Te(kt)||fe(kt))return Wn!==null?null:Qt(Rt,ht,kt,on,null);if(typeof kt.then=="function")return Zt(Rt,ht,Ws(kt),on);if(kt.$$typeof===A)return Zt(Rt,ht,Do(Rt,kt),on);Mo(Rt,kt)}return null}function $t(Rt,ht,kt,on,Wn){if(typeof on=="string"&&on!==""||typeof on=="number"||typeof on=="bigint")return Rt=Rt.get(kt)||null,ke(ht,Rt,""+on,Wn);if(typeof on=="object"&&on!==null){switch(on.$$typeof){case S:return Rt=Rt.get(on.key===null?kt:on.key)||null,rt(ht,Rt,on,Wn);case _:return Rt=Rt.get(on.key===null?kt:on.key)||null,Ut(ht,Rt,on,Wn);case Z:return on=zs(on),$t(Rt,ht,kt,on,Wn)}if(Te(on)||fe(on))return Rt=Rt.get(kt)||null,Qt(ht,Rt,on,Wn,null);if(typeof on.then=="function")return $t(Rt,ht,kt,Ws(on),Wn);if(on.$$typeof===A)return $t(Rt,ht,kt,Do(ht,on),Wn);Mo(ht,on)}return null}function Bn(Rt,ht,kt,on){for(var Wn=null,Ar=null,Yn=ht,ir=ht=0,vr=null;Yn!==null&&ir<kt.length;ir++){Yn.index>ir?(vr=Yn,Yn=null):vr=Yn.sibling;var br=Zt(Rt,Yn,kt[ir],on);if(br===null){Yn===null&&(Yn=vr);break}n&&Yn&&br.alternate===null&&i(Rt,Yn),ht=M(br,ht,ir),Ar===null?Wn=br:Ar.sibling=br,Ar=br,Yn=vr}if(ir===kt.length)return c(Rt,Yn),ur&&xa(Rt,ir),Wn;if(Yn===null){for(;ir<kt.length;ir++)Yn=dn(Rt,kt[ir],on),Yn!==null&&(ht=M(Yn,ht,ir),Ar===null?Wn=Yn:Ar.sibling=Yn,Ar=Yn);return ur&&xa(Rt,ir),Wn}for(Yn=v(Yn);ir<kt.length;ir++)vr=$t(Yn,Rt,ir,kt[ir],on),vr!==null&&(n&&vr.alternate!==null&&Yn.delete(vr.key===null?ir:vr.key),ht=M(vr,ht,ir),Ar===null?Wn=vr:Ar.sibling=vr,Ar=vr);return n&&Yn.forEach(function($o){return i(Rt,$o)}),ur&&xa(Rt,ir),Wn}function Qn(Rt,ht,kt,on){if(kt==null)throw Error(r(151));for(var Wn=null,Ar=null,Yn=ht,ir=ht=0,vr=null,br=kt.next();Yn!==null&&!br.done;ir++,br=kt.next()){Yn.index>ir?(vr=Yn,Yn=null):vr=Yn.sibling;var $o=Zt(Rt,Yn,br.value,on);if($o===null){Yn===null&&(Yn=vr);break}n&&Yn&&$o.alternate===null&&i(Rt,Yn),ht=M($o,ht,ir),Ar===null?Wn=$o:Ar.sibling=$o,Ar=$o,Yn=vr}if(br.done)return c(Rt,Yn),ur&&xa(Rt,ir),Wn;if(Yn===null){for(;!br.done;ir++,br=kt.next())br=dn(Rt,br.value,on),br!==null&&(ht=M(br,ht,ir),Ar===null?Wn=br:Ar.sibling=br,Ar=br);return ur&&xa(Rt,ir),Wn}for(Yn=v(Yn);!br.done;ir++,br=kt.next())br=$t(Yn,Rt,ir,br.value,on),br!==null&&(n&&br.alternate!==null&&Yn.delete(br.key===null?ir:br.key),ht=M(br,ht,ir),Ar===null?Wn=br:Ar.sibling=br,Ar=br);return n&&Yn.forEach(function(xT){return i(Rt,xT)}),ur&&xa(Rt,ir),Wn}function Br(Rt,ht,kt,on){if(typeof kt=="object"&&kt!==null&&kt.type===E&&kt.key===null&&(kt=kt.props.children),typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case S:e:{for(var Wn=kt.key;ht!==null;){if(ht.key===Wn){if(Wn=kt.type,Wn===E){if(ht.tag===7){c(Rt,ht.sibling),on=L(ht,kt.props.children),on.return=Rt,Rt=on;break e}}else if(ht.elementType===Wn||typeof Wn=="object"&&Wn!==null&&Wn.$$typeof===Z&&zs(Wn)===ht.type){c(Rt,ht.sibling),on=L(ht,kt.props),Xs(on,kt),on.return=Rt,Rt=on;break e}c(Rt,ht);break}else i(Rt,ht);ht=ht.sibling}kt.type===E?(on=Hs(kt.props.children,Rt.mode,on,kt.key),on.return=Rt,Rt=on):(on=El(kt.type,kt.key,kt.props,null,Rt.mode,on),Xs(on,kt),on.return=Rt,Rt=on)}return ce(Rt);case _:e:{for(Wn=kt.key;ht!==null;){if(ht.key===Wn)if(ht.tag===4&&ht.stateNode.containerInfo===kt.containerInfo&&ht.stateNode.implementation===kt.implementation){c(Rt,ht.sibling),on=L(ht,kt.children||[]),on.return=Rt,Rt=on;break e}else{c(Rt,ht);break}else i(Rt,ht);ht=ht.sibling}on=tc(kt,Rt.mode,on),on.return=Rt,Rt=on}return ce(Rt);case Z:return kt=zs(kt),Br(Rt,ht,kt,on)}if(Te(kt))return Bn(Rt,ht,kt,on);if(fe(kt)){if(Wn=fe(kt),typeof Wn!="function")throw Error(r(150));return kt=Wn.call(kt),Qn(Rt,ht,kt,on)}if(typeof kt.then=="function")return Br(Rt,ht,Ws(kt),on);if(kt.$$typeof===A)return Br(Rt,ht,Do(Rt,kt),on);Mo(Rt,kt)}return typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint"?(kt=""+kt,ht!==null&&ht.tag===6?(c(Rt,ht.sibling),on=L(ht,kt),on.return=Rt,Rt=on):(c(Rt,ht),on=Ju(kt,Rt.mode,on),on.return=Rt,Rt=on),ce(Rt)):c(Rt,ht)}return function(Rt,ht,kt,on){try{$s=0;var Wn=Br(Rt,ht,kt,on);return Oo=null,Wn}catch(Yn){if(Yn===wo||Yn===su)throw Yn;var Ar=Vi(29,Yn,null,Rt.mode);return Ar.lanes=on,Ar.return=Rt,Ar}finally{}}}var Oa=wf(!0),Of=wf(!1),bs=!1;function lu(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hc(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Xa(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Rs(n,i,c){var v=n.updateQueue;if(v===null)return null;if(v=v.shared,(Dr&2)!==0){var L=v.pending;return L===null?i.next=i:(i.next=L.next,L.next=i),v.pending=i,i=vl(n),Rf(n,null,c),i}return Ro(n,v,i,c),vl(n)}function Qs(n,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var v=i.lanes;v&=n.pendingLanes,c|=v,i.lanes=c,Ot(n,c)}}function uu(n,i){var c=n.updateQueue,v=n.alternate;if(v!==null&&(v=v.updateQueue,c===v)){var L=null,M=null;if(c=c.firstBaseUpdate,c!==null){do{var ce={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};M===null?L=M=ce:M=M.next=ce,c=c.next}while(c!==null);M===null?L=M=i:M=M.next=i}else L=M=i;c={baseState:v.baseState,firstBaseUpdate:L,lastBaseUpdate:M,shared:v.shared,callbacks:v.callbacks},n.updateQueue=c;return}n=c.lastBaseUpdate,n===null?c.firstBaseUpdate=i:n.next=i,c.lastBaseUpdate=i}var gc=!1;function Po(){if(gc){var n=No;if(n!==null)throw n}}function bl(n,i,c,v){gc=!1;var L=n.updateQueue;bs=!1;var M=L.firstBaseUpdate,ce=L.lastBaseUpdate,ke=L.shared.pending;if(ke!==null){L.shared.pending=null;var rt=ke,Ut=rt.next;rt.next=null,ce===null?M=Ut:ce.next=Ut,ce=rt;var Qt=n.alternate;Qt!==null&&(Qt=Qt.updateQueue,ke=Qt.lastBaseUpdate,ke!==ce&&(ke===null?Qt.firstBaseUpdate=Ut:ke.next=Ut,Qt.lastBaseUpdate=rt))}if(M!==null){var dn=L.baseState;ce=0,Qt=Ut=rt=null,ke=M;do{var Zt=ke.lane&-536870913,$t=Zt!==ke.lane;if($t?(yr&Zt)===Zt:(v&Zt)===Zt){Zt!==0&&Zt===xo&&(gc=!0),Qt!==null&&(Qt=Qt.next={lane:0,tag:ke.tag,payload:ke.payload,callback:null,next:null});e:{var Bn=n,Qn=ke;Zt=i;var Br=c;switch(Qn.tag){case 1:if(Bn=Qn.payload,typeof Bn=="function"){dn=Bn.call(Br,dn,Zt);break e}dn=Bn;break e;case 3:Bn.flags=Bn.flags&-65537|128;case 0:if(Bn=Qn.payload,Zt=typeof Bn=="function"?Bn.call(Br,dn,Zt):Bn,Zt==null)break e;dn=u({},dn,Zt);break e;case 2:bs=!0}}Zt=ke.callback,Zt!==null&&(n.flags|=64,$t&&(n.flags|=8192),$t=L.callbacks,$t===null?L.callbacks=[Zt]:$t.push(Zt))}else $t={lane:Zt,tag:ke.tag,payload:ke.payload,callback:ke.callback,next:null},Qt===null?(Ut=Qt=$t,rt=dn):Qt=Qt.next=$t,ce|=Zt;if(ke=ke.next,ke===null){if(ke=L.shared.pending,ke===null)break;$t=ke,ke=$t.next,$t.next=null,L.lastBaseUpdate=$t,L.shared.pending=null}}while(!0);Qt===null&&(rt=dn),L.baseState=rt,L.firstBaseUpdate=Ut,L.lastBaseUpdate=Qt,M===null&&(L.shared.lanes=0),Bo|=ce,n.lanes=ce,n.memoizedState=dn}}function mc(n,i){if(typeof n!="function")throw Error(r(191,n));n.call(i)}function Mf(n,i){var c=n.callbacks;if(c!==null)for(n.callbacks=null,n=0;n<c.length;n++)mc(c[n],i)}var Js=ee(null),cu=ee(0);function pc(n,i){n=oo,Ze(cu,n),Ze(Js,i),oo=n|i.baseLanes}function yc(){Ze(cu,oo),Ze(Js,Js.current)}function fu(){oo=cu.current,_e(Js),_e(cu)}var Fi=ee(null),Ji=null;function Qa(n){var i=n.alternate;Ze(Wr,Wr.current&1),Ze(Fi,n),Ji===null&&(i===null||Js.current!==null||i.memoizedState!==null)&&(Ji=n)}function du(n){Ze(Wr,Wr.current),Ze(Fi,n),Ji===null&&(Ji=n)}function Pf(n){n.tag===22?(Ze(Wr,Wr.current),Ze(Fi,n),Ji===null&&(Ji=n)):Ja()}function Ja(){Ze(Wr,Wr.current),Ze(Fi,Fi.current)}function qi(n){_e(Fi),Ji===n&&(Ji=null),_e(Wr)}var Wr=ee(0);function eo(n){for(var i=n;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||eg(c)||tg(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var es=0,D=null,C=null,x=null,B=!1,q=!1,Y=!1,k=0,K=0,re=null,ge=0;function ie(){throw Error(r(321))}function z(n,i){if(i===null)return!1;for(var c=0;c<i.length&&c<n.length;c++)if(!xi(n[c],i[c]))return!1;return!0}function oe(n,i,c,v,L,M){return es=M,D=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,me.H=n===null||n.memoizedState===null?Is:ts,Y=!1,M=c(v,L),Y=!1,q&&(M=Ne(i,c,v,L)),se(n),M}function se(n){me.H=ea;var i=C!==null&&C.next!==null;if(es=0,x=C=D=null,B=!1,K=0,re=null,i)throw Error(r(300));n===null||Vn||(n=n.dependencies,n!==null&&_l(n)&&(Vn=!0))}function Ne(n,i,c,v){D=n;var L=0;do{if(q&&(re=null),K=0,q=!1,25<=L)throw Error(r(301));if(L+=1,x=C=null,n.updateQueue!=null){var M=n.updateQueue;M.lastEffect=null,M.events=null,M.stores=null,M.memoCache!=null&&(M.memoCache.index=0)}me.H=ta,M=i(c,v)}while(q);return M}function be(){var n=me.H,i=n.useState()[0];return i=typeof i.then=="function"?P(i):i,n=n.useState()[0],(C!==null?C.memoizedState:null)!==n&&(D.flags|=1024),i}function Le(){var n=k!==0;return k=0,n}function Me(n,i,c){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~c}function le(n){if(B){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}B=!1}es=0,x=C=D=null,q=!1,K=k=0,re=null}function Re(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return x===null?D.memoizedState=x=n:x=x.next=n,x}function ue(){if(C===null){var n=D.alternate;n=n!==null?n.memoizedState:null}else n=C.next;var i=x===null?D.memoizedState:x.next;if(i!==null)x=i,C=n;else{if(n===null)throw D.alternate===null?Error(r(467)):Error(r(310));C=n,n={memoizedState:C.memoizedState,baseState:C.baseState,baseQueue:C.baseQueue,queue:C.queue,next:null},x===null?D.memoizedState=x=n:x=x.next=n}return x}function xe(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function P(n){var i=K;return K+=1,re===null&&(re=[]),n=fc(re,n,i),i=D,(x===null?i.memoizedState:x.next)===null&&(i=i.alternate,me.H=i===null||i.memoizedState===null?Is:ts),n}function te(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return P(n);if(n.$$typeof===A)return mi(n)}throw Error(r(438,String(n)))}function J(n){var i=null,c=D.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var v=D.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(i={data:v.data.map(function(L){return L.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=xe(),D.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(n),v=0;v<n;v++)c[v]=F;return i.index++,c}function Q(n,i){return typeof i=="function"?i(n):i}function j(n){var i=ue();return Ae(i,C,n)}function Ae(n,i,c){var v=n.queue;if(v===null)throw Error(r(311));v.lastRenderedReducer=c;var L=n.baseQueue,M=v.pending;if(M!==null){if(L!==null){var ce=L.next;L.next=M.next,M.next=ce}i.baseQueue=L=M,v.pending=null}if(M=n.baseState,L===null)n.memoizedState=M;else{i=L.next;var ke=ce=null,rt=null,Ut=i,Qt=!1;do{var dn=Ut.lane&-536870913;if(dn!==Ut.lane?(yr&dn)===dn:(es&dn)===dn){var Zt=Ut.revertLane;if(Zt===0)rt!==null&&(rt=rt.next={lane:0,revertLane:0,gesture:null,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null}),dn===xo&&(Qt=!0);else if((es&Zt)===Zt){Ut=Ut.next,Zt===xo&&(Qt=!0);continue}else dn={lane:0,revertLane:Ut.revertLane,gesture:null,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null},rt===null?(ke=rt=dn,ce=M):rt=rt.next=dn,D.lanes|=Zt,Bo|=Zt;dn=Ut.action,Y&&c(M,dn),M=Ut.hasEagerState?Ut.eagerState:c(M,dn)}else Zt={lane:dn,revertLane:Ut.revertLane,gesture:Ut.gesture,action:Ut.action,hasEagerState:Ut.hasEagerState,eagerState:Ut.eagerState,next:null},rt===null?(ke=rt=Zt,ce=M):rt=rt.next=Zt,D.lanes|=dn,Bo|=dn;Ut=Ut.next}while(Ut!==null&&Ut!==i);if(rt===null?ce=M:rt.next=ke,!xi(M,n.memoizedState)&&(Vn=!0,Qt&&(c=No,c!==null)))throw c;n.memoizedState=M,n.baseState=ce,n.baseQueue=rt,v.lastRenderedState=M}return L===null&&(v.lanes=0),[n.memoizedState,v.dispatch]}function ve(n){var i=ue(),c=i.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=n;var v=c.dispatch,L=c.pending,M=i.memoizedState;if(L!==null){c.pending=null;var ce=L=L.next;do M=n(M,ce.action),ce=ce.next;while(ce!==L);xi(M,i.memoizedState)||(Vn=!0),i.memoizedState=M,i.baseQueue===null&&(i.baseState=M),c.lastRenderedState=M}return[M,v]}function Ce(n,i,c){var v=D,L=ue(),M=ur;if(M){if(c===void 0)throw Error(r(407));c=c()}else c=i();var ce=!xi((C||L).memoizedState,c);if(ce&&(L.memoizedState=c,Vn=!0),L=L.queue,st(Se.bind(null,v,L,n),[n]),L.getSnapshot!==i||ce||x!==null&&x.memoizedState.tag&1){if(v.flags|=2048,Ct(9,{destroy:void 0},ae.bind(null,v,L,c,i),null),Yr===null)throw Error(r(349));M||(es&127)!==0||Ee(v,i,c)}return c}function Ee(n,i,c){n.flags|=16384,n={getSnapshot:i,value:c},i=D.updateQueue,i===null?(i=xe(),D.updateQueue=i,i.stores=[n]):(c=i.stores,c===null?i.stores=[n]:c.push(n))}function ae(n,i,c,v){i.value=c,i.getSnapshot=v,Pe(i)&&We(n)}function Se(n,i,c){return c(function(){Pe(i)&&We(n)})}function Pe(n){var i=n.getSnapshot;n=n.value;try{var c=i();return!xi(n,c)}catch{return!0}}function We(n){var i=Da(n,2);i!==null&&sa(i,n,2)}function je(n){var i=Re();if(typeof n=="function"){var c=n;if(n=c(),Y){ar(!0);try{c()}finally{ar(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q,lastRenderedState:n},i}function Xe(n,i,c,v){return n.baseState=c,Ae(n,C,typeof v=="function"?v:Q)}function ze(n,i,c,v,L){if(fr(n))throw Error(r(485));if(n=i.action,n!==null){var M={payload:L,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ce){M.listeners.push(ce)}};me.T!==null?c(!0):M.isTransition=!1,v(M),c=i.pending,c===null?(M.next=i.pending=M,St(i,M)):(M.next=c.next,i.pending=c.next=M)}}function St(n,i){var c=i.action,v=i.payload,L=n.state;if(i.isTransition){var M=me.T,ce={};me.T=ce;try{var ke=c(L,v),rt=me.S;rt!==null&&rt(ce,ke),At(n,i,ke)}catch(Ut){yt(n,i,Ut)}finally{M!==null&&ce.types!==null&&(M.types=ce.types),me.T=M}}else try{M=c(L,v),At(n,i,M)}catch(Ut){yt(n,i,Ut)}}function At(n,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(v){pt(n,i,v)},function(v){return yt(n,i,v)}):pt(n,i,c)}function pt(n,i,c){i.status="fulfilled",i.value=c,un(i),n.state=c,i=n.pending,i!==null&&(c=i.next,c===i?n.pending=null:(c=c.next,i.next=c,St(n,c)))}function yt(n,i,c){var v=n.pending;if(n.pending=null,v!==null){v=v.next;do i.status="rejected",i.reason=c,un(i),i=i.next;while(i!==v)}n.action=null}function un(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function Ve(n,i){return i}function tt(n,i){if(ur){var c=Yr.formState;if(c!==null){e:{var v=D;if(ur){if(Vr){t:{for(var L=Vr,M=Qi;L.nodeType!==8;){if(!M){L=null;break t}if(L=ka(L.nextSibling),L===null){L=null;break t}}M=L.data,L=M==="F!"||M==="F"?L:null}if(L){Vr=ka(L.nextSibling),v=L.data==="F!";break e}}Wa(v)}v=!1}v&&(i=c[0])}}return c=Re(),c.memoizedState=c.baseState=i,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ve,lastRenderedState:i},c.queue=v,c=Hn.bind(null,D,v),v.dispatch=c,v=je(!1),M=$r.bind(null,D,!1,v.queue),v=Re(),L={state:i,dispatch:null,action:n,pending:null},v.queue=L,c=ze.bind(null,D,L,M,c),L.dispatch=c,v.memoizedState=n,[i,c,!1]}function Nt(n){var i=ue();return lt(i,C,n)}function lt(n,i,c){if(i=Ae(n,i,Ve)[0],n=j(Q)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var v=P(i)}catch(ce){throw ce===wo?su:ce}else v=i;i=ue();var L=i.queue,M=L.dispatch;return c!==i.memoizedState&&(D.flags|=2048,Ct(9,{destroy:void 0},Bt.bind(null,L,c),null)),[v,M,n]}function Bt(n,i){n.action=i}function Ft(n){var i=ue(),c=C;if(c!==null)return lt(i,c,n);ue(),i=i.memoizedState,c=ue();var v=c.queue.dispatch;return c.memoizedState=n,[i,v,!1]}function Ct(n,i,c,v){return n={tag:n,create:c,deps:v,inst:i,next:null},i=D.updateQueue,i===null&&(i=xe(),D.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=n.next=n:(v=c.next,c.next=n,n.next=v,i.lastEffect=n),n}function vn(){return ue().memoizedState}function yn(n,i,c,v){var L=Re();D.flags|=n,L.memoizedState=Ct(1|i,{destroy:void 0},c,v===void 0?null:v)}function Fn(n,i,c,v){var L=ue();v=v===void 0?null:v;var M=L.memoizedState.inst;C!==null&&v!==null&&z(v,C.memoizedState.deps)?L.memoizedState=Ct(i,M,c,v):(D.flags|=n,L.memoizedState=Ct(1|i,M,c,v))}function Zn(n,i){yn(8390656,8,n,i)}function st(n,i){Fn(2048,8,n,i)}function Mt(n){D.flags|=4;var i=D.updateQueue;if(i===null)i=xe(),D.updateQueue=i,i.events=[n];else{var c=i.events;c===null?i.events=[n]:c.push(n)}}function Tt(n){var i=ue().memoizedState;return Mt({ref:i,nextImpl:n}),function(){if((Dr&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function jt(n,i){return Fn(4,2,n,i)}function en(n,i){return Fn(4,4,n,i)}function _n(n,i){if(typeof i=="function"){n=n();var c=i(n);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function En(n,i,c){c=c!=null?c.concat([n]):null,Fn(4,4,_n.bind(null,i,n),c)}function An(){}function Ln(n,i){var c=ue();i=i===void 0?null:i;var v=c.memoizedState;return i!==null&&z(i,v[1])?v[0]:(c.memoizedState=[n,i],n)}function xt(n,i){var c=ue();i=i===void 0?null:i;var v=c.memoizedState;if(i!==null&&z(i,v[1]))return v[0];if(v=n(),Y){ar(!0);try{n()}finally{ar(!1)}}return c.memoizedState=[v,i],v}function an(n,i,c){return c===void 0||(es&1073741824)!==0&&(yr&261930)===0?n.memoizedState=i:(n.memoizedState=c,n=fp(),D.lanes|=n,Bo|=n,c)}function mn(n,i,c,v){return xi(c,i)?c:Js.current!==null?(n=an(n,c,v),xi(n,i)||(Vn=!0),n):(es&42)===0||(es&1073741824)!==0&&(yr&261930)===0?(Vn=!0,n.memoizedState=c):(n=fp(),D.lanes|=n,Bo|=n,i)}function pn(n,i,c,v,L){var M=X.p;X.p=M!==0&&8>M?M:8;var ce=me.T,ke={};me.T=ke,$r(n,!1,i,c);try{var rt=L(),Ut=me.S;if(Ut!==null&&Ut(ke,rt),rt!==null&&typeof rt=="object"&&typeof rt.then=="function"){var Qt=mh(rt,v);cr(n,i,Qt,Ea(n))}else cr(n,i,v,Ea(n))}catch(dn){cr(n,i,{then:function(){},status:"rejected",reason:dn},Ea())}finally{X.p=M,ce!==null&&ke.types!==null&&(ce.types=ke.types),me.T=ce}}function Tn(){}function ot(n,i,c,v){if(n.tag!==5)throw Error(r(476));var L=$e(n).queue;pn(n,L,i,Ie,c===null?Tn:function(){return bt(n),c(v)})}function $e(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:Ie,baseState:Ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q,lastRenderedState:Ie},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q,lastRenderedState:c},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function bt(n){var i=$e(n);i.next===null&&(i=n.alternate.memoizedState),cr(n,i.next.queue,{},Ea())}function we(){return mi(wc)}function Ue(){return ue().memoizedState}function ft(){return ue().memoizedState}function zt(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var c=Ea();n=Xa(c);var v=Rs(i,n,c);v!==null&&(sa(v,i,c),Qs(v,i,c)),i={cache:lc()},n.payload=i;return}i=i.return}}function tn(n,i,c){var v=Ea();c={lane:v,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},fr(n)?Ri(i,c):(c=Xu(n,i,c,v),c!==null&&(sa(c,n,v),ei(c,i,v)))}function Hn(n,i,c){var v=Ea();cr(n,i,c,v)}function cr(n,i,c,v){var L={lane:v,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(fr(n))Ri(i,L);else{var M=n.alternate;if(n.lanes===0&&(M===null||M.lanes===0)&&(M=i.lastRenderedReducer,M!==null))try{var ce=i.lastRenderedState,ke=M(ce,c);if(L.hasEagerState=!0,L.eagerState=ke,xi(ke,ce))return Ro(n,i,L,0),Yr===null&&bo(),!1}catch{}finally{}if(c=Xu(n,i,L,v),c!==null)return sa(c,n,v),ei(c,i,v),!0}return!1}function $r(n,i,c,v){if(v={lane:2,revertLane:Hh(),gesture:null,action:v,hasEagerState:!1,eagerState:null,next:null},fr(n)){if(i)throw Error(r(479))}else i=Xu(n,c,v,2),i!==null&&sa(i,n,2)}function fr(n){var i=n.alternate;return n===D||i!==null&&i===D}function Ri(n,i){q=B=!0;var c=n.pending;c===null?i.next=i:(i.next=c.next,c.next=i),n.pending=i}function ei(n,i,c){if((c&4194048)!==0){var v=i.lanes;v&=n.pendingLanes,c|=v,i.lanes=c,Ot(n,c)}}var ea={readContext:mi,use:te,useCallback:ie,useContext:ie,useEffect:ie,useImperativeHandle:ie,useLayoutEffect:ie,useInsertionEffect:ie,useMemo:ie,useReducer:ie,useRef:ie,useState:ie,useDebugValue:ie,useDeferredValue:ie,useTransition:ie,useSyncExternalStore:ie,useId:ie,useHostTransitionStatus:ie,useFormState:ie,useActionState:ie,useOptimistic:ie,useMemoCache:ie,useCacheRefresh:ie};ea.useEffectEvent=ie;var Is={readContext:mi,use:te,useCallback:function(n,i){return Re().memoizedState=[n,i===void 0?null:i],n},useContext:mi,useEffect:Zn,useImperativeHandle:function(n,i,c){c=c!=null?c.concat([n]):null,yn(4194308,4,_n.bind(null,i,n),c)},useLayoutEffect:function(n,i){return yn(4194308,4,n,i)},useInsertionEffect:function(n,i){yn(4,2,n,i)},useMemo:function(n,i){var c=Re();i=i===void 0?null:i;var v=n();if(Y){ar(!0);try{n()}finally{ar(!1)}}return c.memoizedState=[v,i],v},useReducer:function(n,i,c){var v=Re();if(c!==void 0){var L=c(i);if(Y){ar(!0);try{c(i)}finally{ar(!1)}}}else L=i;return v.memoizedState=v.baseState=L,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:L},v.queue=n,n=n.dispatch=tn.bind(null,D,n),[v.memoizedState,n]},useRef:function(n){var i=Re();return n={current:n},i.memoizedState=n},useState:function(n){n=je(n);var i=n.queue,c=Hn.bind(null,D,i);return i.dispatch=c,[n.memoizedState,c]},useDebugValue:An,useDeferredValue:function(n,i){var c=Re();return an(c,n,i)},useTransition:function(){var n=je(!1);return n=pn.bind(null,D,n.queue,!0,!1),Re().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,c){var v=D,L=Re();if(ur){if(c===void 0)throw Error(r(407));c=c()}else{if(c=i(),Yr===null)throw Error(r(349));(yr&127)!==0||Ee(v,i,c)}L.memoizedState=c;var M={value:c,getSnapshot:i};return L.queue=M,Zn(Se.bind(null,v,M,n),[n]),v.flags|=2048,Ct(9,{destroy:void 0},ae.bind(null,v,M,c,i),null),c},useId:function(){var n=Re(),i=Yr.identifierPrefix;if(ur){var c=La,v=ga;c=(v&~(1<<32-er(v)-1)).toString(32)+c,i="_"+i+"R_"+c,c=k++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=ge++,i="_"+i+"r_"+c.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:we,useFormState:tt,useActionState:tt,useOptimistic:function(n){var i=Re();i.memoizedState=i.baseState=n;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=$r.bind(null,D,!0,c),c.dispatch=i,[n,i]},useMemoCache:J,useCacheRefresh:function(){return Re().memoizedState=zt.bind(null,D)},useEffectEvent:function(n){var i=Re(),c={impl:n};return i.memoizedState=c,function(){if((Dr&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}},ts={readContext:mi,use:te,useCallback:Ln,useContext:mi,useEffect:st,useImperativeHandle:En,useInsertionEffect:jt,useLayoutEffect:en,useMemo:xt,useReducer:j,useRef:vn,useState:function(){return j(Q)},useDebugValue:An,useDeferredValue:function(n,i){var c=ue();return mn(c,C.memoizedState,n,i)},useTransition:function(){var n=j(Q)[0],i=ue().memoizedState;return[typeof n=="boolean"?n:P(n),i]},useSyncExternalStore:Ce,useId:Ue,useHostTransitionStatus:we,useFormState:Nt,useActionState:Nt,useOptimistic:function(n,i){var c=ue();return Xe(c,C,n,i)},useMemoCache:J,useCacheRefresh:ft};ts.useEffectEvent=Tt;var ta={readContext:mi,use:te,useCallback:Ln,useContext:mi,useEffect:st,useImperativeHandle:En,useInsertionEffect:jt,useLayoutEffect:en,useMemo:xt,useReducer:ve,useRef:vn,useState:function(){return ve(Q)},useDebugValue:An,useDeferredValue:function(n,i){var c=ue();return C===null?an(c,n,i):mn(c,C.memoizedState,n,i)},useTransition:function(){var n=ve(Q)[0],i=ue().memoizedState;return[typeof n=="boolean"?n:P(n),i]},useSyncExternalStore:Ce,useId:Ue,useHostTransitionStatus:we,useFormState:Ft,useActionState:Ft,useOptimistic:function(n,i){var c=ue();return C!==null?Xe(c,C,n,i):(c.baseState=n,[n,c.queue.dispatch])},useMemoCache:J,useCacheRefresh:ft};ta.useEffectEvent=Tt;function ma(n,i,c,v){i=n.memoizedState,c=c(v,i),c=c==null?i:u({},i,c),n.memoizedState=c,n.lanes===0&&(n.updateQueue.baseState=c)}var Ti={enqueueSetState:function(n,i,c){n=n._reactInternals;var v=Ea(),L=Xa(v);L.payload=i,c!=null&&(L.callback=c),i=Rs(n,L,v),i!==null&&(sa(i,n,v),Qs(i,n,v))},enqueueReplaceState:function(n,i,c){n=n._reactInternals;var v=Ea(),L=Xa(v);L.tag=1,L.payload=i,c!=null&&(L.callback=c),i=Rs(n,L,v),i!==null&&(sa(i,n,v),Qs(i,n,v))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var c=Ea(),v=Xa(c);v.tag=2,i!=null&&(v.callback=i),i=Rs(n,v,c),i!==null&&(sa(i,n,c),Qs(i,n,c))}};function ns(n,i,c,v,L,M,ce){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(v,M,ce):i.prototype&&i.prototype.isPureReactComponent?!hl(c,v)||!hl(L,M):!0}function Cs(n,i,c,v){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,v),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,v),i.state!==n&&Ti.enqueueReplaceState(i,i.state,null)}function pi(n,i){var c=i;if("ref"in i){c={};for(var v in i)v!=="ref"&&(c[v]=i[v])}if(n=n.defaultProps){c===i&&(c=u({},c));for(var L in n)c[L]===void 0&&(c[L]=n[L])}return c}function ko(n){Ao(n)}function Rl(n){console.error(n)}function Il(n){Ao(n)}function pa(n,i){try{var c=n.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(v){setTimeout(function(){throw v})}}function Cl(n,i,c){try{var v=n.onCaughtError;v(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(L){setTimeout(function(){throw L})}}function rs(n,i,c){return c=Xa(c),c.tag=3,c.payload={element:null},c.callback=function(){pa(n,i)},c}function dt(n){return n=Xa(n),n.tag=3,n}function Xt(n,i,c,v){var L=c.type.getDerivedStateFromError;if(typeof L=="function"){var M=v.value;n.payload=function(){return L(M)},n.callback=function(){Cl(i,c,v)}}var ce=c.stateNode;ce!==null&&typeof ce.componentDidCatch=="function"&&(n.callback=function(){Cl(i,c,v),typeof L!="function"&&(Go===null?Go=new Set([this]):Go.add(this));var ke=v.stack;this.componentDidCatch(v.value,{componentStack:ke!==null?ke:""})})}function Dn(n,i,c,v,L){if(c.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(i=c.alternate,i!==null&&Co(i,c,L,!0),c=Fi.current,c!==null){switch(c.tag){case 31:case 13:return Ji===null?Kf():c.alternate===null&&si===0&&(si=3),c.flags&=-257,c.flags|=65536,c.lanes=L,v===ou?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([v]):i.add(v),Bh(n,v,L)),!1;case 22:return c.flags|=65536,v===ou?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([v])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([v]):c.add(v)),Bh(n,v,L)),!1}throw Error(r(435,c.tag))}return Bh(n,v,L),Kf(),!1}if(ur)return i=Fi.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=L,v!==ic&&(n=Error(r(422),{cause:v}),Sl(Xi(n,c)))):(v!==ic&&(i=Error(r(423),{cause:v}),Sl(Xi(i,c))),n=n.current.alternate,n.flags|=65536,L&=-L,n.lanes|=L,v=Xi(v,c),L=rs(n.stateNode,v,L),uu(n,L),si!==4&&(si=2)),!1;var M=Error(r(520),{cause:v});if(M=Xi(M,c),bc===null?bc=[M]:bc.push(M),si!==4&&(si=2),i===null)return!0;v=Xi(v,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,n=L&-L,c.lanes|=n,n=rs(c.stateNode,v,n),uu(c,n),!1;case 1:if(i=c.type,M=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Go===null||!Go.has(M))))return c.flags|=65536,L&=-L,c.lanes|=L,L=dt(L),Xt(L,n,c,v),uu(c,L),!1}c=c.return}while(c!==null);return!1}var Un=Error(r(461)),Vn=!1;function Kn(n,i,c,v){i.child=n===null?Of(i,null,c,v):Oa(i,n.child,c,v)}function qn(n,i,c,v,L){c=c.render;var M=i.ref;if("ref"in v){var ce={};for(var ke in v)ke!=="ref"&&(ce[ke]=v[ke])}else ce=v;return qs(i),v=oe(n,i,c,ce,M,L),ke=Le(),n!==null&&!Vn?(Me(n,i,L),to(n,i,L)):(ur&&ke&&Ql(i),i.flags|=1,Kn(n,i,v,L),i.child)}function Cr(n,i,c,v,L){if(n===null){var M=c.type;return typeof M=="function"&&!Wl(M)&&M.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=M,Sr(n,i,M,v,L)):(n=El(c.type,null,v,i,i.mode,L),n.ref=i.ref,n.return=i,i.child=n)}if(M=n.child,!Ah(n,L)){var ce=M.memoizedProps;if(c=c.compare,c=c!==null?c:hl,c(ce,v)&&n.ref===i.ref)return to(n,i,L)}return i.flags|=1,n=za(M,v),n.ref=i.ref,n.return=i,i.child=n}function Sr(n,i,c,v,L){if(n!==null){var M=n.memoizedProps;if(hl(M,v)&&n.ref===i.ref)if(Vn=!1,i.pendingProps=v=M,Ah(n,L))(n.flags&131072)!==0&&(Vn=!0);else return i.lanes=n.lanes,to(n,i,L)}return ph(n,i,c,v,L)}function Ma(n,i,c,v){var L=v.children,M=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),v.mode==="hidden"){if((i.flags&128)!==0){if(M=M!==null?M.baseLanes|c:c,n!==null){for(v=i.child=n.child,L=0;v!==null;)L=L|v.lanes|v.childLanes,v=v.sibling;v=L&~M}else v=0,i.child=null;return Mm(n,i,M,c,v)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&iu(i,M!==null?M.cachePool:null),M!==null?pc(i,M):yc(),Pf(i);else return v=i.lanes=536870912,Mm(n,i,M!==null?M.baseLanes|c:c,c,v)}else M!==null?(iu(i,M.cachePool),pc(i,M),Ja(),i.memoizedState=null):(n!==null&&iu(i,null),yc(),Ja());return Kn(n,i,L,c),i.child}function Pa(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Mm(n,i,c,v,L){var M=uc();return M=M===null?null:{parent:ai._currentValue,pool:M},i.memoizedState={baseLanes:c,cachePool:M},n!==null&&iu(i,null),yc(),Pf(i),n!==null&&Co(n,i,v,!0),i.childLanes=L,null}function kf(n,i){return i=Uf({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Pm(n,i,c){return Oa(i,n.child,null,c),n=kf(i,i.pendingProps),n.flags|=2,qi(i),i.memoizedState=null,n}function L0(n,i,c){var v=i.pendingProps,L=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(ur){if(v.mode==="hidden")return n=kf(i,v),i.lanes=536870912,Pa(null,n);if(du(i),(n=Vr)?(n=Kp(n,Qi),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:ha!==null?{id:ga,overflow:La}:null,retryLane:536870912,hydrationErrors:null},c=ec(n),c.return=i,i.child=c,di=i,Vr=null)):n=null,n===null)throw Wa(i);return i.lanes=536870912,null}return kf(i,v)}var M=n.memoizedState;if(M!==null){var ce=M.dehydrated;if(du(i),L)if(i.flags&256)i.flags&=-257,i=Pm(n,i,c);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(r(558));else if(Vn||Co(n,i,c,!1),L=(c&n.childLanes)!==0,Vn||L){if(v=Yr,v!==null&&(ce=ct(v,c),ce!==0&&ce!==M.retryLane))throw M.retryLane=ce,Da(n,ce),sa(v,n,ce),Un;Kf(),i=Pm(n,i,c)}else n=M.treeContext,Vr=ka(ce.nextSibling),di=i,ur=!0,$a=null,Qi=!1,n!==null&&Jl(i,n),i=kf(i,v),i.flags|=4096;return i}return n=za(n.child,{mode:v.mode,children:v.children}),n.ref=i.ref,i.child=n,n.return=i,n}function Ff(n,i){var c=i.ref;if(c===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(r(284));(n===null||n.ref!==c)&&(i.flags|=4194816)}}function ph(n,i,c,v,L){return qs(i),c=oe(n,i,c,v,void 0,L),v=Le(),n!==null&&!Vn?(Me(n,i,L),to(n,i,L)):(ur&&v&&Ql(i),i.flags|=1,Kn(n,i,c,L),i.child)}function km(n,i,c,v,L,M){return qs(i),i.updateQueue=null,c=Ne(i,v,c,L),se(n),v=Le(),n!==null&&!Vn?(Me(n,i,M),to(n,i,M)):(ur&&v&&Ql(i),i.flags|=1,Kn(n,i,c,M),i.child)}function Fm(n,i,c,v,L){if(qs(i),i.stateNode===null){var M=Io,ce=c.contextType;typeof ce=="object"&&ce!==null&&(M=mi(ce)),M=new c(v,M),i.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=Ti,i.stateNode=M,M._reactInternals=i,M=i.stateNode,M.props=v,M.state=i.memoizedState,M.refs={},lu(i),ce=c.contextType,M.context=typeof ce=="object"&&ce!==null?mi(ce):Io,M.state=i.memoizedState,ce=c.getDerivedStateFromProps,typeof ce=="function"&&(ma(i,c,ce,v),M.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof M.getSnapshotBeforeUpdate=="function"||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(ce=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),ce!==M.state&&Ti.enqueueReplaceState(M,M.state,null),bl(i,v,M,L),Po(),M.state=i.memoizedState),typeof M.componentDidMount=="function"&&(i.flags|=4194308),v=!0}else if(n===null){M=i.stateNode;var ke=i.memoizedProps,rt=pi(c,ke);M.props=rt;var Ut=M.context,Qt=c.contextType;ce=Io,typeof Qt=="object"&&Qt!==null&&(ce=mi(Qt));var dn=c.getDerivedStateFromProps;Qt=typeof dn=="function"||typeof M.getSnapshotBeforeUpdate=="function",ke=i.pendingProps!==ke,Qt||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(ke||Ut!==ce)&&Cs(i,M,v,ce),bs=!1;var Zt=i.memoizedState;M.state=Zt,bl(i,v,M,L),Po(),Ut=i.memoizedState,ke||Zt!==Ut||bs?(typeof dn=="function"&&(ma(i,c,dn,v),Ut=i.memoizedState),(rt=bs||ns(i,c,rt,v,Zt,Ut,ce))?(Qt||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(i.flags|=4194308)):(typeof M.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=v,i.memoizedState=Ut),M.props=v,M.state=Ut,M.context=ce,v=rt):(typeof M.componentDidMount=="function"&&(i.flags|=4194308),v=!1)}else{M=i.stateNode,hc(n,i),ce=i.memoizedProps,Qt=pi(c,ce),M.props=Qt,dn=i.pendingProps,Zt=M.context,Ut=c.contextType,rt=Io,typeof Ut=="object"&&Ut!==null&&(rt=mi(Ut)),ke=c.getDerivedStateFromProps,(Ut=typeof ke=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(ce!==dn||Zt!==rt)&&Cs(i,M,v,rt),bs=!1,Zt=i.memoizedState,M.state=Zt,bl(i,v,M,L),Po();var $t=i.memoizedState;ce!==dn||Zt!==$t||bs||n!==null&&n.dependencies!==null&&_l(n.dependencies)?(typeof ke=="function"&&(ma(i,c,ke,v),$t=i.memoizedState),(Qt=bs||ns(i,c,Qt,v,Zt,$t,rt)||n!==null&&n.dependencies!==null&&_l(n.dependencies))?(Ut||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(v,$t,rt),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(v,$t,rt)),typeof M.componentDidUpdate=="function"&&(i.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof M.componentDidUpdate!="function"||ce===n.memoizedProps&&Zt===n.memoizedState||(i.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||ce===n.memoizedProps&&Zt===n.memoizedState||(i.flags|=1024),i.memoizedProps=v,i.memoizedState=$t),M.props=v,M.state=$t,M.context=rt,v=Qt):(typeof M.componentDidUpdate!="function"||ce===n.memoizedProps&&Zt===n.memoizedState||(i.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||ce===n.memoizedProps&&Zt===n.memoizedState||(i.flags|=1024),v=!1)}return M=v,Ff(n,i),v=(i.flags&128)!==0,M||v?(M=i.stateNode,c=v&&typeof c.getDerivedStateFromError!="function"?null:M.render(),i.flags|=1,n!==null&&v?(i.child=Oa(i,n.child,null,L),i.child=Oa(i,null,c,L)):Kn(n,i,c,L),i.memoizedState=M.state,n=i.child):n=to(n,i,L),n}function Um(n,i,c,v){return Ts(),i.flags|=256,Kn(n,i,c,v),i.child}var yh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vh(n){return{baseLanes:n,cachePool:au()}}function Eh(n,i,c){return n=n!==null?n.childLanes&~c:0,i&&(n|=va),n}function Bm(n,i,c){var v=i.pendingProps,L=!1,M=(i.flags&128)!==0,ce;if((ce=M)||(ce=n!==null&&n.memoizedState===null?!1:(Wr.current&2)!==0),ce&&(L=!0,i.flags&=-129),ce=(i.flags&32)!==0,i.flags&=-33,n===null){if(ur){if(L?Qa(i):Ja(),(n=Vr)?(n=Kp(n,Qi),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:ha!==null?{id:ga,overflow:La}:null,retryLane:536870912,hydrationErrors:null},c=ec(n),c.return=i,i.child=c,di=i,Vr=null)):n=null,n===null)throw Wa(i);return tg(n)?i.lanes=32:i.lanes=536870912,null}var ke=v.children;return v=v.fallback,L?(Ja(),L=i.mode,ke=Uf({mode:"hidden",children:ke},L),v=Hs(v,L,c,null),ke.return=i,v.return=i,ke.sibling=v,i.child=ke,v=i.child,v.memoizedState=vh(c),v.childLanes=Eh(n,ce,c),i.memoizedState=yh,Pa(null,v)):(Qa(i),Th(i,ke))}var rt=n.memoizedState;if(rt!==null&&(ke=rt.dehydrated,ke!==null)){if(M)i.flags&256?(Qa(i),i.flags&=-257,i=Sh(n,i,c)):i.memoizedState!==null?(Ja(),i.child=n.child,i.flags|=128,i=null):(Ja(),ke=v.fallback,L=i.mode,v=Uf({mode:"visible",children:v.children},L),ke=Hs(ke,L,c,null),ke.flags|=2,v.return=i,ke.return=i,v.sibling=ke,i.child=v,Oa(i,n.child,null,c),v=i.child,v.memoizedState=vh(c),v.childLanes=Eh(n,ce,c),i.memoizedState=yh,i=Pa(null,v));else if(Qa(i),tg(ke)){if(ce=ke.nextSibling&&ke.nextSibling.dataset,ce)var Ut=ce.dgst;ce=Ut,v=Error(r(419)),v.stack="",v.digest=ce,Sl({value:v,source:null,stack:null}),i=Sh(n,i,c)}else if(Vn||Co(n,i,c,!1),ce=(c&n.childLanes)!==0,Vn||ce){if(ce=Yr,ce!==null&&(v=ct(ce,c),v!==0&&v!==rt.retryLane))throw rt.retryLane=v,Da(n,v),sa(ce,n,v),Un;eg(ke)||Kf(),i=Sh(n,i,c)}else eg(ke)?(i.flags|=192,i.child=n.child,i=null):(n=rt.treeContext,Vr=ka(ke.nextSibling),di=i,ur=!0,$a=null,Qi=!1,n!==null&&Jl(i,n),i=Th(i,v.children),i.flags|=4096);return i}return L?(Ja(),ke=v.fallback,L=i.mode,rt=n.child,Ut=rt.sibling,v=za(rt,{mode:"hidden",children:v.children}),v.subtreeFlags=rt.subtreeFlags&65011712,Ut!==null?ke=za(Ut,ke):(ke=Hs(ke,L,c,null),ke.flags|=2),ke.return=i,v.return=i,v.sibling=ke,i.child=v,Pa(null,v),v=i.child,ke=n.child.memoizedState,ke===null?ke=vh(c):(L=ke.cachePool,L!==null?(rt=ai._currentValue,L=L.parent!==rt?{parent:rt,pool:rt}:L):L=au(),ke={baseLanes:ke.baseLanes|c,cachePool:L}),v.memoizedState=ke,v.childLanes=Eh(n,ce,c),i.memoizedState=yh,Pa(n.child,v)):(Qa(i),c=n.child,n=c.sibling,c=za(c,{mode:"visible",children:v.children}),c.return=i,c.sibling=null,n!==null&&(ce=i.deletions,ce===null?(i.deletions=[n],i.flags|=16):ce.push(n)),i.child=c,i.memoizedState=null,c)}function Th(n,i){return i=Uf({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function Uf(n,i){return n=Vi(22,n,null,i),n.lanes=0,n}function Sh(n,i,c){return Oa(i,n.child,null,c),n=Th(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function Gm(n,i,c){n.lanes|=i;var v=n.alternate;v!==null&&(v.lanes|=i),tu(n.return,i,c)}function _h(n,i,c,v,L,M){var ce=n.memoizedState;ce===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:v,tail:c,tailMode:L,treeForkCount:M}:(ce.isBackwards=i,ce.rendering=null,ce.renderingStartTime=0,ce.last=v,ce.tail=c,ce.tailMode=L,ce.treeForkCount=M)}function Zm(n,i,c){var v=i.pendingProps,L=v.revealOrder,M=v.tail;v=v.children;var ce=Wr.current,ke=(ce&2)!==0;if(ke?(ce=ce&1|2,i.flags|=128):ce&=1,Ze(Wr,ce),Kn(n,i,v,c),v=ur?Tl:0,!ke&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Gm(n,c,i);else if(n.tag===19)Gm(n,c,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(L){case"forwards":for(c=i.child,L=null;c!==null;)n=c.alternate,n!==null&&eo(n)===null&&(L=c),c=c.sibling;c=L,c===null?(L=i.child,i.child=null):(L=c.sibling,c.sibling=null),_h(i,!1,L,c,M,v);break;case"backwards":case"unstable_legacy-backwards":for(c=null,L=i.child,i.child=null;L!==null;){if(n=L.alternate,n!==null&&eo(n)===null){i.child=L;break}n=L.sibling,L.sibling=c,c=L,L=n}_h(i,!0,c,null,M,v);break;case"together":_h(i,!1,null,null,void 0,v);break;default:i.memoizedState=null}return i.child}function to(n,i,c){if(n!==null&&(i.dependencies=n.dependencies),Bo|=i.lanes,(c&i.childLanes)===0)if(n!==null){if(Co(n,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,c=za(n,n.pendingProps),i.child=c,c.return=i;n.sibling!==null;)n=n.sibling,c=c.sibling=za(n,n.pendingProps),c.return=i;c.sibling=null}return i.child}function Ah(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&_l(n)))}function x0(n,i,c){switch(i.tag){case 3:vt(i,i.stateNode.containerInfo),_s(i,ai,n.memoizedState.cache),Ts();break;case 27:case 5:gt(i);break;case 4:vt(i,i.stateNode.containerInfo);break;case 10:_s(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,du(i),null;break;case 13:var v=i.memoizedState;if(v!==null)return v.dehydrated!==null?(Qa(i),i.flags|=128,null):(c&i.child.childLanes)!==0?Bm(n,i,c):(Qa(i),n=to(n,i,c),n!==null?n.sibling:null);Qa(i);break;case 19:var L=(n.flags&128)!==0;if(v=(c&i.childLanes)!==0,v||(Co(n,i,c,!1),v=(c&i.childLanes)!==0),L){if(v)return Zm(n,i,c);i.flags|=128}if(L=i.memoizedState,L!==null&&(L.rendering=null,L.tail=null,L.lastEffect=null),Ze(Wr,Wr.current),v)break;return null;case 22:return i.lanes=0,Ma(n,i,c,i.pendingProps);case 24:_s(i,ai,n.memoizedState.cache)}return to(n,i,c)}function Hm(n,i,c){if(n!==null)if(n.memoizedProps!==i.pendingProps)Vn=!0;else{if(!Ah(n,c)&&(i.flags&128)===0)return Vn=!1,x0(n,i,c);Vn=(n.flags&131072)!==0}else Vn=!1,ur&&(i.flags&1048576)!==0&&Cf(i,Tl,i.index);switch(i.lanes=0,i.tag){case 16:e:{var v=i.pendingProps;if(n=zs(i.elementType),i.type=n,typeof n=="function")Wl(n)?(v=pi(n,v),i.tag=1,i=Fm(null,i,n,v,c)):(i.tag=0,i=ph(null,i,n,v,c));else{if(n!=null){var L=n.$$typeof;if(L===R){i.tag=11,i=qn(null,i,n,v,c);break e}else if(L===U){i.tag=14,i=Cr(null,i,n,v,c);break e}}throw i=de(n)||n,Error(r(306,i,""))}}return i;case 0:return ph(n,i,i.type,i.pendingProps,c);case 1:return v=i.type,L=pi(v,i.pendingProps),Fm(n,i,v,L,c);case 3:e:{if(vt(i,i.stateNode.containerInfo),n===null)throw Error(r(387));v=i.pendingProps;var M=i.memoizedState;L=M.element,hc(n,i),bl(i,v,null,c);var ce=i.memoizedState;if(v=ce.cache,_s(i,ai,v),v!==M.cache&&nu(i,[ai],c,!0),Po(),v=ce.element,M.isDehydrated)if(M={element:v,isDehydrated:!1,cache:ce.cache},i.updateQueue.baseState=M,i.memoizedState=M,i.flags&256){i=Um(n,i,v,c);break e}else if(v!==L){L=Xi(Error(r(424)),i),Sl(L),i=Um(n,i,v,c);break e}else{switch(n=i.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Vr=ka(n.firstChild),di=i,ur=!0,$a=null,Qi=!0,c=Of(i,null,v,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Ts(),v===L){i=to(n,i,c);break e}Kn(n,i,v,c)}i=i.child}return i;case 26:return Ff(n,i),n===null?(c=Jp(i.type,null,i.pendingProps,null))?i.memoizedState=c:ur||(c=i.type,n=i.pendingProps,v=ed(Ge.current).createElement(c),v[Jt]=i,v[Pt]=n,Ni(v,c,n),$n(v),i.stateNode=v):i.memoizedState=Jp(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return gt(i),n===null&&ur&&(v=i.stateNode=Wp(i.type,i.pendingProps,Ge.current),di=i,Qi=!0,L=Vr,Yo(i.type)?(ng=L,Vr=ka(v.firstChild)):Vr=L),Kn(n,i,i.pendingProps.children,c),Ff(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&ur&&((L=v=Vr)&&(v=sT(v,i.type,i.pendingProps,Qi),v!==null?(i.stateNode=v,di=i,Vr=ka(v.firstChild),Qi=!1,L=!0):L=!1),L||Wa(i)),gt(i),L=i.type,M=i.pendingProps,ce=n!==null?n.memoizedProps:null,v=M.children,Xh(L,M)?v=null:ce!==null&&Xh(L,ce)&&(i.flags|=32),i.memoizedState!==null&&(L=oe(n,i,be,null,null,c),wc._currentValue=L),Ff(n,i),Kn(n,i,v,c),i.child;case 6:return n===null&&ur&&((n=c=Vr)&&(c=oT(c,i.pendingProps,Qi),c!==null?(i.stateNode=c,di=i,Vr=null,n=!0):n=!1),n||Wa(i)),null;case 13:return Bm(n,i,c);case 4:return vt(i,i.stateNode.containerInfo),v=i.pendingProps,n===null?i.child=Oa(i,null,v,c):Kn(n,i,v,c),i.child;case 11:return qn(n,i,i.type,i.pendingProps,c);case 7:return Kn(n,i,i.pendingProps,c),i.child;case 8:return Kn(n,i,i.pendingProps.children,c),i.child;case 12:return Kn(n,i,i.pendingProps.children,c),i.child;case 10:return v=i.pendingProps,_s(i,i.type,v.value),Kn(n,i,v.children,c),i.child;case 9:return L=i.type._context,v=i.pendingProps.children,qs(i),L=mi(L),v=v(L),i.flags|=1,Kn(n,i,v,c),i.child;case 14:return Cr(n,i,i.type,i.pendingProps,c);case 15:return Sr(n,i,i.type,i.pendingProps,c);case 19:return Zm(n,i,c);case 31:return L0(n,i,c);case 22:return Ma(n,i,c,i.pendingProps);case 24:return qs(i),v=mi(ai),n===null?(L=uc(),L===null&&(L=Yr,M=lc(),L.pooledCache=M,M.refCount++,M!==null&&(L.pooledCacheLanes|=c),L=M),i.memoizedState={parent:v,cache:L},lu(i),_s(i,ai,L)):((n.lanes&c)!==0&&(hc(n,i),bl(i,null,null,c),Po()),L=n.memoizedState,M=i.memoizedState,L.parent!==v?(L={parent:v,cache:v},i.memoizedState=L,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=L),_s(i,ai,v)):(v=M.cache,_s(i,ai,v),v!==L.cache&&nu(i,[ai],c,!0))),Kn(n,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function no(n){n.flags|=4}function bh(n,i,c,v,L){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(L&335544128)===L)if(n.stateNode.complete)n.flags|=8192;else if(mp())n.flags|=8192;else throw As=ou,cc}else n.flags&=-16777217}function Vm(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!iy(i))if(mp())n.flags|=8192;else throw As=ou,cc}function Bf(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?Us():536870912,n.lanes|=i,pu|=i)}function vc(n,i){if(!ur)switch(n.tailMode){case"hidden":i=n.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?n.tail=null:c.sibling=null;break;case"collapsed":c=n.tail;for(var v=null;c!==null;)c.alternate!==null&&(v=c),c=c.sibling;v===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:v.sibling=null}}function Xr(n){var i=n.alternate!==null&&n.alternate.child===n.child,c=0,v=0;if(i)for(var L=n.child;L!==null;)c|=L.lanes|L.childLanes,v|=L.subtreeFlags&65011712,v|=L.flags&65011712,L.return=n,L=L.sibling;else for(L=n.child;L!==null;)c|=L.lanes|L.childLanes,v|=L.subtreeFlags,v|=L.flags,L.return=n,L=L.sibling;return n.subtreeFlags|=v,n.childLanes=c,i}function N0(n,i,c){var v=i.pendingProps;switch(rc(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xr(i),null;case 1:return Xr(i),null;case 3:return c=i.stateNode,v=null,n!==null&&(v=n.memoizedState.cache),i.memoizedState.cache!==v&&(i.flags|=2048),wa(ai),et(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(js(i)?no(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,eu())),Xr(i),null;case 26:var L=i.type,M=i.memoizedState;return n===null?(no(i),M!==null?(Xr(i),Vm(i,M)):(Xr(i),bh(i,L,null,v,c))):M?M!==n.memoizedState?(no(i),Xr(i),Vm(i,M)):(Xr(i),i.flags&=-16777217):(n=n.memoizedProps,n!==v&&no(i),Xr(i),bh(i,L,n,v,c)),null;case 27:if(Oe(i),c=Ge.current,L=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==v&&no(i);else{if(!v){if(i.stateNode===null)throw Error(r(166));return Xr(i),null}n=Ke.current,js(i)?ac(i):(n=Wp(L,v,c),i.stateNode=n,no(i))}return Xr(i),null;case 5:if(Oe(i),L=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==v&&no(i);else{if(!v){if(i.stateNode===null)throw Error(r(166));return Xr(i),null}if(M=Ke.current,js(i))ac(i);else{var ce=ed(Ge.current);switch(M){case 1:M=ce.createElementNS("http://www.w3.org/2000/svg",L);break;case 2:M=ce.createElementNS("http://www.w3.org/1998/Math/MathML",L);break;default:switch(L){case"svg":M=ce.createElementNS("http://www.w3.org/2000/svg",L);break;case"math":M=ce.createElementNS("http://www.w3.org/1998/Math/MathML",L);break;case"script":M=ce.createElement("div"),M.innerHTML="<script><\/script>",M=M.removeChild(M.firstChild);break;case"select":M=typeof v.is=="string"?ce.createElement("select",{is:v.is}):ce.createElement("select"),v.multiple?M.multiple=!0:v.size&&(M.size=v.size);break;default:M=typeof v.is=="string"?ce.createElement(L,{is:v.is}):ce.createElement(L)}}M[Jt]=i,M[Pt]=v;e:for(ce=i.child;ce!==null;){if(ce.tag===5||ce.tag===6)M.appendChild(ce.stateNode);else if(ce.tag!==4&&ce.tag!==27&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===i)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===i)break e;ce=ce.return}ce.sibling.return=ce.return,ce=ce.sibling}i.stateNode=M;e:switch(Ni(M,L,v),L){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}v&&no(i)}}return Xr(i),bh(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,c),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==v&&no(i);else{if(typeof v!="string"&&i.stateNode===null)throw Error(r(166));if(n=Ge.current,js(i)){if(n=i.stateNode,c=i.memoizedProps,v=null,L=di,L!==null)switch(L.tag){case 27:case 5:v=L.memoizedProps}n[Jt]=i,n=!!(n.nodeValue===c||v!==null&&v.suppressHydrationWarning===!0||Bp(n.nodeValue,c)),n||Wa(i,!0)}else n=ed(n).createTextNode(v),n[Jt]=i,i.stateNode=n}return Xr(i),null;case 31:if(c=i.memoizedState,n===null||n.memoizedState!==null){if(v=js(i),c!==null){if(n===null){if(!v)throw Error(r(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[Jt]=i}else Ts(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Xr(i),n=!1}else c=eu(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=c),n=!0;if(!n)return i.flags&256?(qi(i),i):(qi(i),null);if((i.flags&128)!==0)throw Error(r(558))}return Xr(i),null;case 13:if(v=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(L=js(i),v!==null&&v.dehydrated!==null){if(n===null){if(!L)throw Error(r(318));if(L=i.memoizedState,L=L!==null?L.dehydrated:null,!L)throw Error(r(317));L[Jt]=i}else Ts(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Xr(i),L=!1}else L=eu(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=L),L=!0;if(!L)return i.flags&256?(qi(i),i):(qi(i),null)}return qi(i),(i.flags&128)!==0?(i.lanes=c,i):(c=v!==null,n=n!==null&&n.memoizedState!==null,c&&(v=i.child,L=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(L=v.alternate.memoizedState.cachePool.pool),M=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(M=v.memoizedState.cachePool.pool),M!==L&&(v.flags|=2048)),c!==n&&c&&(i.child.flags|=8192),Bf(i,i.updateQueue),Xr(i),null);case 4:return et(),n===null&&qh(i.stateNode.containerInfo),Xr(i),null;case 10:return wa(i.type),Xr(i),null;case 19:if(_e(Wr),v=i.memoizedState,v===null)return Xr(i),null;if(L=(i.flags&128)!==0,M=v.rendering,M===null)if(L)vc(v,!1);else{if(si!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(M=eo(n),M!==null){for(i.flags|=128,vc(v,!1),n=M.updateQueue,i.updateQueue=n,Bf(i,n),i.subtreeFlags=0,n=c,c=i.child;c!==null;)Qu(c,n),c=c.sibling;return Ze(Wr,Wr.current&1|2),ur&&xa(i,v.treeForkCount),i.child}n=n.sibling}v.tail!==null&&Ye()>Yf&&(i.flags|=128,L=!0,vc(v,!1),i.lanes=4194304)}else{if(!L)if(n=eo(M),n!==null){if(i.flags|=128,L=!0,n=n.updateQueue,i.updateQueue=n,Bf(i,n),vc(v,!0),v.tail===null&&v.tailMode==="hidden"&&!M.alternate&&!ur)return Xr(i),null}else 2*Ye()-v.renderingStartTime>Yf&&c!==536870912&&(i.flags|=128,L=!0,vc(v,!1),i.lanes=4194304);v.isBackwards?(M.sibling=i.child,i.child=M):(n=v.last,n!==null?n.sibling=M:i.child=M,v.last=M)}return v.tail!==null?(n=v.tail,v.rendering=n,v.tail=n.sibling,v.renderingStartTime=Ye(),n.sibling=null,c=Wr.current,Ze(Wr,L?c&1|2:c&1),ur&&xa(i,v.treeForkCount),n):(Xr(i),null);case 22:case 23:return qi(i),fu(),v=i.memoizedState!==null,n!==null?n.memoizedState!==null!==v&&(i.flags|=8192):v&&(i.flags|=8192),v?(c&536870912)!==0&&(i.flags&128)===0&&(Xr(i),i.subtreeFlags&6&&(i.flags|=8192)):Xr(i),c=i.updateQueue,c!==null&&Bf(i,c.retryQueue),c=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),v=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(v=i.memoizedState.cachePool.pool),v!==c&&(i.flags|=2048),n!==null&&_e(Ks),null;case 24:return c=null,n!==null&&(c=n.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),wa(ai),Xr(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function w0(n,i){switch(rc(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return wa(ai),et(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return Oe(i),null;case 31:if(i.memoizedState!==null){if(qi(i),i.alternate===null)throw Error(r(340));Ts()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(qi(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Ts()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return _e(Wr),null;case 4:return et(),null;case 10:return wa(i.type),null;case 22:case 23:return qi(i),fu(),n!==null&&_e(Ks),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return wa(ai),null;case 25:return null;default:return null}}function Ym(n,i){switch(rc(i),i.tag){case 3:wa(ai),et();break;case 26:case 27:case 5:Oe(i);break;case 4:et();break;case 31:i.memoizedState!==null&&qi(i);break;case 13:qi(i);break;case 19:_e(Wr);break;case 10:wa(i.type);break;case 22:case 23:qi(i),fu(),n!==null&&_e(Ks);break;case 24:wa(ai)}}function Ec(n,i){try{var c=i.updateQueue,v=c!==null?c.lastEffect:null;if(v!==null){var L=v.next;c=L;do{if((c.tag&n)===n){v=void 0;var M=c.create,ce=c.inst;v=M(),ce.destroy=v}c=c.next}while(c!==L)}}catch(ke){wr(i,i.return,ke)}}function Fo(n,i,c){try{var v=i.updateQueue,L=v!==null?v.lastEffect:null;if(L!==null){var M=L.next;v=M;do{if((v.tag&n)===n){var ce=v.inst,ke=ce.destroy;if(ke!==void 0){ce.destroy=void 0,L=i;var rt=c,Ut=ke;try{Ut()}catch(Qt){wr(L,rt,Qt)}}}v=v.next}while(v!==M)}}catch(Qt){wr(i,i.return,Qt)}}function jm(n){var i=n.updateQueue;if(i!==null){var c=n.stateNode;try{Mf(i,c)}catch(v){wr(n,n.return,v)}}}function qm(n,i,c){c.props=pi(n.type,n.memoizedProps),c.state=n.memoizedState;try{c.componentWillUnmount()}catch(v){wr(n,i,v)}}function Tc(n,i){try{var c=n.ref;if(c!==null){switch(n.tag){case 26:case 27:case 5:var v=n.stateNode;break;case 30:v=n.stateNode;break;default:v=n.stateNode}typeof c=="function"?n.refCleanup=c(v):c.current=v}}catch(L){wr(n,i,L)}}function Ds(n,i){var c=n.ref,v=n.refCleanup;if(c!==null)if(typeof v=="function")try{v()}catch(L){wr(n,i,L)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(L){wr(n,i,L)}else c.current=null}function Km(n){var i=n.type,c=n.memoizedProps,v=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&v.focus();break e;case"img":c.src?v.src=c.src:c.srcSet&&(v.srcset=c.srcSet)}}catch(L){wr(n,n.return,L)}}function Rh(n,i,c){try{var v=n.stateNode;eT(v,n.type,c,i),v[Pt]=i}catch(L){wr(n,n.return,L)}}function zm(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Yo(n.type)||n.tag===4}function Ih(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||zm(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Yo(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Ch(n,i,c){var v=n.tag;if(v===5||v===6)n=n.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(n,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(n),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Gi));else if(v!==4&&(v===27&&Yo(n.type)&&(c=n.stateNode,i=null),n=n.child,n!==null))for(Ch(n,i,c),n=n.sibling;n!==null;)Ch(n,i,c),n=n.sibling}function Gf(n,i,c){var v=n.tag;if(v===5||v===6)n=n.stateNode,i?c.insertBefore(n,i):c.appendChild(n);else if(v!==4&&(v===27&&Yo(n.type)&&(c=n.stateNode),n=n.child,n!==null))for(Gf(n,i,c),n=n.sibling;n!==null;)Gf(n,i,c),n=n.sibling}function $m(n){var i=n.stateNode,c=n.memoizedProps;try{for(var v=n.type,L=i.attributes;L.length;)i.removeAttributeNode(L[0]);Ni(i,v,c),i[Jt]=n,i[Pt]=c}catch(M){wr(n,n.return,M)}}var ro=!1,yi=!1,Dh=!1,Wm=typeof WeakSet=="function"?WeakSet:Set,Ii=null;function O0(n,i){if(n=n.containerInfo,$h=od,n=jl(n),ml(n)){if("selectionStart"in n)var c={start:n.selectionStart,end:n.selectionEnd};else e:{c=(c=n.ownerDocument)&&c.defaultView||window;var v=c.getSelection&&c.getSelection();if(v&&v.rangeCount!==0){c=v.anchorNode;var L=v.anchorOffset,M=v.focusNode;v=v.focusOffset;try{c.nodeType,M.nodeType}catch{c=null;break e}var ce=0,ke=-1,rt=-1,Ut=0,Qt=0,dn=n,Zt=null;t:for(;;){for(var $t;dn!==c||L!==0&&dn.nodeType!==3||(ke=ce+L),dn!==M||v!==0&&dn.nodeType!==3||(rt=ce+v),dn.nodeType===3&&(ce+=dn.nodeValue.length),($t=dn.firstChild)!==null;)Zt=dn,dn=$t;for(;;){if(dn===n)break t;if(Zt===c&&++Ut===L&&(ke=ce),Zt===M&&++Qt===v&&(rt=ce),($t=dn.nextSibling)!==null)break;dn=Zt,Zt=dn.parentNode}dn=$t}c=ke===-1||rt===-1?null:{start:ke,end:rt}}else c=null}c=c||{start:0,end:0}}else c=null;for(Wh={focusedElem:n,selectionRange:c},od=!1,Ii=i;Ii!==null;)if(i=Ii,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Ii=n;else for(;Ii!==null;){switch(i=Ii,M=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(c=0;c<n.length;c++)L=n[c],L.ref.impl=L.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&M!==null){n=void 0,c=i,L=M.memoizedProps,M=M.memoizedState,v=c.stateNode;try{var Bn=pi(c.type,L);n=v.getSnapshotBeforeUpdate(Bn,M),v.__reactInternalSnapshotBeforeUpdate=n}catch(Qn){wr(c,c.return,Qn)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,c=n.nodeType,c===9)Jh(n);else if(c===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Jh(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=i.sibling,n!==null){n.return=i.return,Ii=n;break}Ii=i.return}}function Xm(n,i,c){var v=c.flags;switch(c.tag){case 0:case 11:case 15:ao(n,c),v&4&&Ec(5,c);break;case 1:if(ao(n,c),v&4)if(n=c.stateNode,i===null)try{n.componentDidMount()}catch(ce){wr(c,c.return,ce)}else{var L=pi(c.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(L,i,n.__reactInternalSnapshotBeforeUpdate)}catch(ce){wr(c,c.return,ce)}}v&64&&jm(c),v&512&&Tc(c,c.return);break;case 3:if(ao(n,c),v&64&&(n=c.updateQueue,n!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{Mf(n,i)}catch(ce){wr(c,c.return,ce)}}break;case 27:i===null&&v&4&&$m(c);case 26:case 5:ao(n,c),i===null&&v&4&&Km(c),v&512&&Tc(c,c.return);break;case 12:ao(n,c);break;case 31:ao(n,c),v&4&&ep(n,c);break;case 13:ao(n,c),v&4&&tp(n,c),v&64&&(n=c.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(c=H0.bind(null,c),lT(n,c))));break;case 22:if(v=c.memoizedState!==null||ro,!v){i=i!==null&&i.memoizedState!==null||yi,L=ro;var M=yi;ro=v,(yi=i)&&!M?so(n,c,(c.subtreeFlags&8772)!==0):ao(n,c),ro=L,yi=M}break;case 30:break;default:ao(n,c)}}function Qm(n){var i=n.alternate;i!==null&&(n.alternate=null,Qm(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Ht(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Qr=null,na=!1;function io(n,i,c){for(c=c.child;c!==null;)Jm(n,i,c),c=c.sibling}function Jm(n,i,c){if(zn&&typeof zn.onCommitFiberUnmount=="function")try{zn.onCommitFiberUnmount(On,c)}catch{}switch(c.tag){case 26:yi||Ds(c,i),io(n,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:yi||Ds(c,i);var v=Qr,L=na;Yo(c.type)&&(Qr=c.stateNode,na=!1),io(n,i,c),Lc(c.stateNode),Qr=v,na=L;break;case 5:yi||Ds(c,i);case 6:if(v=Qr,L=na,Qr=null,io(n,i,c),Qr=v,na=L,Qr!==null)if(na)try{(Qr.nodeType===9?Qr.body:Qr.nodeName==="HTML"?Qr.ownerDocument.body:Qr).removeChild(c.stateNode)}catch(M){wr(c,i,M)}else try{Qr.removeChild(c.stateNode)}catch(M){wr(c,i,M)}break;case 18:Qr!==null&&(na?(n=Qr,jp(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,c.stateNode),bu(n)):jp(Qr,c.stateNode));break;case 4:v=Qr,L=na,Qr=c.stateNode.containerInfo,na=!0,io(n,i,c),Qr=v,na=L;break;case 0:case 11:case 14:case 15:Fo(2,c,i),yi||Fo(4,c,i),io(n,i,c);break;case 1:yi||(Ds(c,i),v=c.stateNode,typeof v.componentWillUnmount=="function"&&qm(c,i,v)),io(n,i,c);break;case 21:io(n,i,c);break;case 22:yi=(v=yi)||c.memoizedState!==null,io(n,i,c),yi=v;break;default:io(n,i,c)}}function ep(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{bu(n)}catch(c){wr(i,i.return,c)}}}function tp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{bu(n)}catch(c){wr(i,i.return,c)}}function M0(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new Wm),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new Wm),i;default:throw Error(r(435,n.tag))}}function Zf(n,i){var c=M0(n);i.forEach(function(v){if(!c.has(v)){c.add(v);var L=V0.bind(null,n,v);v.then(L,L)}})}function ra(n,i){var c=i.deletions;if(c!==null)for(var v=0;v<c.length;v++){var L=c[v],M=n,ce=i,ke=ce;e:for(;ke!==null;){switch(ke.tag){case 27:if(Yo(ke.type)){Qr=ke.stateNode,na=!1;break e}break;case 5:Qr=ke.stateNode,na=!1;break e;case 3:case 4:Qr=ke.stateNode.containerInfo,na=!0;break e}ke=ke.return}if(Qr===null)throw Error(r(160));Jm(M,ce,L),Qr=null,na=!1,M=L.alternate,M!==null&&(M.return=null),L.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)np(i,n),i=i.sibling}var is=null;function np(n,i){var c=n.alternate,v=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ra(i,n),ia(n),v&4&&(Fo(3,n,n.return),Ec(3,n),Fo(5,n,n.return));break;case 1:ra(i,n),ia(n),v&512&&(yi||c===null||Ds(c,c.return)),v&64&&ro&&(n=n.updateQueue,n!==null&&(v=n.callbacks,v!==null&&(c=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=c===null?v:c.concat(v))));break;case 26:var L=is;if(ra(i,n),ia(n),v&512&&(yi||c===null||Ds(c,c.return)),v&4){var M=c!==null?c.memoizedState:null;if(v=n.memoizedState,c===null)if(v===null)if(n.stateNode===null){e:{v=n.type,c=n.memoizedProps,L=L.ownerDocument||L;t:switch(v){case"title":M=L.getElementsByTagName("title")[0],(!M||M[xn]||M[Jt]||M.namespaceURI==="http://www.w3.org/2000/svg"||M.hasAttribute("itemprop"))&&(M=L.createElement(v),L.head.insertBefore(M,L.querySelector("head > title"))),Ni(M,v,c),M[Jt]=n,$n(M),v=M;break e;case"link":var ce=ny("link","href",L).get(v+(c.href||""));if(ce){for(var ke=0;ke<ce.length;ke++)if(M=ce[ke],M.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&M.getAttribute("rel")===(c.rel==null?null:c.rel)&&M.getAttribute("title")===(c.title==null?null:c.title)&&M.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){ce.splice(ke,1);break t}}M=L.createElement(v),Ni(M,v,c),L.head.appendChild(M);break;case"meta":if(ce=ny("meta","content",L).get(v+(c.content||""))){for(ke=0;ke<ce.length;ke++)if(M=ce[ke],M.getAttribute("content")===(c.content==null?null:""+c.content)&&M.getAttribute("name")===(c.name==null?null:c.name)&&M.getAttribute("property")===(c.property==null?null:c.property)&&M.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&M.getAttribute("charset")===(c.charSet==null?null:c.charSet)){ce.splice(ke,1);break t}}M=L.createElement(v),Ni(M,v,c),L.head.appendChild(M);break;default:throw Error(r(468,v))}M[Jt]=n,$n(M),v=M}n.stateNode=v}else ry(L,n.type,n.stateNode);else n.stateNode=ty(L,v,n.memoizedProps);else M!==v?(M===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):M.count--,v===null?ry(L,n.type,n.stateNode):ty(L,v,n.memoizedProps)):v===null&&n.stateNode!==null&&Rh(n,n.memoizedProps,c.memoizedProps)}break;case 27:ra(i,n),ia(n),v&512&&(yi||c===null||Ds(c,c.return)),c!==null&&v&4&&Rh(n,n.memoizedProps,c.memoizedProps);break;case 5:if(ra(i,n),ia(n),v&512&&(yi||c===null||Ds(c,c.return)),n.flags&32){L=n.stateNode;try{xr(L,"")}catch(Bn){wr(n,n.return,Bn)}}v&4&&n.stateNode!=null&&(L=n.memoizedProps,Rh(n,L,c!==null?c.memoizedProps:L)),v&1024&&(Dh=!0);break;case 6:if(ra(i,n),ia(n),v&4){if(n.stateNode===null)throw Error(r(162));v=n.memoizedProps,c=n.stateNode;try{c.nodeValue=v}catch(Bn){wr(n,n.return,Bn)}}break;case 3:if(rd=null,L=is,is=td(i.containerInfo),ra(i,n),is=L,ia(n),v&4&&c!==null&&c.memoizedState.isDehydrated)try{bu(i.containerInfo)}catch(Bn){wr(n,n.return,Bn)}Dh&&(Dh=!1,rp(n));break;case 4:v=is,is=td(n.stateNode.containerInfo),ra(i,n),ia(n),is=v;break;case 12:ra(i,n),ia(n);break;case 31:ra(i,n),ia(n),v&4&&(v=n.updateQueue,v!==null&&(n.updateQueue=null,Zf(n,v)));break;case 13:ra(i,n),ia(n),n.child.flags&8192&&n.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Vf=Ye()),v&4&&(v=n.updateQueue,v!==null&&(n.updateQueue=null,Zf(n,v)));break;case 22:L=n.memoizedState!==null;var rt=c!==null&&c.memoizedState!==null,Ut=ro,Qt=yi;if(ro=Ut||L,yi=Qt||rt,ra(i,n),yi=Qt,ro=Ut,ia(n),v&8192)e:for(i=n.stateNode,i._visibility=L?i._visibility&-2:i._visibility|1,L&&(c===null||rt||ro||yi||Dl(n)),c=null,i=n;;){if(i.tag===5||i.tag===26){if(c===null){rt=c=i;try{if(M=rt.stateNode,L)ce=M.style,typeof ce.setProperty=="function"?ce.setProperty("display","none","important"):ce.display="none";else{ke=rt.stateNode;var dn=rt.memoizedProps.style,Zt=dn!=null&&dn.hasOwnProperty("display")?dn.display:null;ke.style.display=Zt==null||typeof Zt=="boolean"?"":(""+Zt).trim()}}catch(Bn){wr(rt,rt.return,Bn)}}}else if(i.tag===6){if(c===null){rt=i;try{rt.stateNode.nodeValue=L?"":rt.memoizedProps}catch(Bn){wr(rt,rt.return,Bn)}}}else if(i.tag===18){if(c===null){rt=i;try{var $t=rt.stateNode;L?qp($t,!0):qp(rt.stateNode,!1)}catch(Bn){wr(rt,rt.return,Bn)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}v&4&&(v=n.updateQueue,v!==null&&(c=v.retryQueue,c!==null&&(v.retryQueue=null,Zf(n,c))));break;case 19:ra(i,n),ia(n),v&4&&(v=n.updateQueue,v!==null&&(n.updateQueue=null,Zf(n,v)));break;case 30:break;case 21:break;default:ra(i,n),ia(n)}}function ia(n){var i=n.flags;if(i&2){try{for(var c,v=n.return;v!==null;){if(zm(v)){c=v;break}v=v.return}if(c==null)throw Error(r(160));switch(c.tag){case 27:var L=c.stateNode,M=Ih(n);Gf(n,M,L);break;case 5:var ce=c.stateNode;c.flags&32&&(xr(ce,""),c.flags&=-33);var ke=Ih(n);Gf(n,ke,ce);break;case 3:case 4:var rt=c.stateNode.containerInfo,Ut=Ih(n);Ch(n,Ut,rt);break;default:throw Error(r(161))}}catch(Qt){wr(n,n.return,Qt)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function rp(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;rp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function ao(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Xm(n,i.alternate,i),i=i.sibling}function Dl(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Fo(4,i,i.return),Dl(i);break;case 1:Ds(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&qm(i,i.return,c),Dl(i);break;case 27:Lc(i.stateNode);case 26:case 5:Ds(i,i.return),Dl(i);break;case 22:i.memoizedState===null&&Dl(i);break;case 30:Dl(i);break;default:Dl(i)}n=n.sibling}}function so(n,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var v=i.alternate,L=n,M=i,ce=M.flags;switch(M.tag){case 0:case 11:case 15:so(L,M,c),Ec(4,M);break;case 1:if(so(L,M,c),v=M,L=v.stateNode,typeof L.componentDidMount=="function")try{L.componentDidMount()}catch(Ut){wr(v,v.return,Ut)}if(v=M,L=v.updateQueue,L!==null){var ke=v.stateNode;try{var rt=L.shared.hiddenCallbacks;if(rt!==null)for(L.shared.hiddenCallbacks=null,L=0;L<rt.length;L++)mc(rt[L],ke)}catch(Ut){wr(v,v.return,Ut)}}c&&ce&64&&jm(M),Tc(M,M.return);break;case 27:$m(M);case 26:case 5:so(L,M,c),c&&v===null&&ce&4&&Km(M),Tc(M,M.return);break;case 12:so(L,M,c);break;case 31:so(L,M,c),c&&ce&4&&ep(L,M);break;case 13:so(L,M,c),c&&ce&4&&tp(L,M);break;case 22:M.memoizedState===null&&so(L,M,c),Tc(M,M.return);break;case 30:break;default:so(L,M,c)}i=i.sibling}}function Lh(n,i){var c=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==c&&(n!=null&&n.refCount++,c!=null&&Lo(c))}function xh(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Lo(n))}function as(n,i,c,v){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)ip(n,i,c,v),i=i.sibling}function ip(n,i,c,v){var L=i.flags;switch(i.tag){case 0:case 11:case 15:as(n,i,c,v),L&2048&&Ec(9,i);break;case 1:as(n,i,c,v);break;case 3:as(n,i,c,v),L&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Lo(n)));break;case 12:if(L&2048){as(n,i,c,v),n=i.stateNode;try{var M=i.memoizedProps,ce=M.id,ke=M.onPostCommit;typeof ke=="function"&&ke(ce,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(rt){wr(i,i.return,rt)}}else as(n,i,c,v);break;case 31:as(n,i,c,v);break;case 13:as(n,i,c,v);break;case 23:break;case 22:M=i.stateNode,ce=i.alternate,i.memoizedState!==null?M._visibility&2?as(n,i,c,v):Sc(n,i):M._visibility&2?as(n,i,c,v):(M._visibility|=2,hu(n,i,c,v,(i.subtreeFlags&10256)!==0||!1)),L&2048&&Lh(ce,i);break;case 24:as(n,i,c,v),L&2048&&xh(i.alternate,i);break;default:as(n,i,c,v)}}function hu(n,i,c,v,L){for(L=L&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var M=n,ce=i,ke=c,rt=v,Ut=ce.flags;switch(ce.tag){case 0:case 11:case 15:hu(M,ce,ke,rt,L),Ec(8,ce);break;case 23:break;case 22:var Qt=ce.stateNode;ce.memoizedState!==null?Qt._visibility&2?hu(M,ce,ke,rt,L):Sc(M,ce):(Qt._visibility|=2,hu(M,ce,ke,rt,L)),L&&Ut&2048&&Lh(ce.alternate,ce);break;case 24:hu(M,ce,ke,rt,L),L&&Ut&2048&&xh(ce.alternate,ce);break;default:hu(M,ce,ke,rt,L)}i=i.sibling}}function Sc(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=n,v=i,L=v.flags;switch(v.tag){case 22:Sc(c,v),L&2048&&Lh(v.alternate,v);break;case 24:Sc(c,v),L&2048&&xh(v.alternate,v);break;default:Sc(c,v)}i=i.sibling}}var _c=8192;function gu(n,i,c){if(n.subtreeFlags&_c)for(n=n.child;n!==null;)ap(n,i,c),n=n.sibling}function ap(n,i,c){switch(n.tag){case 26:gu(n,i,c),n.flags&_c&&n.memoizedState!==null&&TT(c,is,n.memoizedState,n.memoizedProps);break;case 5:gu(n,i,c);break;case 3:case 4:var v=is;is=td(n.stateNode.containerInfo),gu(n,i,c),is=v;break;case 22:n.memoizedState===null&&(v=n.alternate,v!==null&&v.memoizedState!==null?(v=_c,_c=16777216,gu(n,i,c),_c=v):gu(n,i,c));break;default:gu(n,i,c)}}function sp(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Ac(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var v=i[c];Ii=v,lp(v,n)}sp(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)op(n),n=n.sibling}function op(n){switch(n.tag){case 0:case 11:case 15:Ac(n),n.flags&2048&&Fo(9,n,n.return);break;case 3:Ac(n);break;case 12:Ac(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,Hf(n)):Ac(n);break;default:Ac(n)}}function Hf(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var v=i[c];Ii=v,lp(v,n)}sp(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Fo(8,i,i.return),Hf(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,Hf(i));break;default:Hf(i)}n=n.sibling}}function lp(n,i){for(;Ii!==null;){var c=Ii;switch(c.tag){case 0:case 11:case 15:Fo(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var v=c.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:Lo(c.memoizedState.cache)}if(v=c.child,v!==null)v.return=c,Ii=v;else e:for(c=n;Ii!==null;){v=Ii;var L=v.sibling,M=v.return;if(Qm(v),v===c){Ii=null;break e}if(L!==null){L.return=M,Ii=L;break e}Ii=M}}}var P0={getCacheForType:function(n){var i=mi(ai),c=i.data.get(n);return c===void 0&&(c=n(),i.data.set(n,c)),c},cacheSignal:function(){return mi(ai).controller.signal}},k0=typeof WeakMap=="function"?WeakMap:Map,Dr=0,Yr=null,dr=null,yr=0,Nr=0,ya=null,Uo=!1,mu=!1,Nh=!1,oo=0,si=0,Bo=0,Ll=0,wh=0,va=0,pu=0,bc=null,aa=null,Oh=!1,Vf=0,up=0,Yf=1/0,jf=null,Go=null,Si=0,Zo=null,yu=null,lo=0,Mh=0,Ph=null,cp=null,Rc=0,kh=null;function Ea(){return(Dr&2)!==0&&yr!==0?yr&-yr:me.T!==null?Hh():fn()}function fp(){if(va===0)if((yr&536870912)===0||ur){var n=Zr;Zr<<=1,(Zr&3932160)===0&&(Zr=262144),va=n}else va=536870912;return n=Fi.current,n!==null&&(n.flags|=32),va}function sa(n,i,c){(n===Yr&&(Nr===2||Nr===9)||n.cancelPendingCommit!==null)&&(vu(n,0),Ho(n,yr,va,!1)),Vt(n,c),((Dr&2)===0||n!==Yr)&&(n===Yr&&((Dr&2)===0&&(Ll|=c),si===4&&Ho(n,yr,va,!1)),Ls(n))}function dp(n,i,c){if((Dr&6)!==0)throw Error(r(327));var v=!c&&(i&127)===0&&(i&n.expiredLanes)===0||bi(n,i),L=v?B0(n,i):Uh(n,i,!0),M=v;do{if(L===0){mu&&!v&&Ho(n,i,0,!1);break}else{if(c=n.current.alternate,M&&!F0(c)){L=Uh(n,i,!1),M=!1;continue}if(L===2){if(M=i,n.errorRecoveryDisabledLanes&M)var ce=0;else ce=n.pendingLanes&-536870913,ce=ce!==0?ce:ce&536870912?536870912:0;if(ce!==0){i=ce;e:{var ke=n;L=bc;var rt=ke.current.memoizedState.isDehydrated;if(rt&&(vu(ke,ce).flags|=256),ce=Uh(ke,ce,!1),ce!==2){if(Nh&&!rt){ke.errorRecoveryDisabledLanes|=M,Ll|=M,L=4;break e}M=aa,aa=L,M!==null&&(aa===null?aa=M:aa.push.apply(aa,M))}L=ce}if(M=!1,L!==2)continue}}if(L===1){vu(n,0),Ho(n,i,0,!0);break}e:{switch(v=n,M=L,M){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Ho(v,i,va,!Uo);break e;case 2:aa=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(L=Vf+300-Ye(),10<L)){if(Ho(v,i,va,!Uo),ii(v,0,!0)!==0)break e;lo=i,v.timeoutHandle=Vp(hp.bind(null,v,c,aa,jf,Oh,i,va,Ll,pu,Uo,M,"Throttled",-0,0),L);break e}hp(v,c,aa,jf,Oh,i,va,Ll,pu,Uo,M,null,-0,0)}}break}while(!0);Ls(n)}function hp(n,i,c,v,L,M,ce,ke,rt,Ut,Qt,dn,Zt,$t){if(n.timeoutHandle=-1,dn=i.subtreeFlags,dn&8192||(dn&16785408)===16785408){dn={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gi},ap(i,M,dn);var Bn=(M&62914560)===M?Vf-Ye():(M&4194048)===M?up-Ye():0;if(Bn=ST(dn,Bn),Bn!==null){lo=M,n.cancelPendingCommit=Bn(Sp.bind(null,n,i,M,c,v,L,ce,ke,rt,Qt,dn,null,Zt,$t)),Ho(n,M,ce,!Ut);return}}Sp(n,i,M,c,v,L,ce,ke,rt)}function F0(n){for(var i=n;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var v=0;v<c.length;v++){var L=c[v],M=L.getSnapshot;L=L.value;try{if(!xi(M(),L))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ho(n,i,c,v){i&=~wh,i&=~Ll,n.suspendedLanes|=i,n.pingedLanes&=~i,v&&(n.warmLanes|=i),v=n.expirationTimes;for(var L=i;0<L;){var M=31-er(L),ce=1<<M;v[M]=-1,L&=~ce}c!==0&&at(n,c,i)}function qf(){return(Dr&6)===0?(Ic(0),!1):!0}function Fh(){if(dr!==null){if(Nr===0)var n=dr.return;else n=dr,Na=Ss=null,le(n),Oo=null,$s=0,n=dr;for(;n!==null;)Ym(n.alternate,n),n=n.return;dr=null}}function vu(n,i){var c=n.timeoutHandle;c!==-1&&(n.timeoutHandle=-1,rT(c)),c=n.cancelPendingCommit,c!==null&&(n.cancelPendingCommit=null,c()),lo=0,Fh(),Yr=n,dr=c=za(n.current,null),yr=i,Nr=0,ya=null,Uo=!1,mu=bi(n,i),Nh=!1,pu=va=wh=Ll=Bo=si=0,aa=bc=null,Oh=!1,(i&8)!==0&&(i|=i&32);var v=n.entangledLanes;if(v!==0)for(n=n.entanglements,v&=i;0<v;){var L=31-er(v),M=1<<L;i|=n[L],v&=~M}return oo=i,bo(),c}function gp(n,i){D=null,me.H=ea,i===wo||i===su?(i=Nf(),Nr=3):i===cc?(i=Nf(),Nr=4):Nr=i===Un?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,ya=i,dr===null&&(si=1,pa(n,Xi(i,n.current)))}function mp(){var n=Fi.current;return n===null?!0:(yr&4194048)===yr?Ji===null:(yr&62914560)===yr||(yr&536870912)!==0?n===Ji:!1}function pp(){var n=me.H;return me.H=ea,n===null?ea:n}function yp(){var n=me.A;return me.A=P0,n}function Kf(){si=4,Uo||(yr&4194048)!==yr&&Fi.current!==null||(mu=!0),(Bo&134217727)===0&&(Ll&134217727)===0||Yr===null||Ho(Yr,yr,va,!1)}function Uh(n,i,c){var v=Dr;Dr|=2;var L=pp(),M=yp();(Yr!==n||yr!==i)&&(jf=null,vu(n,i)),i=!1;var ce=si;e:do try{if(Nr!==0&&dr!==null){var ke=dr,rt=ya;switch(Nr){case 8:Fh(),ce=6;break e;case 3:case 2:case 9:case 6:Fi.current===null&&(i=!0);var Ut=Nr;if(Nr=0,ya=null,Eu(n,ke,rt,Ut),c&&mu){ce=0;break e}break;default:Ut=Nr,Nr=0,ya=null,Eu(n,ke,rt,Ut)}}U0(),ce=si;break}catch(Qt){gp(n,Qt)}while(!0);return i&&n.shellSuspendCounter++,Na=Ss=null,Dr=v,me.H=L,me.A=M,dr===null&&(Yr=null,yr=0,bo()),ce}function U0(){for(;dr!==null;)vp(dr)}function B0(n,i){var c=Dr;Dr|=2;var v=pp(),L=yp();Yr!==n||yr!==i?(jf=null,Yf=Ye()+500,vu(n,i)):mu=bi(n,i);e:do try{if(Nr!==0&&dr!==null){i=dr;var M=ya;t:switch(Nr){case 1:Nr=0,ya=null,Eu(n,i,M,1);break;case 2:case 9:if(xf(M)){Nr=0,ya=null,Ep(i);break}i=function(){Nr!==2&&Nr!==9||Yr!==n||(Nr=7),Ls(n)},M.then(i,i);break e;case 3:Nr=7;break e;case 4:Nr=5;break e;case 7:xf(M)?(Nr=0,ya=null,Ep(i)):(Nr=0,ya=null,Eu(n,i,M,7));break;case 5:var ce=null;switch(dr.tag){case 26:ce=dr.memoizedState;case 5:case 27:var ke=dr;if(ce?iy(ce):ke.stateNode.complete){Nr=0,ya=null;var rt=ke.sibling;if(rt!==null)dr=rt;else{var Ut=ke.return;Ut!==null?(dr=Ut,zf(Ut)):dr=null}break t}}Nr=0,ya=null,Eu(n,i,M,5);break;case 6:Nr=0,ya=null,Eu(n,i,M,6);break;case 8:Fh(),si=6;break e;default:throw Error(r(462))}}G0();break}catch(Qt){gp(n,Qt)}while(!0);return Na=Ss=null,me.H=v,me.A=L,Dr=c,dr!==null?0:(Yr=null,yr=0,bo(),si)}function G0(){for(;dr!==null&&!Je();)vp(dr)}function vp(n){var i=Hm(n.alternate,n,oo);n.memoizedProps=n.pendingProps,i===null?zf(n):dr=i}function Ep(n){var i=n,c=i.alternate;switch(i.tag){case 15:case 0:i=km(c,i,i.pendingProps,i.type,void 0,yr);break;case 11:i=km(c,i,i.pendingProps,i.type.render,i.ref,yr);break;case 5:le(i);default:Ym(c,i),i=dr=Qu(i,oo),i=Hm(c,i,oo)}n.memoizedProps=n.pendingProps,i===null?zf(n):dr=i}function Eu(n,i,c,v){Na=Ss=null,le(i),Oo=null,$s=0;var L=i.return;try{if(Dn(n,L,i,c,yr)){si=1,pa(n,Xi(c,n.current)),dr=null;return}}catch(M){if(L!==null)throw dr=L,M;si=1,pa(n,Xi(c,n.current)),dr=null;return}i.flags&32768?(ur||v===1?n=!0:mu||(yr&536870912)!==0?n=!1:(Uo=n=!0,(v===2||v===9||v===3||v===6)&&(v=Fi.current,v!==null&&v.tag===13&&(v.flags|=16384))),Tp(i,n)):zf(i)}function zf(n){var i=n;do{if((i.flags&32768)!==0){Tp(i,Uo);return}n=i.return;var c=N0(i.alternate,i,oo);if(c!==null){dr=c;return}if(i=i.sibling,i!==null){dr=i;return}dr=i=n}while(i!==null);si===0&&(si=5)}function Tp(n,i){do{var c=w0(n.alternate,n);if(c!==null){c.flags&=32767,dr=c;return}if(c=n.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(n=n.sibling,n!==null)){dr=n;return}dr=n=c}while(n!==null);si=6,dr=null}function Sp(n,i,c,v,L,M,ce,ke,rt){n.cancelPendingCommit=null;do $f();while(Si!==0);if((Dr&6)!==0)throw Error(r(327));if(i!==null){if(i===n.current)throw Error(r(177));if(M=i.lanes|i.childLanes,M|=Wu,Kt(n,c,M,ce,ke,rt),n===Yr&&(dr=Yr=null,yr=0),yu=i,Zo=n,lo=c,Mh=M,Ph=L,cp=v,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Y0(_t,function(){return Ip(),null})):(n.callbackNode=null,n.callbackPriority=0),v=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||v){v=me.T,me.T=null,L=X.p,X.p=2,ce=Dr,Dr|=4;try{O0(n,i,c)}finally{Dr=ce,X.p=L,me.T=v}}Si=1,_p(),Ap(),bp()}}function _p(){if(Si===1){Si=0;var n=Zo,i=yu,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=me.T,me.T=null;var v=X.p;X.p=2;var L=Dr;Dr|=4;try{np(i,n);var M=Wh,ce=jl(n.containerInfo),ke=M.focusedElem,rt=M.selectionRange;if(ce!==ke&&ke&&ke.ownerDocument&&Tf(ke.ownerDocument.documentElement,ke)){if(rt!==null&&ml(ke)){var Ut=rt.start,Qt=rt.end;if(Qt===void 0&&(Qt=Ut),"selectionStart"in ke)ke.selectionStart=Ut,ke.selectionEnd=Math.min(Qt,ke.value.length);else{var dn=ke.ownerDocument||document,Zt=dn&&dn.defaultView||window;if(Zt.getSelection){var $t=Zt.getSelection(),Bn=ke.textContent.length,Qn=Math.min(rt.start,Bn),Br=rt.end===void 0?Qn:Math.min(rt.end,Bn);!$t.extend&&Qn>Br&&(ce=Br,Br=Qn,Qn=ce);var Rt=zu(ke,Qn),ht=zu(ke,Br);if(Rt&&ht&&($t.rangeCount!==1||$t.anchorNode!==Rt.node||$t.anchorOffset!==Rt.offset||$t.focusNode!==ht.node||$t.focusOffset!==ht.offset)){var kt=dn.createRange();kt.setStart(Rt.node,Rt.offset),$t.removeAllRanges(),Qn>Br?($t.addRange(kt),$t.extend(ht.node,ht.offset)):(kt.setEnd(ht.node,ht.offset),$t.addRange(kt))}}}}for(dn=[],$t=ke;$t=$t.parentNode;)$t.nodeType===1&&dn.push({element:$t,left:$t.scrollLeft,top:$t.scrollTop});for(typeof ke.focus=="function"&&ke.focus(),ke=0;ke<dn.length;ke++){var on=dn[ke];on.element.scrollLeft=on.left,on.element.scrollTop=on.top}}od=!!$h,Wh=$h=null}finally{Dr=L,X.p=v,me.T=c}}n.current=i,Si=2}}function Ap(){if(Si===2){Si=0;var n=Zo,i=yu,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=me.T,me.T=null;var v=X.p;X.p=2;var L=Dr;Dr|=4;try{Xm(n,i.alternate,i)}finally{Dr=L,X.p=v,me.T=c}}Si=3}}function bp(){if(Si===4||Si===3){Si=0,Qe();var n=Zo,i=yu,c=lo,v=cp;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Si=5:(Si=0,yu=Zo=null,Rp(n,n.pendingLanes));var L=n.pendingLanes;if(L===0&&(Go=null),sn(c),i=i.stateNode,zn&&typeof zn.onCommitFiberRoot=="function")try{zn.onCommitFiberRoot(On,i,void 0,(i.current.flags&128)===128)}catch{}if(v!==null){i=me.T,L=X.p,X.p=2,me.T=null;try{for(var M=n.onRecoverableError,ce=0;ce<v.length;ce++){var ke=v[ce];M(ke.value,{componentStack:ke.stack})}}finally{me.T=i,X.p=L}}(lo&3)!==0&&$f(),Ls(n),L=n.pendingLanes,(c&261930)!==0&&(L&42)!==0?n===kh?Rc++:(Rc=0,kh=n):Rc=0,Ic(0)}}function Rp(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,Lo(i)))}function $f(){return _p(),Ap(),bp(),Ip()}function Ip(){if(Si!==5)return!1;var n=Zo,i=Mh;Mh=0;var c=sn(lo),v=me.T,L=X.p;try{X.p=32>c?32:c,me.T=null,c=Ph,Ph=null;var M=Zo,ce=lo;if(Si=0,yu=Zo=null,lo=0,(Dr&6)!==0)throw Error(r(331));var ke=Dr;if(Dr|=4,op(M.current),ip(M,M.current,ce,c),Dr=ke,Ic(0,!1),zn&&typeof zn.onPostCommitFiberRoot=="function")try{zn.onPostCommitFiberRoot(On,M)}catch{}return!0}finally{X.p=L,me.T=v,Rp(n,i)}}function Cp(n,i,c){i=Xi(c,i),i=rs(n.stateNode,i,2),n=Rs(n,i,2),n!==null&&(Vt(n,2),Ls(n))}function wr(n,i,c){if(n.tag===3)Cp(n,n,c);else for(;i!==null;){if(i.tag===3){Cp(i,n,c);break}else if(i.tag===1){var v=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Go===null||!Go.has(v))){n=Xi(c,n),c=dt(2),v=Rs(i,c,2),v!==null&&(Xt(c,v,i,n),Vt(v,2),Ls(v));break}}i=i.return}}function Bh(n,i,c){var v=n.pingCache;if(v===null){v=n.pingCache=new k0;var L=new Set;v.set(i,L)}else L=v.get(i),L===void 0&&(L=new Set,v.set(i,L));L.has(c)||(Nh=!0,L.add(c),n=Z0.bind(null,n,i,c),i.then(n,n))}function Z0(n,i,c){var v=n.pingCache;v!==null&&v.delete(i),n.pingedLanes|=n.suspendedLanes&c,n.warmLanes&=~c,Yr===n&&(yr&c)===c&&(si===4||si===3&&(yr&62914560)===yr&&300>Ye()-Vf?(Dr&2)===0&&vu(n,0):wh|=c,pu===yr&&(pu=0)),Ls(n)}function Dp(n,i){i===0&&(i=Us()),n=Da(n,i),n!==null&&(Vt(n,i),Ls(n))}function H0(n){var i=n.memoizedState,c=0;i!==null&&(c=i.retryLane),Dp(n,c)}function V0(n,i){var c=0;switch(n.tag){case 31:case 13:var v=n.stateNode,L=n.memoizedState;L!==null&&(c=L.retryLane);break;case 19:v=n.stateNode;break;case 22:v=n.stateNode._retryCache;break;default:throw Error(r(314))}v!==null&&v.delete(i),Dp(n,c)}function Y0(n,i){return He(n,i)}var Wf=null,Tu=null,Gh=!1,Xf=!1,Zh=!1,Vo=0;function Ls(n){n!==Tu&&n.next===null&&(Tu===null?Wf=Tu=n:Tu=Tu.next=n),Xf=!0,Gh||(Gh=!0,q0())}function Ic(n,i){if(!Zh&&Xf){Zh=!0;do for(var c=!1,v=Wf;v!==null;){if(n!==0){var L=v.pendingLanes;if(L===0)var M=0;else{var ce=v.suspendedLanes,ke=v.pingedLanes;M=(1<<31-er(42|n)+1)-1,M&=L&~(ce&~ke),M=M&201326741?M&201326741|1:M?M|2:0}M!==0&&(c=!0,wp(v,M))}else M=yr,M=ii(v,v===Yr?M:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(M&3)===0||bi(v,M)||(c=!0,wp(v,M));v=v.next}while(c);Zh=!1}}function j0(){Lp()}function Lp(){Xf=Gh=!1;var n=0;Vo!==0&&nT()&&(n=Vo);for(var i=Ye(),c=null,v=Wf;v!==null;){var L=v.next,M=xp(v,i);M===0?(v.next=null,c===null?Wf=L:c.next=L,L===null&&(Tu=c)):(c=v,(n!==0||(M&3)!==0)&&(Xf=!0)),v=L}Si!==0&&Si!==5||Ic(n),Vo!==0&&(Vo=0)}function xp(n,i){for(var c=n.suspendedLanes,v=n.pingedLanes,L=n.expirationTimes,M=n.pendingLanes&-62914561;0<M;){var ce=31-er(M),ke=1<<ce,rt=L[ce];rt===-1?((ke&c)===0||(ke&v)!==0)&&(L[ce]=zi(ke,i)):rt<=i&&(n.expiredLanes|=ke),M&=~ke}if(i=Yr,c=yr,c=ii(n,n===i?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),v=n.callbackNode,c===0||n===i&&(Nr===2||Nr===9)||n.cancelPendingCommit!==null)return v!==null&&v!==null&&ut(v),n.callbackNode=null,n.callbackPriority=0;if((c&3)===0||bi(n,c)){if(i=c&-c,i===n.callbackPriority)return i;switch(v!==null&&ut(v),sn(c)){case 2:case 8:c=Gt;break;case 32:c=_t;break;case 268435456:c=Wt;break;default:c=_t}return v=Np.bind(null,n),c=He(c,v),n.callbackPriority=i,n.callbackNode=c,i}return v!==null&&v!==null&&ut(v),n.callbackPriority=2,n.callbackNode=null,2}function Np(n,i){if(Si!==0&&Si!==5)return n.callbackNode=null,n.callbackPriority=0,null;var c=n.callbackNode;if($f()&&n.callbackNode!==c)return null;var v=yr;return v=ii(n,n===Yr?v:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),v===0?null:(dp(n,v,i),xp(n,Ye()),n.callbackNode!=null&&n.callbackNode===c?Np.bind(null,n):null)}function wp(n,i){if($f())return null;dp(n,i,!0)}function q0(){iT(function(){(Dr&6)!==0?He(mt,j0):Lp()})}function Hh(){if(Vo===0){var n=xo;n===0&&(n=gi,gi<<=1,(gi&261888)===0&&(gi=256)),Vo=n}return Vo}function Op(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:ca(""+n)}function Mp(n,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,n.id&&c.setAttribute("form",n.id),i.parentNode.insertBefore(c,i),n=new FormData(n),c.parentNode.removeChild(c),n}function K0(n,i,c,v,L){if(i==="submit"&&c&&c.stateNode===L){var M=Op((L[Pt]||null).action),ce=v.submitter;ce&&(i=(i=ce[Pt]||null)?Op(i.formAction):ce.getAttribute("formAction"),i!==null&&(M=i,ce=null));var ke=new da("action","action",null,v,L);n.push({event:ke,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(Vo!==0){var rt=ce?Mp(L,ce):new FormData(L);ot(c,{pending:!0,data:rt,method:L.method,action:M},null,rt)}}else typeof M=="function"&&(ke.preventDefault(),rt=ce?Mp(L,ce):new FormData(L),ot(c,{pending:!0,data:rt,method:L.method,action:M},M,rt))},currentTarget:L}]})}}for(var Vh=0;Vh<vs.length;Vh++){var Yh=vs[Vh],z0=Yh.toLowerCase(),$0=Yh[0].toUpperCase()+Yh.slice(1);Hi(z0,"on"+$0)}Hi(_o,"onAnimationEnd"),Hi(zl,"onAnimationIteration"),Hi(_f,"onAnimationStart"),Hi("dblclick","onDoubleClick"),Hi("focusin","onFocus"),Hi("focusout","onBlur"),Hi($l,"onTransitionRun"),Hi(uh,"onTransitionStart"),Hi(ch,"onTransitionCancel"),Hi(Af,"onTransitionEnd"),Er("onMouseEnter",["mouseout","mouseover"]),Er("onMouseLeave",["mouseout","mouseover"]),Er("onPointerEnter",["pointerout","pointerover"]),Er("onPointerLeave",["pointerout","pointerover"]),Kr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Kr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Kr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Kr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Kr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Kr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),W0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Cc));function Pp(n,i){i=(i&4)!==0;for(var c=0;c<n.length;c++){var v=n[c],L=v.event;v=v.listeners;e:{var M=void 0;if(i)for(var ce=v.length-1;0<=ce;ce--){var ke=v[ce],rt=ke.instance,Ut=ke.currentTarget;if(ke=ke.listener,rt!==M&&L.isPropagationStopped())break e;M=ke,L.currentTarget=Ut;try{M(L)}catch(Qt){Ao(Qt)}L.currentTarget=null,M=rt}else for(ce=0;ce<v.length;ce++){if(ke=v[ce],rt=ke.instance,Ut=ke.currentTarget,ke=ke.listener,rt!==M&&L.isPropagationStopped())break e;M=ke,L.currentTarget=Ut;try{M(L)}catch(Qt){Ao(Qt)}L.currentTarget=null,M=rt}}}}function hr(n,i){var c=i[Sn];c===void 0&&(c=i[Sn]=new Set);var v=n+"__bubble";c.has(v)||(kp(i,n,2,!1),c.add(v))}function jh(n,i,c){var v=0;i&&(v|=4),kp(c,n,v,i)}var Qf="_reactListening"+Math.random().toString(36).slice(2);function qh(n){if(!n[Qf]){n[Qf]=!0,lr.forEach(function(c){c!=="selectionchange"&&(W0.has(c)||jh(c,!1,n),jh(c,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Qf]||(i[Qf]=!0,jh("selectionchange",!1,i))}}function kp(n,i,c,v){switch(fy(i)){case 2:var L=bT;break;case 8:L=RT;break;default:L=og}c=L.bind(null,i,c,n),L=void 0,!Gs||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(L=!0),v?L!==void 0?n.addEventListener(i,c,{capture:!0,passive:L}):n.addEventListener(i,c,!0):L!==void 0?n.addEventListener(i,c,{passive:L}):n.addEventListener(i,c,!1)}function Kh(n,i,c,v,L){var M=v;if((i&1)===0&&(i&2)===0&&v!==null)e:for(;;){if(v===null)return;var ce=v.tag;if(ce===3||ce===4){var ke=v.stateNode.containerInfo;if(ke===L)break;if(ce===4)for(ce=v.return;ce!==null;){var rt=ce.tag;if((rt===3||rt===4)&&ce.stateNode.containerInfo===L)return;ce=ce.return}for(;ke!==null;){if(ce=Yt(ke),ce===null)return;if(rt=ce.tag,rt===5||rt===6||rt===26||rt===27){v=M=ce;continue e}ke=ke.parentNode}}v=v.return}al(function(){var Ut=M,Qt=ds(c),dn=[];e:{var Zt=bf.get(n);if(Zt!==void 0){var $t=da,Bn=n;switch(n){case"keypress":if(Va(c)===0)break e;case"keydown":case"keyup":$t=Fl;break;case"focusin":Bn="focus",$t=dl;break;case"focusout":Bn="blur",$t=dl;break;case"beforeblur":case"afterblur":$t=dl;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$t=Qc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$t=Xd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$t=th;break;case _o:case zl:case _f:$t=tf;break;case Af:$t=ff;break;case"scroll":case"scrollend":$t=Xc;break;case"wheel":$t=nh;break;case"copy":case"cut":case"paste":$t=Qd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$t=Ul;break;case"toggle":case"beforetoggle":$t=rh}var Qn=(i&4)!==0,Br=!Qn&&(n==="scroll"||n==="scrollend"),Rt=Qn?Zt!==null?Zt+"Capture":null:Zt;Qn=[];for(var ht=Ut,kt;ht!==null;){var on=ht;if(kt=on.stateNode,on=on.tag,on!==5&&on!==26&&on!==27||kt===null||Rt===null||(on=hs(ht,Rt),on!=null&&Qn.push(Dc(ht,on,kt))),Br)break;ht=ht.return}0<Qn.length&&(Zt=new $t(Zt,Bn,null,c,Qt),dn.push({event:Zt,listeners:Qn}))}}if((i&7)===0){e:{if(Zt=n==="mouseover"||n==="pointerover",$t=n==="mouseout"||n==="pointerout",Zt&&c!==fs&&(Bn=c.relatedTarget||c.fromElement)&&(Yt(Bn)||Bn[bn]))break e;if(($t||Zt)&&(Zt=Qt.window===Qt?Qt:(Zt=Qt.ownerDocument)?Zt.defaultView||Zt.parentWindow:window,$t?(Bn=c.relatedTarget||c.toElement,$t=Ut,Bn=Bn?Yt(Bn):null,Bn!==null&&(Br=l(Bn),Qn=Bn.tag,Bn!==Br||Qn!==5&&Qn!==27&&Qn!==6)&&(Bn=null)):($t=null,Bn=Ut),$t!==Bn)){if(Qn=Qc,on="onMouseLeave",Rt="onMouseEnter",ht="mouse",(n==="pointerout"||n==="pointerover")&&(Qn=Ul,on="onPointerLeave",Rt="onPointerEnter",ht="pointer"),Br=$t==null?Zt:Mn($t),kt=Bn==null?Zt:Mn(Bn),Zt=new Qn(on,ht+"leave",$t,c,Qt),Zt.target=Br,Zt.relatedTarget=kt,on=null,Yt(Qt)===Ut&&(Qn=new Qn(Rt,ht+"enter",Bn,c,Qt),Qn.target=kt,Qn.relatedTarget=Br,on=Qn),Br=on,$t&&Bn)t:{for(Qn=X0,Rt=$t,ht=Bn,kt=0,on=Rt;on;on=Qn(on))kt++;on=0;for(var Wn=ht;Wn;Wn=Qn(Wn))on++;for(;0<kt-on;)Rt=Qn(Rt),kt--;for(;0<on-kt;)ht=Qn(ht),on--;for(;kt--;){if(Rt===ht||ht!==null&&Rt===ht.alternate){Qn=Rt;break t}Rt=Qn(Rt),ht=Qn(ht)}Qn=null}else Qn=null;$t!==null&&Fp(dn,Zt,$t,Qn,!1),Bn!==null&&Br!==null&&Fp(dn,Br,Bn,Qn,!0)}}e:{if(Zt=Ut?Mn(Ut):window,$t=Zt.nodeName&&Zt.nodeName.toLowerCase(),$t==="select"||$t==="input"&&Zt.type==="file")var Ar=To;else if(Hu(Zt))if(Vu)Ar=oh;else{Ar=sh;var Yn=qu}else $t=Zt.nodeName,!$t||$t.toLowerCase()!=="input"||Zt.type!=="checkbox"&&Zt.type!=="radio"?Ut&&Bi(Ut.elementType)&&(Ar=To):Ar=Yl;if(Ar&&(Ar=Ar(n,Ut))){vf(dn,Ar,c,Qt);break e}Yn&&Yn(n,Zt,Ut),n==="focusout"&&Ut&&Zt.type==="number"&&Ut.memoizedProps.value!=null&&pr(Zt,"number",Zt.value)}switch(Yn=Ut?Mn(Ut):window,n){case"focusin":(Hu(Yn)||Yn.contentEditable==="true")&&(Ya=Yn,ql=Ut,pl=null);break;case"focusout":pl=ql=Ya=null;break;case"mousedown":yl=!0;break;case"contextmenu":case"mouseup":case"dragend":yl=!1,Kl(dn,c,Qt);break;case"selectionchange":if(lh)break;case"keydown":case"keyup":Kl(dn,c,Qt)}var ir;if(Bu)e:{switch(n){case"compositionstart":var vr="onCompositionStart";break e;case"compositionend":vr="onCompositionEnd";break e;case"compositionupdate":vr="onCompositionUpdate";break e}vr=void 0}else ys?pf(n,c)&&(vr="onCompositionEnd"):n==="keydown"&&c.keyCode===229&&(vr="onCompositionStart");vr&&(Gu&&c.locale!=="ko"&&(ys||vr!=="onCompositionStart"?vr==="onCompositionEnd"&&ys&&(ir=ms()):(Zi=Qt,sl="value"in Zi?Zi.value:Zi.textContent,ys=!0)),Yn=Jf(Ut,vr),0<Yn.length&&(vr=new af(vr,n,null,c,Qt),dn.push({event:vr,listeners:Yn}),ir?vr.data=ir:(ir=Gl(c),ir!==null&&(vr.data=ir)))),(ir=ih?ah(n,c):Zl(n,c))&&(vr=Jf(Ut,"onBeforeInput"),0<vr.length&&(Yn=new af("onBeforeInput","beforeinput",null,c,Qt),dn.push({event:Yn,listeners:vr}),Yn.data=ir)),K0(dn,n,Ut,c,Qt)}Pp(dn,i)})}function Dc(n,i,c){return{instance:n,listener:i,currentTarget:c}}function Jf(n,i){for(var c=i+"Capture",v=[];n!==null;){var L=n,M=L.stateNode;if(L=L.tag,L!==5&&L!==26&&L!==27||M===null||(L=hs(n,c),L!=null&&v.unshift(Dc(n,L,M)),L=hs(n,i),L!=null&&v.push(Dc(n,L,M))),n.tag===3)return v;n=n.return}return[]}function X0(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Fp(n,i,c,v,L){for(var M=i._reactName,ce=[];c!==null&&c!==v;){var ke=c,rt=ke.alternate,Ut=ke.stateNode;if(ke=ke.tag,rt!==null&&rt===v)break;ke!==5&&ke!==26&&ke!==27||Ut===null||(rt=Ut,L?(Ut=hs(c,M),Ut!=null&&ce.unshift(Dc(c,Ut,rt))):L||(Ut=hs(c,M),Ut!=null&&ce.push(Dc(c,Ut,rt)))),c=c.return}ce.length!==0&&n.push({event:i,listeners:ce})}var Q0=/\r\n?/g,J0=/\u0000|\uFFFD/g;function Up(n){return(typeof n=="string"?n:""+n).replace(Q0,`
`).replace(J0,"")}function Bp(n,i){return i=Up(i),Up(n)===i}function Ur(n,i,c,v,L,M){switch(c){case"children":typeof v=="string"?i==="body"||i==="textarea"&&v===""||xr(n,v):(typeof v=="number"||typeof v=="bigint")&&i!=="body"&&xr(n,""+v);break;case"className":Pi(n,"class",v);break;case"tabIndex":Pi(n,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":Pi(n,c,v);break;case"style":Ei(n,v,M);break;case"data":if(i!=="object"){Pi(n,"data",v);break}case"src":case"href":if(v===""&&(i!=="a"||c!=="href")){n.removeAttribute(c);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){n.removeAttribute(c);break}v=ca(""+v),n.setAttribute(c,v);break;case"action":case"formAction":if(typeof v=="function"){n.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof M=="function"&&(c==="formAction"?(i!=="input"&&Ur(n,i,"name",L.name,L,null),Ur(n,i,"formEncType",L.formEncType,L,null),Ur(n,i,"formMethod",L.formMethod,L,null),Ur(n,i,"formTarget",L.formTarget,L,null)):(Ur(n,i,"encType",L.encType,L,null),Ur(n,i,"method",L.method,L,null),Ur(n,i,"target",L.target,L,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){n.removeAttribute(c);break}v=ca(""+v),n.setAttribute(c,v);break;case"onClick":v!=null&&(n.onclick=Gi);break;case"onScroll":v!=null&&hr("scroll",n);break;case"onScrollEnd":v!=null&&hr("scrollend",n);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(r(61));if(c=v.__html,c!=null){if(L.children!=null)throw Error(r(60));n.innerHTML=c}}break;case"multiple":n.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":n.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){n.removeAttribute("xlink:href");break}c=ca(""+v),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?n.setAttribute(c,""+v):n.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?n.setAttribute(c,""):n.removeAttribute(c);break;case"capture":case"download":v===!0?n.setAttribute(c,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?n.setAttribute(c,v):n.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?n.setAttribute(c,v):n.removeAttribute(c);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?n.removeAttribute(c):n.setAttribute(c,v);break;case"popover":hr("beforetoggle",n),hr("toggle",n),Di(n,"popover",v);break;case"xlinkActuate":zr(n,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":zr(n,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":zr(n,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":zr(n,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":zr(n,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":zr(n,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":zr(n,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":zr(n,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":zr(n,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":Di(n,"is",v);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=$i.get(c)||c,Di(n,c,v))}}function zh(n,i,c,v,L,M){switch(c){case"style":Ei(n,v,M);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(r(61));if(c=v.__html,c!=null){if(L.children!=null)throw Error(r(60));n.innerHTML=c}}break;case"children":typeof v=="string"?xr(n,v):(typeof v=="number"||typeof v=="bigint")&&xr(n,""+v);break;case"onScroll":v!=null&&hr("scroll",n);break;case"onScrollEnd":v!=null&&hr("scrollend",n);break;case"onClick":v!=null&&(n.onclick=Gi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ci.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(L=c.endsWith("Capture"),i=c.slice(2,L?c.length-7:void 0),M=n[Pt]||null,M=M!=null?M[c]:null,typeof M=="function"&&n.removeEventListener(i,M,L),typeof v=="function")){typeof M!="function"&&M!==null&&(c in n?n[c]=null:n.hasAttribute(c)&&n.removeAttribute(c)),n.addEventListener(i,v,L);break e}c in n?n[c]=v:v===!0?n.setAttribute(c,""):Di(n,c,v)}}}function Ni(n,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":hr("error",n),hr("load",n);var v=!1,L=!1,M;for(M in c)if(c.hasOwnProperty(M)){var ce=c[M];if(ce!=null)switch(M){case"src":v=!0;break;case"srcSet":L=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:Ur(n,i,M,ce,c,null)}}L&&Ur(n,i,"srcSet",c.srcSet,c,null),v&&Ur(n,i,"src",c.src,c,null);return;case"input":hr("invalid",n);var ke=M=ce=L=null,rt=null,Ut=null;for(v in c)if(c.hasOwnProperty(v)){var Qt=c[v];if(Qt!=null)switch(v){case"name":L=Qt;break;case"type":ce=Qt;break;case"checked":rt=Qt;break;case"defaultChecked":Ut=Qt;break;case"value":M=Qt;break;case"defaultValue":ke=Qt;break;case"children":case"dangerouslySetInnerHTML":if(Qt!=null)throw Error(r(137,i));break;default:Ur(n,i,v,Qt,c,null)}}kr(n,M,ke,rt,Ut,ce,L,!1);return;case"select":hr("invalid",n),v=ce=M=null;for(L in c)if(c.hasOwnProperty(L)&&(ke=c[L],ke!=null))switch(L){case"value":M=ke;break;case"defaultValue":ce=ke;break;case"multiple":v=ke;default:Ur(n,i,L,ke,c,null)}i=M,c=ce,n.multiple=!!v,i!=null?Fr(n,!!v,i,!1):c!=null&&Fr(n,!!v,c,!0);return;case"textarea":hr("invalid",n),M=L=v=null;for(ce in c)if(c.hasOwnProperty(ce)&&(ke=c[ce],ke!=null))switch(ce){case"value":v=ke;break;case"defaultValue":L=ke;break;case"children":M=ke;break;case"dangerouslySetInnerHTML":if(ke!=null)throw Error(r(91));break;default:Ur(n,i,ce,ke,c,null)}ki(n,v,L,M);return;case"option":for(rt in c)if(c.hasOwnProperty(rt)&&(v=c[rt],v!=null))switch(rt){case"selected":n.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:Ur(n,i,rt,v,c,null)}return;case"dialog":hr("beforetoggle",n),hr("toggle",n),hr("cancel",n),hr("close",n);break;case"iframe":case"object":hr("load",n);break;case"video":case"audio":for(v=0;v<Cc.length;v++)hr(Cc[v],n);break;case"image":hr("error",n),hr("load",n);break;case"details":hr("toggle",n);break;case"embed":case"source":case"link":hr("error",n),hr("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ut in c)if(c.hasOwnProperty(Ut)&&(v=c[Ut],v!=null))switch(Ut){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:Ur(n,i,Ut,v,c,null)}return;default:if(Bi(i)){for(Qt in c)c.hasOwnProperty(Qt)&&(v=c[Qt],v!==void 0&&zh(n,i,Qt,v,c,void 0));return}}for(ke in c)c.hasOwnProperty(ke)&&(v=c[ke],v!=null&&Ur(n,i,ke,v,c,null))}function eT(n,i,c,v){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var L=null,M=null,ce=null,ke=null,rt=null,Ut=null,Qt=null;for($t in c){var dn=c[$t];if(c.hasOwnProperty($t)&&dn!=null)switch($t){case"checked":break;case"value":break;case"defaultValue":rt=dn;default:v.hasOwnProperty($t)||Ur(n,i,$t,null,v,dn)}}for(var Zt in v){var $t=v[Zt];if(dn=c[Zt],v.hasOwnProperty(Zt)&&($t!=null||dn!=null))switch(Zt){case"type":M=$t;break;case"name":L=$t;break;case"checked":Ut=$t;break;case"defaultChecked":Qt=$t;break;case"value":ce=$t;break;case"defaultValue":ke=$t;break;case"children":case"dangerouslySetInnerHTML":if($t!=null)throw Error(r(137,i));break;default:$t!==dn&&Ur(n,i,Zt,$t,v,dn)}}Xn(n,ce,ke,rt,Ut,Qt,M,L);return;case"select":$t=ce=ke=Zt=null;for(M in c)if(rt=c[M],c.hasOwnProperty(M)&&rt!=null)switch(M){case"value":break;case"multiple":$t=rt;default:v.hasOwnProperty(M)||Ur(n,i,M,null,v,rt)}for(L in v)if(M=v[L],rt=c[L],v.hasOwnProperty(L)&&(M!=null||rt!=null))switch(L){case"value":Zt=M;break;case"defaultValue":ke=M;break;case"multiple":ce=M;default:M!==rt&&Ur(n,i,L,M,v,rt)}i=ke,c=ce,v=$t,Zt!=null?Fr(n,!!c,Zt,!1):!!v!=!!c&&(i!=null?Fr(n,!!c,i,!0):Fr(n,!!c,c?[]:"",!1));return;case"textarea":$t=Zt=null;for(ke in c)if(L=c[ke],c.hasOwnProperty(ke)&&L!=null&&!v.hasOwnProperty(ke))switch(ke){case"value":break;case"children":break;default:Ur(n,i,ke,null,v,L)}for(ce in v)if(L=v[ce],M=c[ce],v.hasOwnProperty(ce)&&(L!=null||M!=null))switch(ce){case"value":Zt=L;break;case"defaultValue":$t=L;break;case"children":break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(r(91));break;default:L!==M&&Ur(n,i,ce,L,v,M)}_r(n,Zt,$t);return;case"option":for(var Bn in c)if(Zt=c[Bn],c.hasOwnProperty(Bn)&&Zt!=null&&!v.hasOwnProperty(Bn))switch(Bn){case"selected":n.selected=!1;break;default:Ur(n,i,Bn,null,v,Zt)}for(rt in v)if(Zt=v[rt],$t=c[rt],v.hasOwnProperty(rt)&&Zt!==$t&&(Zt!=null||$t!=null))switch(rt){case"selected":n.selected=Zt&&typeof Zt!="function"&&typeof Zt!="symbol";break;default:Ur(n,i,rt,Zt,v,$t)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qn in c)Zt=c[Qn],c.hasOwnProperty(Qn)&&Zt!=null&&!v.hasOwnProperty(Qn)&&Ur(n,i,Qn,null,v,Zt);for(Ut in v)if(Zt=v[Ut],$t=c[Ut],v.hasOwnProperty(Ut)&&Zt!==$t&&(Zt!=null||$t!=null))switch(Ut){case"children":case"dangerouslySetInnerHTML":if(Zt!=null)throw Error(r(137,i));break;default:Ur(n,i,Ut,Zt,v,$t)}return;default:if(Bi(i)){for(var Br in c)Zt=c[Br],c.hasOwnProperty(Br)&&Zt!==void 0&&!v.hasOwnProperty(Br)&&zh(n,i,Br,void 0,v,Zt);for(Qt in v)Zt=v[Qt],$t=c[Qt],!v.hasOwnProperty(Qt)||Zt===$t||Zt===void 0&&$t===void 0||zh(n,i,Qt,Zt,v,$t);return}}for(var Rt in c)Zt=c[Rt],c.hasOwnProperty(Rt)&&Zt!=null&&!v.hasOwnProperty(Rt)&&Ur(n,i,Rt,null,v,Zt);for(dn in v)Zt=v[dn],$t=c[dn],!v.hasOwnProperty(dn)||Zt===$t||Zt==null&&$t==null||Ur(n,i,dn,Zt,v,$t)}function Gp(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tT(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,c=performance.getEntriesByType("resource"),v=0;v<c.length;v++){var L=c[v],M=L.transferSize,ce=L.initiatorType,ke=L.duration;if(M&&ke&&Gp(ce)){for(ce=0,ke=L.responseEnd,v+=1;v<c.length;v++){var rt=c[v],Ut=rt.startTime;if(Ut>ke)break;var Qt=rt.transferSize,dn=rt.initiatorType;Qt&&Gp(dn)&&(rt=rt.responseEnd,ce+=Qt*(rt<ke?1:(ke-Ut)/(rt-Ut)))}if(--v,i+=8*(M+ce)/(L.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var $h=null,Wh=null;function ed(n){return n.nodeType===9?n:n.ownerDocument}function Zp(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Hp(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Xh(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Qh=null;function nT(){var n=window.event;return n&&n.type==="popstate"?n===Qh?!1:(Qh=n,!0):(Qh=null,!1)}var Vp=typeof setTimeout=="function"?setTimeout:void 0,rT=typeof clearTimeout=="function"?clearTimeout:void 0,Yp=typeof Promise=="function"?Promise:void 0,iT=typeof queueMicrotask=="function"?queueMicrotask:typeof Yp<"u"?function(n){return Yp.resolve(null).then(n).catch(aT)}:Vp;function aT(n){setTimeout(function(){throw n})}function Yo(n){return n==="head"}function jp(n,i){var c=i,v=0;do{var L=c.nextSibling;if(n.removeChild(c),L&&L.nodeType===8)if(c=L.data,c==="/$"||c==="/&"){if(v===0){n.removeChild(L),bu(i);return}v--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")v++;else if(c==="html")Lc(n.ownerDocument.documentElement);else if(c==="head"){c=n.ownerDocument.head,Lc(c);for(var M=c.firstChild;M;){var ce=M.nextSibling,ke=M.nodeName;M[xn]||ke==="SCRIPT"||ke==="STYLE"||ke==="LINK"&&M.rel.toLowerCase()==="stylesheet"||c.removeChild(M),M=ce}}else c==="body"&&Lc(n.ownerDocument.body);c=L}while(c);bu(i)}function qp(n,i){var c=n;n=0;do{var v=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),v&&v.nodeType===8)if(c=v.data,c==="/$"){if(n===0)break;n--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||n++;c=v}while(c)}function Jh(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Jh(c),Ht(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}n.removeChild(c)}}function sT(n,i,c,v){for(;n.nodeType===1;){var L=c;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!v&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(v){if(!n[xn])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(M=n.getAttribute("rel"),M==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(M!==L.rel||n.getAttribute("href")!==(L.href==null||L.href===""?null:L.href)||n.getAttribute("crossorigin")!==(L.crossOrigin==null?null:L.crossOrigin)||n.getAttribute("title")!==(L.title==null?null:L.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(M=n.getAttribute("src"),(M!==(L.src==null?null:L.src)||n.getAttribute("type")!==(L.type==null?null:L.type)||n.getAttribute("crossorigin")!==(L.crossOrigin==null?null:L.crossOrigin))&&M&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var M=L.name==null?null:""+L.name;if(L.type==="hidden"&&n.getAttribute("name")===M)return n}else return n;if(n=ka(n.nextSibling),n===null)break}return null}function oT(n,i,c){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!c||(n=ka(n.nextSibling),n===null))return null;return n}function Kp(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=ka(n.nextSibling),n===null))return null;return n}function eg(n){return n.data==="$?"||n.data==="$~"}function tg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function lT(n,i){var c=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||c.readyState!=="loading")i();else{var v=function(){i(),c.removeEventListener("DOMContentLoaded",v)};c.addEventListener("DOMContentLoaded",v),n._reactRetry=v}}function ka(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var ng=null;function zp(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var c=n.data;if(c==="/$"||c==="/&"){if(i===0)return ka(n.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}n=n.nextSibling}return null}function $p(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var c=n.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return n;i--}else c!=="/$"&&c!=="/&"||i++}n=n.previousSibling}return null}function Wp(n,i,c){switch(i=ed(c),n){case"html":if(n=i.documentElement,!n)throw Error(r(452));return n;case"head":if(n=i.head,!n)throw Error(r(453));return n;case"body":if(n=i.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Lc(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Ht(n)}var Fa=new Map,Xp=new Set;function td(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var uo=X.d;X.d={f:uT,r:cT,D:fT,C:dT,L:hT,m:gT,X:pT,S:mT,M:yT};function uT(){var n=uo.f(),i=qf();return n||i}function cT(n){var i=hn(n);i!==null&&i.tag===5&&i.type==="form"?bt(i):uo.r(n)}var Su=typeof document>"u"?null:document;function Qp(n,i,c){var v=Su;if(v&&typeof i=="string"&&i){var L=Cn(i);L='link[rel="'+n+'"][href="'+L+'"]',typeof c=="string"&&(L+='[crossorigin="'+c+'"]'),Xp.has(L)||(Xp.add(L),n={rel:n,crossOrigin:c,href:i},v.querySelector(L)===null&&(i=v.createElement("link"),Ni(i,"link",n),$n(i),v.head.appendChild(i)))}}function fT(n){uo.D(n),Qp("dns-prefetch",n,null)}function dT(n,i){uo.C(n,i),Qp("preconnect",n,i)}function hT(n,i,c){uo.L(n,i,c);var v=Su;if(v&&n&&i){var L='link[rel="preload"][as="'+Cn(i)+'"]';i==="image"&&c&&c.imageSrcSet?(L+='[imagesrcset="'+Cn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(L+='[imagesizes="'+Cn(c.imageSizes)+'"]')):L+='[href="'+Cn(n)+'"]';var M=L;switch(i){case"style":M=_u(n);break;case"script":M=Au(n)}Fa.has(M)||(n=u({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:n,as:i},c),Fa.set(M,n),v.querySelector(L)!==null||i==="style"&&v.querySelector(xc(M))||i==="script"&&v.querySelector(Nc(M))||(i=v.createElement("link"),Ni(i,"link",n),$n(i),v.head.appendChild(i)))}}function gT(n,i){uo.m(n,i);var c=Su;if(c&&n){var v=i&&typeof i.as=="string"?i.as:"script",L='link[rel="modulepreload"][as="'+Cn(v)+'"][href="'+Cn(n)+'"]',M=L;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":M=Au(n)}if(!Fa.has(M)&&(n=u({rel:"modulepreload",href:n},i),Fa.set(M,n),c.querySelector(L)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Nc(M)))return}v=c.createElement("link"),Ni(v,"link",n),$n(v),c.head.appendChild(v)}}}function mT(n,i,c){uo.S(n,i,c);var v=Su;if(v&&n){var L=kn(v).hoistableStyles,M=_u(n);i=i||"default";var ce=L.get(M);if(!ce){var ke={loading:0,preload:null};if(ce=v.querySelector(xc(M)))ke.loading=5;else{n=u({rel:"stylesheet",href:n,"data-precedence":i},c),(c=Fa.get(M))&&rg(n,c);var rt=ce=v.createElement("link");$n(rt),Ni(rt,"link",n),rt._p=new Promise(function(Ut,Qt){rt.onload=Ut,rt.onerror=Qt}),rt.addEventListener("load",function(){ke.loading|=1}),rt.addEventListener("error",function(){ke.loading|=2}),ke.loading|=4,nd(ce,i,v)}ce={type:"stylesheet",instance:ce,count:1,state:ke},L.set(M,ce)}}}function pT(n,i){uo.X(n,i);var c=Su;if(c&&n){var v=kn(c).hoistableScripts,L=Au(n),M=v.get(L);M||(M=c.querySelector(Nc(L)),M||(n=u({src:n,async:!0},i),(i=Fa.get(L))&&ig(n,i),M=c.createElement("script"),$n(M),Ni(M,"link",n),c.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},v.set(L,M))}}function yT(n,i){uo.M(n,i);var c=Su;if(c&&n){var v=kn(c).hoistableScripts,L=Au(n),M=v.get(L);M||(M=c.querySelector(Nc(L)),M||(n=u({src:n,async:!0,type:"module"},i),(i=Fa.get(L))&&ig(n,i),M=c.createElement("script"),$n(M),Ni(M,"link",n),c.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},v.set(L,M))}}function Jp(n,i,c,v){var L=(L=Ge.current)?td(L):null;if(!L)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=_u(c.href),c=kn(L).hoistableStyles,v=c.get(i),v||(v={type:"style",instance:null,count:0,state:null},c.set(i,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){n=_u(c.href);var M=kn(L).hoistableStyles,ce=M.get(n);if(ce||(L=L.ownerDocument||L,ce={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},M.set(n,ce),(M=L.querySelector(xc(n)))&&!M._p&&(ce.instance=M,ce.state.loading=5),Fa.has(n)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Fa.set(n,c),M||vT(L,n,c,ce.state))),i&&v===null)throw Error(r(528,""));return ce}if(i&&v!==null)throw Error(r(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Au(c),c=kn(L).hoistableScripts,v=c.get(i),v||(v={type:"script",instance:null,count:0,state:null},c.set(i,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function _u(n){return'href="'+Cn(n)+'"'}function xc(n){return'link[rel="stylesheet"]['+n+"]"}function ey(n){return u({},n,{"data-precedence":n.precedence,precedence:null})}function vT(n,i,c,v){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?v.loading=1:(i=n.createElement("link"),v.preload=i,i.addEventListener("load",function(){return v.loading|=1}),i.addEventListener("error",function(){return v.loading|=2}),Ni(i,"link",c),$n(i),n.head.appendChild(i))}function Au(n){return'[src="'+Cn(n)+'"]'}function Nc(n){return"script[async]"+n}function ty(n,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var v=n.querySelector('style[data-href~="'+Cn(c.href)+'"]');if(v)return i.instance=v,$n(v),v;var L=u({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return v=(n.ownerDocument||n).createElement("style"),$n(v),Ni(v,"style",L),nd(v,c.precedence,n),i.instance=v;case"stylesheet":L=_u(c.href);var M=n.querySelector(xc(L));if(M)return i.state.loading|=4,i.instance=M,$n(M),M;v=ey(c),(L=Fa.get(L))&&rg(v,L),M=(n.ownerDocument||n).createElement("link"),$n(M);var ce=M;return ce._p=new Promise(function(ke,rt){ce.onload=ke,ce.onerror=rt}),Ni(M,"link",v),i.state.loading|=4,nd(M,c.precedence,n),i.instance=M;case"script":return M=Au(c.src),(L=n.querySelector(Nc(M)))?(i.instance=L,$n(L),L):(v=c,(L=Fa.get(M))&&(v=u({},c),ig(v,L)),n=n.ownerDocument||n,L=n.createElement("script"),$n(L),Ni(L,"link",v),n.head.appendChild(L),i.instance=L);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(v=i.instance,i.state.loading|=4,nd(v,c.precedence,n));return i.instance}function nd(n,i,c){for(var v=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),L=v.length?v[v.length-1]:null,M=L,ce=0;ce<v.length;ce++){var ke=v[ce];if(ke.dataset.precedence===i)M=ke;else if(M!==L)break}M?M.parentNode.insertBefore(n,M.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(n,i.firstChild))}function rg(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function ig(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var rd=null;function ny(n,i,c){if(rd===null){var v=new Map,L=rd=new Map;L.set(c,v)}else L=rd,v=L.get(c),v||(v=new Map,L.set(c,v));if(v.has(n))return v;for(v.set(n,null),c=c.getElementsByTagName(n),L=0;L<c.length;L++){var M=c[L];if(!(M[xn]||M[Jt]||n==="link"&&M.getAttribute("rel")==="stylesheet")&&M.namespaceURI!=="http://www.w3.org/2000/svg"){var ce=M.getAttribute(i)||"";ce=n+ce;var ke=v.get(ce);ke?ke.push(M):v.set(ce,[M])}}return v}function ry(n,i,c){n=n.ownerDocument||n,n.head.insertBefore(c,i==="title"?n.querySelector("head > title"):null)}function ET(n,i,c){if(c===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return n=i.disabled,typeof i.precedence=="string"&&n==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function iy(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function TT(n,i,c,v){if(c.type==="stylesheet"&&(typeof v.media!="string"||matchMedia(v.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var L=_u(v.href),M=i.querySelector(xc(L));if(M){i=M._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=id.bind(n),i.then(n,n)),c.state.loading|=4,c.instance=M,$n(M);return}M=i.ownerDocument||i,v=ey(v),(L=Fa.get(L))&&rg(v,L),M=M.createElement("link"),$n(M);var ce=M;ce._p=new Promise(function(ke,rt){ce.onload=ke,ce.onerror=rt}),Ni(M,"link",v),c.instance=M}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(n.count++,c=id.bind(n),i.addEventListener("load",c),i.addEventListener("error",c))}}var ag=0;function ST(n,i){return n.stylesheets&&n.count===0&&sd(n,n.stylesheets),0<n.count||0<n.imgCount?function(c){var v=setTimeout(function(){if(n.stylesheets&&sd(n,n.stylesheets),n.unsuspend){var M=n.unsuspend;n.unsuspend=null,M()}},6e4+i);0<n.imgBytes&&ag===0&&(ag=62500*tT());var L=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&sd(n,n.stylesheets),n.unsuspend)){var M=n.unsuspend;n.unsuspend=null,M()}},(n.imgBytes>ag?50:800)+i);return n.unsuspend=c,function(){n.unsuspend=null,clearTimeout(v),clearTimeout(L)}}:null}function id(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)sd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var ad=null;function sd(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,ad=new Map,i.forEach(_T,n),ad=null,id.call(n))}function _T(n,i){if(!(i.state.loading&4)){var c=ad.get(n);if(c)var v=c.get(null);else{c=new Map,ad.set(n,c);for(var L=n.querySelectorAll("link[data-precedence],style[data-precedence]"),M=0;M<L.length;M++){var ce=L[M];(ce.nodeName==="LINK"||ce.getAttribute("media")!=="not all")&&(c.set(ce.dataset.precedence,ce),v=ce)}v&&c.set(null,v)}L=i.instance,ce=L.getAttribute("data-precedence"),M=c.get(ce)||v,M===v&&c.set(null,L),c.set(ce,L),this.count++,v=id.bind(this),L.addEventListener("load",v),L.addEventListener("error",v),M?M.parentNode.insertBefore(L,M.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(L,n.firstChild)),i.state.loading|=4}}var wc={$$typeof:A,Provider:null,Consumer:null,_currentValue:Ie,_currentValue2:Ie,_threadCount:0};function AT(n,i,c,v,L,M,ce,ke,rt){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qt(0),this.hiddenUpdates=qt(null),this.identifierPrefix=v,this.onUncaughtError=L,this.onCaughtError=M,this.onRecoverableError=ce,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=rt,this.incompleteTransitions=new Map}function ay(n,i,c,v,L,M,ce,ke,rt,Ut,Qt,dn){return n=new AT(n,i,c,ce,rt,Ut,Qt,dn,ke),i=1,M===!0&&(i|=24),M=Vi(3,null,null,i),n.current=M,M.stateNode=n,i=lc(),i.refCount++,n.pooledCache=i,i.refCount++,M.memoizedState={element:v,isDehydrated:c,cache:i},lu(M),n}function sy(n){return n?(n=Io,n):Io}function oy(n,i,c,v,L,M){L=sy(L),v.context===null?v.context=L:v.pendingContext=L,v=Xa(i),v.payload={element:c},M=M===void 0?null:M,M!==null&&(v.callback=M),c=Rs(n,v,i),c!==null&&(sa(c,n,i),Qs(c,n,i))}function ly(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var c=n.retryLane;n.retryLane=c!==0&&c<i?c:i}}function sg(n,i){ly(n,i),(n=n.alternate)&&ly(n,i)}function uy(n){if(n.tag===13||n.tag===31){var i=Da(n,67108864);i!==null&&sa(i,n,67108864),sg(n,67108864)}}function cy(n){if(n.tag===13||n.tag===31){var i=Ea();i=It(i);var c=Da(n,i);c!==null&&sa(c,n,i),sg(n,i)}}var od=!0;function bT(n,i,c,v){var L=me.T;me.T=null;var M=X.p;try{X.p=2,og(n,i,c,v)}finally{X.p=M,me.T=L}}function RT(n,i,c,v){var L=me.T;me.T=null;var M=X.p;try{X.p=8,og(n,i,c,v)}finally{X.p=M,me.T=L}}function og(n,i,c,v){if(od){var L=lg(v);if(L===null)Kh(n,i,v,ld,c),dy(n,v);else if(CT(L,n,i,c,v))v.stopPropagation();else if(dy(n,v),i&4&&-1<IT.indexOf(n)){for(;L!==null;){var M=hn(L);if(M!==null)switch(M.tag){case 3:if(M=M.stateNode,M.current.memoizedState.isDehydrated){var ce=ui(M.pendingLanes);if(ce!==0){var ke=M;for(ke.pendingLanes|=2,ke.entangledLanes|=2;ce;){var rt=1<<31-er(ce);ke.entanglements[1]|=rt,ce&=~rt}Ls(M),(Dr&6)===0&&(Yf=Ye()+500,Ic(0))}}break;case 31:case 13:ke=Da(M,2),ke!==null&&sa(ke,M,2),qf(),sg(M,2)}if(M=lg(v),M===null&&Kh(n,i,v,ld,c),M===L)break;L=M}L!==null&&v.stopPropagation()}else Kh(n,i,v,null,c)}}function lg(n){return n=ds(n),ug(n)}var ld=null;function ug(n){if(ld=null,n=Yt(n),n!==null){var i=l(n);if(i===null)n=null;else{var c=i.tag;if(c===13){if(n=f(i),n!==null)return n;n=null}else if(c===31){if(n=y(i),n!==null)return n;n=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return ld=n,null}function fy(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nt()){case mt:return 2;case Gt:return 8;case _t:case gn:return 32;case Wt:return 268435456;default:return 32}default:return 32}}var cg=!1,jo=null,qo=null,Ko=null,Oc=new Map,Mc=new Map,zo=[],IT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dy(n,i){switch(n){case"focusin":case"focusout":jo=null;break;case"dragenter":case"dragleave":qo=null;break;case"mouseover":case"mouseout":Ko=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mc.delete(i.pointerId)}}function Pc(n,i,c,v,L,M){return n===null||n.nativeEvent!==M?(n={blockedOn:i,domEventName:c,eventSystemFlags:v,nativeEvent:M,targetContainers:[L]},i!==null&&(i=hn(i),i!==null&&uy(i)),n):(n.eventSystemFlags|=v,i=n.targetContainers,L!==null&&i.indexOf(L)===-1&&i.push(L),n)}function CT(n,i,c,v,L){switch(i){case"focusin":return jo=Pc(jo,n,i,c,v,L),!0;case"dragenter":return qo=Pc(qo,n,i,c,v,L),!0;case"mouseover":return Ko=Pc(Ko,n,i,c,v,L),!0;case"pointerover":var M=L.pointerId;return Oc.set(M,Pc(Oc.get(M)||null,n,i,c,v,L)),!0;case"gotpointercapture":return M=L.pointerId,Mc.set(M,Pc(Mc.get(M)||null,n,i,c,v,L)),!0}return!1}function hy(n){var i=Yt(n.target);if(i!==null){var c=l(i);if(c!==null){if(i=c.tag,i===13){if(i=f(c),i!==null){n.blockedOn=i,Rn(n.priority,function(){cy(c)});return}}else if(i===31){if(i=y(c),i!==null){n.blockedOn=i,Rn(n.priority,function(){cy(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){n.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ud(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var c=lg(n.nativeEvent);if(c===null){c=n.nativeEvent;var v=new c.constructor(c.type,c);fs=v,c.target.dispatchEvent(v),fs=null}else return i=hn(c),i!==null&&uy(i),n.blockedOn=c,!1;i.shift()}return!0}function gy(n,i,c){ud(n)&&c.delete(i)}function DT(){cg=!1,jo!==null&&ud(jo)&&(jo=null),qo!==null&&ud(qo)&&(qo=null),Ko!==null&&ud(Ko)&&(Ko=null),Oc.forEach(gy),Mc.forEach(gy)}function cd(n,i){n.blockedOn===i&&(n.blockedOn=null,cg||(cg=!0,h.unstable_scheduleCallback(h.unstable_NormalPriority,DT)))}var fd=null;function my(n){fd!==n&&(fd=n,h.unstable_scheduleCallback(h.unstable_NormalPriority,function(){fd===n&&(fd=null);for(var i=0;i<n.length;i+=3){var c=n[i],v=n[i+1],L=n[i+2];if(typeof v!="function"){if(ug(v||c)===null)continue;break}var M=hn(c);M!==null&&(n.splice(i,3),i-=3,ot(M,{pending:!0,data:L,method:c.method,action:v},v,L))}}))}function bu(n){function i(rt){return cd(rt,n)}jo!==null&&cd(jo,n),qo!==null&&cd(qo,n),Ko!==null&&cd(Ko,n),Oc.forEach(i),Mc.forEach(i);for(var c=0;c<zo.length;c++){var v=zo[c];v.blockedOn===n&&(v.blockedOn=null)}for(;0<zo.length&&(c=zo[0],c.blockedOn===null);)hy(c),c.blockedOn===null&&zo.shift();if(c=(n.ownerDocument||n).$$reactFormReplay,c!=null)for(v=0;v<c.length;v+=3){var L=c[v],M=c[v+1],ce=L[Pt]||null;if(typeof M=="function")ce||my(c);else if(ce){var ke=null;if(M&&M.hasAttribute("formAction")){if(L=M,ce=M[Pt]||null)ke=ce.formAction;else if(ug(L)!==null)continue}else ke=ce.action;typeof ke=="function"?c[v+1]=ke:(c.splice(v,3),v-=3),my(c)}}}function py(){function n(M){M.canIntercept&&M.info==="react-transition"&&M.intercept({handler:function(){return new Promise(function(ce){return L=ce})},focusReset:"manual",scroll:"manual"})}function i(){L!==null&&(L(),L=null),v||setTimeout(c,20)}function c(){if(!v&&!navigation.transition){var M=navigation.currentEntry;M&&M.url!=null&&navigation.navigate(M.url,{state:M.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var v=!1,L=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){v=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),L!==null&&(L(),L=null)}}}function fg(n){this._internalRoot=n}dd.prototype.render=fg.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));var c=i.current,v=Ea();oy(c,v,n,i,null,null)},dd.prototype.unmount=fg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;oy(n.current,2,null,n,null,null),qf(),i[bn]=null}};function dd(n){this._internalRoot=n}dd.prototype.unstable_scheduleHydration=function(n){if(n){var i=fn();n={blockedOn:null,target:n,priority:i};for(var c=0;c<zo.length&&i!==0&&i<zo[c].priority;c++);zo.splice(c,0,n),c===0&&hy(n)}};var yy=e.version;if(yy!=="19.2.4")throw Error(r(527,yy,"19.2.4"));X.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=p(i),n=n!==null?m(n):null,n=n===null?null:n.stateNode,n};var LT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:me,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hd.isDisabled&&hd.supportsFiber)try{On=hd.inject(LT),zn=hd}catch{}}return Fc.createRoot=function(n,i){if(!o(n))throw Error(r(299));var c=!1,v="",L=ko,M=Rl,ce=Il;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(v=i.identifierPrefix),i.onUncaughtError!==void 0&&(L=i.onUncaughtError),i.onCaughtError!==void 0&&(M=i.onCaughtError),i.onRecoverableError!==void 0&&(ce=i.onRecoverableError)),i=ay(n,1,!1,null,null,c,v,null,L,M,ce,py),n[bn]=i.current,qh(n),new fg(i)},Fc.hydrateRoot=function(n,i,c){if(!o(n))throw Error(r(299));var v=!1,L="",M=ko,ce=Rl,ke=Il,rt=null;return c!=null&&(c.unstable_strictMode===!0&&(v=!0),c.identifierPrefix!==void 0&&(L=c.identifierPrefix),c.onUncaughtError!==void 0&&(M=c.onUncaughtError),c.onCaughtError!==void 0&&(ce=c.onCaughtError),c.onRecoverableError!==void 0&&(ke=c.onRecoverableError),c.formState!==void 0&&(rt=c.formState)),i=ay(n,1,!0,i,c??null,v,L,rt,M,ce,ke,py),i.context=sy(null),c=i.current,v=Ea(),v=It(v),L=Xa(v),L.callback=null,Rs(c,L,v),c=v,i.current.lanes=c,Vt(i,c),Ls(i),n[bn]=i.current,qh(n),new dd(i)},Fc.version="19.2.4",Fc}var Cy;function GT(){if(Cy)return gg.exports;Cy=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(e){console.error(e)}}return h(),gg.exports=BT(),gg.exports}var ZT=GT();const HT=lm(ZT),Nn=Number.isFinite||function(h){return typeof h=="number"&&isFinite(h)},VT=Number.isSafeInteger||function(h){return typeof h=="number"&&Math.abs(h)<=YT},YT=Number.MAX_SAFE_INTEGER||9007199254740991;let jn=(function(h){return h.NETWORK_ERROR="networkError",h.MEDIA_ERROR="mediaError",h.KEY_SYSTEM_ERROR="keySystemError",h.MUX_ERROR="muxError",h.OTHER_ERROR="otherError",h})({}),wt=(function(h){return h.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",h.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",h.KEY_SYSTEM_NO_SESSION="keySystemNoSession",h.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",h.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",h.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",h.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",h.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",h.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",h.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",h.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",h.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",h.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",h.MANIFEST_LOAD_ERROR="manifestLoadError",h.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",h.MANIFEST_PARSING_ERROR="manifestParsingError",h.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",h.LEVEL_EMPTY_ERROR="levelEmptyError",h.LEVEL_LOAD_ERROR="levelLoadError",h.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",h.LEVEL_PARSING_ERROR="levelParsingError",h.LEVEL_SWITCH_ERROR="levelSwitchError",h.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",h.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",h.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",h.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",h.FRAG_LOAD_ERROR="fragLoadError",h.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",h.FRAG_DECRYPT_ERROR="fragDecryptError",h.FRAG_PARSING_ERROR="fragParsingError",h.FRAG_GAP="fragGap",h.REMUX_ALLOC_ERROR="remuxAllocError",h.KEY_LOAD_ERROR="keyLoadError",h.KEY_LOAD_TIMEOUT="keyLoadTimeOut",h.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",h.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",h.BUFFER_APPEND_ERROR="bufferAppendError",h.BUFFER_APPENDING_ERROR="bufferAppendingError",h.BUFFER_STALLED_ERROR="bufferStalledError",h.BUFFER_FULL_ERROR="bufferFullError",h.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",h.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",h.ASSET_LIST_LOAD_ERROR="assetListLoadError",h.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",h.ASSET_LIST_PARSING_ERROR="assetListParsingError",h.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",h.INTERNAL_EXCEPTION="internalException",h.INTERNAL_ABORTED="aborted",h.ATTACH_MEDIA_ERROR="attachMediaError",h.UNKNOWN="unknown",h})({}),pe=(function(h){return h.MEDIA_ATTACHING="hlsMediaAttaching",h.MEDIA_ATTACHED="hlsMediaAttached",h.MEDIA_DETACHING="hlsMediaDetaching",h.MEDIA_DETACHED="hlsMediaDetached",h.MEDIA_ENDED="hlsMediaEnded",h.STALL_RESOLVED="hlsStallResolved",h.BUFFER_RESET="hlsBufferReset",h.BUFFER_CODECS="hlsBufferCodecs",h.BUFFER_CREATED="hlsBufferCreated",h.BUFFER_APPENDING="hlsBufferAppending",h.BUFFER_APPENDED="hlsBufferAppended",h.BUFFER_EOS="hlsBufferEos",h.BUFFERED_TO_END="hlsBufferedToEnd",h.BUFFER_FLUSHING="hlsBufferFlushing",h.BUFFER_FLUSHED="hlsBufferFlushed",h.MANIFEST_LOADING="hlsManifestLoading",h.MANIFEST_LOADED="hlsManifestLoaded",h.MANIFEST_PARSED="hlsManifestParsed",h.LEVEL_SWITCHING="hlsLevelSwitching",h.LEVEL_SWITCHED="hlsLevelSwitched",h.LEVEL_LOADING="hlsLevelLoading",h.LEVEL_LOADED="hlsLevelLoaded",h.LEVEL_UPDATED="hlsLevelUpdated",h.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",h.LEVELS_UPDATED="hlsLevelsUpdated",h.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",h.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",h.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",h.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",h.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",h.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",h.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",h.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",h.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",h.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",h.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",h.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",h.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",h.CUES_PARSED="hlsCuesParsed",h.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",h.INIT_PTS_FOUND="hlsInitPtsFound",h.FRAG_LOADING="hlsFragLoading",h.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",h.FRAG_LOADED="hlsFragLoaded",h.FRAG_DECRYPTED="hlsFragDecrypted",h.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",h.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",h.FRAG_PARSING_METADATA="hlsFragParsingMetadata",h.FRAG_PARSED="hlsFragParsed",h.FRAG_BUFFERED="hlsFragBuffered",h.FRAG_CHANGED="hlsFragChanged",h.FPS_DROP="hlsFpsDrop",h.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",h.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",h.ERROR="hlsError",h.DESTROYING="hlsDestroying",h.KEY_LOADING="hlsKeyLoading",h.KEY_LOADED="hlsKeyLoaded",h.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",h.BACK_BUFFER_REACHED="hlsBackBufferReached",h.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",h.ASSET_LIST_LOADING="hlsAssetListLoading",h.ASSET_LIST_LOADED="hlsAssetListLoaded",h.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",h.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",h.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",h.INTERSTITIAL_STARTED="hlsInterstitialStarted",h.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",h.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",h.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",h.INTERSTITIAL_ENDED="hlsInterstitialEnded",h.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",h.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",h.EVENT_CUE_ENTER="hlsEventCueEnter",h})({});var or={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Pn={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Ru{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class jT{constructor(e,t,r,o=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Ru(e),this.fast_=new Ru(t),this.defaultTTFB_=o,this.ttfb_=new Ru(e)}update(e,t){const{slow_:r,fast_:o,ttfb_:l}=this;r.halfLife!==e&&(this.slow_=new Ru(e,r.getEstimate(),r.getTotalWeight())),o.halfLife!==t&&(this.fast_=new Ru(t,o.getEstimate(),o.getTotalWeight())),l.halfLife!==e&&(this.ttfb_=new Ru(e,l.getEstimate(),l.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,o=e/1e3,l=r/o;this.fast_.sample(o,l),this.slow_.sample(o,l)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function qT(h,e,t){return(e=zT(e))in h?Object.defineProperty(h,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):h[e]=t,h}function Gr(){return Gr=Object.assign?Object.assign.bind():function(h){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(h[r]=t[r])}return h},Gr.apply(null,arguments)}function Dy(h,e){var t=Object.keys(h);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(h);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(h,o).enumerable})),t.push.apply(t,r)}return t}function Or(h){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Dy(Object(t),!0).forEach(function(r){qT(h,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(t)):Dy(Object(t)).forEach(function(r){Object.defineProperty(h,r,Object.getOwnPropertyDescriptor(t,r))})}return h}function KT(h,e){if(typeof h!="object"||!h)return h;var t=h[Symbol.toPrimitive];if(t!==void 0){var r=t.call(h,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(h)}function zT(h){var e=KT(h,"string");return typeof e=="symbol"?e:e+""}class Ba{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${e}]:`;this.trace=Qo,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)}}const Qo=function(){},$T={trace:Qo,debug:Qo,log:Qo,warn:Qo,info:Qo,error:Qo};function Vg(){return Gr({},$T)}function WT(h,e){const t=self.console[h];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${h}] >`):Qo}function Ly(h,e,t){return e[h]?e[h].bind(e):WT(h,t)}const Yg=Vg();function XT(h,e,t){const r=Vg();if(typeof console=="object"&&h===!0||typeof h=="object"){const o=["debug","log","info","warn","error"];o.forEach(l=>{r[l]=Ly(l,h,t)});try{r.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return Vg()}o.forEach(l=>{Yg[l]=Ly(l,h)})}else Gr(Yg,r);return r}const Mr=Yg;function tl(h=!0){return typeof self>"u"?void 0:(h||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function QT(h){return typeof self<"u"&&h===self.ManagedMediaSource}function Wv(h,e){const t=Object.keys(h),r=Object.keys(e),o=t.length,l=r.length;return!o||!l||o===l&&!t.some(f=>r.indexOf(f)===-1)}function ba(h,e=!1){if(typeof TextDecoder<"u"){const p=new TextDecoder("utf-8").decode(h);if(e){const m=p.indexOf("\0");return m!==-1?p.substring(0,m):p}return p.replace(/\0/g,"")}const t=h.length;let r,o,l,f="",y=0;for(;y<t;){if(r=h[y++],r===0&&e)return f;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:f+=String.fromCharCode(r);break;case 12:case 13:o=h[y++],f+=String.fromCharCode((r&31)<<6|o&63);break;case 14:o=h[y++],l=h[y++],f+=String.fromCharCode((r&15)<<12|(o&63)<<6|(l&63)<<0);break}}return f}function Oi(h){let e="";for(let t=0;t<h.length;t++){let r=h[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}function Xv(h){return Uint8Array.from(h.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function JT(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var vg={exports:{}},xy;function eS(){return xy||(xy=1,(function(h,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,l=/(?:\/|^)\.(?=\/)/g,f=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,y={buildAbsoluteURL:function(g,p,m){if(m=m||{},g=g.trim(),p=p.trim(),!p){if(!m.alwaysNormalize)return g;var u=y.parseURL(g);if(!u)throw new Error("Error trying to parse base URL.");return u.path=y.normalizePath(u.path),y.buildURLFromParts(u)}var d=y.parseURL(p);if(!d)throw new Error("Error trying to parse relative URL.");if(d.scheme)return m.alwaysNormalize?(d.path=y.normalizePath(d.path),y.buildURLFromParts(d)):p;var S=y.parseURL(g);if(!S)throw new Error("Error trying to parse base URL.");if(!S.netLoc&&S.path&&S.path[0]!=="/"){var _=o.exec(S.path);S.netLoc=_[1],S.path=_[2]}S.netLoc&&!S.path&&(S.path="/");var E={scheme:S.scheme,netLoc:d.netLoc,path:null,params:d.params,query:d.query,fragment:d.fragment};if(!d.netLoc&&(E.netLoc=S.netLoc,d.path[0]!=="/"))if(!d.path)E.path=S.path,d.params||(E.params=S.params,d.query||(E.query=S.query));else{var b=S.path,I=b.substring(0,b.lastIndexOf("/")+1)+d.path;E.path=y.normalizePath(I)}return E.path===null&&(E.path=m.alwaysNormalize?y.normalizePath(d.path):d.path),y.buildURLFromParts(E)},parseURL:function(g){var p=r.exec(g);return p?{scheme:p[1]||"",netLoc:p[2]||"",path:p[3]||"",params:p[4]||"",query:p[5]||"",fragment:p[6]||""}:null},normalizePath:function(g){for(g=g.split("").reverse().join("").replace(l,"");g.length!==(g=g.replace(f,"")).length;);return g.split("").reverse().join("")},buildURLFromParts:function(g){return g.scheme+g.netLoc+g.path+g.params+g.query+g.fragment}};h.exports=y})()})(vg)),vg.exports}var cm=eS();class fm{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var jr={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Qv{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,nS(this,"stats")}setByteRange(e,t){const r=e.split("@",2);let o;r.length===1?o=(t==null?void 0:t.byteRangeEndOffset)||0:o=parseInt(r[1]),this._byteRange=[o,parseInt(r[0])+o]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[jr.AUDIO]:null,[jr.VIDEO]:null,[jr.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new fm),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=cm.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[jr.AUDIO]=null,e[jr.VIDEO]=null,e[jr.AUDIOVIDEO]=null}}function hi(h){return h.sn!=="initSegment"}class Eg extends Qv{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(Nn(e)&&Nn(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const r=Object.keys(t);if(r.length===1){const o=this._decryptdata=t[r[0]]||null;o&&(this._decryptdata=o.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Nn(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const r=Object.keys(this.levelkeys),o=r.length;if(o>1||o===1&&(t=this.levelkeys[r[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Nn(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return hi(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var r;const o=t[e];o&&!((r=this._decryptdata)!=null&&r.keyId)&&(this._decryptdata=o.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,o,l,f=!1){const{elementaryStreams:y}=this,g=y[e];if(!g){y[e]={startPTS:t,endPTS:r,startDTS:o,endDTS:l,partial:f};return}g.startPTS=Math.min(g.startPTS,t),g.endPTS=Math.max(g.endPTS,r),g.startDTS=Math.min(g.startDTS,o),g.endDTS=Math.max(g.endDTS,l)}}class tS extends Qv{constructor(e,t,r,o,l){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=o;const f=e.enumeratedString("BYTERANGE");f&&this.setByteRange(f,l),l&&(this.fragOffset=l.fragOffset+l.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function Jv(h,e){const t=Object.getPrototypeOf(h);if(t){const r=Object.getOwnPropertyDescriptor(t,e);return r||Jv(t,e)}}function nS(h,e){const t=Jv(h,e);t&&(t.enumerable=!0,Object.defineProperty(h,e,t))}const Ny=Math.pow(2,32)-1,rS=[].push,eE={video:1,audio:2,id3:3,text:4};function _i(h){return String.fromCharCode.apply(null,h)}function tE(h,e){const t=h[e]<<8|h[e+1];return t<0?65536+t:t}function Jn(h,e){const t=nE(h,e);return t<0?4294967296+t:t}function wy(h,e){let t=Jn(h,e);return t*=Math.pow(2,32),t+=Jn(h,e+4),t}function nE(h,e){return h[e]<<24|h[e+1]<<16|h[e+2]<<8|h[e+3]}function iS(h){const e=h.byteLength;for(let t=0;t<e;){const r=Jn(h,t);if(r>8&&h[t+4]===109&&h[t+5]===111&&h[t+6]===111&&h[t+7]===102)return!0;t=r>1?t+r:e}return!1}function sr(h,e){const t=[];if(!e.length)return t;const r=h.byteLength;for(let o=0;o<r;){const l=Jn(h,o),f=_i(h.subarray(o+4,o+8)),y=l>1?o+l:r;if(f===e[0])if(e.length===1)t.push(h.subarray(o+8,y));else{const g=sr(h.subarray(o+8,y),e.slice(1));g.length&&rS.apply(t,g)}o=y}return t}function aS(h){const e=[],t=h[0];let r=8;const o=Jn(h,r);r+=4;let l=0,f=0;t===0?(l=Jn(h,r),f=Jn(h,r+4),r+=8):(l=wy(h,r),f=wy(h,r+8),r+=16),r+=2;let y=h.length+f;const g=tE(h,r);r+=2;for(let p=0;p<g;p++){let m=r;const u=Jn(h,m);m+=4;const d=u&2147483647;if((u&2147483648)>>>31===1)return Mr.warn("SIDX has hierarchical references (not supported)"),null;const _=Jn(h,m);m+=4,e.push({referenceSize:d,subsegmentDuration:_,info:{duration:_/o,start:y,end:y+d-1}}),y+=d,m+=4,r=m}return{earliestPresentationTime:l,timescale:o,version:t,referencesCount:g,references:e}}function rE(h){const e=[],t=sr(h,["moov","trak"]);for(let o=0;o<t.length;o++){const l=t[o],f=sr(l,["tkhd"])[0];if(f){let y=f[0];const g=Jn(f,y===0?12:20),p=sr(l,["mdia","mdhd"])[0];if(p){y=p[0];const m=Jn(p,y===0?12:20),u=sr(l,["mdia","hdlr"])[0];if(u){const d=_i(u.subarray(8,12)),S={soun:jr.AUDIO,vide:jr.VIDEO}[d],_=sr(l,["mdia","minf","stbl","stsd"])[0],E=sS(_);S?(e[g]={timescale:m,type:S,stsd:E},e[S]=Or({timescale:m,id:g},E)):e[g]={timescale:m,type:d,stsd:E}}}}}return sr(h,["moov","mvex","trex"]).forEach(o=>{const l=Jn(o,4),f=e[l];f&&(f.default={duration:Jn(o,12),flags:Jn(o,20)})}),e}function sS(h){const e=h.subarray(8),t=e.subarray(86),r=_i(e.subarray(4,8));let o=r,l;const f=r==="enca"||r==="encv";if(f){const p=sr(e,[r])[0].subarray(r==="enca"?28:78);sr(p,["sinf"]).forEach(u=>{const d=sr(u,["schm"])[0];if(d){const S=_i(d.subarray(4,8));if(S==="cbcs"||S==="cenc"){const _=sr(u,["frma"])[0];_&&(o=_i(_))}}})}const y=o;switch(o){case"avc1":case"avc2":case"avc3":case"avc4":{const g=sr(t,["avcC"])[0];g&&g.length>3&&(o+="."+md(g[1])+md(g[2])+md(g[3]),l=gd(y==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const g=sr(e,[r])[0],p=sr(g.subarray(28),["esds"])[0];if(p&&p.length>7){let m=4;if(p[m++]!==3)break;m=Tg(p,m),m+=2;const u=p[m++];if(u&128&&(m+=2),u&64&&(m+=p[m++]),p[m++]!==4)break;m=Tg(p,m);const d=p[m++];if(d===64)o+="."+md(d);else break;if(m+=12,p[m++]!==5)break;m=Tg(p,m);const S=p[m++];let _=(S&248)>>3;_===31&&(_+=1+((S&7)<<3)+((p[m]&224)>>5)),o+="."+_}break}case"hvc1":case"hev1":{const g=sr(t,["hvcC"])[0];if(g&&g.length>12){const p=g[1],m=["","A","B","C"][p>>6],u=p&31,d=Jn(g,2),S=(p&32)>>5?"H":"L",_=g[12],E=g.subarray(6,12);o+="."+m+u,o+="."+oS(d).toString(16).toUpperCase(),o+="."+S+_;let b="";for(let I=E.length;I--;){const T=E[I];(T||b)&&(b="."+T.toString(16).toUpperCase()+b)}o+=b}l=gd(y=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{o=gd(o,t)||o;break}case"vp09":{const g=sr(t,["vpcC"])[0];if(g&&g.length>6){const p=g[4],m=g[5],u=g[6]>>4&15;o+="."+ws(p)+"."+ws(m)+"."+ws(u)}break}case"av01":{const g=sr(t,["av1C"])[0];if(g&&g.length>2){const p=g[1]>>>5,m=g[1]&31,u=g[2]>>>7?"H":"M",d=(g[2]&64)>>6,S=(g[2]&32)>>5,_=p===2&&d?S?12:10:d?10:8,E=(g[2]&16)>>4,b=(g[2]&8)>>3,I=(g[2]&4)>>2,T=g[2]&3;o+="."+p+"."+ws(m)+u+"."+ws(_)+"."+E+"."+b+I+T+"."+ws(1)+"."+ws(1)+"."+ws(1)+"."+0,l=gd("dav1",t)}break}}return{codec:o,encrypted:f,supplemental:l}}function gd(h,e){const t=sr(e,["dvvC"]),r=t.length?t[0]:sr(e,["dvcC"])[0];if(r){const o=r[2]>>1&127,l=r[2]<<5&32|r[3]>>3&31;return h+"."+ws(o)+"."+ws(l)}}function oS(h){let e=0;for(let t=0;t<32;t++)e|=(h>>t&1)<<31-t;return e>>>0}function Tg(h,e){const t=e+5;for(;h[e++]&128&&e<t;);return e}function md(h){return("0"+h.toString(16).toUpperCase()).slice(-2)}function ws(h){return(h<10?"0":"")+h}function lS(h,e){if(!h||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&iE(h,(r,o)=>{const l=r.subarray(8,24);l.some(f=>f!==0)||(Mr.log(`[eme] Patching keyId in 'enc${o?"a":"v"}>sinf>>tenc' box: ${Oi(l)} -> ${Oi(t)}`),r.set(t,8))})}function uS(h){const e=[];return iE(h,t=>e.push(t.subarray(8,24))),e}function iE(h,e){sr(h,["moov","trak"]).forEach(r=>{const o=sr(r,["mdia","minf","stbl","stsd"])[0];if(!o)return;const l=o.subarray(8);let f=sr(l,["enca"]);const y=f.length>0;y||(f=sr(l,["encv"])),f.forEach(g=>{const p=y?g.subarray(28):g.subarray(78);sr(p,["sinf"]).forEach(u=>{const d=aE(u);d&&e(d,y)})})})}function aE(h){const e=sr(h,["schm"])[0];if(e){const t=_i(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const r=sr(h,["schi","tenc"])[0];if(r)return r}}}function cS(h,e,t){const r={},o=sr(h,["moof","traf"]);for(let l=0;l<o.length;l++){const f=o[l],y=sr(f,["tfhd"])[0],g=Jn(y,4),p=e[g];if(!p)continue;r[g]||(r[g]={start:NaN,duration:0,sampleCount:0,timescale:p.timescale,type:p.type});const m=r[g],u=sr(f,["tfdt"])[0];if(u){const A=u[0];let R=Jn(u,4);A===1&&(R===Ny?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(R*=Ny+1,R+=Jn(u,8))),Nn(R)&&(!Nn(m.start)||R<m.start)&&(m.start=R)}const d=p.default,S=Jn(y,0)|(d==null?void 0:d.flags);let _=(d==null?void 0:d.duration)||0;S&8&&(S&2?_=Jn(y,12):_=Jn(y,8));const E=sr(f,["trun"]);let b=m.start||0,I=0,T=_;for(let A=0;A<E.length;A++){const R=E[A],O=Jn(R,4),H=m.sampleCount;m.sampleCount+=O;const U=R[3]&1,Z=R[3]&4,$=R[2]&1,F=R[2]&2,W=R[2]&4,fe=R[2]&8;let ne=8,de=O;for(U&&(ne+=4),Z&&O&&(!(R[ne+1]&1)&&m.keyFrameIndex===void 0&&(m.keyFrameIndex=H),ne+=4,$?(T=Jn(R,ne),ne+=4):T=_,F&&(ne+=4),fe&&(ne+=4),b+=T,I+=T,de--);de--;)$?(T=Jn(R,ne),ne+=4):T=_,F&&(ne+=4),W&&(R[ne+1]&1||m.keyFrameIndex===void 0&&(m.keyFrameIndex=m.sampleCount-(de+1),m.keyFrameStart=b),ne+=4),fe&&(ne+=4),b+=T,I+=T;!I&&_&&(I+=_*O)}m.duration+=I}if(!Object.keys(r).some(l=>r[l].duration)){let l=1/0,f=0;const y=sr(h,["sidx"]);for(let g=0;g<y.length;g++){const p=aS(y[g]);if(p!=null&&p.references){l=Math.min(l,p.earliestPresentationTime/p.timescale);const m=p.references.reduce((u,d)=>u+d.info.duration||0,0);f=Math.max(f,m+p.earliestPresentationTime/p.timescale)}}f&&Nn(f)&&Object.keys(r).forEach(g=>{r[g].duration||(r[g].duration=f*r[g].timescale-r[g].start)})}return r}function fS(h){const e={valid:null,remainder:null},t=sr(h,["moof"]);if(t.length<2)return e.remainder=h,e;const r=t[t.length-1];return e.valid=h.slice(0,r.byteOffset-8),e.remainder=h.slice(r.byteOffset-8),e}function Ua(h,e){const t=new Uint8Array(h.length+e.length);return t.set(h),t.set(e,h.length),t}function Oy(h,e){const t=[],r=e.samples,o=e.timescale,l=e.id;let f=!1;return sr(r,["moof"]).map(g=>{const p=g.byteOffset-8;sr(g,["traf"]).map(u=>{const d=sr(u,["tfdt"]).map(S=>{const _=S[0];let E=Jn(S,4);return _===1&&(E*=Math.pow(2,32),E+=Jn(S,8)),E/o})[0];return d!==void 0&&(h=d),sr(u,["tfhd"]).map(S=>{const _=Jn(S,4),E=Jn(S,0)&16777215,b=(E&1)!==0,I=(E&2)!==0,T=(E&8)!==0;let A=0;const R=(E&16)!==0;let O=0;const H=(E&32)!==0;let U=8;_===l&&(b&&(U+=8),I&&(U+=4),T&&(A=Jn(S,U),U+=4),R&&(O=Jn(S,U),U+=4),H&&(U+=4),e.type==="video"&&(f=zd(e.codec)),sr(u,["trun"]).map(Z=>{const $=Z[0],F=Jn(Z,0)&16777215,W=(F&1)!==0;let fe=0;const ne=(F&4)!==0,de=(F&256)!==0;let Te=0;const me=(F&512)!==0;let X=0;const Ie=(F&1024)!==0,Be=(F&2048)!==0;let qe=0;const ee=Jn(Z,4);let _e=8;W&&(fe=Jn(Z,_e),_e+=4),ne&&(_e+=4);let Ze=fe+p;for(let Ke=0;Ke<ee;Ke++){if(de?(Te=Jn(Z,_e),_e+=4):Te=A,me?(X=Jn(Z,_e),_e+=4):X=O,Ie&&(_e+=4),Be&&($===0?qe=Jn(Z,_e):qe=nE(Z,_e),_e+=4),e.type===jr.VIDEO){let De=0;for(;De<X;){const Ge=Jn(r,Ze);if(Ze+=4,dS(f,r[Ze])){const Et=r.subarray(Ze,Ze+Ge);dm(Et,f?2:1,h+qe/o,t)}Ze+=Ge,De+=Ge+4}}h+=Te/o}}))})})}),t}function zd(h){if(!h)return!1;const e=h.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function dS(h,e){if(h){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function dm(h,e,t,r){const o=sE(h);let l=0;l+=e;let f=0,y=0,g=0;for(;l<o.length;){f=0;do{if(l>=o.length)break;g=o[l++],f+=g}while(g===255);y=0;do{if(l>=o.length)break;g=o[l++],y+=g}while(g===255);const p=o.length-l;let m=l;if(y<p)l+=y;else if(y>p){Mr.error(`Malformed SEI payload. ${y} is too small, only ${p} bytes left to parse.`);break}if(f===4){if(o[m++]===181){const d=tE(o,m);if(m+=2,d===49){const S=Jn(o,m);if(m+=4,S===1195456820){const _=o[m++];if(_===3){const E=o[m++],b=31&E,I=64&E,T=I?2+b*3:0,A=new Uint8Array(T);if(I){A[0]=E;for(let R=1;R<T;R++)A[R]=o[m++]}r.push({type:_,payloadType:f,pts:t,bytes:A})}}}}}else if(f===5&&y>16){const u=[];for(let _=0;_<16;_++){const E=o[m++].toString(16);u.push(E.length==1?"0"+E:E),(_===3||_===5||_===7||_===9)&&u.push("-")}const d=y-16,S=new Uint8Array(d);for(let _=0;_<d;_++)S[_]=o[m++];r.push({payloadType:f,pts:t,uuid:u.join(""),userData:ba(S),userDataBytes:S})}}}function sE(h){const e=h.byteLength,t=[];let r=1;for(;r<e-2;)h[r]===0&&h[r+1]===0&&h[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return h;const o=e-t.length,l=new Uint8Array(o);let f=0;for(r=0;r<o;f++,r++)f===t[0]&&(f++,t.shift()),l[r]=h[f];return l}function hS(h){const e=h[0];let t="",r="",o=0,l=0,f=0,y=0,g=0,p=0;if(e===0){for(;_i(h.subarray(p,p+1))!=="\0";)t+=_i(h.subarray(p,p+1)),p+=1;for(t+=_i(h.subarray(p,p+1)),p+=1;_i(h.subarray(p,p+1))!=="\0";)r+=_i(h.subarray(p,p+1)),p+=1;r+=_i(h.subarray(p,p+1)),p+=1,o=Jn(h,12),l=Jn(h,16),y=Jn(h,20),g=Jn(h,24),p=28}else if(e===1){p+=4,o=Jn(h,p),p+=4;const u=Jn(h,p);p+=4;const d=Jn(h,p);for(p+=4,f=2**32*u+d,VT(f)||(f=Number.MAX_SAFE_INTEGER,Mr.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),y=Jn(h,p),p+=4,g=Jn(h,p),p+=4;_i(h.subarray(p,p+1))!=="\0";)t+=_i(h.subarray(p,p+1)),p+=1;for(t+=_i(h.subarray(p,p+1)),p+=1;_i(h.subarray(p,p+1))!=="\0";)r+=_i(h.subarray(p,p+1)),p+=1;r+=_i(h.subarray(p,p+1)),p+=1}const m=h.subarray(p,h.byteLength);return{schemeIdUri:t,value:r,timeScale:o,presentationTime:f,presentationTimeDelta:l,eventDuration:y,id:g,payload:m}}function gS(h,...e){const t=e.length;let r=8,o=t;for(;o--;)r+=e[o].byteLength;const l=new Uint8Array(r);for(l[0]=r>>24&255,l[1]=r>>16&255,l[2]=r>>8&255,l[3]=r&255,l.set(h,4),o=0,r=8;o<t;o++)l.set(e[o],r),r+=e[o].byteLength;return l}function mS(h,e,t){if(h.byteLength!==16)throw new RangeError("Invalid system id");let r,o;r=0,o=new Uint8Array;let l;r>0?(l=new Uint8Array(4),e.length>0&&new DataView(l.buffer).setUint32(0,e.length,!1)):l=new Uint8Array;const f=new Uint8Array(4);return t.byteLength>0&&new DataView(f.buffer).setUint32(0,t.byteLength,!1),gS([112,115,115,104],new Uint8Array([r,0,0,0]),h,l,o,f,t)}function pS(h){const e=[];if(h instanceof ArrayBuffer){const t=h.byteLength;let r=0;for(;r+32<t;){const o=new DataView(h,r),l=yS(o);e.push(l),r+=l.size}}return e}function yS(h){const e=h.getUint32(0),t=h.byteOffset,r=h.byteLength;if(r<e)return{offset:t,size:r};if(h.getUint32(4)!==1886614376)return{offset:t,size:e};const l=h.getUint32(8)>>>24;if(l!==0&&l!==1)return{offset:t,size:e};const f=h.buffer,y=Oi(new Uint8Array(f,t+12,16));let g=null,p=null,m=0;if(l===0)m=28;else{const d=h.getUint32(28);if(!d||r<32+d*16)return{offset:t,size:e};g=[];for(let S=0;S<d;S++)g.push(new Uint8Array(f,t+32+S*16,16));m=32+d*16}if(!m)return{offset:t,size:e};const u=h.getUint32(m);return e-32<u?{offset:t,size:e}:(p=new Uint8Array(f,t+m+4,u),{version:l,systemId:y,kids:g,data:p,offset:t,size:e})}const oE=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),ku={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function hm(h,e){const t=ku[e];return!!t&&!!t[h.slice(0,4)]}function Vc(h,e,t=!0){return!h.split(",").some(r=>!gm(r,e,t))}function gm(h,e,t=!0){var r;const o=tl(t);return(r=o==null?void 0:o.isTypeSupported(Yc(h,e)))!=null?r:!1}function Yc(h,e){return`${e}/mp4;codecs=${h}`}function My(h){if(h){const e=h.substring(0,4);return ku.video[e]}return 2}function Fd(h){const e=oE();return h.split(",").reduce((t,r)=>{const l=e&&zd(r)?9:ku.video[r];return l?(l*2+t)/(t?3:2):(ku.audio[r]+t)/(t?2:1)},0)}const Sg={};function vS(h,e=!0){if(Sg[h])return Sg[h];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[h];for(let o=0;o<t.length;o++){var r;if(gm(t[o],"audio",e))return Sg[h]=t[o],t[o];if(t[o]==="mp3"&&(r=tl(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return h}const ES=/flac|opus|mp4a\.40\.34/i;function Ud(h,e=!0){return h.replace(ES,t=>vS(t.toLowerCase(),e))}function TS(h,e){const t=[];if(h){const r=h.split(",");for(let o=0;o<r.length;o++)hm(r[o],"video")||t.push(r[o])}return e&&t.push(e),t.join(",")}function Ld(h,e){if(h&&(h.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(h)!==-1)&&(Py(h,"audio")||Py(h,"video")))return h;if(e){const t=e.split(",");if(t.length>1){if(h){for(let r=t.length;r--;)if(t[r].substring(0,4)===h.substring(0,4))return t[r]}return t[0]}}return e||h}function Py(h,e){return hm(h,e)&&gm(h,e)}function SS(h){const e=h.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");r.length>2&&r[0]==="avc1"&&(e[t]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}function _S(h){if(h.startsWith("av01.")){const e=h.split("."),t=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=t[r-4];return e.join(".")}return h}function ky(h){const e=tl(h)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function jg(h){return h.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const AS={supported:!0,powerEfficient:!0,smooth:!0},bS={supported:!1,smooth:!1,powerEfficient:!1},lE={supported:!0,configurations:[],decodingInfoResults:[AS]};function uE(h,e){return{supported:!1,configurations:e,decodingInfoResults:[bS],error:h}}function RS(h,e,t,r,o,l){const f=h.videoCodec,y=h.audioCodec?h.audioGroups:null,g=l==null?void 0:l.audioCodec,p=l==null?void 0:l.channels,m=p?parseInt(p):g?1/0:2;let u=null;if(y!=null&&y.length)try{y.length===1&&y[0]?u=e.groups[y[0]].channels:u=y.reduce((d,S)=>{if(S){const _=e.groups[S];if(!_)throw new Error(`Audio track group ${S} not found`);Object.keys(_.channels).forEach(E=>{d[E]=(d[E]||0)+_.channels[E]})}return d},{2:0})}catch{return!0}return f!==void 0&&(f.split(",").some(d=>zd(d))||h.width>1920&&h.height>1088||h.height>1920&&h.width>1088||h.frameRate>Math.max(r,30)||h.videoRange!=="SDR"&&h.videoRange!==t||h.bitrate>Math.max(o,8e6))||!!u&&Nn(m)&&Object.keys(u).some(d=>parseInt(d)>m)}function cE(h,e,t,r={}){const o=h.videoCodec;if(!o&&!h.audioCodec||!t)return Promise.resolve(lE);const l=[],f=IS(h),y=f.length,g=CS(h,e,y>0),p=g.length;for(let m=y||1*p||1;m--;){const u={type:"media-source"};if(y&&(u.video=f[m%y]),p){u.audio=g[m%p];const d=u.audio.bitrate;u.video&&d&&(u.video.bitrate-=d)}l.push(u)}if(o){const m=navigator.userAgent;if(o.split(",").some(u=>zd(u))&&oE())return Promise.resolve(uE(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${m})`),l))}return Promise.all(l.map(m=>{const u=LS(m);return r[u]||(r[u]=t.decodingInfo(m))})).then(m=>({supported:!m.some(u=>!u.supported),configurations:l,decodingInfoResults:m})).catch(m=>({supported:!1,configurations:l,decodingInfoResults:[],error:m}))}function IS(h){var e;const t=(e=h.videoCodec)==null?void 0:e.split(","),r=fE(h),o=h.width||640,l=h.height||480,f=h.frameRate||30,y=h.videoRange.toLowerCase();return t?t.map(g=>{const p={contentType:Yc(_S(g),"video"),width:o,height:l,bitrate:r,framerate:f};return y!=="sdr"&&(p.transferFunction=y),p}):[]}function CS(h,e,t){var r;const o=(r=h.audioCodec)==null?void 0:r.split(","),l=fE(h);return o&&h.audioGroups?h.audioGroups.reduce((f,y)=>{var g;const p=y?(g=e.groups[y])==null?void 0:g.tracks:null;return p?p.reduce((m,u)=>{if(u.groupId===y){const d=parseFloat(u.channels||"");o.forEach(S=>{const _={contentType:Yc(S,"audio"),bitrate:t?DS(S,l):l};d&&(_.channels=""+d),m.push(_)})}return m},f):f},[]):[]}function DS(h,e){if(e<=1)return 1;let t=128e3;return h==="ec-3"?t=768e3:h==="ac-3"&&(t=64e4),Math.min(e/2,t)}function fE(h){return Math.ceil(Math.max(h.bitrate*.9,h.averageBitrate)/1e3)*1e3||1}function LS(h){let e="";const{audio:t,video:r}=h;if(r){const o=jg(r.contentType);e+=`${o}_r${r.height}x${r.width}f${Math.ceil(r.framerate)}${r.transferFunction||"sd"}_${Math.ceil(r.bitrate/1e5)}`}if(t){const o=jg(t.contentType);e+=`${r?"_":""}${o}_c${t.channels}`}return e}const qg=["NONE","TYPE-0","TYPE-1",null];function xS(h){return qg.indexOf(h)>-1}const Bd=["SDR","PQ","HLG"];function NS(h){return!!h&&Bd.indexOf(h)>-1}var xd={No:"",Yes:"YES",v2:"v2"};function Fy(h){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=h,o=r<e/2;return e&&o?t?xd.v2:xd.Yes:xd.No}class Uy{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class jc{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return By(this._audioGroups,e)}hasSubtitleGroup(e){return By(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function By(h,e){return!e||!h?!1:h.indexOf(e)!==-1}function wS(){if(typeof matchMedia=="function"){const h=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(h.media!==e.media)return h.matches===!0}return!1}function OS(h,e){let t=!1,r=[];if(h&&(t=h!=="SDR",r=[h]),e){r=e.allowedVideoRanges||Bd.slice(0);const o=r.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:o&&wS(),t||(r=["SDR"])}return{preferHDR:t,allowedVideoRanges:r}}const MS=h=>{const e=new WeakSet;return(t,r)=>{if(h&&(r=h(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},qr=(h,e)=>JSON.stringify(h,MS(e));function PS(h,e,t,r,o){const l=Object.keys(h),f=r==null?void 0:r.channels,y=r==null?void 0:r.audioCodec,g=o==null?void 0:o.videoCodec,p=f&&parseInt(f)===2;let m=!1,u=!1,d=1/0,S=1/0,_=1/0,E=1/0,b=0,I=[];const{preferHDR:T,allowedVideoRanges:A}=OS(e,o);for(let Z=l.length;Z--;){const $=h[l[Z]];m||(m=$.channels[2]>0),d=Math.min(d,$.minHeight),S=Math.min(S,$.minFramerate),_=Math.min(_,$.minBitrate),A.filter(W=>$.videoRanges[W]>0).length>0&&(u=!0)}d=Nn(d)?d:0,S=Nn(S)?S:0;const R=Math.max(1080,d),O=Math.max(30,S);_=Nn(_)?_:t,t=Math.max(_,t),u||(e=void 0);const H=l.length>1;return{codecSet:l.reduce((Z,$)=>{const F=h[$];if($===Z)return Z;if(I=u?A.filter(W=>F.videoRanges[W]>0):[],H){if(F.minBitrate>t)return xs($,`min bitrate of ${F.minBitrate} > current estimate of ${t}`),Z;if(!F.hasDefaultAudio)return xs($,"no renditions with default or auto-select sound found"),Z;if(y&&$.indexOf(y.substring(0,4))%5!==0)return xs($,`audio codec preference "${y}" not found`),Z;if(f&&!p){if(!F.channels[f])return xs($,`no renditions with ${f} channel sound found (channels options: ${Object.keys(F.channels)})`),Z}else if((!y||p)&&m&&F.channels[2]===0)return xs($,"no renditions with stereo sound found"),Z;if(F.minHeight>R)return xs($,`min resolution of ${F.minHeight} > maximum of ${R}`),Z;if(F.minFramerate>O)return xs($,`min framerate of ${F.minFramerate} > maximum of ${O}`),Z;if(!I.some(W=>F.videoRanges[W]>0))return xs($,`no variants with VIDEO-RANGE of ${qr(I)} found`),Z;if(g&&$.indexOf(g.substring(0,4))%5!==0)return xs($,`video codec preference "${g}" not found`),Z;if(F.maxScore<b)return xs($,`max score of ${F.maxScore} < selected max of ${b}`),Z}return Z&&(Fd($)>=Fd(Z)||F.fragmentError>h[Z].fragmentError)?Z:(E=F.minIndex,b=F.maxScore,$)},void 0),videoRanges:I,preferHDR:T,minFramerate:S,minBitrate:_,minIndex:E}}function xs(h,e){Mr.log(`[abr] start candidates with "${h}" ignored because ${e}`)}function dE(h){return h.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const o=t.channels||"2";return r.channels[o]=(r.channels[o]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function kS(h,e,t,r){return h.slice(t,r+1).reduce((o,l,f)=>{if(!l.codecSet)return o;const y=l.audioGroups;let g=o[l.codecSet];g||(o[l.codecSet]=g={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:f,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!y,fragmentError:0}),g.minBitrate=Math.min(g.minBitrate,l.bitrate);const p=Math.min(l.height,l.width);return g.minHeight=Math.min(g.minHeight,p),g.minFramerate=Math.min(g.minFramerate,l.frameRate),g.minIndex=Math.min(g.minIndex,f),g.maxScore=Math.max(g.maxScore,l.score),g.fragmentError+=l.fragmentError,g.videoRanges[l.videoRange]=(g.videoRanges[l.videoRange]||0)+1,y&&y.forEach(m=>{if(!m)return;const u=e.groups[m];u&&(g.hasDefaultAudio=g.hasDefaultAudio||e.hasDefaultAudio?u.hasDefault:u.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(u.channels).forEach(d=>{g.channels[d]=(g.channels[d]||0)+u.channels[d]}))}),o},{})}function Gy(h){if(!h)return h;const{lang:e,assocLang:t,characteristics:r,channels:o,audioCodec:l}=h;return{lang:e,assocLang:t,characteristics:r,channels:o,audioCodec:l}}function Ms(h,e,t){if("attrs"in h){const r=e.indexOf(h);if(r!==-1)return r}for(let r=0;r<e.length;r++){const o=e[r];if(Ol(h,o,t))return r}return-1}function Ol(h,e,t){const{groupId:r,name:o,lang:l,assocLang:f,default:y}=h,g=h.forced;return(r===void 0||e.groupId===r)&&(o===void 0||e.name===o)&&(l===void 0||FS(l,e.lang))&&(l===void 0||e.assocLang===f)&&(y===void 0||e.default===y)&&(g===void 0||e.forced===g)&&(!("characteristics"in h)||US(h.characteristics||"",e.characteristics))&&(t===void 0||t(h,e))}function FS(h,e="--"){return h.length===e.length?h===e:h.startsWith(e)||e.startsWith(h)}function US(h,e=""){const t=h.split(","),r=e.split(",");return t.length===r.length&&!t.some(o=>r.indexOf(o)===-1)}function wl(h,e){const{audioCodec:t,channels:r}=h;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function BS(h,e,t,r,o){const l=e[r],y=e.reduce((d,S,_)=>{const E=S.uri;return(d[E]||(d[E]=[])).push(_),d},{})[l.uri];y.length>1&&(r=Math.max.apply(Math,y));const g=l.videoRange,p=l.frameRate,m=l.codecSet.substring(0,4),u=Zy(e,r,d=>{if(d.videoRange!==g||d.frameRate!==p||d.codecSet.substring(0,4)!==m)return!1;const S=d.audioGroups,_=t.filter(E=>!S||S.indexOf(E.groupId)!==-1);return Ms(h,_,o)>-1});return u>-1?u:Zy(e,r,d=>{const S=d.audioGroups,_=t.filter(E=>!S||S.indexOf(E.groupId)!==-1);return Ms(h,_,o)>-1})}function Zy(h,e,t){for(let r=e;r>-1;r--)if(t(h[r]))return r;for(let r=e+1;r<h.length;r++)if(t(h[r]))return r;return-1}function Gd(h,e){var t;return!!h&&h!==((t=e.loadLevelObj)==null?void 0:t.uri)}class GS extends Ba{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;const{fragCurrent:o,partCurrent:l,hls:f}=this,{autoLevelEnabled:y,media:g}=f;if(!o||!g)return;const p=performance.now(),m=l?l.stats:o.stats,u=l?l.duration:o.duration,d=p-m.loading.start,S=f.minAutoLevel,_=o.level,E=this._nextAutoLevel;if(m.aborted||m.loaded&&m.loaded===m.total||_<=S){this.clearTimer(),this._nextAutoLevel=-1;return}if(!y)return;const b=E>-1&&E!==_,I=!!t||b;if(!I&&(g.paused||!g.playbackRate||!g.readyState))return;const T=f.mainForwardBufferInfo;if(!I&&T===null)return;const A=this.bwEstimator.getEstimateTTFB(),R=Math.abs(g.playbackRate);if(d<=Math.max(A,1e3*(u/(R*2))))return;const O=T?T.len/R:0,H=m.loading.first?m.loading.first-m.loading.start:-1,U=m.loaded&&H>-1,Z=this.getBwEstimate(),$=f.levels,F=$[_],W=Math.max(m.loaded,Math.round(u*(o.bitrate||F.averageBitrate)/8));let fe=U?d-H:d;fe<1&&U&&(fe=Math.min(d,m.loaded*8/Z));const ne=U?m.loaded*1e3/fe:0,de=A/1e3,Te=ne?(W-m.loaded)/ne:W*8/Z+de;if(Te<=O)return;const me=ne?ne*8:Z,X=((r=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,Ie=this.hls.config.abrBandWidthUpFactor;let Be=Number.POSITIVE_INFINITY,qe;for(qe=_-1;qe>S;qe--){const Ke=$[qe].maxBitrate,De=!$[qe].details||X;if(Be=this.getTimeToLoadFrag(de,me,u*Ke,De),Be<Math.min(O,u+de))break}if(Be>=Te||Be>u*10)return;U?this.bwEstimator.sample(d-Math.min(A,H),m.loaded):this.bwEstimator.sampleTTFB(d);const ee=$[qe].maxBitrate;this.getBwEstimate()*Ie>ee&&this.resetEstimator(ee);const _e=this.findBestLevel(ee,S,qe,0,O,1,1);_e>-1&&(qe=_e),this.warn(`Fragment ${o.sn}${l?" part "+l.index:""} of level ${_} is loading too slowly;
      Fragment duration: ${o.duration.toFixed(3)}
      Time to underbuffer: ${O.toFixed(3)} s
      Estimated load time for current fragment: ${Te.toFixed(3)} s
      Estimated load time for down switch fragment: ${Be.toFixed(3)} s
      TTFB estimate: ${H|0} ms
      Current BW estimate: ${Nn(Z)?Z|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${qe} @ ${ee|0} bps`),f.nextLoadLevel=f.nextAutoLevel=qe,this.clearTimer();const Ze=()=>{if(this.clearTimer(),this.fragCurrent===o&&this.hls.loadLevel===qe&&qe>0){const Ke=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${qe>0?"and switching down":""}
      Fragment duration: ${o.duration.toFixed(3)} s
      Time to underbuffer: ${Ke.toFixed(3)} s`),o.abortRequests(),this.fragCurrent=this.partCurrent=null,qe>S){let De=this.findBestLevel(this.hls.levels[S].bitrate,S,qe,0,Ke,1,1);De===-1&&(De=S),this.hls.nextLoadLevel=this.hls.nextAutoLevel=De,this.resetEstimator(this.hls.levels[De].bitrate)}}};b||Te>Be*2?Ze():this.timer=self.setInterval(Ze,Be*1e3),f.trigger(pe.FRAG_LOAD_EMERGENCY_ABORTED,{frag:o,part:l,stats:m})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new jT(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.FRAG_LOADING,this.onFragLoading,this),e.on(pe.FRAG_LOADED,this.onFragLoaded,this),e.on(pe.FRAG_BUFFERED,this.onFragBuffered,this),e.on(pe.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.on(pe.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(pe.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(pe.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.FRAG_LOADING,this.onFragLoading,this),e.off(pe.FRAG_LOADED,this.onFragLoaded,this),e.off(pe.FRAG_BUFFERED,this.onFragBuffered,this),e.off(pe.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.off(pe.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(pe.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(pe.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var o;this.fragCurrent=r,this.partCurrent=(o=t.part)!=null?o:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case wt.BUFFER_ADD_CODEC_ERROR:case wt.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case wt.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:o,partCurrent:l}=this;if(r&&o&&r.sn===o.sn&&r.level===o.level){const f=performance.now(),y=l?l.stats:r.stats,g=f-y.loading.start,p=y.loading.first?y.loading.first-y.loading.start:-1;if(y.loaded&&p>-1){const u=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(g-Math.min(u,p),y.loaded)}else this.bwEstimator.sampleTTFB(g)}break}}}getTimeToLoadFrag(e,t,r,o){const l=e+r/t,f=o?e+this.lastLevelLoadSec:0;return l+f}onLevelLoaded(e,t){const r=this.hls.config,{loading:o}=t.stats,l=o.end-o.first;Nn(l)&&(this.lastLevelLoadSec=l/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){const o=r?r.stats:t.stats;if(t.type===Pn.MAIN&&this.bwEstimator.sampleTTFB(o.loading.first-o.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const l=r?r.duration:t.duration,f=this.hls.levels[t.level],y=(f.loaded?f.loaded.bytes:0)+o.loaded,g=(f.loaded?f.loaded.duration:0)+l;f.loaded={bytes:y,duration:g},f.realBitrate=Math.round(8*y/g)}if(t.bitrateTest){const l={stats:o,frag:t,part:r,id:t.type};this.onFragBuffered(pe.FRAG_BUFFERED,l),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:o}=t,l=o!=null&&o.stats.loaded?o.stats:r.stats;if(l.aborted||this.ignoreFragment(r))return;const f=l.parsing.end-l.loading.start-Math.min(l.loading.first-l.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(f,l.loaded),l.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=f/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Pn.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),o=this.hls.config.maxStarvationDelay,l=this.findBestLevel(r,t,e,0,o,1,1);if(l>-1)return l;const f=this.hls.firstLevel,y=Math.min(Math.max(f,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${f} clamped to ${y}`),y}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),o=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!o||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const l=r&&o?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const f=this.hls.levels;if(f.length>Math.max(e,l)&&f[e].loadError<=f[l].loadError)return e}return this._nextAutoLevel=l,this.nextAutoLevelKey=this.getAutoLevelKey(),l}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:o,config:l,minAutoLevel:f}=r,y=t?t.duration:e?e.duration:0,g=this.getBwEstimate(),p=this.getStarvationDelay();let m=l.abrBandWidthFactor,u=l.abrBandWidthUpFactor;if(p){const b=this.findBestLevel(g,f,o,p,0,m,u);if(b>=0)return this.rebufferNotice=-1,b}let d=y?Math.min(y,l.maxStarvationDelay):l.maxStarvationDelay;if(!p){const b=this.bitrateTestDelay;b&&(d=(y?Math.min(y,l.maxLoadingDelay):l.maxLoadingDelay)-b,this.info(`bitrate test took ${Math.round(1e3*b)}ms, set first fragment max fetchDuration to ${Math.round(1e3*d)} ms`),m=u=1)}const S=this.findBestLevel(g,f,o,p,d,m,u);if(this.rebufferNotice!==S&&(this.rebufferNotice=S,this.info(`${p?"rebuffering expected":"buffer is empty"}, optimal quality level ${S}`)),S>-1)return S;const _=r.levels[f],E=r.loadLevelObj;return E&&(_==null?void 0:_.bitrate)<E.bitrate?f:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,o=e.mainForwardBufferInfo;return(o?o.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,o,l,f,y){var g;const p=o+l,m=this.lastLoadedFragLevel,u=m===-1?this.hls.firstLevel:m,{fragCurrent:d,partCurrent:S}=this,{levels:_,allAudioTracks:E,loadLevel:b,config:I}=this.hls;if(_.length===1)return 0;const T=_[u],A=!!((g=this.hls.latestLevelDetails)!=null&&g.live),R=b===-1||m===-1;let O,H="SDR",U=(T==null?void 0:T.frameRate)||0;const{audioPreference:Z,videoPreference:$}=I,F=this.audioTracksByGroup||(this.audioTracksByGroup=dE(E));let W=-1;if(R){if(this.firstSelection!==-1)return this.firstSelection;const me=this.codecTiers||(this.codecTiers=kS(_,F,t,r)),X=PS(me,H,e,Z,$),{codecSet:Ie,videoRanges:Be,minFramerate:qe,minBitrate:ee,minIndex:_e,preferHDR:Ze}=X;W=_e,O=Ie,H=Ze?Be[Be.length-1]:Be[0],U=qe,e=Math.max(e,ee),this.log(`picked start tier ${qr(X)}`)}else O=T==null?void 0:T.codecSet,H=T==null?void 0:T.videoRange;const fe=S?S.duration:d?d.duration:0,ne=this.bwEstimator.getEstimateTTFB()/1e3,de=[];for(let me=r;me>=t;me--){var Te;const X=_[me],Ie=me>u;if(!X)continue;if(I.useMediaCapabilities&&!X.supportedResult&&!X.supportedPromise){const De=navigator.mediaCapabilities;typeof(De==null?void 0:De.decodingInfo)=="function"&&RS(X,F,H,U,e,Z)?(X.supportedPromise=cE(X,F,De,this.supportedCache),X.supportedPromise.then(Ge=>{if(!this.hls)return;X.supportedResult=Ge;const Et=this.hls.levels,vt=Et.indexOf(X);Ge.error?this.warn(`MediaCapabilities decodingInfo error: "${Ge.error}" for level ${vt} ${qr(Ge)}`):Ge.supported?Ge.decodingInfoResults.some(et=>et.smooth===!1||et.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${vt} not smooth or powerEfficient: ${qr(Ge)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${vt} ${qr(Ge)}`),vt>-1&&Et.length>1&&(this.log(`Removing unsupported level ${vt}`),this.hls.removeLevel(vt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(Ge=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${Ge}`)})):X.supportedResult=lE}if((O&&X.codecSet!==O||H&&X.videoRange!==H||Ie&&U>X.frameRate||!Ie&&U>0&&U<X.frameRate||(Te=X.supportedResult)!=null&&(Te=Te.decodingInfoResults)!=null&&Te.some(De=>De.smooth===!1))&&(!R||me!==W)){de.push(me);continue}const Be=X.details,qe=(S?Be==null?void 0:Be.partTarget:Be==null?void 0:Be.averagetargetduration)||fe;let ee;Ie?ee=y*e:ee=f*e;const _e=fe&&o>=fe*2&&l===0?X.averageBitrate:X.maxBitrate,Ze=this.getTimeToLoadFrag(ne,ee,_e*qe,Be===void 0);if(ee>=_e&&(me===m||X.loadError===0&&X.fragmentError===0)&&(Ze<=ne||!Nn(Ze)||A&&!this.bitrateTestDelay||Ze<p)){const De=this.forcedAutoLevel;return me!==b&&(De===-1||De!==b)&&(de.length&&this.trace(`Skipped level(s) ${de.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${_[de[0]].codecs}" ${_[de[0]].videoRange}; not compatible with "${O}" ${H}`),this.info(`switch candidate:${u}->${me} adjustedbw(${Math.round(ee)})-bitrate=${Math.round(ee-_e)} ttfb:${ne.toFixed(1)} avgDuration:${qe.toFixed(1)} maxFetchDuration:${p.toFixed(1)} fetchDuration:${Ze.toFixed(1)} firstSelection:${R} codecSet:${X.codecSet} videoRange:${X.videoRange} hls.loadLevel:${b}`)),R&&(this.firstSelection=me),me}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}const hE={search:function(h,e){let t=0,r=h.length-1,o=null,l=null;for(;t<=r;){o=(t+r)/2|0,l=h[o];const f=e(l);if(f>0)t=o+1;else if(f<0)r=o-1;else return l}return null}};function ZS(h,e,t){if(e===null||!Array.isArray(h)||!h.length||!Nn(e))return null;const r=h[0].programDateTime;if(e<(r||0))return null;const o=h[h.length-1].endProgramDateTime;if(e>=(o||0))return null;for(let l=0;l<h.length;++l){const f=h[l];if(VS(e,t,f))return f}return null}function Ml(h,e,t=0,r=0,o=.005){let l=null;if(h){l=e[1+h.sn-e[0].sn]||null;const y=h.endDTS-t;y>0&&y<15e-7&&(t+=15e-7),l&&h.level!==l.level&&l.end<=h.end&&(l=e[2+h.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(l=e[0]);if(l&&((!h||h.level===l.level)&&Hy(t,r,l)===0||HS(l,h,Math.min(o,r))))return l;const f=hE.search(e,Hy.bind(null,t,r));return f&&(f!==h||!l)?f:l}function HS(h,e,t){if(e&&e.start===0&&e.level<h.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((o,l)=>(l[0]==="INF"&&(o+=parseFloat(l[1])),o),t);return h.start<=r}return!1}function Hy(h=0,e=0,t){if(t.start<=h&&t.start+t.duration>h)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=h?1:t.start-r>h&&t.start?-1:0}function VS(h,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>h}function gE(h,e,t){if(h&&h.startCC<=e&&h.endCC>=e){let r=h.fragments;const{fragmentHint:o}=h;o&&(r=r.concat(o));let l;return hE.search(r,f=>f.cc<e?1:f.cc>e?-1:(l=f,f.end<=t?1:f.start>t?-1:0)),l||null}return null}function Zd(h){switch(h.details){case wt.FRAG_LOAD_TIMEOUT:case wt.KEY_LOAD_TIMEOUT:case wt.LEVEL_LOAD_TIMEOUT:case wt.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function mE(h){return h.details.startsWith("key")}function pE(h){return mE(h)&&!!h.frag&&!h.frag.decryptdata}function Vy(h,e){const t=Zd(e);return h.default[`${t?"timeout":"error"}Retry`]}function mm(h,e){const t=h.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*h.retryDelayMs,h.maxRetryDelayMs)}function Yy(h){return Or(Or({},h),{errorRetry:null,timeoutRetry:null})}function Hd(h,e,t,r){if(!h)return!1;const o=r==null?void 0:r.code,l=e<h.maxNumRetry&&(YS(o)||!!t);return h.shouldRetry?h.shouldRetry(h,e,t,r,l):l}function YS(h){return Kg(h)||!!h&&(h<400||h>499)}function Kg(h){return h===0&&navigator.onLine===!1}var wi={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Sa={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class jS extends Ba{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(pe.ERROR,this.onError,this),e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(pe.ERROR,this.onError,this),e.off(pe.ERROR,this.onErrorOut,this),e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Pn.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,r=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||r===-1?t.loadLevel:r}variantHasKey(e,t){if(e){var r;if((r=e.details)!=null&&r.hasKey(t))return!0;const o=e.audioGroups;if(o)return this.hls.allAudioTracks.filter(f=>o.indexOf(f.groupId)>=0).some(f=>{var y;return(y=f.details)==null?void 0:y.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var r;if(t.fatal)return;const o=this.hls,l=t.context;switch(t.details){case wt.FRAG_LOAD_ERROR:case wt.FRAG_LOAD_TIMEOUT:case wt.KEY_LOAD_ERROR:case wt.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case wt.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=wu();return}case wt.FRAG_GAP:case wt.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=wi.SendAlternateToPenaltyBox;return}case wt.LEVEL_EMPTY_ERROR:case wt.LEVEL_PARSING_ERROR:{var f;const g=t.parent===Pn.MAIN?t.level:o.loadLevel;t.details===wt.LEVEL_EMPTY_ERROR&&((f=t.context)!=null&&(f=f.levelDetails)!=null&&f.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,g):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,g))}return;case wt.LEVEL_LOAD_ERROR:case wt.LEVEL_LOAD_TIMEOUT:typeof(l==null?void 0:l.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l.level));return;case wt.AUDIO_TRACK_LOAD_ERROR:case wt.AUDIO_TRACK_LOAD_TIMEOUT:case wt.SUBTITLE_LOAD_ERROR:case wt.SUBTITLE_TRACK_LOAD_TIMEOUT:if(l){const g=o.loadLevelObj;if(g&&(l.type===or.AUDIO_TRACK&&g.hasAudioGroup(l.groupId)||l.type===or.SUBTITLE_TRACK&&g.hasSubtitleGroup(l.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.loadLevel),t.errorAction.action=wi.SendAlternateToPenaltyBox,t.errorAction.flags=Sa.MoveAllAlternatesMatchingHost;return}}return;case wt.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:wi.SendAlternateToPenaltyBox,flags:Sa.MoveAllAlternatesMatchingHDCP};return;case wt.KEY_SYSTEM_SESSION_UPDATE_FAILED:case wt.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case wt.KEY_SYSTEM_NO_SESSION:t.errorAction={action:wi.SendAlternateToPenaltyBox,flags:Sa.MoveAllAlternatesMatchingKey};return;case wt.BUFFER_ADD_CODEC_ERROR:case wt.REMUX_ALLOC_ERROR:case wt.BUFFER_APPEND_ERROR:if(!t.errorAction){var y;t.errorAction=this.getLevelSwitchAction(t,(y=t.level)!=null?y:o.loadLevel)}return;case wt.INTERNAL_EXCEPTION:case wt.BUFFER_APPENDING_ERROR:case wt.BUFFER_FULL_ERROR:case wt.LEVEL_SWITCH_ERROR:case wt.BUFFER_STALLED_ERROR:case wt.BUFFER_SEEK_OVER_HOLE:case wt.BUFFER_NUDGE_ON_STALL:t.errorAction=wu();return}t.type===jn.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=wu())}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,o=Vy(r.config.playlistLoadPolicy,e),l=this.playlistError++;if(Hd(o,l,Zd(e),e.response))return{action:wi.RetryRequest,flags:Sa.None,retryConfig:o,retryCount:l};const y=this.getLevelSwitchAction(e,t);return o&&(y.retryConfig=o,y.retryCount=l),y}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),o=t.levels[r],{fragLoadPolicy:l,keyLoadPolicy:f}=t.config,y=Vy(mE(e)?f:l,e),g=t.levels.reduce((m,u)=>m+u.fragmentError,0);if(o&&(e.details!==wt.FRAG_GAP&&o.fragmentError++,!pE(e)&&Hd(y,g,Zd(e),e.response)))return{action:wi.RetryRequest,flags:Sa.None,retryConfig:y,retryCount:g};const p=this.getLevelSwitchAction(e,r);return y&&(p.retryConfig=y,p.retryCount=g),p}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const o=this.hls.levels[t];if(o){var l,f;const p=e.details;o.loadError++,p===wt.BUFFER_APPEND_ERROR&&o.fragmentError++;let m=-1;const{levels:u,loadLevel:d,minAutoLevel:S,maxAutoLevel:_}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const E=(l=e.frag)==null?void 0:l.type,I=(E===Pn.AUDIO&&p===wt.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(p===wt.BUFFER_ADD_CODEC_ERROR||p===wt.BUFFER_APPEND_ERROR))&&u.some(({audioCodec:H})=>o.audioCodec!==H),A=e.sourceBufferName==="video"&&(p===wt.BUFFER_ADD_CODEC_ERROR||p===wt.BUFFER_APPEND_ERROR)&&u.some(({codecSet:H,audioCodec:U})=>o.codecSet!==H&&o.audioCodec===U),{type:R,groupId:O}=(f=e.context)!=null?f:{};for(let H=u.length;H--;){const U=(H+d)%u.length;if(U!==d&&U>=S&&U<=_&&u[U].loadError===0){var y,g;const Z=u[U];if(p===wt.FRAG_GAP&&E===Pn.MAIN&&e.frag){const $=u[U].details;if($){const F=Ml(e.frag,$.fragments,e.frag.start);if(F!=null&&F.gap)continue}}else{if(R===or.AUDIO_TRACK&&Z.hasAudioGroup(O)||R===or.SUBTITLE_TRACK&&Z.hasSubtitleGroup(O))continue;if(E===Pn.AUDIO&&(y=o.audioGroups)!=null&&y.some($=>Z.hasAudioGroup($))||E===Pn.SUBTITLE&&(g=o.subtitleGroups)!=null&&g.some($=>Z.hasSubtitleGroup($))||I&&o.audioCodec===Z.audioCodec||A&&o.codecSet===Z.codecSet||!I&&o.codecSet!==Z.codecSet)continue}m=U;break}}if(m>-1&&r.loadLevel!==m)return e.levelRetry=!0,this.playlistError=0,{action:wi.SendAlternateToPenaltyBox,flags:Sa.None,nextAutoLevel:m}}return{action:wi.SendAlternateToPenaltyBox,flags:Sa.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case wi.DoNothing:break;case wi.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==wt.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:o}=r,l=r.nextAutoLevel;switch(o){case Sa.None:this.switchLevel(e,l);break;case Sa.MoveAllAlternatesMatchingHDCP:{const g=this.getVariantLevelIndex(e.frag),p=t.levels[g],m=p==null?void 0:p.attrs["HDCP-LEVEL"];if(r.hdcpLevel=m,m==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(m){t.maxHdcpLevel=qg[qg.indexOf(m)-1],r.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case Sa.MoveAllAlternatesMatchingKey:{const g=e.decryptdata;if(g){const p=this.hls.levels,m=p.length;for(let d=m;d--;)if(this.variantHasKey(p[d],g)){var f,y;this.log(`Banned key found in level ${d} (${p[d].bitrate}bps) or audio group "${(f=p[d].audioGroups)==null?void 0:f.join(",")}" (${(y=e.frag)==null?void 0:y.type} fragment) ${Oi(g.keyId||[])}`),p[d].fragmentError++,p[d].loadError++,this.log(`Removing level ${d} with key error (${e.error})`),this.hls.removeLevel(d)}const u=e.frag;if(this.hls.levels.length<m)r.resolved=!0;else if(u&&u.type!==Pn.MAIN){const d=u.decryptdata;d&&!g.matches(d)&&(r.resolved=!0)}}break}}r.resolved||this.switchLevel(e,l)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===wt.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=jg(e.mimeType),o=this.hls.levels;for(let l=o.length;l--;)o[l][`${e.sourceBufferName}Codec`]===r&&(this.log(`Removing level ${l} for ${e.details} ("${r}" not supported)`),this.hls.removeLevel(l))}}}function wu(h){const e={action:wi.DoNothing,flags:Sa.None};return h&&(e.resolved=!0),e}var Ai={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class qS{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.BUFFER_APPENDED,this.onBufferAppended,this),e.on(pe.FRAG_BUFFERED,this.onFragBuffered,this),e.on(pe.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.BUFFER_APPENDED,this.onBufferAppended,this),e.off(pe.FRAG_BUFFERED,this.onFragBuffered,this),e.off(pe.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let o=r.length;o--;){const l=r[o];if(!l)break;if(l.start<=e&&e<=l.end&&l.loaded)return l}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,r){const{fragments:o}=this,l=Object.keys(o);for(let f=l.length;f--;){const y=o[l[f]];if((y==null?void 0:y.body.type)===t&&(!r||y.buffered)){const g=y.body;if(g.start<=e&&e<=g.end)return g}}return null}detectEvictedFragments(e,t,r,o,l){this.timeRanges&&(this.timeRanges[e]=t);const f=(o==null?void 0:o.fragment.sn)||-1;Object.keys(this.fragments).forEach(y=>{const g=this.fragments[y];if(!g||f>=g.body.sn)return;if(!g.buffered&&(!g.loaded||l)){g.body.type===r&&this.removeFragment(g.body);return}const p=g.range[e];if(p){if(p.time.length===0){this.removeFragment(g.body);return}p.time.some(m=>{const u=!this.isTimeBuffered(m.startPTS,m.endPTS,t);return u&&this.removeFragment(g.body),u})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const r=e.frag,o=Iu(r),l=this.fragments[o];if(!l||l.buffered&&r.gap)return;const f=!r.relurl;Object.keys(t).forEach(y=>{const g=r.elementaryStreams[y];if(!g)return;const p=t[y],m=f||g.partial===!0;l.range[y]=this.getBufferedTimes(r,e.part,m,p)}),l.loaded=null,Object.keys(l.range).length?(this.bufferedEnd(l,r),pd(l)||this.removeParts(r.sn-1,r.type)):this.removeFragment(l.body)}bufferedEnd(e,t){e.buffered=!0,(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=jy(r,o=>o.fragment.sn>=e))}fragBuffered(e,t){const r=Iu(e);let o=this.fragments[r];!o&&t&&(o=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),o&&(o.loaded=null,this.bufferedEnd(o,e))}getBufferedTimes(e,t,r,o){const l={time:[],partial:r},f=e.start,y=e.end,g=e.minEndPTS||y,p=e.maxStartPTS||f;for(let m=0;m<o.length;m++){const u=o.start(m)-this.bufferPadding,d=o.end(m)+this.bufferPadding;if(p>=u&&g<=d){l.time.push({startPTS:Math.max(f,o.start(m)),endPTS:Math.min(y,o.end(m))});break}else if(f<d&&y>u){const S=Math.max(f,o.start(m)),_=Math.min(y,o.end(m));_>S&&(l.partial=!0,l.time.push({startPTS:S,endPTS:_}))}else if(y<=u)break}return l}getPartialFragment(e){let t=null,r,o,l,f=0;const{bufferPadding:y,fragments:g}=this;return Object.keys(g).forEach(p=>{const m=g[p];m&&pd(m)&&(o=m.body.start-y,l=m.body.end+y,e>=o&&e<=l&&(r=Math.min(e-o,l-e),f<=r&&(t=m.body,f=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||pd(t))}getState(e){const t=Iu(e),r=this.fragments[t];return r?r.buffered?pd(r)?Ai.PARTIAL:Ai.OK:Ai.APPENDING:Ai.NOT_LOADED}isTimeBuffered(e,t,r){let o,l;for(let f=0;f<r.length;f++){if(o=r.start(f)-this.bufferPadding,l=r.end(f)+this.bufferPadding,e>=o&&t<=l)return!0;if(t<=o)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const r=t.frag,o=t.part?null:t,l=Iu(r);this.fragments[l]={body:r,appendedPTS:null,loaded:o,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:o,timeRanges:l,type:f}=t;if(r.sn==="initSegment")return;const y=r.type;if(o){let p=this.activePartLists[y];p||(this.activePartLists[y]=p=[]),p.push(o)}this.timeRanges=l;const g=l[f];this.detectEvictedFragments(f,g,y,o)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Iu(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,r=Object.keys(t);if(!e)return r.length>0;for(let o=r.length;o--;){const l=t[r[o]];if((l==null?void 0:l.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,o,l){o&&!this.hasGaps||Object.keys(this.fragments).forEach(f=>{const y=this.fragments[f];if(!y)return;const g=y.body;g.type!==r||o&&!g.gap||g.start<t&&g.end>e&&(y.buffered||l)&&this.removeFragment(g)})}removeFragment(e){const t=Iu(e);e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const o=e.sn;this.activePartLists[e.type]=jy(r,l=>l.fragment.sn!==o)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(r=>r.clearElementaryStreamInfo())}}function pd(h){var e,t,r;return h.buffered&&!!(h.body.gap||(e=h.range.video)!=null&&e.partial||(t=h.range.audio)!=null&&t.partial||(r=h.range.audiovideo)!=null&&r.partial)}function Iu(h){return`${h.type}_${h.level}_${h.sn}`}function jy(h,e){return h.filter(t=>{const r=e(t);return r||t.clearElementaryStreamInfo(),r})}var nl={cbc:0,ctr:1};class KS{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case nl.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case nl.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function zS(h){const e=h.byteLength,t=e&&new DataView(h.buffer).getUint8(e-1);return t?h.slice(0,e-t):h}class $S{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let o=0;o<4;o++)r[o]=t.getUint32(o*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,o=r[0],l=r[1],f=r[2],y=r[3],g=this.invSubMix,p=g[0],m=g[1],u=g[2],d=g[3],S=new Uint32Array(256);let _=0,E=0,b=0;for(b=0;b<256;b++)b<128?S[b]=b<<1:S[b]=b<<1^283;for(b=0;b<256;b++){let I=E^E<<1^E<<2^E<<3^E<<4;I=I>>>8^I&255^99,e[_]=I,t[I]=_;const T=S[_],A=S[T],R=S[A];let O=S[I]*257^I*16843008;o[_]=O<<24|O>>>8,l[_]=O<<16|O>>>16,f[_]=O<<8|O>>>24,y[_]=O,O=R*16843009^A*65537^T*257^_*16843008,p[I]=O<<24|O>>>8,m[I]=O<<16|O>>>16,u[I]=O<<8|O>>>24,d[I]=O,_?(_=T^S[S[S[R^T]]],E^=S[S[E]]):_=E=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,o=0;for(;o<t.length&&r;)r=t[o]===this.key[o],o++;if(r)return;this.key=t;const l=this.keySize=t.length;if(l!==4&&l!==6&&l!==8)throw new Error("Invalid aes key size="+l);const f=this.ksRows=(l+6+1)*4;let y,g;const p=this.keySchedule=new Uint32Array(f),m=this.invKeySchedule=new Uint32Array(f),u=this.sBox,d=this.rcon,S=this.invSubMix,_=S[0],E=S[1],b=S[2],I=S[3];let T,A;for(y=0;y<f;y++){if(y<l){T=p[y]=t[y];continue}A=T,y%l===0?(A=A<<8|A>>>24,A=u[A>>>24]<<24|u[A>>>16&255]<<16|u[A>>>8&255]<<8|u[A&255],A^=d[y/l|0]<<24):l>6&&y%l===4&&(A=u[A>>>24]<<24|u[A>>>16&255]<<16|u[A>>>8&255]<<8|u[A&255]),p[y]=T=(p[y-l]^A)>>>0}for(g=0;g<f;g++)y=f-g,g&3?A=p[y]:A=p[y-4],g<4||y<=4?m[g]=A:m[g]=_[u[A>>>24]]^E[u[A>>>16&255]]^b[u[A>>>8&255]]^I[u[A&255]],m[g]=m[g]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const o=this.keySize+6,l=this.invKeySchedule,f=this.invSBox,y=this.invSubMix,g=y[0],p=y[1],m=y[2],u=y[3],d=this.uint8ArrayToUint32Array_(r);let S=d[0],_=d[1],E=d[2],b=d[3];const I=new Int32Array(e),T=new Int32Array(I.length);let A,R,O,H,U,Z,$,F,W,fe,ne,de,Te,me;const X=this.networkToHostOrderSwap;for(;t<I.length;){for(W=X(I[t]),fe=X(I[t+1]),ne=X(I[t+2]),de=X(I[t+3]),U=W^l[0],Z=de^l[1],$=ne^l[2],F=fe^l[3],Te=4,me=1;me<o;me++)A=g[U>>>24]^p[Z>>16&255]^m[$>>8&255]^u[F&255]^l[Te],R=g[Z>>>24]^p[$>>16&255]^m[F>>8&255]^u[U&255]^l[Te+1],O=g[$>>>24]^p[F>>16&255]^m[U>>8&255]^u[Z&255]^l[Te+2],H=g[F>>>24]^p[U>>16&255]^m[Z>>8&255]^u[$&255]^l[Te+3],U=A,Z=R,$=O,F=H,Te=Te+4;A=f[U>>>24]<<24^f[Z>>16&255]<<16^f[$>>8&255]<<8^f[F&255]^l[Te],R=f[Z>>>24]<<24^f[$>>16&255]<<16^f[F>>8&255]<<8^f[U&255]^l[Te+1],O=f[$>>>24]<<24^f[F>>16&255]<<16^f[U>>8&255]<<8^f[Z&255]^l[Te+2],H=f[F>>>24]<<24^f[U>>16&255]<<16^f[Z>>8&255]<<8^f[$&255]^l[Te+3],T[t]=X(A^S),T[t+1]=X(H^_),T[t+2]=X(O^E),T[t+3]=X(R^b),S=W,_=fe,E=ne,b=de,t=t+4}return T.buffer}}class WS{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){const e=XS(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function XS(h){switch(h){case nl.cbc:return"AES-CBC";case nl.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${h}`)}}const QS=16;class pm{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?zS(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,o){return this.useSoftware?new Promise((l,f)=>{const y=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(y,t,r,o);const g=this.flush();g?l(g.buffer):f(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,o)}softwareDecrypt(e,t,r,o){const{currentIV:l,currentResult:f,remainderData:y}=this;if(o!==nl.cbc||t.byteLength!==16)return Mr.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),y&&(e=Ua(y,e),this.remainderData=null);const g=this.getValidChunk(e);if(!g.length)return null;l&&(r=l);let p=this.softwareDecrypter;p||(p=this.softwareDecrypter=new $S),p.expandKey(t);const m=f;return this.currentResult=p.decrypt(g.buffer,0,r),this.currentIV=g.slice(-16).buffer,m||null}webCryptoDecrypt(e,t,r,o){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,o));this.key=t,this.fastAesKey=new WS(this.subtle,t,o)}return this.fastAesKey.expandKey().then(l=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new KS(this.subtle,new Uint8Array(r),o).decrypt(e.buffer,l)):Promise.reject(new Error("web crypto not initialized"))).catch(l=>(Mr.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${l.name}: ${l.message}`),this.onWebCryptoError(e,t,r,o)))}onWebCryptoError(e,t,r,o){const l=this.enableSoftwareAES;if(l){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,o);const f=this.flush();if(f)return f.buffer}throw new Error("WebCrypto"+(l?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%QS;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(Mr.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const qy=Math.pow(2,17);class JS{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new ho({type:jn.NETWORK_ERROR,details:wt.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const o=this.config,l=o.fLoader,f=o.loader;return new Promise((y,g)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(_=>_[0]==="GAP")){g(zy(e));return}else e.gap=!1;const p=this.loader=l?new l(o):new f(o),m=Ky(e);e.loader=p;const u=Yy(o.fragLoadPolicy.default),d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:qy};e.stats=p.stats;const S={onSuccess:(_,E,b,I)=>{this.resetLoader(e,p);let T=_.data;b.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(T.slice(0,16)),T=T.slice(16)),y({frag:e,part:null,payload:T,networkDetails:I})},onError:(_,E,b,I)=>{this.resetLoader(e,p),g(new ho({type:jn.NETWORK_ERROR,details:wt.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Or({url:r,data:void 0},_),error:new Error(`HTTP Error ${_.code} ${_.text}`),networkDetails:b,stats:I}))},onAbort:(_,E,b)=>{this.resetLoader(e,p),g(new ho({type:jn.NETWORK_ERROR,details:wt.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:b,stats:_}))},onTimeout:(_,E,b)=>{this.resetLoader(e,p),g(new ho({type:jn.NETWORK_ERROR,details:wt.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:b,stats:_}))}};t&&(S.onProgress=(_,E,b,I)=>t({frag:e,part:null,payload:b,networkDetails:I})),p.load(m,d,S)})}loadPart(e,t,r){this.abort();const o=this.config,l=o.fLoader,f=o.loader;return new Promise((y,g)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){g(zy(e,t));return}const p=this.loader=l?new l(o):new f(o),m=Ky(e,t);e.loader=p;const u=Yy(o.fragLoadPolicy.default),d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:qy};t.stats=p.stats,p.load(m,d,{onSuccess:(S,_,E,b)=>{this.resetLoader(e,p),this.updateStatsFromPart(e,t);const I={frag:e,part:t,payload:S.data,networkDetails:b};r(I),y(I)},onError:(S,_,E,b)=>{this.resetLoader(e,p),g(new ho({type:jn.NETWORK_ERROR,details:wt.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Or({url:m.url,data:void 0},S),error:new Error(`HTTP Error ${S.code} ${S.text}`),networkDetails:E,stats:b}))},onAbort:(S,_,E)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,p),g(new ho({type:jn.NETWORK_ERROR,details:wt.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:E,stats:S}))},onTimeout:(S,_,E)=>{this.resetLoader(e,p),g(new ho({type:jn.NETWORK_ERROR,details:wt.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:E,stats:S}))}})})}updateStatsFromPart(e,t){const r=e.stats,o=t.stats,l=o.total;if(r.loaded+=o.loaded,l){const g=Math.round(e.duration/t.duration),p=Math.min(Math.round(r.loaded/l),g),u=(g-p)*Math.round(r.loaded/p);r.total=r.loaded+u}else r.total=Math.max(r.loaded,r.total);const f=r.loading,y=o.loading;f.start?f.first+=y.first-y.start:(f.start=y.start,f.first=y.first),f.end=y.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Ky(h,e=null){const t=e||h,r={frag:h,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},o=t.byteRangeStartOffset,l=t.byteRangeEndOffset;if(Nn(o)&&Nn(l)){var f;let y=o,g=l;if(h.sn==="initSegment"&&e_((f=h.decryptdata)==null?void 0:f.method)){const p=l-o;p%16&&(g=l+(16-p%16)),o!==0&&(r.resetIV=!0,y=o-16)}r.rangeStart=y,r.rangeEnd=g}return r}function zy(h,e){const t=new Error(`GAP ${h.gap?"tag":"attribute"} found`),r={type:jn.MEDIA_ERROR,details:wt.FRAG_GAP,fatal:!1,frag:h,error:t,networkDetails:null};return e&&(r.part=e),(e||h).stats.aborted=!0,new ho(r)}function e_(h){return h==="AES-128"||h==="AES-256"}class ho extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class yE extends Ba{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class ym{constructor(e,t,r,o=0,l=-1,f=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=yd(),this.buffering={audio:yd(),video:yd(),audiovideo:yd()},this.level=e,this.sn=t,this.id=r,this.size=o,this.part=l,this.partial=f}}function yd(){return{start:0,executeStart:0,executeEnd:0,end:0}}const $y={length:0,start:()=>0,end:()=>0};class nr{static isBuffered(e,t){if(e){const r=nr.getBuffered(e);for(let o=r.length;o--;)if(t>=r.start(o)&&t<=r.end(o))return!0}return!1}static bufferedRanges(e){if(e){const t=nr.getBuffered(e);return nr.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){const o=nr.bufferedRanges(e);if(o.length)return nr.bufferedInfo(o,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((m,u)=>m.start-u.start||u.end-m.end);let o=-1,l=[];if(r)for(let m=0;m<e.length;m++){t>=e[m].start&&t<=e[m].end&&(o=m);const u=l.length;if(u){const d=l[u-1].end;e[m].start-d<r?e[m].end>d&&(l[u-1].end=e[m].end):l.push(e[m])}else l.push(e[m])}else l=e;let f=0,y,g=t,p=t;for(let m=0;m<l.length;m++){const u=l[m].start,d=l[m].end;if(o===-1&&t>=u&&t<=d&&(o=m),t+r>=u&&t<d)g=u,p=d,f=p-t;else if(t+r<u){y=u;break}}return{len:f,start:g||0,end:p||0,nextStart:y,buffered:e,bufferedIndex:o}}static getBuffered(e){try{return e.buffered||$y}catch(t){return Mr.log("failed to get media.buffered",t),$y}}}const vE=/\{\$([a-zA-Z0-9-_]+)\}/g;function Wy(h){return vE.test(h)}function zg(h,e){if(h.variableList!==null||h.hasVariableRefs){const t=h.variableList;return e.replace(vE,r=>{const o=r.substring(2,r.length-1),l=t==null?void 0:t[o];return l===void 0?(h.playlistParsingError||(h.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${o}"`)),r):l})}return e}function Xy(h,e,t){let r=h.variableList;r||(h.variableList=r={});let o,l;if("QUERYPARAM"in e){o=e.QUERYPARAM;try{const f=new self.URL(t).searchParams;if(f.has(o))l=f.get(o);else throw new Error(`"${o}" does not match any query parameter in URI: "${t}"`)}catch(f){h.playlistParsingError||(h.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${f.message}`))}}else o=e.NAME,l=e.VALUE;o in r?h.playlistParsingError||(h.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${o}"`)):r[o]=l||""}function t_(h,e,t){const r=e.IMPORT;if(t&&r in t){let o=h.variableList;o||(h.variableList=o={}),o[r]=t[r]}else h.playlistParsingError||(h.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const n_=/^(\d+)x(\d+)$/,Qy=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ti{constructor(e,t){typeof e=="string"&&(e=ti.parseAttrList(e,t)),Gr(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let o=0;o<t.length/2;o++)r[o]=parseInt(t.slice(o*2,o*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((o,l)=>(o[l.toLowerCase()]=!0,o),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=n_.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r;const o={};for(Qy.lastIndex=0;(r=Qy.exec(e))!==null;){const f=r[1].trim();let y=r[2];const g=y.indexOf('"')===0&&y.lastIndexOf('"')===y.length-1;let p=!1;if(g)y=y.slice(1,-1);else switch(f){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":p=!0}if(t&&(g||p))y=zg(t,y);else if(!p&&!g)switch(f){case"CLOSED-CAPTIONS":if(y==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Mr.warn(`${e}: attribute ${f} is missing quotes`)}o[f]=y}return o}}const r_="com.apple.hls.interstitial";function i_(h){return h!=="ID"&&h!=="CLASS"&&h!=="CUE"&&h!=="START-DATE"&&h!=="DURATION"&&h!=="END-DATE"&&h!=="END-ON-NEXT"}function a_(h){return h==="SCTE35-OUT"||h==="SCTE35-IN"||h==="SCTE35-CMD"}class EE{constructor(e,t,r=0){var o;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(o=t==null?void 0:t.tagOrder)!=null?o:r,t){const l=t.attr;for(const f in l)if(Object.prototype.hasOwnProperty.call(e,f)&&e[f]!==l[f]){Mr.warn(`DATERANGE tag attribute: "${f}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=f;break}e=Gr(new ti({}),l,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const l=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);Nn(l.getTime())&&(this._endDate=l)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Mr.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Nn(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===r_}get isValid(){return!!this.id&&!this._badValueForSameId&&Nn(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const s_=10;class o_{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let r=t.decryptdata;return r||(t.setKeyFormat(e.keyFormat),r=t.decryptdata),!!r&&e.matches(r)})}get hasProgramDateTime(){return this.fragments.length?Nn(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||s_}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Vd(h,e){return h.length===e.length?!h.some((t,r)=>t!==e[r]):!1}function Jy(h,e){return!h&&!e?!0:!h||!e?!1:Vd(h,e)}function Ou(h){return h==="AES-128"||h==="AES-256"||h==="AES-256-CTR"}function vm(h){switch(h){case"AES-128":case"AES-256":return nl.cbc;case"AES-256-CTR":return nl.ctr;default:throw new Error(`invalid full segment method ${h}`)}}function Em(h){return Uint8Array.from(atob(h),e=>e.charCodeAt(0))}function $g(h){return Uint8Array.from(unescape(encodeURIComponent(h)),e=>e.charCodeAt(0))}function l_(h){const e=$g(h).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function TE(h){const e=function(r,o,l){const f=r[o];r[o]=r[l],r[l]=f};e(h,0,3),e(h,1,2),e(h,4,5),e(h,6,7)}function SE(h){const e=h.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),o=r[r.length-1].split(",");if(o.length===2){const l=o[0]==="base64",f=o[1];l?(r.splice(-1,1),t=Em(f)):t=l_(f)}}return t}const Yd=typeof self<"u"?self:void 0;var ni={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Mi={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Nd(h){switch(h){case Mi.FAIRPLAY:return ni.FAIRPLAY;case Mi.PLAYREADY:return ni.PLAYREADY;case Mi.WIDEVINE:return ni.WIDEVINE;case Mi.CLEARKEY:return ni.CLEARKEY}}function _g(h){switch(h){case ni.FAIRPLAY:return Mi.FAIRPLAY;case ni.PLAYREADY:return Mi.PLAYREADY;case ni.WIDEVINE:return Mi.WIDEVINE;case ni.CLEARKEY:return Mi.CLEARKEY}}function Bc(h){const{drmSystems:e,widevineLicenseUrl:t}=h,r=e?[ni.FAIRPLAY,ni.WIDEVINE,ni.PLAYREADY,ni.CLEARKEY].filter(o=>!!e[o]):[];return!r[ni.WIDEVINE]&&t&&r.push(ni.WIDEVINE),r}const _E=(function(h){return Yd!=null&&(h=Yd.navigator)!=null&&h.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function u_(h,e,t,r){let o;switch(h){case ni.FAIRPLAY:o=["cenc","sinf"];break;case ni.WIDEVINE:case ni.PLAYREADY:o=["cenc"];break;case ni.CLEARKEY:o=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${h}`)}return c_(o,e,t,r)}function c_(h,e,t,r){return[{initDataTypes:h,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(l=>({contentType:`audio/mp4; codecs=${l}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(l=>({contentType:`video/mp4; codecs=${l}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function f_(h){var e;return!!h&&(h.sessionType==="persistent-license"||!!((e=h.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function AE(h){const e=new Uint16Array(h.buffer,h.byteOffset,h.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),r=t.substring(t.indexOf("<"),t.length),f=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(f){const y=f.childNodes[0]?f.childNodes[0].nodeValue:f.getAttribute("VALUE");if(y){const g=Em(y).subarray(0,16);return TE(g),g}}return null}let Cu={};class el{static clearKeyUriToKeyIdMap(){Cu={}}static setKeyIdForUri(e,t){Cu[e]=t}static addKeyIdForUri(e){const t=Object.keys(Cu).length%Number.MAX_SAFE_INTEGER,r=new Uint8Array(16);return new DataView(r.buffer,12,4).setUint32(0,t),Cu[e]=r,r}constructor(e,t,r,o=[1],l=null,f){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=o,this.iv=l,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Ou(e),f!=null&&f.startsWith("0x")&&(this.keyId=new Uint8Array(Xv(f)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Vd(e.keyFormatVersions,this.keyFormatVersions)&&Jy(e.iv,this.iv)&&Jy(e.keyId,this.keyId)}isSupported(){if(this.method){if(Ou(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Mi.FAIRPLAY:case Mi.WIDEVINE:case Mi.PLAYREADY:case Mi.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(Ou(this.method)){let l=this.iv;return l||(typeof e!="number"&&(Mr.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),l=h_(e)),new el(this.method,this.uri,"identity",this.keyFormatVersions,l)}if(this.keyId){const l=Cu[this.uri];if(l&&!Vd(this.keyId,l)&&el.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const r=SE(this.uri);if(r)switch(this.keyFormat){case Mi.WIDEVINE:if(this.pssh=r,!this.keyId){const l=pS(r.buffer);if(l.length){var o;const f=l[0];this.keyId=(o=f.kids)!=null&&o.length?f.kids[0]:null}}this.keyId||(this.keyId=ev(t));break;case Mi.PLAYREADY:{const l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=mS(l,null,r),this.keyId=AE(r);break}default:{let l=r.subarray(0,16);if(l.length!==16){const f=new Uint8Array(16);f.set(l,16-l.length),l=f}this.keyId=l;break}}if(!this.keyId||this.keyId.byteLength!==16){let l;l=d_(t),l||(l=ev(t),l||(l=Cu[this.uri])),l&&(this.keyId=l,el.setKeyIdForUri(this.uri,l))}return this}}function d_(h){const e=h==null?void 0:h[Mi.WIDEVINE];return e?e.keyId:null}function ev(h){const e=h==null?void 0:h[Mi.PLAYREADY];if(e){const t=SE(e.uri);if(t)return AE(t)}return null}function h_(h){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=h>>8*(15-t)&255;return e}const tv=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,nv=/#EXT-X-MEDIA:(.*)/g,g_=/^#EXT(?:INF|-X-TARGETDURATION):/m,Ag=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),m_=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Ps{static findGroup(e,t){for(let r=0;r<e.length;r++){const o=e[r];if(o.id===t)return o}}static resolve(e,t){return cm.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return g_.test(e)}static parseMasterPlaylist(e,t){const r=Wy(e),o={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},l=[];if(tv.lastIndex=0,!e.startsWith("#EXTM3U"))return o.playlistParsingError=new Error("no EXTM3U delimiter"),o;let f;for(;(f=tv.exec(e))!=null;)if(f[1]){var y;const p=new ti(f[1],o),m=zg(o,f[2]),u={attrs:p,bitrate:p.decimalInteger("BANDWIDTH")||p.decimalInteger("AVERAGE-BANDWIDTH"),name:p.NAME,url:Ps.resolve(m,t)},d=p.decimalResolution("RESOLUTION");d&&(u.width=d.width,u.height=d.height),av(p.CODECS,u);const S=p["SUPPLEMENTAL-CODECS"];S&&(u.supplemental={},av(S,u.supplemental)),(y=u.unknownCodecs)!=null&&y.length||l.push(u),o.levels.push(u)}else if(f[3]){const p=f[3],m=f[4];switch(p){case"SESSION-DATA":{const u=new ti(m,o),d=u["DATA-ID"];d&&(o.sessionData===null&&(o.sessionData={}),o.sessionData[d]=u);break}case"SESSION-KEY":{const u=rv(m,t,o);u.encrypted&&u.isSupported()?(o.sessionKeys===null&&(o.sessionKeys=[]),o.sessionKeys.push(u)):Mr.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${m}"`);break}case"DEFINE":{{const u=new ti(m,o);Xy(o,u,t)}break}case"CONTENT-STEERING":{const u=new ti(m,o);o.contentSteering={uri:Ps.resolve(u["SERVER-URI"],t),pathwayId:u["PATHWAY-ID"]||"."};break}case"START":{o.startTimeOffset=iv(m);break}}}const g=l.length>0&&l.length<o.levels.length;return o.levels=g?l:o.levels,o.levels.length===0&&(o.playlistParsingError=new Error("no levels found in manifest")),o}static parseMasterPlaylistMedia(e,t,r){let o;const l={},f=r.levels,y={AUDIO:f.map(p=>({id:p.attrs.AUDIO,audioCodec:p.audioCodec})),SUBTITLES:f.map(p=>({id:p.attrs.SUBTITLES,textCodec:p.textCodec})),"CLOSED-CAPTIONS":[]};let g=0;for(nv.lastIndex=0;(o=nv.exec(e))!==null;){const p=new ti(o[1],r),m=p.TYPE;if(m){const u=y[m],d=l[m]||[];l[m]=d;const S=p.LANGUAGE,_=p["ASSOC-LANGUAGE"],E=p.CHANNELS,b=p.CHARACTERISTICS,I=p["INSTREAM-ID"],T={attrs:p,bitrate:0,id:g++,groupId:p["GROUP-ID"]||"",name:p.NAME||S||"",type:m,default:p.bool("DEFAULT"),autoselect:p.bool("AUTOSELECT"),forced:p.bool("FORCED"),lang:S,url:p.URI?Ps.resolve(p.URI,t):""};if(_&&(T.assocLang=_),E&&(T.channels=E),b&&(T.characteristics=b),I&&(T.instreamId=I),u!=null&&u.length){const A=Ps.findGroup(u,T.groupId)||u[0];sv(T,A,"audioCodec"),sv(T,A,"textCodec")}d.push(T)}}return l}static parseLevelPlaylist(e,t,r,o,l,f){var y;const g={url:t},p=new o_(t),m=p.fragments,u=[];let d=null,S=0,_=0,E=0,b=0,I=0,T=null,A=new Eg(o,g),R,O,H,U=-1,Z=!1,$=null,F;if(Ag.lastIndex=0,p.m3u8=e,p.hasVariableRefs=Wy(e),((y=Ag.exec(e))==null?void 0:y[0])!=="#EXTM3U")return p.playlistParsingError=new Error("Missing format identifier #EXTM3U"),p;for(;(R=Ag.exec(e))!==null;){Z&&(Z=!1,A=new Eg(o,g),A.playlistOffset=E,A.setStart(E),A.sn=S,A.cc=b,I&&(A.bitrate=I),A.level=r,d&&(A.initSegment=d,d.rawProgramDateTime&&(A.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null),$&&(A.setByteRange($),$=null)));const de=R[1];if(de){A.duration=parseFloat(de);const Te=(" "+R[2]).slice(1);A.title=Te||null,A.tagList.push(Te?["INF",de,Te]:["INF",de])}else if(R[3]){if(Nn(A.duration)){A.playlistOffset=E,A.setStart(E),H&&lv(A,H,p),A.sn=S,A.level=r,A.cc=b,m.push(A);const Te=(" "+R[3]).slice(1);A.relurl=zg(p,Te),Wg(A,T,u),T=A,E+=A.duration,S++,_=0,Z=!0}}else{if(R=R[0].match(m_),!R){Mr.warn("No matches on slow regex match for level playlist!");continue}for(O=1;O<R.length&&R[O]===void 0;O++);const Te=(" "+R[O]).slice(1),me=(" "+R[O+1]).slice(1),X=R[O+2]?(" "+R[O+2]).slice(1):null;switch(Te){case"BYTERANGE":T?A.setByteRange(me,T):A.setByteRange(me);break;case"PROGRAM-DATE-TIME":A.rawProgramDateTime=me,A.tagList.push(["PROGRAM-DATE-TIME",me]),U===-1&&(U=m.length);break;case"PLAYLIST-TYPE":p.type&&co(p,Te,R),p.type=me.toUpperCase();break;case"MEDIA-SEQUENCE":p.startSN!==0?co(p,Te,R):m.length>0&&uv(p,Te,R),S=p.startSN=parseInt(me);break;case"SKIP":{p.skippedSegments&&co(p,Te,R);const Ie=new ti(me,p),Be=Ie.decimalInteger("SKIPPED-SEGMENTS");if(Nn(Be)){p.skippedSegments+=Be;for(let ee=Be;ee--;)m.push(null);S+=Be}const qe=Ie.enumeratedString("RECENTLY-REMOVED-DATERANGES");qe&&(p.recentlyRemovedDateranges=(p.recentlyRemovedDateranges||[]).concat(qe.split("	")));break}case"TARGETDURATION":p.targetduration!==0&&co(p,Te,R),p.targetduration=Math.max(parseInt(me),1);break;case"VERSION":p.version!==null&&co(p,Te,R),p.version=parseInt(me);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":p.live||co(p,Te,R),p.live=!1;break;case"#":(me||X)&&A.tagList.push(X?[me,X]:[me]);break;case"DISCONTINUITY":b++,A.tagList.push(["DIS"]);break;case"GAP":A.gap=!0,A.tagList.push([Te]);break;case"BITRATE":A.tagList.push([Te,me]),I=parseInt(me)*1e3,Nn(I)?A.bitrate=I:I=0;break;case"DATERANGE":{const Ie=new ti(me,p),Be=new EE(Ie,p.dateRanges[Ie.ID],p.dateRangeTagCount);p.dateRangeTagCount++,Be.isValid||p.skippedSegments?p.dateRanges[Be.id]=Be:Mr.warn(`Ignoring invalid DATERANGE tag: "${me}"`),A.tagList.push(["EXT-X-DATERANGE",me]);break}case"DEFINE":{{const Ie=new ti(me,p);"IMPORT"in Ie?t_(p,Ie,f):Xy(p,Ie,t)}break}case"DISCONTINUITY-SEQUENCE":p.startCC!==0?co(p,Te,R):m.length>0&&uv(p,Te,R),p.startCC=b=parseInt(me);break;case"KEY":{const Ie=rv(me,t,p);if(Ie.isSupported()){if(Ie.method==="NONE"){H=void 0;break}H||(H={});const Be=H[Ie.keyFormat];Be!=null&&Be.matches(Ie)||(Be&&(H=Gr({},H)),H[Ie.keyFormat]=Ie)}else Mr.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${me}"`);break}case"START":p.startTimeOffset=iv(me);break;case"MAP":{const Ie=new ti(me,p);if(A.duration){const Be=new Eg(o,g);ov(Be,Ie,r,H),d=Be,A.initSegment=d,d.rawProgramDateTime&&!A.rawProgramDateTime&&(A.rawProgramDateTime=d.rawProgramDateTime)}else{const Be=A.byteRangeEndOffset;if(Be){const qe=A.byteRangeStartOffset;$=`${Be-qe}@${qe}`}else $=null;ov(A,Ie,r,H),d=A,Z=!0}d.cc=b;break}case"SERVER-CONTROL":{F&&co(p,Te,R),F=new ti(me),p.canBlockReload=F.bool("CAN-BLOCK-RELOAD"),p.canSkipUntil=F.optionalFloat("CAN-SKIP-UNTIL",0),p.canSkipDateRanges=p.canSkipUntil>0&&F.bool("CAN-SKIP-DATERANGES"),p.partHoldBack=F.optionalFloat("PART-HOLD-BACK",0),p.holdBack=F.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{p.partTarget&&co(p,Te,R);const Ie=new ti(me);p.partTarget=Ie.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Ie=p.partList;Ie||(Ie=p.partList=[]);const Be=_>0?Ie[Ie.length-1]:void 0,qe=_++,ee=new ti(me,p),_e=new tS(ee,A,g,qe,Be);Ie.push(_e),A.duration+=_e.duration;break}case"PRELOAD-HINT":{const Ie=new ti(me,p);p.preloadHint=Ie;break}case"RENDITION-REPORT":{const Ie=new ti(me,p);p.renditionReports=p.renditionReports||[],p.renditionReports.push(Ie);break}default:Mr.warn(`line parsed but not handled: ${R}`);break}}}T&&!T.relurl?(m.pop(),E-=T.duration,p.partList&&(p.fragmentHint=T)):p.partList&&(Wg(A,T,u),A.cc=b,p.fragmentHint=A,H&&lv(A,H,p)),p.targetduration||(p.playlistParsingError=new Error("Missing Target Duration"));const W=m.length,fe=m[0],ne=m[W-1];if(E+=p.skippedSegments*p.targetduration,E>0&&W&&ne){p.averagetargetduration=E/W;const de=ne.sn;p.endSN=de!=="initSegment"?de:0,p.live||(ne.endList=!0),U>0&&(y_(m,U),fe&&u.unshift(fe))}return p.fragmentHint&&(E+=p.fragmentHint.duration),p.totalduration=E,u.length&&p.dateRangeTagCount&&fe&&bE(u,p),p.endCC=b,p}}function bE(h,e){let t=h.length;if(!t)if(e.hasProgramDateTime){const y=e.fragments[e.fragments.length-1];h.push(y),t++}else return;const r=h[t-1],o=e.live?1/0:e.totalduration,l=Object.keys(e.dateRanges);for(let y=l.length;y--;){const g=e.dateRanges[l[y]],p=g.startDate.getTime();g.tagAnchor=r.ref;for(let m=t;m--;){var f;if(((f=h[m])==null?void 0:f.sn)<e.startSN)break;const u=p_(e,p,h,m,o);if(u!==-1){g.tagAnchor=e.fragments[u].ref;break}}}}function p_(h,e,t,r,o){const l=t[r];if(l){const y=l.programDateTime;if(e>=y||r===0){var f;const g=(((f=t[r+1])==null?void 0:f.start)||o)-l.start;if(e<=y+g*1e3){const p=t[r].sn-h.startSN;if(p<0)return-1;const m=h.fragments;if(m.length>t.length){const d=(t[r+1]||m[m.length-1]).sn-h.startSN;for(let S=d;S>p;S--){const _=m[S].programDateTime;if(e>=_&&e<_+m[S].duration*1e3)return S}}return p}}}return-1}function rv(h,e,t){var r,o;const l=new ti(h,t),f=(r=l.METHOD)!=null?r:"",y=l.URI,g=l.hexadecimalInteger("IV"),p=l.KEYFORMATVERSIONS,m=(o=l.KEYFORMAT)!=null?o:"identity";y&&l.IV&&!g&&Mr.error(`Invalid IV: ${l.IV}`);const u=y?Ps.resolve(y,e):"",d=(p||"1").split("/").map(Number).filter(Number.isFinite);return new el(f,u,m,d,g,l.KEYID)}function iv(h){const t=new ti(h).decimalFloatingPoint("TIME-OFFSET");return Nn(t)?t:null}function av(h,e){let t=(h||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const o=t.filter(l=>hm(l,r));o.length&&(e[`${r}Codec`]=o.map(l=>l.split("/")[0]).join(","),t=t.filter(l=>o.indexOf(l)===-1))}),e.unknownCodecs=t}function sv(h,e,t){const r=e[t];r&&(h[t]=r)}function y_(h,e){let t=h[e];for(let r=e;r--;){const o=h[r];if(!o)return;o.programDateTime=t.programDateTime-o.duration*1e3,t=o}}function Wg(h,e,t){h.rawProgramDateTime?t.push(h):e!=null&&e.programDateTime&&(h.programDateTime=e.endProgramDateTime)}function ov(h,e,t,r){h.relurl=e.URI,e.BYTERANGE&&h.setByteRange(e.BYTERANGE),h.level=t,h.sn="initSegment",r&&(h.levelkeys=r),h.initSegment=null}function lv(h,e,t){h.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(o=>e[o].isCommonEncryption)&&r.push(h)}function co(h,e,t){h.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function uv(h,e,t){h.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function bg(h,e){const t=e.startPTS;if(Nn(t)){let r=0,o;e.sn>h.sn?(r=t-h.start,o=h):(r=h.start-t,o=e),o.duration!==r&&o.setDuration(r)}else e.sn>h.sn?h.cc===e.cc&&h.minEndPTS?e.setStart(h.start+(h.minEndPTS-h.start)):e.setStart(h.start+h.duration):e.setStart(Math.max(h.start-e.duration,0))}function RE(h,e,t,r,o,l,f){r-t<=0&&(f.warn("Fragment should have a positive duration",e),r=t+e.duration,l=o+e.duration);let g=t,p=r;const m=e.startPTS,u=e.endPTS;if(Nn(m)){const I=Math.abs(m-t);h&&I>h.totalduration?f.warn(`media timestamps and playlist times differ by ${I}s for level ${e.level} ${h.url}`):Nn(e.deltaPTS)?e.deltaPTS=Math.max(I,e.deltaPTS):e.deltaPTS=I,g=Math.max(t,m),t=Math.min(t,m),o=e.startDTS!==void 0?Math.min(o,e.startDTS):o,p=Math.min(r,u),r=Math.max(r,u),l=e.endDTS!==void 0?Math.max(l,e.endDTS):l}const d=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=g,e.startDTS=o,e.endPTS=r,e.minEndPTS=p,e.endDTS=l;const S=e.sn;if(!h||S<h.startSN||S>h.endSN)return 0;let _;const E=S-h.startSN,b=h.fragments;for(b[E]=e,_=E;_>0;_--)bg(b[_],b[_-1]);for(_=E;_<b.length-1;_++)bg(b[_],b[_+1]);return h.fragmentHint&&bg(b[b.length-1],h.fragmentHint),h.PTSKnown=h.alignedSliding=!0,d}function v_(h,e,t){if(h===e)return;let r=null;const o=h.fragments;for(let m=o.length-1;m>=0;m--){const u=o[m].initSegment;if(u){r=u;break}}h.fragmentHint&&delete h.fragmentHint.endPTS;let l;S_(h,e,(m,u,d,S)=>{if((!e.startCC||e.skippedSegments)&&u.cc!==m.cc){const _=m.cc-u.cc;for(let E=d;E<S.length;E++)S[E].cc+=_;e.endCC=S[S.length-1].cc}Nn(m.startPTS)&&Nn(m.endPTS)&&(u.setStart(u.startPTS=m.startPTS),u.startDTS=m.startDTS,u.maxStartPTS=m.maxStartPTS,u.endPTS=m.endPTS,u.endDTS=m.endDTS,u.minEndPTS=m.minEndPTS,u.setDuration(m.endPTS-m.startPTS),u.duration&&(l=u),e.PTSKnown=e.alignedSliding=!0),m.hasStreams&&(u.elementaryStreams=m.elementaryStreams),u.loader=m.loader,m.hasStats&&(u.stats=m.stats),m.initSegment&&(u.initSegment=m.initSegment,r=m.initSegment)});const f=e.fragments,y=e.fragmentHint?f.concat(e.fragmentHint):f;if(r&&y.forEach(m=>{var u;m&&(!m.initSegment||m.initSegment.relurl===((u=r)==null?void 0:u.relurl))&&(m.initSegment=r)}),e.skippedSegments){if(e.deltaUpdateFailed=f.some(m=>!m),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let m=e.skippedSegments;m--;)f.shift();e.startSN=f[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=E_(h.dateRanges,e,t));const m=h.fragments.filter(u=>u.rawProgramDateTime);if(h.hasProgramDateTime&&!e.hasProgramDateTime)for(let u=1;u<y.length;u++)y[u].programDateTime===null&&Wg(y[u],y[u-1],m);bE(m,e)}e.endCC=f[f.length-1].cc}if(!e.startCC){var g;const m=DE(h,e.startSN-1);e.startCC=(g=m==null?void 0:m.cc)!=null?g:f[0].cc}T_(h.partList,e.partList,(m,u)=>{u.elementaryStreams=m.elementaryStreams,u.stats=m.stats}),l?RE(e,l,l.startPTS,l.endPTS,l.startDTS,l.endDTS,t):IE(h,e),f.length&&(e.totalduration=e.edge-f[0].start),e.driftStartTime=h.driftStartTime,e.driftStart=h.driftStart;const p=e.advancedDateTime;if(e.advanced&&p){const m=e.edge;e.driftStart||(e.driftStartTime=p,e.driftStart=m),e.driftEndTime=p,e.driftEnd=m}else e.driftEndTime=h.driftEndTime,e.driftEnd=h.driftEnd,e.advancedDateTime=h.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=h.requestScheduled)}function E_(h,e,t){const{dateRanges:r,recentlyRemovedDateranges:o}=e,l=Gr({},h);o&&o.forEach(g=>{delete l[g]});const y=Object.keys(l).length;return y?(Object.keys(r).forEach(g=>{const p=l[g],m=new EE(r[g].attr,p);m.isValid?(l[g]=m,p||(m.tagOrder+=y)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${qr(r[g].attr)}"`)}),l):r}function T_(h,e,t){if(h&&e){let r=0;for(let o=0,l=h.length;o<=l;o++){const f=h[o],y=e[o+r];f&&y&&f.index===y.index&&f.fragment.sn===y.fragment.sn?t(f,y):r--}}}function S_(h,e,t){const r=e.skippedSegments,o=Math.max(h.startSN,e.startSN)-e.startSN,l=(h.fragmentHint?1:0)+(r?e.endSN:Math.min(h.endSN,e.endSN))-e.startSN,f=e.startSN-h.startSN,y=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,g=h.fragmentHint?h.fragments.concat(h.fragmentHint):h.fragments;for(let p=o;p<=l;p++){const m=g[f+p];let u=y[p];if(r&&!u&&m&&(u=e.fragments[p]=m),m&&u){t(m,u,p,y);const d=m.relurl,S=u.relurl;if(d&&__(d,S)){e.playlistParsingError=cv(`media sequence mismatch ${u.sn}:`,h,e,m,u);return}else if(m.cc!==u.cc){e.playlistParsingError=cv(`discontinuity sequence mismatch (${m.cc}!=${u.cc})`,h,e,m,u);return}}}}function cv(h,e,t,r,o){return new Error(`${h} ${o.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function IE(h,e,t=!0){const r=e.startSN+e.skippedSegments-h.startSN,o=h.fragments,l=r>=0;let f=0;if(l&&r<o.length)f=o[r].start;else if(l&&e.startSN===h.endSN+1)f=h.fragmentEnd;else if(l&&t)f=h.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)f=h.fragmentStart;else return;Xg(e,f)}function Xg(h,e){if(e){const t=h.fragments;for(let r=h.skippedSegments;r<t.length;r++)t[r].addStart(e);h.fragmentHint&&h.fragmentHint.addStart(e)}}function CE(h,e=1/0){let t=1e3*h.targetduration;if(h.updated){const r=h.fragments;if(r.length&&t*4>e){const l=r[r.length-1].duration*1e3;l<t&&(t=l)}}else t/=2;return Math.round(t)}function DE(h,e,t){if(!h)return null;let r=h.fragments[e-h.startSN];return r||(r=h.fragmentHint,r&&r.sn===e)?r:e<h.startSN&&t&&t.sn===e?t:null}function fv(h,e,t){return h?LE(h.partList,e,t):null}function LE(h,e,t){if(h)for(let r=h.length;r--;){const o=h[r];if(o.index===t&&o.fragment.sn===e)return o}return null}function xE(h){h.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(o=>{o.level=t,o.initSegment&&(o.initSegment.level=t)})})}function __(h,e){return h!==e&&e?dv(h)!==dv(e):!1}function dv(h){return h.replace(/\?[^?]*$/,"")}function Gc(h,e){for(let r=0,o=h.length;r<o;r++){var t;if(((t=h[r])==null?void 0:t.cc)===e)return h[r]}return null}function A_(h,e){return!!(h&&e.startCC<h.endCC&&e.endCC>h.startCC)}function hv(h,e){const t=h.start+e;h.startPTS=t,h.setStart(t),h.endPTS=t+h.duration}function NE(h,e){const t=e.fragments;for(let r=0,o=t.length;r<o;r++)hv(t[r],h);e.fragmentHint&&hv(e.fragmentHint,h),e.alignedSliding=!0}function b_(h,e){h&&(wE(e,h),e.alignedSliding||jd(e,h),!e.alignedSliding&&!e.skippedSegments&&IE(h,e,!1))}function wE(h,e){if(!A_(e,h))return;const t=Math.min(e.endCC,h.endCC),r=Gc(e.fragments,t),o=Gc(h.fragments,t);if(!r||!o)return;Mr.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const l=r.start-o.start;NE(l,h)}function jd(h,e){if(!h.hasProgramDateTime||!e.hasProgramDateTime)return;const t=h.fragments,r=e.fragments;if(!t.length||!r.length)return;let o,l;const f=Math.min(e.endCC,h.endCC);e.startCC<f&&h.startCC<f&&(o=Gc(r,f),l=Gc(t,f)),(!o||!l)&&(o=r[Math.floor(r.length/2)],l=Gc(t,o.cc)||t[Math.floor(t.length/2)]);const y=o.programDateTime,g=l.programDateTime;if(!y||!g)return;const p=(g-y)/1e3-(l.start-o.start);NE(p,h)}function Ki(h,e,t){la(h,e,t),h.addEventListener(e,t)}function la(h,e,t){h.removeEventListener(e,t)}const R_={toString:function(h){let e="";const t=h.length;for(let r=0;r<t;r++)e+=`[${h.start(r).toFixed(3)}-${h.end(r).toFixed(3)}]`;return e}},nn={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Tm extends yE{constructor(e,t,r,o,l){super(o,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=nn.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:f,fragCurrent:y,media:g,mediaBuffer:p,state:m}=this,u=g?g.currentTime:0,d=nr.bufferInfo(p||g,u,f.maxBufferHole),S=!d.len;if(this.log(`Media seeking to ${Nn(u)?u.toFixed(3):u}, state: ${m}, ${S?"out of":"in"} buffer`),this.state===nn.ENDED)this.resetLoadingState();else if(y){const _=f.maxFragLookUpTolerance,E=y.start-_,b=y.start+y.duration+_;if(S||b<d.start||E>d.end){const I=u>b;(u<E||I)&&(I&&y.loader&&(this.log(`Cancelling fragment load for seek (sn: ${y.sn})`),y.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(g){this.fragmentTracker.removeFragmentsInRange(u,1/0,this.playlistType,!0);const _=this.lastCurrentTime;if(u>_&&(this.lastCurrentTime=u),!this.loadingParts){const E=Math.max(d.end,u),b=this.shouldLoadParts(this.getLevelDetails(),E);b&&(this.log(`LL-Part loading ON after seeking to ${u.toFixed(2)} with buffer @${E.toFixed(2)}`),this.loadingParts=b)}}this.hls.hasEnoughToStart||(this.log(`Setting ${S?"startPosition":"nextLoadPosition"} to ${u} for seek without enough to start`),this.nextLoadPosition=u,S&&(this.startPosition=u)),S&&this.state===nn.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=l,this.hls=e,this.fragmentLoader=new JS(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new pm(e.config)}registerListeners(){const{hls:e}=this;e.on(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(pe.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(pe.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===nn.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=nn.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const r=e.end||0,o=this.config.timelineOffset||0;if(r<=o)return!1;const l=e.buffered;this.config.maxBufferHole&&l&&l.length>1&&(e=nr.bufferedInfo(l,e.start,0));const f=e.nextStart;if(f&&f>o&&f<t.edge||this.media.currentTime<e.start)return!1;const g=t.partList;if(g!=null&&g.length){const m=g[g.length-1];return nr.isBuffered(this.media,m.start+m.duration/2)}const p=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(p)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;Ki(r,"seeking",this.onMediaSeeking),Ki(r,"ended",this.onMediaEnded);const o=this.config;this.levels&&o.autoStartLoad&&this.state===nn.STOPPED&&this.startLoad(o.startPosition)}onMediaDetaching(e,t){const r=!!t.transferMedia,o=this.media;if(o!==null){if(o.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),la(o,"seeking",this.onMediaSeeking),la(o,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=nn.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const o=l=>{const f=l.frag;if(this.fragContextChanged(f)){this.warn(`${f.type} sn: ${f.sn}${l.part?" part: "+l.part.index:""} of ${this.fragInfo(f,!1,l.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(f);return}f.stats.chunkCount++,this._handleFragmentLoadProgress(l)};this._doFragLoad(e,t,r,o).then(l=>{if(!l)return;const f=this.state,y=l.frag;if(this.fragContextChanged(y)){(f===nn.FRAG_LOADING||!this.fragCurrent&&f===nn.PARSING)&&(this.fragmentTracker.removeFragment(y),this.state=nn.IDLE);return}"payload"in l&&(this.log(`Loaded ${y.type} sn: ${y.sn} of ${this.playlistLabel()} ${y.level}`),this.hls.trigger(pe.FRAG_LOADED,l)),this._handleFragmentLoadComplete(l)}).catch(l=>{this.state===nn.STOPPED||this.state===nn.ERROR||(this.warn(`Frag error: ${(l==null?void 0:l.message)||l}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===Ai.APPENDING){const l=e.type,f=this.getFwdBufferInfo(this.mediaBuffer,l),y=Math.max(e.duration,f?f.len:this.config.maxBufferLength),g=this.backtrackFragment;((g?e.sn-g.sn:0)===1||this.reduceMaxBufferLength(y,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Ai.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const o={startOffset:e,endOffset:t,type:r};this.hls.trigger(pe.BUFFER_FLUSHING,o)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{const o=r==null?void 0:r.frag;if(!o||this.fragContextChanged(o)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:o}=this,{frag:l,payload:f}=r,y=l.decryptdata;if(f&&f.byteLength>0&&y!=null&&y.key&&y.iv&&Ou(y.method)){const g=self.performance.now();return this.decrypter.decrypt(new Uint8Array(f),y.key.buffer,y.iv.buffer,vm(y.method)).catch(p=>{throw o.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.FRAG_DECRYPT_ERROR,fatal:!1,error:p,reason:p.message,frag:l}),p}).then(p=>{const m=self.performance.now();return o.trigger(pe.FRAG_DECRYPTED,{frag:l,payload:p,stats:{tstart:g,tdecrypt:m}}),r.payload=p,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===nn.STOPPED||this.state===nn.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==nn.STOPPED&&(this.state=nn.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var r,o;const l=e.tracks;if(l&&!t.encrypted&&((r=l.audio)!=null&&r.encrypted||(o=l.video)!=null&&o.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const f=this.media,y=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${f?"attached mediaKeys: "+f.mediaKeys:"detached"})`);return this.warn(y.message),!f||f.mediaKeys?!1:(this.hls.trigger(pe.ERROR,{type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_NO_KEYS,fatal:!1,error:y,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?R_.toString(nr.getBuffered(r)):"(detached)"})`),hi(e)){var o;if(e.type!==Pn.SUBTITLE){const f=e.elementaryStreams;if(!Object.keys(f).some(y=>!!f[y])){this.state=nn.IDLE;return}}const l=(o=this.levels)==null?void 0:o[e.level];l!=null&&l.fragmentError&&(this.log(`Resetting level fragment error count of ${l.fragmentError} on frag buffered`),l.fragmentError=0)}this.state=nn.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:o,partsLoaded:l}=e,f=!l||l.length===0||l.some(g=>!g),y=new ym(r.level,r.sn,r.stats.chunkCount+1,0,o?o.index:-1,!f);t.flush(y)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,o){var l;this.fragCurrent=e;const f=t.details;if(!this.levels||!f)throw new Error(`frag load aborted, missing level${f?"":" detail"}s`);let y=null;if(e.encrypted&&!((l=e.decryptdata)!=null&&l.key)){if(this.log(`Loading key for ${e.sn} of [${f.startSN}-${f.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=nn.KEY_LOADING,this.fragCurrent=e,y=this.keyLoader.load(e).then(d=>{if(!this.fragContextChanged(d.frag))return this.hls.trigger(pe.KEY_LOADED,d),this.state===nn.KEY_LOADING&&(this.state=nn.IDLE),d}),this.hls.trigger(pe.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(y=this.keyLoader.loadClear(e,f.encryptedFragments,this.startFragRequested),y&&this.log("[eme] blocking frag load until media-keys acquired"));const g=this.fragPrevious;if(hi(e)&&(!g||e.sn!==g.sn)){const d=this.shouldLoadParts(t.details,e.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} loading sn ${g==null?void 0:g.sn}->${e.sn}`),this.loadingParts=d)}if(r=Math.max(e.start,r||0),this.loadingParts&&hi(e)){const d=f.partList;if(d&&o){r>f.fragmentEnd&&f.fragmentHint&&(e=f.fragmentHint);const S=this.getNextPart(d,e,r);if(S>-1){const _=d[S];e=this.fragCurrent=_.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${_.index} (${S}/${d.length-1}) of ${this.fragInfo(e,!1,_)}) cc: ${e.cc} [${f.startSN}-${f.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=_.start+_.duration,this.state=nn.FRAG_LOADING;let E;return y?E=y.then(b=>!b||this.fragContextChanged(b.frag)?null:this.doFragPartsLoad(e,_,t,o)).catch(b=>this.handleFragLoadError(b)):E=this.doFragPartsLoad(e,_,t,o).catch(b=>this.handleFragLoadError(b)),this.hls.trigger(pe.FRAG_LOADING,{frag:e,part:_,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):E}else if(!e.url||this.loadedEndOfParts(d,r))return Promise.resolve(null)}}if(hi(e)&&this.loadingParts){var p;this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(p=f.partList)==null?void 0:p.filter(d=>d.loaded).map(d=>`[${d.start}-${d.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+f.startSN+"-"+f.endSN+"]"}, target: ${parseFloat(r.toFixed(3))}`),Nn(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=nn.FRAG_LOADING;const m=this.config.progressive&&e.type!==Pn.SUBTITLE;let u;return m&&y?u=y.then(d=>!d||this.fragContextChanged(d.frag)?null:this.fragmentLoader.load(e,o)).catch(d=>this.handleFragLoadError(d)):u=Promise.all([this.fragmentLoader.load(e,m?o:void 0),y]).then(([d])=>(!m&&o&&o(d),d)).catch(d=>this.handleFragLoadError(d)),this.hls.trigger(pe.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,r,o){return new Promise((l,f)=>{var y;const g=[],p=(y=r.details)==null?void 0:y.partList,m=u=>{this.fragmentLoader.loadPart(e,u,o).then(d=>{g[u.index]=d;const S=d.part;this.hls.trigger(pe.FRAG_LOADED,d);const _=fv(r.details,e.sn,u.index+1)||LE(p,e.sn,u.index+1);if(_)m(_);else return l({frag:e,part:S,partsLoaded:g})}).catch(f)};m(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===wt.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===jn.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(pe.ERROR,t)}else this.hls.trigger(pe.ERROR,{type:jn.OTHER_ERROR,details:wt.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==nn.PARSING){!this.fragCurrent&&this.state!==nn.STOPPED&&this.state!==nn.ERROR&&(this.state=nn.IDLE);return}const{frag:r,part:o,level:l}=t,f=self.performance.now();r.stats.parsing.end=f,o&&(o.stats.parsing.end=f);const y=this.getLevelDetails(),p=y&&r.sn>y.endSN||this.shouldLoadParts(y,r.end);p!==this.loadingParts&&(this.log(`LL-Part loading ${p?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=p),this.updateLevelTiming(r,o,l,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r;const l=e.partList[0];if(l.fragment.type===Pn.SUBTITLE)return!1;const f=l.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(t>=f){var o;if((this.hls.hasEnoughToStart?((o=this.media)==null?void 0:o.currentTime)||this.lastCurrentTime:this.getLoadPosition())>l.start-l.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:o,sn:l,part:f}=e;if(!(t!=null&&t[o]))return this.warn(`Levels object was unset while buffering fragment ${l} of ${this.playlistLabel()} ${o}. The current chunk will not be buffered.`),null;const y=t[o],g=y.details,p=f>-1?fv(g,l,f):null,m=p?p.fragment:DE(g,l,r);return m?(r&&r!==m&&(m.stats=r.stats),{frag:m,part:p,level:y}):null}bufferFragmentData(e,t,r,o,l){if(this.state!==nn.PARSING)return;const{data1:f,data2:y}=e;let g=f;if(y&&(g=Ua(f,y)),!g.length)return;const p=this.initPTS[t.cc],m=p?-p.baseTime/p.timescale:void 0,u={type:e.type,frag:t,part:r,chunkMeta:o,offset:m,parent:t.type,data:g};if(this.hls.trigger(pe.BUFFER_APPENDING,u),e.dropped&&e.independent&&!r){if(l)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!nr.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,o=nr.bufferInfo(t,r,0),l=e.duration,f=Math.min(this.config.maxFragLookUpTolerance*2,l*.25),y=Math.max(Math.min(e.start-f,o.end-f),r+f);e.start-y>f&&this.flushMainBuffer(y,e.start)}getFwdBufferInfo(e,t){var r;const o=this.getLoadPosition();if(!Nn(o))return null;const f=this.lastCurrentTime>o||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,o,t,f)}getFwdBufferInfoAtPos(e,t,r,o){const l=nr.bufferInfo(e,t,o);if(l.len===0&&l.nextStart!==void 0){const f=this.fragmentTracker.getBufferedFrag(t,r);if(f&&(l.nextStart<=f.end||f.gap)){const y=Math.max(Math.min(l.nextStart,f.end)-t,o);return nr.bufferInfo(e,t,y)}}return l}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,o=Math.max(Math.min(e-t,r.maxBufferLength),t),l=Math.max(e-t*3,r.maxMaxBufferLength/2,o);return l>=o?(r.maxMaxBufferLength=l,this.warn(`Reduce max buffer length to ${l}s`),!0):!1}getAppendedFrag(e,t=Pn.MAIN){const r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){const r=t.fragments,o=r.length;if(!o)return null;const{config:l}=this,f=r[0].start,y=l.lowLatencyMode&&!!t.partList;let g=null;if(t.live){const u=l.initialLiveManifestSize;if(o<u)return this.warn(`Not enough fragments to start playback (have: ${o}, need: ${u})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<f){var p;y&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),g=this.getInitialLiveFragment(t);const d=this.hls.startPosition,S=this.hls.liveSyncPosition,_=g?(d!==-1&&d>=f?d:S)||g.start:e;this.log(`Setting startPosition to ${_} to match start frag at live edge. mainStart: ${d} liveSyncPosition: ${S} frag.start: ${(p=g)==null?void 0:p.start}`),this.startPosition=this.nextLoadPosition=_}}else e<=f&&(g=r[0]);if(!g){const u=this.loadingParts?t.partEnd:t.fragmentEnd;g=this.getFragmentAtPosition(e,u,t)}let m=this.filterReplacedPrimary(g,t);if(!m&&g){const u=g.sn-t.startSN;m=this.filterReplacedPrimary(r[u+1]||null,t)}return this.mapToInitFragWhenRequired(m)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===Ai.OK||r===Ai.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,o,l){let f=null;if(e.gap&&(f=this.getNextFragment(this.nextLoadPosition,t),f&&!f.gap&&r.nextStart)){const y=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,o,0);if(y!==null&&r.len+y.len>=l){const g=f.sn;return this.loopSn!==g&&(this.log(`buffer full after gaps in "${o}" playlist starting at sn: ${g}`),this.loopSn=g),null}}return this.loopSn=void 0,f}get primaryPrefetch(){if(gv(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(gv(this.config)&&e.type!==Pn.SUBTITLE){const r=this.hls.interstitialsManager,o=r==null?void 0:r.bufferingItem;if(o){const f=o.event;if(f){if(f.appendInPlace||Math.abs(e.start-o.start)>1||o.start===0)return null}else if(e.end<=o.start&&(t==null?void 0:t.live)===!1||e.start>o.end&&o.nextEvent&&(o.nextEvent.appendInPlace||e.start-o.end>1))return null}const l=r==null?void 0:r.playerQueue;if(l)for(let f=l.length;f--;){const y=l[f].interstitial;if(y.appendInPlace&&e.start>=y.startTime&&e.end<=y.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let o=-1,l=!1,f=!0;for(let y=0,g=e.length;y<g;y++){const p=e[y];if(f=f&&!p.independent,o>-1&&r<p.start)break;const m=p.loaded;m?o=-1:(l||(p.independent||f)&&p.fragment===t)&&(p.fragment!==t&&this.warn(`Need buffer at ${r} but next unloaded part starts at ${p.start}`),o=y),l=m}return o}loadedEndOfParts(e,t){let r;for(let o=e.length;o--;){if(r=e[o],!r.loaded)return!1;if(t>r.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,r=this.fragPrevious;let o=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),o=ZS(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!o){const l=r.sn+1;if(l>=e.startSN&&l<=e.endSN){const f=t[l-e.startSN];r.cc===f.cc&&(o=f,this.log(`Live playlist, switching playlist, load frag with next SN: ${o.sn}`))}o||(o=gE(e,r.cc,r.end),o&&this.log(`Live playlist, switching playlist, load frag with same CC: ${o.sn}`))}}else{const l=this.hls.liveSyncPosition;l!==null&&(o=this.getFragmentAtPosition(l,this.bitrateTest?e.fragmentEnd:e.edge,e))}return o}getFragmentAtPosition(e,t,r){const{config:o}=this;let{fragPrevious:l}=this,{fragments:f,endSN:y}=r;const{fragmentHint:g}=r,{maxFragLookUpTolerance:p}=o,m=r.partList,u=!!(this.loadingParts&&m!=null&&m.length&&g);u&&!this.bitrateTest&&m[m.length-1].fragment.sn===g.sn&&(f=f.concat(g),y=g.sn);let d;if(e<t){var S;const E=e<this.lastCurrentTime||e>t-p||(S=this.media)!=null&&S.paused||!this.startFragRequested?0:p;d=Ml(l,f,e,E)}else d=f[f.length-1];if(d){const _=d.sn-r.startSN,E=this.fragmentTracker.getState(d);if((E===Ai.OK||E===Ai.PARTIAL&&d.gap)&&(l=d),l&&d.sn===l.sn&&(!u||m[0].fragment.sn>d.sn||!r.live)&&d.level===l.level){const I=f[_+1];d.sn<y&&this.fragmentTracker.getState(I)!==Ai.OK?d=I:d=null}}return d}alignPlaylists(e,t,r){const o=e.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;const l=e.fragmentStart,f=!t,y=e.alignedSliding&&Nn(l);if(f||!y&&!l){b_(r,e);const g=e.fragmentStart;return this.log(`Live playlist sliding: ${g.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${o}`),g}return l}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);const o=this.timelineOffset;if(r===-1){const l=this.startTimeOffset!==null,f=l?this.startTimeOffset:e.startTimeOffset;f!==null&&Nn(f)?(r=t+f,f<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${f} found in ${l?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+o}this.nextLoadPosition=r+o}getLoadPosition(){var e;const{media:t}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&hi(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==nn.FRAG_LOADING_WAITING_RETRY)&&(this.state=nn.IDLE)}onFragmentOrKeyLoadError(e,t){var r;if(t.chunkMeta&&!t.frag){const I=this.getCurrentContext(t.chunkMeta);I&&(t.frag=I.frag)}const o=t.frag;if(!o||o.type!==e||!this.levels)return;if(this.fragContextChanged(o)){var l;this.warn(`Frag load error must match current frag to retry ${o.url} > ${(l=this.fragCurrent)==null?void 0:l.url}`);return}const f=t.details===wt.FRAG_GAP;f&&this.fragmentTracker.fragBuffered(o,!0);const y=t.errorAction;if(!y){this.state=nn.ERROR;return}const{action:g,flags:p,retryCount:m=0,retryConfig:u}=y,d=!!u,S=d&&g===wi.RetryRequest,_=d&&!y.resolved&&p===Sa.MoveAllAlternatesMatchingHost,E=(r=this.hls.latestLevelDetails)==null?void 0:r.live;if(!S&&_&&hi(o)&&!o.endList&&E&&!pE(t))this.resetFragmentErrors(e),this.treatAsGap(o),y.resolved=!0;else if((S||_)&&m<u.maxNumRetry){var b;const I=Kg((b=t.response)==null?void 0:b.code),T=mm(u,m);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+T,this.state=nn.FRAG_LOADING_WAITING_RETRY,y.resolved=!0,I){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${o.sn} of ${e} ${o.level} errored with ${t.details}, retrying loading ${m+1}/${u.maxNumRetry} in ${T}ms`)}else if(u)if(this.resetFragmentErrors(e),m<u.maxNumRetry)!f&&g!==wi.RemoveAlternatePermanently&&(y.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${m})`);return}else g===wi.SendAlternateToPenaltyBox?this.state=nn.WAITING_LEVEL:this.state=nn.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,r=t===1/0;(!t||e>=t||r&&!Kg(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=nn.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===nn.PARSING||this.state===nn.PARSED){const t=e.frag,r=e.parent,o=this.getFwdBufferInfo(this.mediaBuffer,r),l=o&&o.len>.5;l&&this.reduceMaxBufferLength(o.len,(t==null?void 0:t.duration)||10);const f=!l;return f&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),f}return!1}resetFragmentErrors(e){e===Pn.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==nn.STOPPED&&(this.state=nn.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const o=nr.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,o,r),this.state===nn.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==nn.STOPPED&&(this.state=nn.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,o){const l=r.details;if(!l){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((g,p)=>{const m=e.elementaryStreams[p];if(m){const u=m.endPTS-m.startPTS;if(u<=0)return this.warn(`Could not parse fragment ${e.sn} ${p} duration reliably (${u})`),g||!1;const d=o?0:RE(l,e,m.startPTS,m.endPTS,m.startDTS,m.endDTS,this);return this.hls.trigger(pe.LEVEL_PTS_UPDATED,{details:l,level:r,drift:d,type:p,frag:e,start:m.startPTS,end:m.endPTS}),!0}return g},!1)){var y;const g=((y=this.transmuxer)==null?void 0:y.error)===null;if((r.fragmentError===0||g&&(r.fragmentError<2||e.endList))&&this.treatAsGap(e,r),g){const p=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(p.message),this.hls.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.FRAG_PARSING_ERROR,fatal:!1,error:p,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=nn.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(pe.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===Pn.MAIN?"level":"track"}fragInfo(e,t=!0,r){var o,l;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((o=t&&!r?e.startPTS:(r||e).start)!=null?o:NaN).toFixed(3)}-${((l=t&&!r?e.endPTS:(r||e).end)!=null?l:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function gv(h){return!!h.interstitialsController&&h.enableInterstitialPlayback!==!1}class OE{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=I_(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function I_(h,e){const t=new Uint8Array(e);let r=0;for(let o=0;o<h.length;o++){const l=h[o];t.set(l,r),r+=l.length}return t}var Rg={exports:{}},mv;function C_(){return mv||(mv=1,(function(h){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function o(g,p,m){this.fn=g,this.context=p,this.once=m||!1}function l(g,p,m,u,d){if(typeof m!="function")throw new TypeError("The listener must be a function");var S=new o(m,u||g,d),_=t?t+p:p;return g._events[_]?g._events[_].fn?g._events[_]=[g._events[_],S]:g._events[_].push(S):(g._events[_]=S,g._eventsCount++),g}function f(g,p){--g._eventsCount===0?g._events=new r:delete g._events[p]}function y(){this._events=new r,this._eventsCount=0}y.prototype.eventNames=function(){var p=[],m,u;if(this._eventsCount===0)return p;for(u in m=this._events)e.call(m,u)&&p.push(t?u.slice(1):u);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(m)):p},y.prototype.listeners=function(p){var m=t?t+p:p,u=this._events[m];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,S=u.length,_=new Array(S);d<S;d++)_[d]=u[d].fn;return _},y.prototype.listenerCount=function(p){var m=t?t+p:p,u=this._events[m];return u?u.fn?1:u.length:0},y.prototype.emit=function(p,m,u,d,S,_){var E=t?t+p:p;if(!this._events[E])return!1;var b=this._events[E],I=arguments.length,T,A;if(b.fn){switch(b.once&&this.removeListener(p,b.fn,void 0,!0),I){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,m),!0;case 3:return b.fn.call(b.context,m,u),!0;case 4:return b.fn.call(b.context,m,u,d),!0;case 5:return b.fn.call(b.context,m,u,d,S),!0;case 6:return b.fn.call(b.context,m,u,d,S,_),!0}for(A=1,T=new Array(I-1);A<I;A++)T[A-1]=arguments[A];b.fn.apply(b.context,T)}else{var R=b.length,O;for(A=0;A<R;A++)switch(b[A].once&&this.removeListener(p,b[A].fn,void 0,!0),I){case 1:b[A].fn.call(b[A].context);break;case 2:b[A].fn.call(b[A].context,m);break;case 3:b[A].fn.call(b[A].context,m,u);break;case 4:b[A].fn.call(b[A].context,m,u,d);break;default:if(!T)for(O=1,T=new Array(I-1);O<I;O++)T[O-1]=arguments[O];b[A].fn.apply(b[A].context,T)}}return!0},y.prototype.on=function(p,m,u){return l(this,p,m,u,!1)},y.prototype.once=function(p,m,u){return l(this,p,m,u,!0)},y.prototype.removeListener=function(p,m,u,d){var S=t?t+p:p;if(!this._events[S])return this;if(!m)return f(this,S),this;var _=this._events[S];if(_.fn)_.fn===m&&(!d||_.once)&&(!u||_.context===u)&&f(this,S);else{for(var E=0,b=[],I=_.length;E<I;E++)(_[E].fn!==m||d&&!_[E].once||u&&_[E].context!==u)&&b.push(_[E]);b.length?this._events[S]=b.length===1?b[0]:b:f(this,S)}return this},y.prototype.removeAllListeners=function(p){var m;return p?(m=t?t+p:p,this._events[m]&&f(this,m)):(this._events=new r,this._eventsCount=0),this},y.prototype.off=y.prototype.removeListener,y.prototype.addListener=y.prototype.on,y.prefixed=t,y.EventEmitter=y,h.exports=y})(Rg)),Rg.exports}var D_=C_(),Sm=JT(D_);const qc="1.6.15",Fu={};function L_(){return typeof __HLS_WORKER_BUNDLE__=="function"}function x_(){const h=Fu[qc];if(h)return h.clientCount++,h;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),o={worker:new self.Worker(t),objectURL:t,clientCount:1};return Fu[qc]=o,o}function N_(h){const e=Fu[h];if(e)return e.clientCount++,e;const t=new self.URL(h,self.location.href).href,o={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Fu[h]=o,o}function w_(h){const e=Fu[h||qc];if(e&&e.clientCount--===1){const{worker:r,objectURL:o}=e;delete Fu[h||qc],o&&self.URL.revokeObjectURL(o),r.terminate()}}function ME(h,e){return e+10<=h.length&&h[e]===51&&h[e+1]===68&&h[e+2]===73&&h[e+3]<255&&h[e+4]<255&&h[e+6]<128&&h[e+7]<128&&h[e+8]<128&&h[e+9]<128}function _m(h,e){return e+10<=h.length&&h[e]===73&&h[e+1]===68&&h[e+2]===51&&h[e+3]<255&&h[e+4]<255&&h[e+6]<128&&h[e+7]<128&&h[e+8]<128&&h[e+9]<128}function $d(h,e){let t=0;return t=(h[e]&127)<<21,t|=(h[e+1]&127)<<14,t|=(h[e+2]&127)<<7,t|=h[e+3]&127,t}function Kc(h,e){const t=e;let r=0;for(;_m(h,e);){r+=10;const o=$d(h,e+6);r+=o,ME(h,e+10)&&(r+=10),e+=r}if(r>0)return h.subarray(t,t+r)}function O_(h,e,t,r){const o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],l=e[t+2],f=l>>2&15;if(f>12){const S=new Error(`invalid ADTS sampling index:${f}`);h.emit(pe.ERROR,pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.FRAG_PARSING_ERROR,fatal:!0,error:S,reason:S.message});return}const y=(l>>6&3)+1,g=e[t+3]>>6&3|(l&1)<<2,p="mp4a.40."+y,m=o[f];let u=f;(y===5||y===29)&&(u-=3);const d=[y<<3|(u&14)>>1,(u&1)<<7|g<<3];return Mr.log(`manifest codec:${r}, parsed codec:${p}, channels:${g}, rate:${m} (ADTS object type:${y} sampling index:${f})`),{config:d,samplerate:m,channelCount:g,codec:p,parsedCodec:p,manifestCodec:r}}function PE(h,e){return h[e]===255&&(h[e+1]&246)===240}function kE(h,e){return h[e+1]&1?7:9}function Am(h,e){return(h[e+3]&3)<<11|h[e+4]<<3|(h[e+5]&224)>>>5}function M_(h,e){return e+5<h.length}function qd(h,e){return e+1<h.length&&PE(h,e)}function P_(h,e){return M_(h,e)&&PE(h,e)&&Am(h,e)<=h.length-e}function k_(h,e){if(qd(h,e)){const t=kE(h,e);if(e+t>=h.length)return!1;const r=Am(h,e);if(r<=t)return!1;const o=e+r;return o===h.length||qd(h,o)}return!1}function FE(h,e,t,r,o){if(!h.samplerate){const l=O_(e,t,r,o);if(!l)return;Gr(h,l)}}function UE(h){return 1024*9e4/h}function F_(h,e){const t=kE(h,e);if(e+t<=h.length){const r=Am(h,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function BE(h,e,t,r,o){const l=UE(h.samplerate),f=r+o*l,y=F_(e,t);let g;if(y){const{frameLength:u,headerLength:d}=y,S=d+u,_=Math.max(0,t+S-e.length);_?(g=new Uint8Array(S-d),g.set(e.subarray(t+d,e.length),0)):g=e.subarray(t+d,t+S);const E={unit:g,pts:f};return _||h.samples.push(E),{sample:E,length:S,missing:_}}const p=e.length-t;return g=new Uint8Array(p),g.set(e.subarray(t,e.length),0),{sample:{unit:g,pts:f},length:p,missing:-1}}function U_(h,e){return _m(h,e)&&$d(h,e+6)+10<=h.length-e}function B_(h){return h instanceof ArrayBuffer?h:h.byteOffset==0&&h.byteLength==h.buffer.byteLength?h.buffer:new Uint8Array(h).buffer}function Ig(h,e=0,t=1/0){return G_(h,e,t,Uint8Array)}function G_(h,e,t,r){const o=Z_(h);let l=1;"BYTES_PER_ELEMENT"in r&&(l=r.BYTES_PER_ELEMENT);const f=H_(h)?h.byteOffset:0,y=(f+h.byteLength)/l,g=(f+e)/l,p=Math.floor(Math.max(0,Math.min(g,y))),m=Math.floor(Math.min(p+Math.max(t,0),y));return new r(o,p,m-p)}function Z_(h){return h instanceof ArrayBuffer?h:h.buffer}function H_(h){return h&&h.buffer instanceof ArrayBuffer&&h.byteLength!==void 0&&h.byteOffset!==void 0}function V_(h){const e={key:h.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(h.size<2)return;if(h.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const r=h.data.subarray(1).indexOf(0);if(r===-1)return;const o=ba(Ig(h.data,1,r)),l=h.data[2+r],f=h.data.subarray(3+r).indexOf(0);if(f===-1)return;const y=ba(Ig(h.data,3+r,f));let g;return o==="-->"?g=ba(Ig(h.data,4+r+f)):g=B_(h.data.subarray(4+r+f)),e.mimeType=o,e.pictureType=l,e.description=y,e.data=g,e}function Y_(h){if(h.size<2)return;const e=ba(h.data,!0),t=new Uint8Array(h.data.subarray(e.length+1));return{key:h.type,info:e,data:t.buffer}}function j_(h){if(h.size<2)return;if(h.type==="TXXX"){let t=1;const r=ba(h.data.subarray(t),!0);t+=r.length+1;const o=ba(h.data.subarray(t));return{key:h.type,info:r,data:o}}const e=ba(h.data.subarray(1));return{key:h.type,info:"",data:e}}function q_(h){if(h.type==="WXXX"){if(h.size<2)return;let t=1;const r=ba(h.data.subarray(t),!0);t+=r.length+1;const o=ba(h.data.subarray(t));return{key:h.type,info:r,data:o}}const e=ba(h.data);return{key:h.type,info:"",data:e}}function K_(h){return h.type==="PRIV"?Y_(h):h.type[0]==="W"?q_(h):h.type==="APIC"?V_(h):j_(h)}function z_(h){const e=String.fromCharCode(h[0],h[1],h[2],h[3]),t=$d(h,4),r=10;return{type:e,size:t,data:h.subarray(r,r+t)}}const vd=10,$_=10;function GE(h){let e=0;const t=[];for(;_m(h,e);){const r=$d(h,e+6);h[e+5]>>6&1&&(e+=vd),e+=vd;const o=e+r;for(;e+$_<o;){const l=z_(h.subarray(e)),f=K_(l);f&&t.push(f),e+=l.size+vd}ME(h,e)&&(e+=vd)}return t}function ZE(h){return h&&h.key==="PRIV"&&h.info==="com.apple.streaming.transportStreamTimestamp"}function W_(h){if(h.data.byteLength===8){const e=new Uint8Array(h.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}}function bm(h){const e=GE(h);for(let t=0;t<e.length;t++){const r=e[t];if(ZE(r))return W_(r)}}let Aa=(function(h){return h.audioId3="org.id3",h.dateRange="com.apple.quicktime.HLS",h.emsg="https://aomedia.org/emsg/ID3",h.misbklv="urn:misb:KLV:bin:1910.1",h})({});function Os(h="",e=9e4){return{type:h,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Rm{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,o){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=Ua(this.cachedData,e),this.cachedData=null);let r=Kc(e,0),o=r?r.length:0,l;const f=this._audioTrack,y=this._id3Track,g=r?bm(r):void 0,p=e.length;for((this.basePTS===null||this.frameIndex===0&&Nn(g))&&(this.basePTS=X_(g,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&y.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Aa.audioId3,duration:Number.POSITIVE_INFINITY});o<p;){if(this.canParse(e,o)){const m=this.appendFrame(f,e,o);m?(this.frameIndex++,this.lastPTS=m.sample.pts,o+=m.length,l=o):o=p}else U_(e,o)?(r=Kc(e,o),y.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Aa.audioId3,duration:Number.POSITIVE_INFINITY}),o+=r.length,l=o):o++;if(o===p&&l!==p){const m=e.slice(l);this.cachedData?this.cachedData=Ua(this.cachedData,m):this.cachedData=m}}return{audioTrack:f,videoTrack:Os(),id3Track:y,textTrack:Os()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Os(),id3Track:this._id3Track,textTrack:Os()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const X_=(h,e,t)=>{if(Nn(h))return h*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};let Ed=null;const Q_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],J_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],eA=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],tA=[0,1,1,4];function HE(h,e,t,r,o){if(t+24>e.length)return;const l=VE(e,t);if(l&&t+l.frameLength<=e.length){const f=l.samplesPerFrame*9e4/l.sampleRate,y=r+o*f,g={unit:e.subarray(t,t+l.frameLength),pts:y,dts:y};return h.config=[],h.channelCount=l.channelCount,h.samplerate=l.sampleRate,h.samples.push(g),{sample:g,length:l.frameLength,missing:0}}}function VE(h,e){const t=h[e+1]>>3&3,r=h[e+1]>>1&3,o=h[e+2]>>4&15,l=h[e+2]>>2&3;if(t!==1&&o!==0&&o!==15&&l!==3){const f=h[e+2]>>1&1,y=h[e+3]>>6,g=t===3?3-r:r===3?3:4,p=Q_[g*14+o-1]*1e3,u=J_[(t===3?0:t===2?1:2)*3+l],d=y===3?1:2,S=eA[t][r],_=tA[r],E=S*8*_,b=Math.floor(S*p/u+f)*_;if(Ed===null){const A=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ed=A?parseInt(A[1]):0}return!!Ed&&Ed<=87&&r===2&&p>=224e3&&y===0&&(h[e+3]=h[e+3]|128),{sampleRate:u,channelCount:d,frameLength:b,samplesPerFrame:E}}}function Im(h,e){return h[e]===255&&(h[e+1]&224)===224&&(h[e+1]&6)!==0}function YE(h,e){return e+1<h.length&&Im(h,e)}function nA(h,e){return Im(h,e)&&4<=h.length-e}function jE(h,e){if(e+1<h.length&&Im(h,e)){const r=VE(h,e);let o=4;r!=null&&r.frameLength&&(o=r.frameLength);const l=e+o;return l===h.length||YE(h,l)}return!1}class rA extends Rm{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,o){super.resetInitSegment(e,t,r,o),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:o,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const r=Kc(e,0);let o=(r==null?void 0:r.length)||0;if(jE(e,o))return!1;for(let l=e.length;o<l;o++)if(k_(e,o))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return P_(e,t)}appendFrame(e,t,r){FE(e,this.observer,t,r,e.manifestCodec);const o=BE(e,t,r,this.basePTS,this.frameIndex);if(o&&o.missing===0)return o}}const qE=(h,e)=>{let t=0,r=5;e+=r;const o=new Uint32Array(1),l=new Uint32Array(1),f=new Uint8Array(1);for(;r>0;){f[0]=h[e];const y=Math.min(r,8),g=8-y;l[0]=4278190080>>>24+g<<g,o[0]=(f[0]&l[0])>>g,t=t?t<<y|o[0]:o[0],e+=1,r-=y}return t};class iA extends Rm{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,o){super.resetInitSegment(e,t,r,o),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:o,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const o=KE(e,t,r,this.basePTS,this.frameIndex);if(o!==-1)return{sample:e.samples[e.samples.length-1],length:o,missing:0}}static probe(e){if(!e)return!1;const t=Kc(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&bm(t)!==void 0&&qE(e,r)<16}}function KE(h,e,t,r,o){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const l=e[t+4]>>6;if(l>=3)return-1;const y=[48e3,44100,32e3][l],g=e[t+4]&63,m=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][g*3+l]*2;if(t+m>e.length)return-1;const u=e[t+6]>>5;let d=0;u===2?d+=2:(u&1&&u!==1&&(d+=2),u&4&&(d+=2));const S=(e[t+6]<<8|e[t+7])>>12-d&1,E=[2,1,2,3,3,4,4,5][u]+S,b=e[t+5]>>3,I=e[t+5]&7,T=new Uint8Array([l<<6|b<<1|I>>2,(I&3)<<6|u<<3|S<<2|g>>4,g<<4&224]),A=1536/y*9e4,R=r+o*A,O=e.subarray(t,t+m);return h.config=T,h.channelCount=E,h.samplerate=y,h.samples.push({unit:O,pts:R}),m}class aA extends Rm{resetInitSegment(e,t,r,o){super.resetInitSegment(e,t,r,o),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:o,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Kc(e,0);let r=(t==null?void 0:t.length)||0;if(t&&e[r]===11&&e[r+1]===119&&bm(t)!==void 0&&qE(e,r)<=16)return!1;for(let o=e.length;r<o;r++)if(jE(e,r))return Mr.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return nA(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return HE(e,t,r,this.basePTS,this.frameIndex)}}const sA=/\/emsg[-/]ID3/i;class oA{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,o){const l=this.videoTrack=Os("video",1),f=this.audioTrack=Os("audio",1),y=this.txtTrack=Os("text",1);if(this.id3Track=Os("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const g=rE(e);if(g.video){const{id:p,timescale:m,codec:u,supplemental:d}=g.video;l.id=p,l.timescale=y.timescale=m,l.codec=u,l.supplemental=d}if(g.audio){const{id:p,timescale:m,codec:u}=g.audio;f.id=p,f.timescale=m,f.codec=u}y.id=eE.text,l.sampleDuration=0,l.duration=f.duration=o}resetContiguity(){this.remainderData=null}static probe(e){return iS(e)}demux(e,t){this.timeOffset=t;let r=e;const o=this.videoTrack,l=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=Ua(this.remainderData,e));const y=fS(r);this.remainderData=y.remainder,o.samples=y.valid||new Uint8Array}else o.samples=r;const f=this.extractID3Track(o,t);return l.samples=Oy(t,o),{videoTrack:o,audioTrack:this.audioTrack,id3Track:f,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const o=this.extractID3Track(t,this.timeOffset);return r.samples=Oy(e,t),{videoTrack:t,audioTrack:Os(),id3Track:o,textTrack:Os()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const o=sr(e.samples,["emsg"]);o&&o.forEach(l=>{const f=hS(l);if(sA.test(f.schemeIdUri)){const y=pv(f,t);let g=f.eventDuration===4294967295?Number.POSITIVE_INFINITY:f.eventDuration/f.timeScale;g<=.001&&(g=Number.POSITIVE_INFINITY);const p=f.payload;r.samples.push({data:p,len:p.byteLength,dts:y,pts:y,type:Aa.emsg,duration:g})}else if(this.config.enableEmsgKLVMetadata&&f.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const y=pv(f,t);r.samples.push({data:f.payload,len:f.payload.byteLength,dts:y,pts:y,type:Aa.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function pv(h,e){return Nn(h.presentationTime)?h.presentationTime/h.timeScale:e+h.presentationTimeDelta/h.timeScale}class lA{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new pm(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,nl.cbc)}decryptAacSample(e,t,r){const o=e[t].unit;if(o.length<=16)return;const l=o.subarray(16,o.length-o.length%16),f=l.buffer.slice(l.byteOffset,l.byteOffset+l.length);this.decryptBuffer(f).then(y=>{const g=new Uint8Array(y);o.set(g,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)}).catch(r)}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let o=0;for(let l=32;l<e.length-16;l+=160,o+=16)r.set(e.subarray(l,l+16),o);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let o=0;for(let l=32;l<e.length-16;l+=160,o+=16)e.set(r.subarray(o,o+16),l);return e}decryptAvcSample(e,t,r,o,l){const f=sE(l.data),y=this.getAvcEncryptedData(f);this.decryptBuffer(y.buffer).then(g=>{l.data=this.getAvcDecryptedUnit(f,g),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,o)}).catch(o)}decryptAvcSamples(e,t,r,o){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){o();return}const l=e[t].units;for(;!(r>=l.length);r++){const f=l[r];if(!(f.data.length<=48||f.type!==1&&f.type!==5)&&(this.decryptAvcSample(e,t,r,o,f),!this.decrypter.isSync()))return}}}}class zE{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,o;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const l=r.units;o=l[l.length-1]}return o}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,o=r.length;if(o){const l=r[o-1];e.pts=l.pts,e.dts=l.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){const o=t.byteLength;let l=e.naluState||0;const f=l,y=[];let g=0,p,m,u,d=-1,S=0;for(l===-1&&(d=0,S=this.getNALuType(t,0),l=0,g=1);g<o;){if(p=t[g++],!l){l=p?0:1;continue}if(l===1){l=p?0:2;continue}if(!p)l=3;else if(p===1){if(m=g-l-1,d>=0){const _={data:t.subarray(d,m),type:S};y.push(_)}else{const _=this.getLastNalUnit(e.samples);_&&(f&&g<=4-f&&_.state&&(_.data=_.data.subarray(0,_.data.byteLength-f)),m>0&&(_.data=Ua(_.data,t.subarray(0,m)),_.state=0))}g<o?(u=this.getNALuType(t,g),d=g,S=u,l=0):l=-1}else l=0}if(d>=0&&l>=0){const _={data:t.subarray(d,o),type:S,state:l};y.push(_)}if(y.length===0){const _=this.getLastNalUnit(e.samples);_&&(_.data=Ua(_.data,t))}return e.naluState=l,y}}class Zc{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,o=new Uint8Array(4),l=Math.min(4,t);if(l===0)throw new Error("no bytes available");o.set(e.subarray(r,r+l)),this.word=new DataView(o.buffer).getUint32(0),this.bitsAvailable=l*8,this.bytesAvailable-=l}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&Mr.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class uA extends zE{parsePES(e,t,r,o){const l=this.parseNALu(e,r.data,o);let f=this.VideoSample,y,g=!1;r.data=null,f&&l.length&&!e.audFound&&(this.pushAccessUnit(f,e),f=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),l.forEach(p=>{var m,u;switch(p.type){case 1:{let E=!1;y=!0;const b=p.data;if(g&&b.length>4){const I=this.readSliceType(b);(I===2||I===4||I===7||I===9)&&(E=!0)}if(E){var d;(d=f)!=null&&d.frame&&!f.key&&(this.pushAccessUnit(f,e),f=this.VideoSample=null)}f||(f=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),f.frame=!0,f.key=E;break}case 5:y=!0,(m=f)!=null&&m.frame&&!f.key&&(this.pushAccessUnit(f,e),f=this.VideoSample=null),f||(f=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),f.key=!0,f.frame=!0;break;case 6:{y=!0,dm(p.data,1,r.pts,t.samples);break}case 7:{var S,_;y=!0,g=!0;const E=p.data,b=this.readSPS(E);if(!e.sps||e.width!==b.width||e.height!==b.height||((S=e.pixelRatio)==null?void 0:S[0])!==b.pixelRatio[0]||((_=e.pixelRatio)==null?void 0:_[1])!==b.pixelRatio[1]){e.width=b.width,e.height=b.height,e.pixelRatio=b.pixelRatio,e.sps=[E];const I=E.subarray(1,4);let T="avc1.";for(let A=0;A<3;A++){let R=I[A].toString(16);R.length<2&&(R="0"+R),T+=R}e.codec=T}break}case 8:y=!0,e.pps=[p.data];break;case 9:y=!0,e.audFound=!0,(u=f)!=null&&u.frame&&(this.pushAccessUnit(f,e),f=null),f||(f=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:y=!0;break;default:y=!1;break}f&&y&&f.units.push(p)}),o&&f&&(this.pushAccessUnit(f,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new Zc(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,o=8,l;for(let f=0;f<e;f++)o!==0&&(l=t.readEG(),o=(r+l+256)%256),r=o===0?r:o}readSPS(e){const t=new Zc(e);let r=0,o=0,l=0,f=0,y,g,p;const m=t.readUByte.bind(t),u=t.readBits.bind(t),d=t.readUEG.bind(t),S=t.readBoolean.bind(t),_=t.skipBits.bind(t),E=t.skipEG.bind(t),b=t.skipUEG.bind(t),I=this.skipScalingList.bind(this);m();const T=m();if(u(5),_(3),m(),b(),T===100||T===110||T===122||T===244||T===44||T===83||T===86||T===118||T===128){const Z=d();if(Z===3&&_(1),b(),b(),_(1),S())for(g=Z!==3?8:12,p=0;p<g;p++)S()&&(p<6?I(16,t):I(64,t))}b();const A=d();if(A===0)d();else if(A===1)for(_(1),E(),E(),y=d(),p=0;p<y;p++)E();b(),_(1);const R=d(),O=d(),H=u(1);H===0&&_(1),_(1),S()&&(r=d(),o=d(),l=d(),f=d());let U=[1,1];if(S()&&S())switch(m()){case 1:U=[1,1];break;case 2:U=[12,11];break;case 3:U=[10,11];break;case 4:U=[16,11];break;case 5:U=[40,33];break;case 6:U=[24,11];break;case 7:U=[20,11];break;case 8:U=[32,11];break;case 9:U=[80,33];break;case 10:U=[18,11];break;case 11:U=[15,11];break;case 12:U=[64,33];break;case 13:U=[160,99];break;case 14:U=[4,3];break;case 15:U=[3,2];break;case 16:U=[2,1];break;case 255:{U=[m()<<8|m(),m()<<8|m()];break}}return{width:Math.ceil((R+1)*16-r*2-o*2),height:(2-H)*(O+1)*16-(H?2:4)*(l+f),pixelRatio:U}}}class cA extends zE{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,o){const l=this.parseNALu(e,r.data,o);let f=this.VideoSample,y,g=!1;r.data=null,f&&l.length&&!e.audFound&&(this.pushAccessUnit(f,e),f=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),l.forEach(p=>{var m,u;switch(p.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:f||(f=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),f.frame=!0,y=!0;break;case 16:case 17:case 18:case 21:if(y=!0,g){var d;(d=f)!=null&&d.frame&&!f.key&&(this.pushAccessUnit(f,e),f=this.VideoSample=null)}f||(f=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),f.key=!0,f.frame=!0;break;case 19:case 20:y=!0,(m=f)!=null&&m.frame&&!f.key&&(this.pushAccessUnit(f,e),f=this.VideoSample=null),f||(f=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),f.key=!0,f.frame=!0;break;case 39:y=!0,dm(p.data,2,r.pts,t.samples);break;case 32:y=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Gr(e.params,this.readVPS(p.data)),this.initVPS=p.data),e.vps=[p.data];break;case 33:if(y=!0,g=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],p.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const S=this.readSPS(p.data);e.width=S.width,e.height=S.height,e.pixelRatio=S.pixelRatio,e.codec=S.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const _ in S.params)e.params[_]=S.params[_]}this.pushParameterSet(e.sps,p.data,e.vps),f||(f=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),f.key=!0;break;case 34:if(y=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const S=this.readPPS(p.data);for(const _ in S)e.params[_]=S[_]}this.pushParameterSet(e.pps,p.data,e.vps)}break;case 35:y=!0,e.audFound=!0,(u=f)!=null&&u.frame&&(this.pushAccessUnit(f,e),f=null),f||(f=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:y=!1;break}f&&y&&f.units.push(p)}),o&&f&&(this.pushAccessUnit(f,e),this.VideoSample=null)}pushParameterSet(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let r=0;for(let o=0;o<e.byteLength;o++)o>=2&&e[o]===3&&e[o-1]===0&&e[o-2]===0||(t[r]=e[o],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Zc(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const r=t.readBits(3),o=t.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:o}}readSPS(e){const t=new Zc(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const r=t.readBits(3);t.readBoolean();const o=t.readBits(2),l=t.readBoolean(),f=t.readBits(5),y=t.readUByte(),g=t.readUByte(),p=t.readUByte(),m=t.readUByte(),u=t.readUByte(),d=t.readUByte(),S=t.readUByte(),_=t.readUByte(),E=t.readUByte(),b=t.readUByte(),I=t.readUByte(),T=[],A=[];for(let G=0;G<r;G++)T.push(t.readBoolean()),A.push(t.readBoolean());if(r>0)for(let G=r;G<8;G++)t.readBits(2);for(let G=0;G<r;G++)T[G]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),A[G]&&t.readUByte();t.readUEG();const R=t.readUEG();R==3&&t.skipBits(1);const O=t.readUEG(),H=t.readUEG(),U=t.readBoolean();let Z=0,$=0,F=0,W=0;U&&(Z+=t.readUEG(),$+=t.readUEG(),F+=t.readUEG(),W+=t.readUEG());const fe=t.readUEG(),ne=t.readUEG(),de=t.readUEG(),Te=t.readBoolean();for(let G=Te?0:r;G<=r;G++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let V=0;V<4;V++)for(let ye=0;ye<(V===3?2:6);ye++)if(!t.readBoolean())t.readUEG();else{const He=Math.min(64,1<<4+(V<<1));V>1&&t.readEG();for(let ut=0;ut<He;ut++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const Ie=t.readUEG();let Be=0;for(let G=0;G<Ie;G++){let V=!1;if(G!==0&&(V=t.readBoolean()),V){G===Ie&&t.readUEG(),t.readBoolean(),t.readUEG();let ye=0;for(let he=0;he<=Be;he++){const He=t.readBoolean();let ut=!1;He||(ut=t.readBoolean()),(He||ut)&&ye++}Be=ye}else{const ye=t.readUEG(),he=t.readUEG();Be=ye+he;for(let He=0;He<ye;He++)t.readUEG(),t.readBoolean();for(let He=0;He<he;He++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const G=t.readUEG();for(let V=0;V<G;V++){for(let ye=0;ye<de+4;ye++)t.readBits(1);t.readBits(1)}}let ee=0,_e=1,Ze=1,Ke=!0,De=1,Ge=0;t.readBoolean(),t.readBoolean();let Et=!1;if(t.readBoolean()){if(t.readBoolean()){const Je=t.readUByte(),Qe=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Ye=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Je>0&&Je<16?(_e=Qe[Je-1],Ze=Ye[Je-1]):Je===255&&(_e=t.readBits(16),Ze=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),Et=t.readBoolean(),Et&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(De=t.readBits(32),Ge=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const Ye=t.readBoolean(),nt=t.readBoolean();let mt=!1;(Ye||nt)&&(mt=t.readBoolean(),mt&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),mt&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let Gt=0;Gt<=r;Gt++){Ke=t.readBoolean();const _t=Ke||t.readBoolean();let gn=!1;_t?t.readEG():gn=t.readBoolean();const Wt=gn?1:t.readUEG()+1;if(Ye)for(let ln=0;ln<Wt;ln++)t.readUEG(),t.readUEG(),mt&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(nt)for(let ln=0;ln<Wt;ln++)t.readUEG(),t.readUEG(),mt&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),ee=t.readUEG())}let et=O,gt=H;if(U){let G=1,V=1;R===1?G=V=2:R==2&&(G=2),et=O-G*$-G*Z,gt=H-V*W-V*F}const Oe=o?["A","B","C"][o]:"",Fe=y<<24|g<<16|p<<8|m;let it=0;for(let G=0;G<32;G++)it=(it|(Fe>>G&1)<<31-G)>>>0;let w=it.toString(16);return f===1&&w==="2"&&(w="6"),{codecString:`hvc1.${Oe}${f}.${w}.${l?"H":"L"}${I}.B0`,params:{general_tier_flag:l,general_profile_idc:f,general_profile_space:o,general_profile_compatibility_flags:[y,g,p,m],general_constraint_indicator_flags:[u,d,S,_,E,b],general_level_idc:I,bit_depth:fe+8,bit_depth_luma_minus8:fe,bit_depth_chroma_minus8:ne,min_spatial_segmentation_idc:ee,chroma_format_idc:R,frame_rate:{fixed:Ke,fps:Ge/De}},width:et,height:gt,pixelRatio:[_e,Ze]}}readPPS(e){const t=new Zc(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const o=t.readBoolean(),l=t.readBoolean();let f=1;return l&&o?f=0:l?f=3:o&&(f=2),{parallelismType:f}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Ci=188;class Jo{constructor(e,t,r,o){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=o,this.videoParser=null}static probe(e,t){const r=Jo.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const t=e.length;let r=Math.min(Ci*5,t-Ci)+1,o=0;for(;o<r;){let l=!1,f=-1,y=0;for(let g=o;g<t;g+=Ci)if(e[g]===71&&(t-g===Ci||e[g+Ci]===71)){if(y++,f===-1&&(f=g,f!==0&&(r=Math.min(f+Ci*99,e.length-Ci)+1)),l||(l=Qg(e,g)===0),l&&y>1&&(f===0&&y>2||g+Ci>r))return f}else{if(y)return-1;break}o++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:eE[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,o){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Jo.createTrack("video"),this._videoTrack.duration=o,this._audioTrack=Jo.createTrack("audio",o),this._id3Track=Jo.createTrack("id3"),this._txtTrack=Jo.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,o=!1){r||(this.sampleAes=null);let l;const f=this._videoTrack,y=this._audioTrack,g=this._id3Track,p=this._txtTrack;let m=f.pid,u=f.pesData,d=y.pid,S=g.pid,_=y.pesData,E=g.pesData,b=null,I=this.pmtParsed,T=this._pmtId,A=e.length;if(this.remainderData&&(e=Ua(this.remainderData,e),A=e.length,this.remainderData=null),A<Ci&&!o)return this.remainderData=e,{audioTrack:y,videoTrack:f,id3Track:g,textTrack:p};const R=Math.max(0,Jo.syncOffset(e));A-=(A-R)%Ci,A<e.byteLength&&!o&&(this.remainderData=new Uint8Array(e.buffer,A,e.buffer.byteLength-A));let O=0;for(let U=R;U<A;U+=Ci)if(e[U]===71){const Z=!!(e[U+1]&64),$=Qg(e,U),F=(e[U+3]&48)>>4;let W;if(F>1){if(W=U+5+e[U+4],W===U+Ci)continue}else W=U+4;switch($){case m:Z&&(u&&(l=Du(u,this.logger))&&(this.readyVideoParser(f.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(f,p,l,!1)),u={data:[],size:0}),u&&(u.data.push(e.subarray(W,U+Ci)),u.size+=U+Ci-W);break;case d:if(Z){if(_&&(l=Du(_,this.logger)))switch(y.segmentCodec){case"aac":this.parseAACPES(y,l);break;case"mp3":this.parseMPEGPES(y,l);break;case"ac3":this.parseAC3PES(y,l);break}_={data:[],size:0}}_&&(_.data.push(e.subarray(W,U+Ci)),_.size+=U+Ci-W);break;case S:Z&&(E&&(l=Du(E,this.logger))&&this.parseID3PES(g,l),E={data:[],size:0}),E&&(E.data.push(e.subarray(W,U+Ci)),E.size+=U+Ci-W);break;case 0:Z&&(W+=e[W]+1),T=this._pmtId=fA(e,W);break;case T:{Z&&(W+=e[W]+1);const fe=dA(e,W,this.typeSupported,r,this.observer,this.logger);m=fe.videoPid,m>0&&(f.pid=m,f.segmentCodec=fe.segmentVideoCodec),d=fe.audioPid,d>0&&(y.pid=d,y.segmentCodec=fe.segmentAudioCodec),S=fe.id3Pid,S>0&&(g.pid=S),b!==null&&!I&&(this.logger.warn(`MPEG-TS PMT found at ${U} after unknown PID '${b}'. Backtracking to sync byte @${R} to parse all TS packets.`),b=null,U=R-188),I=this.pmtParsed=!0;break}case 17:case 8191:break;default:b=$;break}}else O++;O>0&&Jg(this.observer,new Error(`Found ${O} TS packet/s that do not start with 0x47`),void 0,this.logger),f.pesData=u,y.pesData=_,g.pesData=E;const H={audioTrack:y,videoTrack:f,id3Track:g,textTrack:p};return o&&this.extractRemainingSamples(H),H}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:o,textTrack:l}=e,f=r.pesData,y=t.pesData,g=o.pesData;let p;if(f&&(p=Du(f,this.logger))?(this.readyVideoParser(r.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(r,l,p,!0),r.pesData=null)):r.pesData=f,y&&(p=Du(y,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,p);break;case"mp3":this.parseMPEGPES(t,p);break;case"ac3":this.parseAC3PES(t,p);break}t.pesData=null}else y!=null&&y.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=y;g&&(p=Du(g,this.logger))?(this.parseID3PES(o,p),o.pesData=null):o.pesData=g}demuxSampleAes(e,t,r){const o=this.demux(e,r,!0,!this.config.progressive),l=this.sampleAes=new lA(this.observer,this.config,t);return this.decrypt(o,l)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new uA:e==="hevc"&&(this.videoParser=new cA))}decrypt(e,t){return new Promise(r=>{const{audioTrack:o,videoTrack:l}=e;o.samples&&o.segmentCodec==="aac"?t.decryptAacSamples(o.samples,0,()=>{l.samples?t.decryptAvcSamples(l.samples,0,0,()=>{r(e)}):r(e)}):l.samples&&t.decryptAvcSamples(l.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r=0;const o=this.aacOverFlow;let l=t.data;if(o){this.aacOverFlow=null;const u=o.missing,d=o.sample.unit.byteLength;if(u===-1)l=Ua(o.sample.unit,l);else{const S=d-u;o.sample.unit.set(l.subarray(0,u),S),e.samples.push(o.sample),r=o.missing}}let f,y;for(f=r,y=l.length;f<y-1&&!qd(l,f);f++);if(f!==r){let u;const d=f<y-1;if(d?u=`AAC PES did not start with ADTS header,offset:${f}`:u="No ADTS header found in AAC PES",Jg(this.observer,new Error(u),d,this.logger),!d)return}FE(e,this.observer,l,f,this.audioCodec);let g;if(t.pts!==void 0)g=t.pts;else if(o){const u=UE(e.samplerate);g=o.sample.pts+u}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let p=0,m;for(;f<y;)if(m=BE(e,l,f,g,p),f+=m.length,m.missing){this.aacOverFlow=m;break}else for(p++;f<y-1&&!qd(l,f);f++);}parseMPEGPES(e,t){const r=t.data,o=r.length;let l=0,f=0;const y=t.pts;if(y===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;f<o;)if(YE(r,f)){const g=HE(e,r,f,y,l);if(g)f+=g.length,l++;else break}else f++}parseAC3PES(e,t){{const r=t.data,o=t.pts;if(o===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const l=r.length;let f=0,y=0,g;for(;y<l&&(g=KE(e,r,y,o,f++))>0;)y+=g}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=Gr({},t,{type:this._videoTrack?Aa.emsg:Aa.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function Qg(h,e){return((h[e+1]&31)<<8)+h[e+2]}function fA(h,e){return(h[e+10]&31)<<8|h[e+11]}function dA(h,e,t,r,o,l){const f={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},y=(h[e+1]&15)<<8|h[e+2],g=e+3+y-4,p=(h[e+10]&15)<<8|h[e+11];for(e+=12+p;e<g;){const m=Qg(h,e),u=(h[e+3]&15)<<8|h[e+4];switch(h[e]){case 207:if(!r){Cg("ADTS AAC",l);break}case 15:f.audioPid===-1&&(f.audioPid=m);break;case 21:f.id3Pid===-1&&(f.id3Pid=m);break;case 219:if(!r){Cg("H.264",l);break}case 27:f.videoPid===-1&&(f.videoPid=m);break;case 3:case 4:!t.mpeg&&!t.mp3?l.log("MPEG audio found, not supported in this browser"):f.audioPid===-1&&(f.audioPid=m,f.segmentAudioCodec="mp3");break;case 193:if(!r){Cg("AC-3",l);break}case 129:t.ac3?f.audioPid===-1&&(f.audioPid=m,f.segmentAudioCodec="ac3"):l.log("AC-3 audio found, not supported in this browser");break;case 6:if(f.audioPid===-1&&u>0){let d=e+5,S=u;for(;S>2;){switch(h[d]){case 106:t.ac3!==!0?l.log("AC-3 audio found, not supported in this browser for now"):(f.audioPid=m,f.segmentAudioCodec="ac3");break}const E=h[d+1]+2;d+=E,S-=E}}break;case 194:case 135:return Jg(o,new Error("Unsupported EC-3 in M2TS found"),void 0,l),f;case 36:f.videoPid===-1&&(f.videoPid=m,f.segmentVideoCodec="hevc",l.log("HEVC in M2TS found"));break}e+=u+5}return f}function Jg(h,e,t,r){r.warn(`parsing error: ${e.message}`),h.emit(pe.ERROR,pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Cg(h,e){e.log(`${h} with AES-128-CBC encryption found in unencrypted stream`)}function Du(h,e){let t=0,r,o,l,f,y;const g=h.data;if(!h||h.size===0)return null;for(;g[0].length<19&&g.length>1;)g[0]=Ua(g[0],g[1]),g.splice(1,1);if(r=g[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(o=(r[4]<<8)+r[5],o&&o>h.size-6)return null;const m=r[7];m&192&&(f=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,m&64?(y=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,f-y>60*9e4&&(e.warn(`${Math.round((f-y)/9e4)}s delta between PTS and DTS, align them`),f=y)):y=f),l=r[8];let u=l+9;if(h.size<=u)return null;h.size-=u;const d=new Uint8Array(h.size);for(let S=0,_=g.length;S<_;S++){r=g[S];let E=r.byteLength;if(u)if(u>E){u-=E;continue}else r=r.subarray(u),E-=u,u=0;d.set(r,t),t+=E}return o&&(o-=l+3),{data:d,pts:f,dts:y,len:o}}return null}class hA{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Wo=Math.pow(2,32)-1;class Lt{static init(){Lt.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Lt.types)Lt.types.hasOwnProperty(e)&&(Lt.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Lt.HDLR_TYPES={video:t,audio:r};const o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),l=new Uint8Array([0,0,0,0,0,0,0,0]);Lt.STTS=Lt.STSC=Lt.STCO=l,Lt.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Lt.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Lt.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Lt.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const f=new Uint8Array([105,115,111,109]),y=new Uint8Array([97,118,99,49]),g=new Uint8Array([0,0,0,1]);Lt.FTYP=Lt.box(Lt.types.ftyp,f,g,f,y),Lt.DINF=Lt.box(Lt.types.dinf,Lt.box(Lt.types.dref,o))}static box(e,...t){let r=8,o=t.length;const l=o;for(;o--;)r+=t[o].byteLength;const f=new Uint8Array(r);for(f[0]=r>>24&255,f[1]=r>>16&255,f[2]=r>>8&255,f[3]=r&255,f.set(e,4),o=0,r=8;o<l;o++)f.set(t[o],r),r+=t[o].byteLength;return f}static hdlr(e){return Lt.box(Lt.types.hdlr,Lt.HDLR_TYPES[e])}static mdat(e){return Lt.box(Lt.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(Wo+1)),o=Math.floor(t%(Wo+1));return Lt.box(Lt.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,o>>24,o>>16&255,o>>8&255,o&255,85,196,0,0]))}static mdia(e){return Lt.box(Lt.types.mdia,Lt.mdhd(e.timescale||0,e.duration||0),Lt.hdlr(e.type),Lt.minf(e))}static mfhd(e){return Lt.box(Lt.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Lt.box(Lt.types.minf,Lt.box(Lt.types.smhd,Lt.SMHD),Lt.DINF,Lt.stbl(e)):Lt.box(Lt.types.minf,Lt.box(Lt.types.vmhd,Lt.VMHD),Lt.DINF,Lt.stbl(e))}static moof(e,t,r){return Lt.box(Lt.types.moof,Lt.mfhd(e),Lt.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=Lt.trak(e[t]);return Lt.box.apply(null,[Lt.types.moov,Lt.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(Lt.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=Lt.trex(e[t]);return Lt.box.apply(null,[Lt.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(Wo+1)),o=Math.floor(t%(Wo+1)),l=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,o>>24,o>>16&255,o>>8&255,o&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Lt.box(Lt.types.mvhd,l)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let o,l;for(o=0;o<t.length;o++)l=t[o].flags,r[o+4]=l.dependsOn<<4|l.isDependedOn<<2|l.hasRedundancy;return Lt.box(Lt.types.sdtp,r)}static stbl(e){return Lt.box(Lt.types.stbl,Lt.stsd(e),Lt.box(Lt.types.stts,Lt.STTS),Lt.box(Lt.types.stsc,Lt.STSC),Lt.box(Lt.types.stsz,Lt.STSZ),Lt.box(Lt.types.stco,Lt.STCO))}static avc1(e){let t=[],r=[],o,l,f;for(o=0;o<e.sps.length;o++)l=e.sps[o],f=l.byteLength,t.push(f>>>8&255),t.push(f&255),t=t.concat(Array.prototype.slice.call(l));for(o=0;o<e.pps.length;o++)l=e.pps[o],f=l.byteLength,r.push(f>>>8&255),r.push(f&255),r=r.concat(Array.prototype.slice.call(l));const y=Lt.box(Lt.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),g=e.width,p=e.height,m=e.pixelRatio[0],u=e.pixelRatio[1];return Lt.box(Lt.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,g>>8&255,g&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),y,Lt.box(Lt.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Lt.box(Lt.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,u>>24,u>>16&255,u>>8&255,u&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Lt.box(Lt.types.mp4a,Lt.audioStsd(e),Lt.box(Lt.types.esds,Lt.esds(e)))}static mp3(e){return Lt.box(Lt.types[".mp3"],Lt.audioStsd(e))}static ac3(e){return Lt.box(Lt.types["ac-3"],Lt.audioStsd(e),Lt.box(Lt.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return Lt.box(Lt.types.stsd,Lt.STSD,Lt.mp4a(e));if(t==="ac3"&&e.config)return Lt.box(Lt.types.stsd,Lt.STSD,Lt.ac3(e));if(t==="mp3"&&e.codec==="mp3")return Lt.box(Lt.types.stsd,Lt.STSD,Lt.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return Lt.box(Lt.types.stsd,Lt.STSD,Lt.avc1(e));if(t==="hevc"&&e.vps)return Lt.box(Lt.types.stsd,Lt.STSD,Lt.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,r=(e.duration||0)*(e.timescale||0),o=e.width||0,l=e.height||0,f=Math.floor(r/(Wo+1)),y=Math.floor(r%(Wo+1));return Lt.box(Lt.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,f>>24,f>>16&255,f>>8&255,f&255,y>>24,y>>16&255,y>>8&255,y&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,o&255,0,0,l>>8&255,l&255,0,0]))}static traf(e,t){const r=Lt.sdtp(e),o=e.id,l=Math.floor(t/(Wo+1)),f=Math.floor(t%(Wo+1));return Lt.box(Lt.types.traf,Lt.box(Lt.types.tfhd,new Uint8Array([0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255])),Lt.box(Lt.types.tfdt,new Uint8Array([1,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,f>>24,f>>16&255,f>>8&255,f&255])),Lt.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,Lt.box(Lt.types.trak,Lt.tkhd(e),Lt.mdia(e))}static trex(e){const t=e.id;return Lt.box(Lt.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],o=r.length,l=12+16*o,f=new Uint8Array(l);let y,g,p,m,u,d;for(t+=8+l,f.set([e.type==="video"?1:0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,o&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),y=0;y<o;y++)g=r[y],p=g.duration,m=g.size,u=g.flags,d=g.cts,f.set([p>>>24&255,p>>>16&255,p>>>8&255,p&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.paddingValue<<1|u.isNonSync,u.degradPrio&61440,u.degradPrio&15,d>>>24&255,d>>>16&255,d>>>8&255,d&255],12+16*y);return Lt.box(Lt.types.trun,f)}static initSegment(e){Lt.types||Lt.init();const t=Lt.moov(e);return Ua(Lt.FTYP,t)}static hvc1(e){const t=e.params,r=[e.vps,e.sps,e.pps],o=4,l=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),o-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]);let f=l.length;for(let _=0;_<r.length;_+=1){f+=3;for(let E=0;E<r[_].length;E+=1)f+=2+r[_][E].length}const y=new Uint8Array(f);y.set(l,0),f=l.length;const g=r.length-1;for(let _=0;_<r.length;_+=1){y.set(new Uint8Array([32+_|(_===g?128:0),0,r[_].length]),f),f+=3;for(let E=0;E<r[_].length;E+=1)y.set(new Uint8Array([r[_][E].length>>8,r[_][E].length&255]),f),f+=2,y.set(r[_][E],f),f+=r[_][E].length}const p=Lt.box(Lt.types.hvcC,y),m=e.width,u=e.height,d=e.pixelRatio[0],S=e.pixelRatio[1];return Lt.box(Lt.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,m&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),p,Lt.box(Lt.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Lt.box(Lt.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,S>>24,S>>16&255,S>>8&255,S&255])))}}Lt.types=void 0;Lt.HDLR_TYPES=void 0;Lt.STTS=void 0;Lt.STSC=void 0;Lt.STCO=void 0;Lt.STSZ=void 0;Lt.VMHD=void 0;Lt.SMHD=void 0;Lt.STSD=void 0;Lt.FTYP=void 0;Lt.DINF=void 0;const $E=9e4;function Cm(h,e,t=1,r=!1){const o=h*e*t;return r?Math.round(o):o}function gA(h,e,t=1,r=!1){return Cm(h,e,1/t,r)}function Uc(h,e=!1){return Cm(h,1e3,1/$E,e)}function mA(h,e=1){return Cm(h,$E,1/e)}function yv(h){const{baseTime:e,timescale:t,trackId:r}=h;return`${e/t} (${e}/${t}) trackId: ${r}`}const pA=10*1e3,yA=1024,vA=1152,EA=1536;let Lu=null,Dg=null;function vv(h,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:h?2:1,isNonSync:h?0:1}}}class wd extends Ba{constructor(e,t,r,o){if(super("mp4-remuxer",o),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,Lu===null){const f=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Lu=f?parseInt(f[1]):0}if(Dg===null){const l=navigator.userAgent.match(/Safari\/(\d+)/i);Dg=l?parseInt(l[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&yv(t)} > ${e&&yv(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e[0].pts,o=e.reduce((l,f)=>{let y=f.pts,g=y-l;return g<-4294967296&&(t=!0,y=_a(y,r),g=y-l),g>0?l:y},r);return t&&this.debug("PTS rollover detected"),o}remux(e,t,r,o,l,f,y,g){let p,m,u,d,S,_,E=l,b=l;const I=e.pid>-1,T=t.pid>-1,A=t.samples.length,R=e.samples.length>0,O=y&&A>0||A>1;if((!I||R)&&(!T||O)||this.ISGenerated||y){if(this.ISGenerated){var U,Z,$,F;const de=this.videoTrackConfig;(de&&(t.width!==de.width||t.height!==de.height||((U=t.pixelRatio)==null?void 0:U[0])!==((Z=de.pixelRatio)==null?void 0:Z[0])||(($=t.pixelRatio)==null?void 0:$[1])!==((F=de.pixelRatio)==null?void 0:F[1]))||!de&&O||this.nextAudioTs===null&&R)&&this.resetInitSegment()}this.ISGenerated||(u=this.generateIS(e,t,l,f));const W=this.isVideoContiguous;let fe=-1,ne;if(O&&(fe=TA(t.samples),!W&&this.config.forceKeyFrameOnDiscontinuity))if(_=!0,fe>0){this.warn(`Dropped ${fe} out of ${A} video samples due to a missing keyframe`);const de=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(fe),t.dropped+=fe,b+=(t.samples[0].pts-de)/t.inputTimeScale,ne=b}else fe===-1&&(this.warn(`No keyframe found out of ${A} video samples`),_=!1);if(this.ISGenerated){if(R&&O){const de=this.getVideoStartPts(t.samples),me=(_a(e.samples[0].pts,de)-de)/t.inputTimeScale;E+=Math.max(0,me),b+=Math.max(0,-me)}if(R){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),u=this.generateIS(e,t,l,f)),m=this.remuxAudio(e,E,this.isAudioContiguous,f,T||O||g===Pn.AUDIO?b:void 0),O){const de=m?m.endPTS-m.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),u=this.generateIS(e,t,l,f)),p=this.remuxVideo(t,b,W,de)}}else O&&(p=this.remuxVideo(t,b,W,0));p&&(p.firstKeyFrame=fe,p.independent=fe!==-1,p.firstKeyFramePTS=ne)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(S=WE(r,l,this._initPTS,this._initDTS)),o.samples.length&&(d=XE(o,l,this._initPTS))),{audio:m,video:p,initSegment:u,independent:_,text:d,id3:S}}computeInitPts(e,t,r,o){const l=Math.round(r*t);let f=_a(e,l);if(f<l+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(l-f)/t} ${o}`);f<l+t;)f+=8589934592;return f-l}generateIS(e,t,r,o){const l=e.samples,f=t.samples,y=this.typeSupported,g={},p=this._initPTS;let m=!p||o,u="audio/mp4",d,S,_,E=-1;if(m&&(d=S=1/0),e.config&&l.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":y.mpeg?(u="audio/mpeg",e.codec=""):y.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}g.audio={id:"audio",container:u,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&y.mpeg?new Uint8Array(0):Lt.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(E=e.id,_=e.inputTimeScale,!p||_!==p.timescale?d=S=this.computeInitPts(l[0].pts,_,r,"audio"):m=!1)}if(t.sps&&t.pps&&f.length){if(t.timescale=t.inputTimeScale,g.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Lt.initSegment([t]),metadata:{width:t.width,height:t.height}},m)if(E=t.id,_=t.inputTimeScale,!p||_!==p.timescale){const b=this.getVideoStartPts(f),I=_a(f[0].dts,b),T=this.computeInitPts(I,_,r,"video"),A=this.computeInitPts(b,_,r,"video");S=Math.min(S,T),d=Math.min(d,A)}else m=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(g).length)return this.ISGenerated=!0,m?(p&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${r} ${d/_} != initPTS: ${p.baseTime/p.timescale} (${p.baseTime}/${p.timescale}) trackId: ${p.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${d/_} (${d}/${_}) trackId: ${E}`),this._initPTS={baseTime:d,timescale:_,trackId:E},this._initDTS={baseTime:S,timescale:_,trackId:E}):d=_=void 0,{tracks:g,initPTS:d,timescale:_,trackId:E}}remuxVideo(e,t,r,o){const l=e.inputTimeScale,f=e.samples,y=[],g=f.length,p=this._initPTS,m=p.baseTime*l/p.timescale;let u=this.nextVideoTs,d=8,S=this.videoSampleDuration,_,E,b=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,T=!1;if(!r||u===null){const ee=m+t*l,_e=f[0].pts-_a(f[0].dts,f[0].pts);Lu&&u!==null&&Math.abs(ee-_e-(u+m))<15e3?r=!0:u=ee-_e-m}const A=u+m;for(let ee=0;ee<g;ee++){const _e=f[ee];_e.pts=_a(_e.pts,A),_e.dts=_a(_e.dts,A),_e.dts<f[ee>0?ee-1:ee].dts&&(T=!0)}T&&f.sort(function(ee,_e){const Ze=ee.dts-_e.dts,Ke=ee.pts-_e.pts;return Ze||Ke}),_=f[0].dts,E=f[f.length-1].dts;const R=E-_,O=R?Math.round(R/(g-1)):S||e.inputTimeScale/30;if(r){const ee=_-A,_e=ee>O,Ze=ee<-1;if((_e||Ze)&&(_e?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Uc(ee,!0)} ms (${ee}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Uc(-ee,!0)} ms (${ee}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!Ze||A>=f[0].pts||Lu)){_=A;const Ke=f[0].pts-ee;if(_e)f[0].dts=_,f[0].pts=Ke;else{let De=!0;for(let Ge=0;Ge<f.length&&!(f[Ge].dts>Ke&&De);Ge++){const Et=f[Ge].pts;if(f[Ge].dts-=ee,f[Ge].pts-=ee,Ge<f.length-1){const vt=f[Ge+1].pts,et=f[Ge].pts,gt=vt<=et,Oe=vt<=Et;De=gt==Oe}}}this.log(`Video: Initial PTS/DTS adjusted: ${Uc(Ke,!0)}/${Uc(_,!0)}, delta: ${Uc(ee,!0)} ms`)}}_=Math.max(0,_);let H=0,U=0,Z=_;for(let ee=0;ee<g;ee++){const _e=f[ee],Ze=_e.units,Ke=Ze.length;let De=0;for(let Ge=0;Ge<Ke;Ge++)De+=Ze[Ge].data.length;U+=De,H+=Ke,_e.length=De,_e.dts<Z?(_e.dts=Z,Z+=O/4|0||1):Z=_e.dts,b=Math.min(_e.pts,b),I=Math.max(_e.pts,I)}E=f[g-1].dts;const $=U+4*H+8;let F;try{F=new Uint8Array($)}catch(ee){this.observer.emit(pe.ERROR,pe.ERROR,{type:jn.MUX_ERROR,details:wt.REMUX_ALLOC_ERROR,fatal:!1,error:ee,bytes:$,reason:`fail allocating video mdat ${$}`});return}const W=new DataView(F.buffer);W.setUint32(0,$),F.set(Lt.types.mdat,4);let fe=!1,ne=Number.POSITIVE_INFINITY,de=Number.POSITIVE_INFINITY,Te=Number.NEGATIVE_INFINITY,me=Number.NEGATIVE_INFINITY;for(let ee=0;ee<g;ee++){const _e=f[ee],Ze=_e.units;let Ke=0;for(let Et=0,vt=Ze.length;Et<vt;Et++){const et=Ze[Et],gt=et.data,Oe=et.data.byteLength;W.setUint32(d,Oe),d+=4,F.set(gt,d),d+=Oe,Ke+=4+Oe}let De;if(ee<g-1)S=f[ee+1].dts-_e.dts,De=f[ee+1].pts-_e.pts;else{const Et=this.config,vt=ee>0?_e.dts-f[ee-1].dts:O;if(De=ee>0?_e.pts-f[ee-1].pts:O,Et.stretchShortVideoTrack&&this.nextAudioTs!==null){const et=Math.floor(Et.maxBufferHole*l),gt=(o?b+o*l:this.nextAudioTs+m)-_e.pts;gt>et?(S=gt-vt,S<0?S=vt:fe=!0,this.log(`It is approximately ${gt/90} ms to the next segment; using duration ${S/90} ms for the last video frame.`)):S=vt}else S=vt}const Ge=Math.round(_e.pts-_e.dts);ne=Math.min(ne,S),Te=Math.max(Te,S),de=Math.min(de,De),me=Math.max(me,De),y.push(vv(_e.key,S,Ke,Ge))}if(y.length){if(Lu){if(Lu<70){const ee=y[0].flags;ee.dependsOn=2,ee.isNonSync=0}}else if(Dg&&me-de<Te-ne&&O/Te<.025&&y[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let ee=_;for(let _e=0,Ze=y.length;_e<Ze;_e++){const Ke=ee+y[_e].duration,De=ee+y[_e].cts;if(_e<Ze-1){const Ge=Ke+y[_e+1].cts;y[_e].duration=Ge-De}else y[_e].duration=_e?y[_e-1].duration:O;y[_e].cts=0,ee=Ke}}}S=fe||!S?O:S;const X=E+S;this.nextVideoTs=u=X-m,this.videoSampleDuration=S,this.isVideoContiguous=!0;const qe={data1:Lt.moof(e.sequenceNumber++,_,Gr(e,{samples:y})),data2:F,startPTS:(b-m)/l,endPTS:(I+S-m)/l,startDTS:(_-m)/l,endDTS:u/l,type:"video",hasAudio:!1,hasVideo:!0,nb:y.length,dropped:e.dropped};return e.samples=[],e.dropped=0,qe}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return vA;case"ac3":return EA;default:return yA}}remuxAudio(e,t,r,o,l){const f=e.inputTimeScale,y=e.samplerate?e.samplerate:f,g=f/y,p=this.getSamplesPerFrame(e),m=p*g,u=this._initPTS,d=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,S=[],_=l!==void 0;let E=e.samples,b=d?0:8,I=this.nextAudioTs||-1;const T=u.baseTime*f/u.timescale,A=T+t*f;if(this.isAudioContiguous=r=r||E.length&&I>0&&(o&&Math.abs(A-(I+T))<9e3||Math.abs(_a(E[0].pts,A)-(I+T))<20*m),E.forEach(function(me){me.pts=_a(me.pts,A)}),!r||I<0){const me=E.length;if(E=E.filter(X=>X.pts>=0),me!==E.length&&this.warn(`Removed ${E.length-me} of ${me} samples (initPTS ${T} / ${f})`),!E.length)return;l===0?I=0:o&&!_?I=Math.max(0,A-T):I=E[0].pts-T}if(e.segmentCodec==="aac"){const me=this.config.maxAudioFramesDrift;for(let X=0,Ie=I+T;X<E.length;X++){const Be=E[X],qe=Be.pts,ee=qe-Ie,_e=Math.abs(1e3*ee/f);if(ee<=-me*m&&_)X===0&&(this.warn(`Audio frame @ ${(qe/f).toFixed(3)}s overlaps marker by ${Math.round(1e3*ee/f)} ms.`),this.nextAudioTs=I=qe-T,Ie=qe);else if(ee>=me*m&&_e<pA&&_){let Ze=Math.round(ee/m);for(Ie=qe-Ze*m;Ie<0&&Ze&&m;)Ze--,Ie+=m;X===0&&(this.nextAudioTs=I=Ie-T),this.warn(`Injecting ${Ze} audio frames @ ${((Ie-T)/f).toFixed(3)}s due to ${Math.round(1e3*ee/f)} ms gap.`);for(let Ke=0;Ke<Ze;Ke++){let De=hA.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);De||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),De=Be.unit.subarray()),E.splice(X,0,{unit:De,pts:Ie}),Ie+=m,X++}}Be.pts=Ie,Ie+=m}}let R=null,O=null,H,U=0,Z=E.length;for(;Z--;)U+=E[Z].unit.byteLength;for(let me=0,X=E.length;me<X;me++){const Ie=E[me],Be=Ie.unit;let qe=Ie.pts;if(O!==null){const _e=S[me-1];_e.duration=Math.round((qe-O)/g)}else if(r&&e.segmentCodec==="aac"&&(qe=I+T),R=qe,U>0){U+=b;try{H=new Uint8Array(U)}catch(_e){this.observer.emit(pe.ERROR,pe.ERROR,{type:jn.MUX_ERROR,details:wt.REMUX_ALLOC_ERROR,fatal:!1,error:_e,bytes:U,reason:`fail allocating audio mdat ${U}`});return}d||(new DataView(H.buffer).setUint32(0,U),H.set(Lt.types.mdat,4))}else return;H.set(Be,b);const ee=Be.byteLength;b+=ee,S.push(vv(!0,p,ee,0)),O=qe}const $=S.length;if(!$)return;const F=S[S.length-1];I=O-T,this.nextAudioTs=I+g*F.duration;const W=d?new Uint8Array(0):Lt.moof(e.sequenceNumber++,R/g,Gr({},e,{samples:S}));e.samples=[];const fe=(R-T)/f,ne=this.nextAudioTs/f,Te={data1:W,data2:H,startPTS:fe,endPTS:ne,startDTS:fe,endDTS:ne,type:"audio",hasAudio:!0,hasVideo:!1,nb:$};return this.isAudioContiguous=!0,Te}}function _a(h,e){let t;if(e===null)return h;for(e<h?t=-8589934592:t=8589934592;Math.abs(h-e)>4294967296;)h+=t;return h}function TA(h){for(let e=0;e<h.length;e++)if(h[e].key)return e;return-1}function WE(h,e,t,r){const o=h.samples.length;if(!o)return;const l=h.inputTimeScale;for(let y=0;y<o;y++){const g=h.samples[y];g.pts=_a(g.pts-t.baseTime*l/t.timescale,e*l)/l,g.dts=_a(g.dts-r.baseTime*l/r.timescale,e*l)/l}const f=h.samples;return h.samples=[],{samples:f}}function XE(h,e,t){const r=h.samples.length;if(!r)return;const o=h.inputTimeScale;for(let f=0;f<r;f++){const y=h.samples[f];y.pts=_a(y.pts-t.baseTime*o/t.timescale,e*o)/o}h.samples.sort((f,y)=>f.pts-y.pts);const l=h.samples;return h.samples=[],{samples:l}}class SA extends Ba{constructor(e,t,r,o){super("passthrough-remuxer",o),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,o){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(e,o),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:r,videoCodec:o}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:l,video:f}=this.initData=rE(e);if(t)lS(e,t);else{const g=l||f;g!=null&&g.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${g.codec}")!`)}l&&(r=Ev(l,jr.AUDIO,this)),f&&(o=Ev(f,jr.VIDEO,this));const y={};l&&f?y.audiovideo={container:"video/mp4",codec:r+","+o,supplemental:f.supplemental,encrypted:f.encrypted,initSegment:e,id:"main"}:l?y.audio={container:"audio/mp4",codec:r,encrypted:l.encrypted,initSegment:e,id:"audio"}:f?y.video={container:"video/mp4",codec:o,supplemental:f.supplemental,encrypted:f.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=y}remux(e,t,r,o,l,f){var y,g;let{initPTS:p,lastEndTime:m}=this;const u={audio:void 0,video:void 0,text:o,id3:r,initSegment:void 0};Nn(m)||(m=this.lastEndTime=l||0);const d=t.samples;if(!d.length)return u;const S={initPTS:void 0,timescale:void 0,trackId:void 0};let _=this.initData;if((y=_)!=null&&y.length||(this.generateInitSegment(d),_=this.initData),!((g=_)!=null&&g.length))return this.warn("Failed to generate initSegment."),u;this.emitInitSegment&&(S.tracks=this.initTracks,this.emitInitSegment=!1);const E=cS(d,_,this),b=_.audio?E[_.audio.id]:null,I=_.video?E[_.video.id]:null,T=Td(I,1/0),A=Td(b,1/0),R=Td(I,0,!0),O=Td(b,0,!0);let H=l,U=0;const Z=b&&(!I||!p&&A<T||p&&p.trackId===_.audio.id),$=Z?b:I;if($){const Ie=$.timescale,Be=$.start-l*Ie,qe=Z?_.audio.id:_.video.id;H=$.start/Ie,U=Z?O-A:R-T,(f||!p)&&(_A(p,H,l,U)||Ie!==p.timescale)&&(p&&this.warn(`Timestamps at playlist time: ${f?"":"~"}${l} ${Be/Ie} != initPTS: ${p.baseTime/p.timescale} (${p.baseTime}/${p.timescale}) trackId: ${p.trackId}`),this.log(`Found initPTS at playlist time: ${l} offset: ${H-l} (${Be}/${Ie}) trackId: ${qe}`),p=null,S.initPTS=Be,S.timescale=Ie,S.trackId=qe)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${l}`);p?(S.initPTS=p.baseTime,S.timescale=p.timescale,S.trackId=p.trackId):((!S.timescale||S.trackId===void 0||S.initPTS===void 0)&&(this.warn("Could not set initPTS"),S.initPTS=H,S.timescale=1,S.trackId=-1),this.initPTS=p={baseTime:S.initPTS,timescale:S.timescale,trackId:S.trackId});const F=H-p.baseTime/p.timescale,W=F+U;U>0?this.lastEndTime=W:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const fe=!!_.audio,ne=!!_.video;let de="";fe&&(de+="audio"),ne&&(de+="video");const Te=(_.audio?_.audio.encrypted:!1)||(_.video?_.video.encrypted:!1),me={data1:d,startPTS:F,startDTS:F,endPTS:W,endDTS:W,type:de,hasAudio:fe,hasVideo:ne,nb:1,dropped:0,encrypted:Te};u.audio=fe&&!ne?me:void 0,u.video=ne?me:void 0;const X=I==null?void 0:I.sampleCount;if(X){const Ie=I.keyFrameIndex,Be=Ie!==-1;me.nb=X,me.dropped=Ie===0||this.isVideoContiguous?0:Be?Ie:X,me.independent=Be,me.firstKeyFrame=Ie,Be&&I.keyFrameStart&&(me.firstKeyFramePTS=(I.keyFrameStart-p.baseTime)/p.timescale),this.isVideoContiguous||(u.independent=Be),this.isVideoContiguous||(this.isVideoContiguous=Be),me.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${Ie}/${X} dropped: ${me.dropped} start: ${me.firstKeyFramePTS||"NA"}`)}return u.initSegment=S,u.id3=WE(r,l,p,p),o.samples.length&&(u.text=XE(o,l,p)),u}}function Td(h,e,t=!1){return(h==null?void 0:h.start)!==void 0?(h.start+(t?h.duration:0))/h.timescale:e}function _A(h,e,t,r){if(h===null)return!0;const o=Math.max(r,1),l=e-h.baseTime/h.timescale;return Math.abs(l-t)>o}function Ev(h,e,t){const r=h.codec;return r&&r.length>4?r:e===jr.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?Ud(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let go;try{go=self.performance.now.bind(self.performance)}catch{go=Date.now}const Od=[{demux:oA,remux:SA},{demux:Jo,remux:wd},{demux:rA,remux:wd},{demux:aA,remux:wd}];Od.splice(2,0,{demux:iA,remux:wd});class Tv{constructor(e,t,r,o,l,f){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=l,this.logger=f}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,o){const l=r.transmuxing;l.executeStart=go();let f=new Uint8Array(e);const{currentTransmuxState:y,transmuxConfig:g}=this;o&&(this.currentTransmuxState=o);const{contiguous:p,discontinuity:m,trackSwitch:u,accurateTimeOffset:d,timeOffset:S,initSegmentChange:_}=o||y,{audioCodec:E,videoCodec:b,defaultInitPts:I,duration:T,initSegmentData:A}=g,R=AA(f,t);if(R&&Ou(R.method)){const Z=this.getDecrypter(),$=vm(R.method);if(Z.isSync()){let F=Z.softwareDecrypt(f,R.key.buffer,R.iv.buffer,$);if(r.part>-1){const fe=Z.flush();F=fe&&fe.buffer}if(!F)return l.executeEnd=go(),Lg(r);f=new Uint8Array(F)}else return this.asyncResult=!0,this.decryptionPromise=Z.webCryptoDecrypt(f,R.key.buffer,R.iv.buffer,$).then(F=>{const W=this.push(F,null,r);return this.decryptionPromise=null,W}),this.decryptionPromise}const O=this.needsProbing(m,u);if(O){const Z=this.configureTransmuxer(f);if(Z)return this.logger.warn(`[transmuxer] ${Z.message}`),this.observer.emit(pe.ERROR,pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.FRAG_PARSING_ERROR,fatal:!1,error:Z,reason:Z.message}),l.executeEnd=go(),Lg(r)}(m||u||_||O)&&this.resetInitSegment(A,E,b,T,t),(m||_||O)&&this.resetInitialTimestamp(I),p||this.resetContiguity();const H=this.transmux(f,R,S,d,r);this.asyncResult=zc(H);const U=this.currentTransmuxState;return U.contiguous=!0,U.discontinuity=!1,U.trackSwitch=!1,l.executeEnd=go(),H}flush(e){const t=e.transmuxing;t.executeStart=go();const{decrypter:r,currentTransmuxState:o,decryptionPromise:l}=this;if(l)return this.asyncResult=!0,l.then(()=>this.flush(e));const f=[],{timeOffset:y}=o;if(r){const u=r.flush();u&&f.push(this.push(u.buffer,null,e))}const{demuxer:g,remuxer:p}=this;if(!g||!p){t.executeEnd=go();const u=[Lg(e)];return this.asyncResult?Promise.resolve(u):u}const m=g.flush(y);return zc(m)?(this.asyncResult=!0,m.then(u=>(this.flushRemux(f,u,e),f))):(this.flushRemux(f,m,e),this.asyncResult?Promise.resolve(f):f)}flushRemux(e,t,r){const{audioTrack:o,videoTrack:l,id3Track:f,textTrack:y}=t,{accurateTimeOffset:g,timeOffset:p}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===Pn.MAIN?"level":"track"} ${r.level}`);const m=this.remuxer.remux(o,l,f,y,p,g,!0,this.id);e.push({remuxResult:m,chunkMeta:r}),r.transmuxing.executeEnd=go()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,o,l){const{demuxer:f,remuxer:y}=this;!f||!y||(f.resetInitSegment(e,t,r,o),y.resetInitSegment(e,t,r,l))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,o,l){let f;return t&&t.method==="SAMPLE-AES"?f=this.transmuxSampleAes(e,t,r,o,l):f=this.transmuxUnencrypted(e,r,o,l),f}transmuxUnencrypted(e,t,r,o){const{audioTrack:l,videoTrack:f,id3Track:y,textTrack:g}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(l,f,y,g,t,r,!1,this.id),chunkMeta:o}}transmuxSampleAes(e,t,r,o,l){return this.demuxer.demuxSampleAes(e,t,r).then(f=>({remuxResult:this.remuxer.remux(f.audioTrack,f.videoTrack,f.id3Track,f.textTrack,r,o,!1,this.id),chunkMeta:l}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:o}=this;let l;for(let u=0,d=Od.length;u<d;u++){var f;if((f=Od[u].demux)!=null&&f.probe(e,this.logger)){l=Od[u];break}}if(!l)return new Error("Failed to find demuxer by probing fragment data");const y=this.demuxer,g=this.remuxer,p=l.remux,m=l.demux;(!g||!(g instanceof p))&&(this.remuxer=new p(r,t,o,this.logger)),(!y||!(y instanceof m))&&(this.demuxer=new m(r,t,o,this.logger),this.probe=m.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new pm(this.config)),e}}function AA(h,e){let t=null;return h.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Lg=h=>({remuxResult:{},chunkMeta:h});function zc(h){return"then"in h&&h.then instanceof Function}class bA{constructor(e,t,r,o,l){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=o,this.defaultInitPts=l||null}}class RA{constructor(e,t,r,o,l,f){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=o,this.timeOffset=l,this.initSegmentChange=f}}let Sv=0;class QE{constructor(e,t,r,o){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Sv++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=g=>{const p=g.data,m=this.hls;if(!(!m||!(p!=null&&p.event)||p.instanceNo!==this.instanceNo))switch(p.event){case"init":{var u;const d=(u=this.workerContext)==null?void 0:u.objectURL;d&&self.URL.revokeObjectURL(d);break}case"transmuxComplete":{this.handleTransmuxComplete(p.data);break}case"flush":{this.onFlush(p.data);break}case"workerLog":{m.logger[p.data.logType]&&m.logger[p.data.logType](p.data.message);break}default:{p.data=p.data||{},p.data.frag=this.frag,p.data.part=this.part,p.data.id=this.id,m.trigger(p.event,p.data);break}}},this.onWorkerError=g=>{if(!this.hls)return;const p=new Error(`${g.message}  (${g.filename}:${g.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(pe.ERROR,{type:jn.OTHER_ERROR,details:wt.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:p})};const l=e.config;this.hls=e,this.id=t,this.useWorker=!!l.enableWorker,this.onTransmuxComplete=r,this.onFlush=o;const f=(g,p)=>{p=p||{},p.frag=this.frag||void 0,g===pe.ERROR&&(p=p,p.parent=this.id,p.part=this.part,this.error=p.error),this.hls.trigger(g,p)};this.observer=new Sm,this.observer.on(pe.FRAG_DECRYPTED,f),this.observer.on(pe.ERROR,f);const y=ky(l.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const g=this.hls.logger;if(l.workerPath||L_()){try{l.workerPath?(g.log(`loading Web Worker ${l.workerPath} for "${t}"`),this.workerContext=N_(l.workerPath)):(g.log(`injecting Web Worker for "${t}"`),this.workerContext=x_());const{worker:m}=this.workerContext;m.addEventListener("message",this.onWorkerMessage),m.addEventListener("error",this.onWorkerError),m.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:y,id:t,config:qr(l)})}catch(m){g.warn(`Error setting up "${t}" Web Worker, fallback to inline`,m),this.terminateWorker(),this.error=null,this.transmuxer=new Tv(this.observer,y,l,"",t,e.logger)}return}}this.transmuxer=new Tv(this.observer,y,l,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=Sv++;const t=this.hls.config,r=ky(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:qr(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),w_(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,o,l,f,y,g,p,m){var u,d;p.transmuxing.start=self.performance.now();const{instanceNo:S,transmuxer:_}=this,E=f?f.start:l.start,b=l.decryptdata,I=this.frag,T=!(I&&l.cc===I.cc),A=!(I&&p.level===I.level),R=I?p.sn-I.sn:-1,O=this.part?p.part-this.part.index:-1,H=R===0&&p.id>1&&p.id===(I==null?void 0:I.stats.chunkCount),U=!A&&(R===1||R===0&&(O===1||H&&O<=0)),Z=self.performance.now();(A||R||l.stats.parsing.start===0)&&(l.stats.parsing.start=Z),f&&(O||!U)&&(f.stats.parsing.start=Z);const $=!(I&&((u=l.initSegment)==null?void 0:u.url)===((d=I.initSegment)==null?void 0:d.url)),F=new RA(T,U,g,A,E,$);if(!U||T||$){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${l.type} sn: ${p.sn}${p.part>-1?" part: "+p.part:""} ${this.id===Pn.MAIN?"level":"track"}: ${p.level} id: ${p.id}
        discontinuity: ${T}
        trackSwitch: ${A}
        contiguous: ${U}
        accurateTimeOffset: ${g}
        timeOffset: ${E}
        initSegmentChange: ${$}`);const W=new bA(r,o,t,y,m);this.configureTransmuxer(W)}if(this.frag=l,this.part=f,this.workerContext)this.workerContext.worker.postMessage({instanceNo:S,cmd:"demux",data:e,decryptdata:b,chunkMeta:p,state:F},e instanceof ArrayBuffer?[e]:[]);else if(_){const W=_.push(e,b,p,F);zc(W)?W.then(fe=>{this.handleTransmuxComplete(fe)}).catch(fe=>{this.transmuxerError(fe,p,"transmuxer-interface push error")}):this.handleTransmuxComplete(W)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){const o=r.flush(e);zc(o)?o.then(l=>{this.handleFlushResult(l,e)}).catch(l=>{this.transmuxerError(l,e,"transmuxer-interface flush error")}):this.handleFlushResult(o,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const _v=100;class IA extends Tm{constructor(e,t,r){super(e,t,r,"audio-stream-controller",Pn.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.on(pe.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(pe.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(pe.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(pe.BUFFER_RESET,this.onBufferReset,this),e.on(pe.BUFFER_CREATED,this.onBufferCreated,this),e.on(pe.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(pe.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(pe.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(pe.FRAG_LOADING,this.onFragLoading,this),e.on(pe.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.off(pe.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(pe.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(pe.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(pe.BUFFER_RESET,this.onBufferReset,this),e.off(pe.BUFFER_CREATED,this.onBufferCreated,this),e.off(pe.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(pe.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(pe.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(pe.FRAG_LOADING,this.onFragLoading,this),e.off(pe.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:o,timescale:l,trackId:f}){if(r===Pn.MAIN){const y=t.cc,g=this.fragCurrent;if(this.initPTS[y]={baseTime:o,timescale:l,trackId:f},this.log(`InitPTS for cc: ${y} found from main: ${o/l} (${o}/${l}) trackId: ${f}`),this.mainAnchor=t,this.state===nn.WAITING_INIT_PTS){const p=this.waitingData;(!p&&!this.loadingParts||p&&p.frag.cc!==y)&&this.syncWithAnchor(t,p==null?void 0:p.frag)}else!this.hls.hasEnoughToStart&&g&&g.cc!==y?(g.abortRequests(),this.syncWithAnchor(t,g)):this.state===nn.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;const o=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&(o==null?void 0:o.cc)===t.cc)return;const l=(o||e).cc,f=this.getLevelDetails(),y=this.getLoadPosition(),g=gE(f,l,y);g&&(this.log(`Syncing with main frag at ${g.start} cc ${g.cc}`),this.startFragRequested=!1,this.nextLoadPosition=g.start,this.resetLoadingState(),this.state===nn.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=nn.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(_v),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=nn.IDLE):this.state=nn.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case nn.IDLE:this.doTickIdle();break;case nn.WAITING_TRACK:{const{levels:e,trackId:t}=this,r=e==null?void 0:e[t],o=r==null?void 0:r.details;if(o&&!this.waitForLive(r)){if(this.waitForCdnTuneIn(o))break;this.state=nn.WAITING_INIT_PTS}break}case nn.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case nn.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:r,cache:o,complete:l}=e,f=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=nn.FRAG_LOADING;const y=o.flush().buffer,g={frag:t,part:r,payload:y,networkDetails:null};this._handleFragmentLoadProgress(g),l&&super._handleFragmentLoadComplete(g)}else f&&f.cc!==e.frag.cc&&this.syncWithAnchor(f,e.frag)}else this.state=nn.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:r,media:o,trackId:l}=this,f=t.config;if(!this.buffering||!o&&!this.primaryPrefetch&&(this.startFragRequested||!f.startFragPrefetch)||!(r!=null&&r[l]))return;const y=r[l],g=y.details;if(!g||this.waitForLive(y)||this.waitForCdnTuneIn(g)){this.state=nn.WAITING_TRACK,this.startFragRequested=!1;return}const p=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&p&&(this.bufferFlushed=!1,this.afterBufferFlushed(p,jr.AUDIO,Pn.AUDIO));const m=this.getFwdBufferInfo(p,Pn.AUDIO);if(m===null)return;if(!this.switchingTrack&&this._streamEnded(m,g)){t.trigger(pe.BUFFER_EOS,{type:"audio"}),this.state=nn.ENDED;return}const u=m.len,d=t.maxBufferLength,S=g.fragments,_=S[0].start,E=this.getLoadPosition(),b=this.flushing?E:m.end;if(this.switchingTrack&&o){const A=E;g.PTSKnown&&A<_&&(m.end>_||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),o.currentTime=_+.05)}if(u>=d&&!this.switchingTrack&&b<S[S.length-1].start)return;let I=this.getNextFragment(b,g);if(I&&this.isLoopLoading(I,b)&&(I=this.getNextFragmentLoopLoading(I,g,m,Pn.MAIN,d)),!I){this.bufferFlushed=!0;return}let T=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&T&&hi(I)&&!I.endList&&(!g.live||!this.loadingParts&&b<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(T)===Ai.OK&&(this.mainFragLoading=T=null),T&&hi(T))){if(I.start>T.end){const R=this.fragmentTracker.getFragAtPos(b,Pn.MAIN);R&&R.end>T.end&&(T=R,this.mainFragLoading={frag:R,targetBufferTime:null})}if(I.start>T.end)return}this.loadFragment(I,y,b)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new jc(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:o}=this;o&&(o.abortRequests(),this.removeUnbufferedFrags(o.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==nn.STOPPED&&(this.setInterval(_v),this.state=nn.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(pe.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r;const{levels:o}=this,{details:l,id:f,groupId:y,track:g}=t;if(!o){this.warn(`Audio tracks reset while loading track ${f} "${g.name}" of "${y}"`);return}const p=this.mainDetails;if(!p||l.endCC>p.endCC||p.expired){this.cachedTrackLoadedData=t,this.state!==nn.STOPPED&&(this.state=nn.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${f} "${g.name}" of "${y}" loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`);const m=o[f];let u=0;if(l.live||(r=m.details)!=null&&r.live){if(this.checkLiveUpdate(l),l.deltaUpdateFailed)return;if(m.details){var d;u=this.alignPlaylists(l,m.details,(d=this.levelLastLoaded)==null?void 0:d.details)}l.alignedSliding||(wE(l,p),l.alignedSliding||jd(l,p),u=l.fragmentStart)}m.details=l,this.levelLastLoaded=m,this.startFragRequested||this.setStartPosition(p,u),this.hls.trigger(pe.AUDIO_TRACK_UPDATED,{details:l,id:f,groupId:t.groupId}),this.state===nn.WAITING_TRACK&&!this.waitForCdnTuneIn(l)&&(this.state=nn.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:o,payload:l}=e,{config:f,trackId:y,levels:g}=this;if(!g){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const p=g[y];if(!p){this.warn("Audio track is undefined on fragment load progress");return}const m=p.details;if(!m){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const u=f.defaultAudioCodec||p.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new QE(this.hls,Pn.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const S=this.initPTS[r.cc],_=(t=r.initSegment)==null?void 0:t.data;if(S!==void 0){const b=o?o.index:-1,I=b!==-1,T=new ym(r.level,r.sn,r.stats.chunkCount,l.byteLength,b,I);d.push(l,_,u,"",r,o,m.totalduration,!1,T,S)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${m.startSN} ,${m.endSN}],track ${y}`);const{cache:E}=this.waitingData=this.waitingData||{frag:r,part:o,cache:new OE,complete:!1};E.push(new Uint8Array(l)),this.state!==nn.STOPPED&&(this.state=nn.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===Pn.MAIN&&hi(t.frag)&&(this.mainFragLoading=t,this.state===nn.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:r,part:o}=t;if(r.type!==Pn.AUDIO){!this.audioOnly&&r.type===Pn.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${o?" p: "+o.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(hi(r)){this.fragPrevious=r;const l=this.switchingTrack;l&&(this.bufferedTrack=l,this.switchingTrack=null,this.hls.trigger(pe.AUDIO_TRACK_SWITCHED,Or({},l)))}this.fragBufferedComplete(r,o),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=nn.ERROR;return}switch(t.details){case wt.FRAG_GAP:case wt.FRAG_PARSING_ERROR:case wt.FRAG_DECRYPT_ERROR:case wt.FRAG_LOAD_ERROR:case wt.FRAG_LOAD_TIMEOUT:case wt.KEY_LOAD_ERROR:case wt.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Pn.AUDIO,t);break;case wt.AUDIO_TRACK_LOAD_ERROR:case wt.AUDIO_TRACK_LOAD_TIMEOUT:case wt.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===nn.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===or.AUDIO_TRACK&&(this.state=nn.IDLE);break;case wt.BUFFER_ADD_CODEC_ERROR:case wt.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case wt.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case wt.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==jr.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==jr.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===nn.ENDED&&(this.state=nn.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,Pn.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:o}=this,{remuxResult:l,chunkMeta:f}=e,y=this.getCurrentContext(f);if(!y){this.resetWhenMissingContext(f);return}const{frag:g,part:p,level:m}=y,{details:u}=m,{audio:d,text:S,id3:_,initSegment:E}=l;if(this.fragContextChanged(g)||!u){this.fragmentTracker.removeFragment(g);return}if(this.state=nn.PARSING,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),E!=null&&E.tracks){const b=g.initSegment||g;if(this.unhandledEncryptionError(E,g))return;this._bufferInitSegment(m,E.tracks,b,f),o.trigger(pe.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:r,tracks:E.tracks})}if(d){const{startPTS:b,endPTS:I,startDTS:T,endDTS:A}=d;p&&(p.elementaryStreams[jr.AUDIO]={startPTS:b,endPTS:I,startDTS:T,endDTS:A}),g.setElementaryStreamInfo(jr.AUDIO,b,I,T,A),this.bufferFragmentData(d,g,p,f)}if(_!=null&&(t=_.samples)!=null&&t.length){const b=Gr({id:r,frag:g,details:u},_);o.trigger(pe.FRAG_PARSING_METADATA,b)}if(S){const b=Gr({id:r,frag:g,details:u},S);o.trigger(pe.FRAG_PARSING_USERDATA,b)}}_bufferInitSegment(e,t,r,o){if(this.state!==nn.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const l=t.audio;l.id=Pn.AUDIO;const f=e.audioCodec;this.log(`Init audio buffer, container:${l.container}, codecs[level/parsed]=[${f}/${l.codec}]`),f&&f.split(",").length===1&&(l.levelCodec=f),this.hls.trigger(pe.BUFFER_CODECS,t);const y=l.initSegment;if(y!=null&&y.byteLength){const g={type:"audio",frag:r,part:null,chunkMeta:o,parent:r.type,data:y};this.hls.trigger(pe.BUFFER_APPENDING,g)}this.tickImmediate()}loadFragment(e,t,r){const o=this.fragmentTracker.getState(e);if(this.switchingTrack||o===Ai.NOT_LOADED||o===Ai.PARTIAL){var l;if(!hi(e))this._loadInitSegment(e,t);else if((l=t.details)!=null&&l.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=nn.WAITING_INIT_PTS;const f=this.mainDetails;f&&f.fragmentStart!==t.details.fragmentStart&&jd(t.details,f)}else super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:r,assocLang:o,characteristics:l,audioCodec:f,channels:y}=this.bufferedTrack;Ol({name:t,lang:r,assocLang:o,characteristics:l,audioCodec:f,channels:y},e,wl)||(Gd(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(pe.AUDIO_TRACK_SWITCHED,Or({},e))}}class Dm extends Ba{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const o=t==null?void 0:t.renditionReports;if(o){let l=-1;for(let f=0;f<o.length;f++){const y=o[f];let g;try{g=new self.URL(y.URI,t.url).href}catch(p){this.warn(`Could not construct new URL for Rendition Report: ${p}`),g=y.URI||""}if(g===e){l=f;break}else g===e.substring(0,g.length)&&(l=f)}if(l!==-1){const f=o[l],y=parseInt(f["LAST-MSN"])||t.lastPartSn;let g=parseInt(f["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const m=Math.min(t.age-t.partTarget,t.targetduration);g>=0&&m>t.partTarget&&(g+=1)}const p=r&&Fy(r);return new Uy(y,g>=0?g:void 0,p)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){const{details:o,stats:l}=t,f=self.performance.now(),y=l.loading.first?Math.max(0,f-l.loading.first):0;o.advancedDateTime=Date.now()-y;const g=this.hls.config.timelineOffset;if(g!==o.appliedTimelineOffset){const m=Math.max(g||0,0);o.appliedTimelineOffset=m,o.fragments.forEach(u=>{u.setStart(u.playlistOffset+m)})}if(o.live||r!=null&&r.live){const m="levelInfo"in t?t.levelInfo:t.track;if(o.reloaded(r),r&&o.fragments.length>0){v_(r,o,this);const T=o.playlistParsingError;if(T){this.warn(T);const A=this.hls;if(!A.config.ignorePlaylistParsingErrors){var p;const{networkDetails:R}=t;A.trigger(pe.ERROR,{type:jn.NETWORK_ERROR,details:wt.LEVEL_PARSING_ERROR,fatal:!1,url:o.url,error:T,reason:T.message,level:t.level||void 0,parent:(p=o.fragments[0])==null?void 0:p.type,networkDetails:R,stats:l});return}o.playlistParsingError=null}}o.requestScheduled===-1&&(o.requestScheduled=l.loading.start);const u=this.hls.mainForwardBufferInfo,d=u?u.end-u.len:0,S=(o.edge-d)*1e3,_=CE(o,S);if(o.requestScheduled+_<f?o.requestScheduled=f:o.requestScheduled+=_,this.log(`live playlist ${e} ${o.advanced?"REFRESHED "+o.lastPartSn+"-"+o.lastPartIndex:o.updated?"UPDATED":"MISSED"}`),!this.canLoad||!o.live)return;let E,b,I;if(o.canBlockReload&&o.endSN&&o.advanced){const T=this.hls.config.lowLatencyMode,A=o.lastPartSn,R=o.endSN,O=o.lastPartIndex,H=O!==-1,U=A===R;H?U?(b=R+1,I=T?0:O):(b=A,I=T?O+1:o.maxPartIndex):b=R+1;const Z=o.age,$=Z+o.ageHeader;let F=Math.min($-o.partTarget,o.targetduration*1.5);if(F>0){if($>o.targetduration*3)this.log(`Playlist last advanced ${Z.toFixed(2)}s ago. Omitting segment and part directives.`),b=void 0,I=void 0;else if(r!=null&&r.tuneInGoal&&$-o.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${F} with playlist age: ${o.age}`),F=0;else{const W=Math.floor(F/o.targetduration);if(b+=W,I!==void 0){const fe=Math.round(F%o.targetduration/o.partTarget);I+=fe}this.log(`CDN Tune-in age: ${o.ageHeader}s last advanced ${Z.toFixed(2)}s goal: ${F} skip sn ${W} to part ${I}`)}o.tuneInGoal=F}if(E=this.getDeliveryDirectives(o,t.deliveryDirectives,b,I),T||!U){o.requestScheduled=f,this.loadingPlaylist(m,E);return}}else(o.canBlockReload||o.canSkipUntil)&&(E=this.getDeliveryDirectives(o,t.deliveryDirectives,b,I));E&&b!==void 0&&o.canBlockReload&&(o.requestScheduled=l.loading.first+Math.max(_-y*2,_/2)),this.scheduleLoading(m,E,o)}else this.clearTimer()}scheduleLoading(e,t,r){const o=r||e.details;if(!o){this.loadingPlaylist(e,t);return}const l=self.performance.now(),f=o.requestScheduled;if(l>=f){this.loadingPlaylist(e,t);return}const y=f-l;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(y)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),y)}getDeliveryDirectives(e,t,r,o){let l=Fy(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,o=t.part,l=xd.No),new Uy(r,o,l)}checkRetry(e){const t=e.details,r=Zd(e),o=e.errorAction,{action:l,retryCount:f=0,retryConfig:y}=o||{},g=!!o&&!!y&&(l===wi.RetryRequest||!o.resolved&&l===wi.SendAlternateToPenaltyBox);if(g){var p;if(f>=y.maxNumRetry)return!1;if(r&&(p=e.context)!=null&&p.deliveryDirectives)this.warn(`Retrying playlist loading ${f+1}/${y.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const m=mm(y,f);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),m),this.warn(`Retrying playlist loading ${f+1}/${y.maxNumRetry} after "${t}" in ${m}ms`)}e.levelRetry=!0,o.resolved=!0}return g}}function JE(h,e){if(h.length!==e.length)return!1;for(let t=0;t<h.length;t++)if(!$c(h[t].attrs,e[t].attrs))return!1;return!0}function $c(h,e,t){const r=h["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(o=>h[o]!==e[o])}function em(h,e){return e.label.toLowerCase()===h.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(h.lang||"").toLowerCase())}class CA extends Dm{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.on(pe.LEVEL_LOADING,this.onLevelLoading,this),e.on(pe.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(pe.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(pe.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.off(pe.LEVEL_LOADING,this.onLevelLoading,this),e.off(pe.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(pe.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(pe.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:o,details:l}=t,f=this.tracksInGroup[r];if(!f||f.groupId!==o){this.warn(`Audio track with id:${r} and group:${o} not found in active group ${f==null?void 0:f.groupId}`);return}const y=f.details;f.details=t.details,this.log(`Audio track ${r} "${f.name}" lang:${f.lang} group:${o} loaded [${l.startSN}-${l.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,y)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,o=this.groupIds;let l=this.currentTrack;if(!r||(o==null?void 0:o.length)!==(r==null?void 0:r.length)||r!=null&&r.some(y=>(o==null?void 0:o.indexOf(y))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const y=this.tracks.filter(d=>!r||r.indexOf(d.groupId)!==-1);if(y.length)this.selectDefaultTrack&&!y.some(d=>d.default)&&(this.selectDefaultTrack=!1),y.forEach((d,S)=>{d.id=S});else if(!l&&!this.tracksInGroup.length)return;this.tracksInGroup=y;const g=this.hls.config.audioPreference;if(!l&&g){const d=Ms(g,y,wl);if(d>-1)l=y[d];else{const S=Ms(g,this.tracks);l=this.tracks[S]}}let p=this.findTrackId(l);p===-1&&l&&(p=this.findTrackId(null));const m={audioTracks:y};this.log(`Updating audio tracks, ${y.length} track(s) found in group(s): ${r==null?void 0:r.join(",")}`),this.hls.trigger(pe.AUDIO_TRACKS_UPDATED,m);const u=this.trackId;if(p!==-1&&u===-1)this.setAudioTrack(p);else if(y.length&&u===-1){var f;const d=new Error(`No audio track selected for current audio group-ID(s): ${(f=this.groupIds)==null?void 0:f.join(",")} track count: ${y.length}`);this.warn(d.message),this.hls.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:d})}}}onError(e,t){t.fatal||!t.context||t.context.type===or.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const o=this.currentTrack;if(o&&Ol(e,o,wl))return o;const l=Ms(e,this.tracksInGroup,wl);if(l>-1){const f=this.tracksInGroup[l];return this.setAudioTrack(l),f}else if(o){let f=t.loadLevel;f===-1&&(f=t.firstAutoLevel);const y=BS(e,t.levels,r,f,wl);if(y===-1)return null;t.nextLoadLevel=y}if(e.channels||e.audioCodec){const f=Ms(e,r);if(f>-1)return r[f]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,o=t[e],l=o.details&&!o.details.live;if(e===this.trackId&&o===r&&l||(this.log(`Switching to audio-track ${e} "${o.name}" lang:${o.lang} group:${o.groupId} channels:${o.channels}`),this.trackId=e,this.currentTrack=o,this.hls.trigger(pe.AUDIO_TRACK_SWITCHING,Or({},o)),l))return;const f=this.switchParams(o.url,r==null?void 0:r.details,o.details);this.loadPlaylist(f)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const o=t[r];if(!(this.selectDefaultTrack&&!o.default)&&(!e||Ol(e,o,wl)))return r}if(e){const{name:r,lang:o,assocLang:l,characteristics:f,audioCodec:y,channels:g}=e;for(let p=0;p<t.length;p++){const m=t[p];if(Ol({name:r,lang:o,assocLang:l,characteristics:f,audioCodec:y,channels:g},m,wl))return p}for(let p=0;p<t.length;p++){const m=t[p];if($c(e.attrs,m.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return p}for(let p=0;p<t.length;p++){const m=t[p];if($c(e.attrs,m.attrs,["LANGUAGE"]))return p}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Gd(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,o=e.groupId,l=this.getUrlWithDirectives(e.url,t),f=e.details,y=f==null?void 0:f.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${o}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${y&&f.live?" age "+y.toFixed(1)+(f.type&&" "+f.type||""):""} ${l}`),this.hls.trigger(pe.AUDIO_TRACK_LOADING,{url:l,id:r,groupId:o,deliveryDirectives:t||null,track:e})}}class DA{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;const o=this.queues[t];o.push(e),o.length===1&&!r&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const r={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const r={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const o=t[0];try{o.execute()}catch(l){var r;if(o.onError(l),this.queues===null||this.tracks===null)return;const f=(r=this.tracks[e])==null?void 0:r.buffer;f!=null&&f.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const r=(t=this.tracks)==null?void 0:t[e],o=r==null?void 0:r.buffer;return o?`SourceBuffer${o.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}const Av=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,e0="HlsJsTrackRemovedError";class LA extends Error{constructor(e){super(e),this.name=e0}}class xA extends Ba{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var o;this.hls&&((o=this.mediaSource)==null?void 0:o.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:o,mediaSource:l}=this;r&&this.log("Media source opened"),!(!o||!l)&&(l.removeEventListener("sourceopen",this._onMediaSourceOpen),o.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(pe.MEDIA_ATTACHED,{media:o,mediaSource:l}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:o}=this;r!==o&&this.error(`Media element src was set while attaching MediaSource (${o} > ${r})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=QT(tl(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.on(pe.BUFFER_RESET,this.onBufferReset,this),e.on(pe.BUFFER_APPENDING,this.onBufferAppending,this),e.on(pe.BUFFER_CODECS,this.onBufferCodecs,this),e.on(pe.BUFFER_EOS,this.onBufferEos,this),e.on(pe.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(pe.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(pe.FRAG_PARSED,this.onFragParsed,this),e.on(pe.FRAG_CHANGED,this.onFragChanged,this),e.on(pe.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.off(pe.BUFFER_RESET,this.onBufferReset,this),e.off(pe.BUFFER_APPENDING,this.onBufferAppending,this),e.off(pe.BUFFER_CODECS,this.onBufferCodecs,this),e.off(pe.BUFFER_EOS,this.onBufferEos,this),e.off(pe.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(pe.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(pe.FRAG_PARSED,this.onFragParsed,this),e.off(pe.FRAG_CHANGED,this.onFragChanged,this),e.off(pe.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const r={};if(this.operationQueue){const l=this.isUpdating();l||this.operationQueue.removeBlockers();const f=this.isQueued();(l||f)&&this.warn(`Transfering MediaSource with${f?" operations in queue":""}${l?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const o=this.transferData;return!this.sourceBufferCount&&o&&o.mediaSource===t?Gr(r,o.tracks):this.sourceBuffers.forEach(l=>{const[f]=l;f&&(r[f]=Gr({},this.tracks[f]),this.removeBuffer(f)),l[0]=l[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let o=2;(t.audio&&!t.video||!t.altAudio)&&(o=1),this.bufferCodecEventsTotal=o,this.log(`${o} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&o&&this.bufferCreated()}onMediaAttaching(e,t){const r=this.media=t.media;this.transferData=this.overrides=void 0;const o=tl(this.appendSource);if(o){const l=!!t.mediaSource;(l||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const f=this.mediaSource=t.mediaSource||new o;if(this.assignMediaSource(f),l)this._objectUrl=r.src,this.attachTransferred();else{const y=this._objectUrl=self.URL.createObjectURL(f);if(this.appendSource)try{r.removeAttribute("src");const g=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||g&&f instanceof g,bv(r),NA(r,y),r.load()}catch{r.src=y}else r.src=y}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const r=this.tracks,o=t.tracks,l=o?Object.keys(o):null,f=l?l.length:0,y=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(o&&l&&f){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${qr(r,(g,p)=>g==="initSegment"?void 0:p)};
transfer tracks: ${qr(o,(g,p)=>g==="initSegment"?void 0:p)}}`),!Wv(o,r)){t.mediaSource=null,t.tracks=void 0;const g=e.currentTime,p=this.details,m=Math.max(g,(p==null?void 0:p.fragments[0].start)||0);if(m-g>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${g} -> ${m}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(o)}"->"${Object.keys(r)}") start time: ${m} currentTime: ${g}`),this.onMediaDetaching(pe.MEDIA_DETACHING,{}),this.onMediaAttaching(pe.MEDIA_ATTACHING,t),e.currentTime=m;return}this.transferData=void 0,l.forEach(g=>{const p=g,m=o[p];if(m){const u=m.buffer;if(u){const d=this.fragmentTracker,S=m.id;if(d.hasFragments(S)||d.hasParts(S)){const b=nr.getBuffered(u);d.detectEvictedFragments(p,b,S,null,!0)}const _=xg(p),E=[p,u];this.sourceBuffers[_]=E,u.updating&&this.operationQueue&&this.operationQueue.prependBlocker(p),this.trackSourceBuffer(p,m)}}}),y(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),y()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const r=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:o,mediaSource:l,_objectUrl:f}=this;if(l){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([y])=>{y&&this.removeBuffer(y)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const y=l.readyState==="open";try{const g=l.sourceBuffers;for(let p=g.length;p--;)y&&g[p].abort(),l.removeSourceBuffer(g[p]);y&&l.endOfStream()}catch(g){this.warn(`onMediaDetaching: ${g.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}l.removeEventListener("sourceopen",this._onMediaSourceOpen),l.removeEventListener("sourceended",this._onMediaSourceEnded),l.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(l.removeEventListener("startstreaming",this._onStartStreaming),l.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}o&&(o.removeEventListener("emptied",this._onMediaEmptied),r||(f&&self.URL.revokeObjectURL(f),this.mediaSrc===f?(o.removeAttribute("src"),this.appendSource&&bv(o),o.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(pe.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const r=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),r)try{var o;(o=this.mediaSource)!=null&&o.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(l){this.warn(`onBufferReset ${e}`,l)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[xg(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new DA(this.tracks)}onBufferCodecs(e,t){var r;const o=this.tracks,l=Object.keys(t);this.log(`BUFFER_CODECS: "${l}" (current SB count ${this.sourceBufferCount})`);const f="audiovideo"in t&&(o.audio||o.video)||o.audiovideo&&("audio"in t||"video"in t),y=!f&&this.sourceBufferCount&&this.media&&l.some(g=>!o[g]);if(f||y){this.warn(`Unsupported transition between "${Object.keys(o)}" and "${l}" SourceBuffers`);return}l.forEach(g=>{var p,m;const u=t[g],{id:d,codec:S,levelCodec:_,container:E,metadata:b,supplemental:I}=u;let T=o[g];const A=(p=this.transferData)==null||(p=p.tracks)==null?void 0:p[g],R=A!=null&&A.buffer?A:T,O=(R==null?void 0:R.pendingCodec)||(R==null?void 0:R.codec),H=R==null?void 0:R.levelCodec;T||(T=o[g]={buffer:void 0,listeners:[],codec:S,supplemental:I,container:E,levelCodec:_,metadata:b,id:d});const U=Ld(O,H),Z=U==null?void 0:U.replace(Av,"$1");let $=Ld(S,_);const F=(m=$)==null?void 0:m.replace(Av,"$1");$&&U&&Z!==F&&(g.slice(0,5)==="audio"&&($=Ud($,this.appendSource)),this.log(`switching codec ${O} to ${$}`),$!==(T.pendingCodec||T.codec)&&(T.pendingCodec=$),T.container=E,this.appendChangeType(g,E,$))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((r=t.audio)==null?void 0:r.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){const o=`${t};codecs=${r}`,l={label:`change-type=${o}`,execute:()=>{const f=this.tracks[e];if(f){const y=f.buffer;y!=null&&y.changeType&&(this.log(`changing ${e} sourceBuffer type to ${o}`),y.changeType(o),f.codec=r,f.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:f=>{this.warn(`Failed to change ${e} SourceBuffer type`,f)}};this.append(l,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const r=e.start,o=r+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(r,Pn.MAIN))==null?void 0:t.gap)===!0)return;const f={label:"block-audio",execute:()=>{var y;const g=this.tracks.video;(this.lastVideoAppendEnd>o||g!=null&&g.buffer&&nr.isBuffered(g.buffer,o)||((y=this.fragmentTracker.getAppendedFrag(o,Pn.MAIN))==null?void 0:y.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:y=>{this.warn("Error executing block-audio operation",y)}};this.blockedAudioAppend={op:f,frag:e},this.append(f,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:r}=this,{data:o,type:l,parent:f,frag:y,part:g,chunkMeta:p,offset:m}=t,u=p.buffering[l],{sn:d,cc:S}=y,_=self.performance.now();u.start=_;const E=y.stats.buffering,b=g?g.stats.buffering:null;E.start===0&&(E.start=_),b&&b.start===0&&(b.start=_);const I=r.audio;let T=!1;l==="audio"&&(I==null?void 0:I.container)==="audio/mpeg"&&(T=!this.lastMpegAudioChunk||p.id===1||this.lastMpegAudioChunk.sn!==p.sn,this.lastMpegAudioChunk=p);const A=r.video,R=A==null?void 0:A.buffer;if(R&&d!=="initSegment"){const U=g||y,Z=this.blockedAudioAppend;if(l==="audio"&&f!=="main"&&!this.blockedAudioAppend&&!(A.ending||A.ended)){const F=U.start+U.duration*.05,W=R.buffered,fe=this.currentOp("video");!W.length&&!fe?this.blockAudio(U):!fe&&!nr.isBuffered(R,F)&&this.lastVideoAppendEnd<F&&this.blockAudio(U)}else if(l==="video"){const $=U.end;if(Z){const F=Z.frag.start;($>F||$<this.lastVideoAppendEnd||nr.isBuffered(R,F))&&this.unblockAudio()}this.lastVideoAppendEnd=$}}const O=(g||y).start,H={label:`append-${l}`,execute:()=>{var U;u.executeStart=self.performance.now();const Z=(U=this.tracks[l])==null?void 0:U.buffer;Z&&(T?this.updateTimestampOffset(Z,O,.1,l,d,S):m!==void 0&&Nn(m)&&this.updateTimestampOffset(Z,m,1e-6,l,d,S)),this.appendExecutor(o,l)},onStart:()=>{},onComplete:()=>{const U=self.performance.now();u.executeEnd=u.end=U,E.first===0&&(E.first=U),b&&b.first===0&&(b.first=U);const Z={};this.sourceBuffers.forEach(([$,F])=>{$&&(Z[$]=nr.getBuffered(F))}),this.appendErrors[l]=0,l==="audio"||l==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(pe.BUFFER_APPENDED,{type:l,frag:y,part:g,chunkMeta:p,parent:y.type,timeRanges:Z})},onError:U=>{var Z;const $={type:jn.MEDIA_ERROR,parent:y.type,details:wt.BUFFER_APPEND_ERROR,sourceBufferName:l,frag:y,part:g,chunkMeta:p,error:U,err:U,fatal:!1},F=(Z=this.media)==null?void 0:Z.error;if(U.code===DOMException.QUOTA_EXCEEDED_ERR||U.name=="QuotaExceededError"||"quota"in U)$.details=wt.BUFFER_FULL_ERROR;else if(U.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!F)$.errorAction=wu(!0);else if(U.name===e0&&this.sourceBufferCount===0)$.errorAction=wu(!0);else{const W=++this.appendErrors[l];this.warn(`Failed ${W}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${l}" sourceBuffer (${F||"no media error"})`),(W>=this.hls.config.appendErrorMaxRetry||F)&&($.fatal=!0)}this.hls.trigger(pe.ERROR,$)}};this.log(`queuing "${l}" append sn: ${d}${g?" p: "+g.index:""} of ${y.type===Pn.MAIN?"level":"track"} ${y.level} cc: ${S}`),this.append(H,l,this.isPending(this.tracks[l]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(pe.BUFFER_FLUSHED,{type:e})},onError:o=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,o)}}}onBufferFlushing(e,t){const{type:r,startOffset:o,endOffset:l}=t;r?this.append(this.getFlushOp(r,o,l),r):this.sourceBuffers.forEach(([f])=>{f&&this.append(this.getFlushOp(f,o,l),f)})}onFragParsed(e,t){const{frag:r,part:o}=t,l=[],f=o?o.elementaryStreams:r.elementaryStreams;f[jr.AUDIOVIDEO]?l.push("audiovideo"):(f[jr.AUDIO]&&l.push("audio"),f[jr.VIDEO]&&l.push("video"));const y=()=>{const g=self.performance.now();r.stats.buffering.end=g,o&&(o.stats.buffering.end=g);const p=o?o.stats:r.stats;this.hls.trigger(pe.FRAG_BUFFERED,{frag:r,part:o,stats:p,id:r.type})};l.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(y,l).catch(g=>{this.warn(`Fragment buffered callback ${g}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([f])=>{if(f){const y=this.tracks[f];(!t.type||t.type===f)&&(y.ending=!0,y.ended||(y.ended=!0,this.log(`${f} buffer reached EOS`)))}});const o=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([f])=>{var y;return f&&!((y=this.tracks[f])!=null&&y.ended)})?o?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:f}=this;if(!f||f.readyState!=="open"){f&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${f.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),f.endOfStream(),this.hls.trigger(pe.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(pe.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===wt.BUFFER_APPEND_ERROR&&t.frag){var r;const o=(r=t.errorAction)==null?void 0:r.nextAutoLevel;Nn(o)&&o!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;const o=e.config,l=r.currentTime,f=t.levelTargetDuration,y=t.live&&o.liveBackBufferLength!==null?o.liveBackBufferLength:o.backBufferLength;if(Nn(y)&&y>=0){const p=Math.max(y,f),m=Math.floor(l/f)*f-p;this.flushBackBuffer(l,f,m)}const g=o.frontBufferFlushThreshold;if(Nn(g)&&g>0){const p=Math.max(o.maxBufferLength,g),m=Math.max(p,f),u=Math.floor(l/f)*f+m;this.flushFrontBuffer(l,f,u)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([o,l])=>{if(l){const y=nr.getBuffered(l);if(y.length>0&&r>y.start(0)){var f;this.hls.trigger(pe.BACK_BUFFER_REACHED,{bufferEnd:r});const g=this.tracks[o];if((f=this.details)!=null&&f.live)this.hls.trigger(pe.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(g!=null&&g.ended){this.log(`Cannot flush ${o} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(pe.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:o})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([o,l])=>{if(l){const f=nr.getBuffered(l),y=f.length;if(y<2)return;const g=f.start(y-1),p=f.end(y-1);if(r>g||e>=g&&e<=p)return;this.hls.trigger(pe.BUFFER_FLUSHING,{startOffset:g,endOffset:1/0,type:o})}})}getDurationAndRange(){var e;const{details:t,mediaSource:r}=this;if(!t||!this.media||(r==null?void 0:r.readyState)!=="open")return null;const o=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&r.setLiveSeekableRange){const p=Math.max(0,t.fragmentStart),m=Math.max(p,o);return{duration:1/0,start:p,end:m}}return{duration:1/0}}const l=(e=this.overrides)==null?void 0:e.duration;if(l)return Nn(l)?{duration:l}:null;const f=this.media.duration,y=Nn(r.duration)?r.duration:0;return o>y&&o>f||!Nn(f)?{duration:o}:null}updateMediaSource({duration:e,start:t,end:r}){const o=this.mediaSource;!this.media||!o||o.readyState!=="open"||(o.duration!==e&&(Nn(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),o.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${o.duration}. Setting seekable range to ${t}-${r}.`),o.setLiveSeekableRange(t,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${qr(r)}`),this.tracksReady){var o;const l=(o=this.transferData)==null?void 0:o.tracks;l&&Object.keys(l).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,r])=>{if(t){const o=this.tracks[t];e[t]={buffer:r,container:o.container,codec:o.codec,supplemental:o.supplemental,levelCodec:o.levelCodec,id:o.id,metadata:o.metadata}}}),this.hls.trigger(pe.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const l in e){const f=l,y=e[f];if(this.isPending(y)){const g=this.getTrackCodec(y,f),p=`${y.container};codecs=${g}`;y.codec=g,this.log(`creating sourceBuffer(${p})${this.currentOp(f)?" Queued":""} ${qr(y)}`);try{const m=r.addSourceBuffer(p),u=xg(f),d=[f,m];t[u]=d,y.buffer=m}catch(m){var o;this.error(`error while trying to add sourceBuffer: ${m.message}`),this.shiftAndExecuteNext(f),(o=this.operationQueue)==null||o.removeBlockers(),delete this.tracks[f],this.hls.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:m,sourceBufferName:f,mimeType:p,parent:y.id});return}this.trackSourceBuffer(f,y)}}this.bufferCreated()}getTrackCodec(e,t){const r=e.supplemental;let o=e.codec;r&&(t==="video"||t==="audiovideo")&&Vc(r,"video")&&(o=TS(o,r));const l=Ld(o,e.levelCodec);return l?t.slice(0,5)==="audio"?Ud(l,this.appendSource):l:""}trackSourceBuffer(e,t){const r=t.buffer;if(!r)return;const o=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:o,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(l,f)=>{const y=f.removedRanges;y!=null&&y.length&&this.hls.trigger(pe.BUFFER_FLUSHED,{type:l})})}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r==null?void 0:r.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;const o=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${o}`,t),this.hls.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:o,fatal:!1});const l=this.currentOp(e);l&&l.onError(o)}updateTimestampOffset(e,t,r,o,l,f){const y=t-e.timestampOffset;Math.abs(y)>=r&&(this.log(`Updating ${o} SourceBuffer timestampOffset to ${t} (sn: ${l} cc: ${f})`),e.timestampOffset=t)}removeExecutor(e,t,r){const{media:o,mediaSource:l}=this,f=this.tracks[e],y=f==null?void 0:f.buffer;if(!o||!l||!y){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const g=Nn(o.duration)?o.duration:1/0,p=Nn(l.duration)?l.duration:1/0,m=Math.max(0,t),u=Math.min(r,g,p);u>m&&(!f.ending||f.ended)?(f.ended=!1,this.log(`Removing [${m},${u}] from the ${e} SourceBuffer`),y.remove(m,u)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.tracks[t],o=r==null?void 0:r.buffer;if(!o)throw new LA(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,o.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,o=t.map(f=>this.appendBlocker(f));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(o).then(f=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;const o=(r=this.tracks[t])==null?void 0:r.buffer;!o||o.updating||this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){const o=this.tracks[e];if(!o)return;const l=o.buffer;if(!l)return;const f=r.bind(this,e);o.listeners.push({event:t,listener:f}),l.addEventListener(t,f)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const r=t.buffer;r&&(t.listeners.forEach(o=>{r.removeEventListener(o.event,o.listener)}),t.listeners.length=0)}}function bv(h){const e=h.querySelectorAll("source");[].slice.call(e).forEach(t=>{h.removeChild(t)})}function NA(h,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,h.appendChild(t)}function xg(h){return h==="audio"?1:0}class Lm{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(pe.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.on(pe.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(pe.BUFFER_CODECS,this.onBufferCodecs,this),e.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(pe.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.off(pe.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(pe.BUFFER_CODECS,this.onBufferCodecs,this),e.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Nn(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((o,l)=>this.isLevelAllowed(o)&&l<=e);return this.clientRect=null,Lm.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const o=(y,g)=>g?y.width!==g.width||y.height!==g.height:!0;let l=e.length-1;const f=Math.max(t,r);for(let y=0;y<e.length;y+=1){const g=e[y];if((g.width>=f||g.height>=f)&&o(g,e[y+1])){l=y;break}}return l}}const wA={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},oa=wA,OA={HLS:"h"},MA=OA;class ks{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof ks?r:new ks(r))),this.value=e,this.params=t}}const PA="Dict";function kA(h){return Array.isArray(h)?JSON.stringify(h):h instanceof Map?"Map{}":h instanceof Set?"Set{}":typeof h=="object"?JSON.stringify(h):String(h)}function FA(h,e,t,r){return new Error(`failed to ${h} "${kA(e)}" as ${t}`,{cause:r})}function Fs(h,e,t){return FA("serialize",h,e,t)}class t0{constructor(e){this.description=e}}const Rv="Bare Item",UA="Boolean";function BA(h){if(typeof h!="boolean")throw Fs(h,UA);return h?"?1":"?0"}function GA(h){return btoa(String.fromCharCode(...h))}const ZA="Byte Sequence";function HA(h){if(ArrayBuffer.isView(h)===!1)throw Fs(h,ZA);return`:${GA(h)}:`}const VA="Integer";function YA(h){return h<-999999999999999||999999999999999<h}function n0(h){if(YA(h))throw Fs(h,VA);return h.toString()}function jA(h){return`@${n0(h.getTime()/1e3)}`}function r0(h,e){if(h<0)return-r0(-h,e);const t=Math.pow(10,e);if(Math.abs(h*t%1-.5)<Number.EPSILON){const o=Math.floor(h*t);return(o%2===0?o:o+1)/t}else return Math.round(h*t)/t}const qA="Decimal";function KA(h){const e=r0(h,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Fs(h,qA);const t=e.toString();return t.includes(".")?t:`${t}.0`}const zA="String",$A=/[\x00-\x1f\x7f]+/;function WA(h){if($A.test(h))throw Fs(h,zA);return`"${h.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function XA(h){return h.description||h.toString().slice(7,-1)}const QA="Token";function Iv(h){const e=XA(h);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Fs(e,QA);return e}function tm(h){switch(typeof h){case"number":if(!Nn(h))throw Fs(h,Rv);return Number.isInteger(h)?n0(h):KA(h);case"string":return WA(h);case"symbol":return Iv(h);case"boolean":return BA(h);case"object":if(h instanceof Date)return jA(h);if(h instanceof Uint8Array)return HA(h);if(h instanceof t0)return Iv(h);default:throw Fs(h,Rv)}}const JA="Key";function nm(h){if(/^[a-z*][a-z0-9\-_.*]*$/.test(h)===!1)throw Fs(h,JA);return h}function xm(h){return h==null?"":Object.entries(h).map(([e,t])=>t===!0?`;${nm(e)}`:`;${nm(e)}=${tm(t)}`).join("")}function i0(h){return h instanceof ks?`${tm(h.value)}${xm(h.params)}`:tm(h)}function eb(h){return`(${h.value.map(i0).join(" ")})${xm(h.params)}`}function tb(h,e={whitespace:!0}){if(typeof h!="object"||h==null)throw Fs(h,PA);const t=h instanceof Map?h.entries():Object.entries(h),r=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([o,l])=>{l instanceof ks||(l=new ks(l));let f=nm(o);return l.value===!0?f+=xm(l.params):(f+="=",Array.isArray(l.value)?f+=eb(l):f+=i0(l)),f}).join(`,${r}`)}function a0(h,e){return tb(h,e)}const Ns="CMCD-Object",oi="CMCD-Request",xl="CMCD-Session",Xo="CMCD-Status",nb={br:Ns,ab:Ns,d:Ns,ot:Ns,tb:Ns,tpb:Ns,lb:Ns,tab:Ns,lab:Ns,url:Ns,pb:oi,bl:oi,tbl:oi,dl:oi,ltc:oi,mtp:oi,nor:oi,nrr:oi,rc:oi,sn:oi,sta:oi,su:oi,ttfb:oi,ttfbb:oi,ttlb:oi,cmsdd:oi,cmsds:oi,smrt:oi,df:oi,cs:oi,ts:oi,cid:xl,pr:xl,sf:xl,sid:xl,st:xl,v:xl,msd:xl,bs:Xo,bsd:Xo,cdn:Xo,rtp:Xo,bg:Xo,pt:Xo,ec:Xo,e:Xo},rb={REQUEST:oi};function ib(h){return Object.keys(h).reduce((e,t)=>{var r;return(r=h[t])===null||r===void 0||r.forEach(o=>e[o]=t),e},{})}function ab(h,e){const t={};if(!h)return t;const r=Object.keys(h),o=e?ib(e):{};return r.reduce((l,f)=>{var y;const g=nb[f]||o[f]||rb.REQUEST,p=(y=l[g])!==null&&y!==void 0?y:l[g]={};return p[f]=h[f],l},t)}function sb(h){return["ot","sf","st","e","sta"].includes(h)}function ob(h){return typeof h=="number"?Nn(h):h!=null&&h!==""&&h!==!1}const s0="event";function lb(h,e){const t=new URL(h),r=new URL(e);if(t.origin!==r.origin)return h;const o=t.pathname.split("/").slice(1),l=r.pathname.split("/").slice(1,-1);for(;o[0]===l[0];)o.shift(),l.shift();for(;l.length;)l.shift(),o.unshift("..");return o.join("/")+t.search+t.hash}const Md=h=>Math.round(h),rm=(h,e)=>Array.isArray(h)?h.map(t=>rm(t,e)):h instanceof ks&&typeof h.value=="string"?new ks(rm(h.value,e),h.params):(e.baseUrl&&(h=lb(h,e.baseUrl)),e.version===1?encodeURIComponent(h):h),Sd=h=>Md(h/100)*100,ub=(h,e)=>{let t=h;return e.version>=2&&(h instanceof ks&&typeof h.value=="string"?t=new ks([h]):typeof h=="string"&&(t=[h])),rm(t,e)},cb={br:Md,d:Md,bl:Sd,dl:Sd,mtp:Sd,nor:ub,rtp:Sd,tb:Md},o0="request",l0="response",Nm=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],fb=["e"],db=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Wd(h){return db.test(h)}function hb(h){return Nm.includes(h)||fb.includes(h)||Wd(h)}const u0=["d","dl","nor","ot","rtp","su"];function gb(h){return Nm.includes(h)||u0.includes(h)||Wd(h)}const mb=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function pb(h){return Nm.includes(h)||u0.includes(h)||mb.includes(h)||Wd(h)}const yb=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function vb(h){return yb.includes(h)||Wd(h)}const Eb={[l0]:pb,[s0]:hb,[o0]:gb};function c0(h,e={}){const t={};if(h==null||typeof h!="object")return t;const r=e.version||h.v||1,o=e.reportingMode||o0,l=r===1?vb:Eb[o];let f=Object.keys(h).filter(l);const y=e.filter;typeof y=="function"&&(f=f.filter(y));const g=o===l0||o===s0;g&&!f.includes("ts")&&f.push("ts"),r>1&&!f.includes("v")&&f.push("v");const p=Gr({},cb,e.formatters),m={version:r,reportingMode:o,baseUrl:e.baseUrl};return f.sort().forEach(u=>{let d=h[u];const S=p[u];if(typeof S=="function"&&(d=S(d,m)),u==="v"){if(r===1)return;d=r}u=="pr"&&d===1||(g&&u==="ts"&&!Nn(d)&&(d=Date.now()),ob(d)&&(sb(u)&&typeof d=="string"&&(d=new t0(d)),t[u]=d))}),t}function Tb(h,e={}){const t={};if(!h)return t;const r=c0(h,e),o=ab(r,e==null?void 0:e.customHeaderMap);return Object.entries(o).reduce((l,[f,y])=>{const g=a0(y,{whitespace:!1});return g&&(l[f]=g),l},t)}function Sb(h,e,t){return Gr(h,Tb(e,t))}const _b="CMCD";function Ab(h,e={}){return h?a0(c0(h,e),{whitespace:!1}):""}function bb(h,e={}){if(!h)return"";const t=Ab(h,e);return encodeURIComponent(t)}function Rb(h,e={}){if(!h)return"";const t=bb(h,e);return`${_b}=${t}`}const Cv=/CMCD=[^&#]+/;function Ib(h,e,t){const r=Rb(e,t);if(!r)return h;if(Cv.test(h))return h.replace(Cv,r);const o=h.includes("?")?"&":"?";return`${h}${o}${r}`}class Cb{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=o=>{try{this.apply(o,{ot:oa.MANIFEST,su:!this.initialized})}catch(l){this.hls.logger.warn("Could not generate manifest CMCD data.",l)}},this.applyFragmentData=o=>{try{const{frag:l,part:f}=o,y=this.hls.levels[l.level],g=this.getObjectType(l),p={d:(f||l).duration*1e3,ot:g};(g===oa.VIDEO||g===oa.AUDIO||g==oa.MUXED)&&(p.br=y.bitrate/1e3,p.tb=this.getTopBandwidth(g)/1e3,p.bl=this.getBufferLength(g));const m=f?this.getNextPart(f):this.getNextFrag(l);m!=null&&m.url&&m.url!==l.url&&(p.nor=m.url),this.apply(o,p)}catch(l){this.hls.logger.warn("Could not generate segment CMCD data.",l)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(pe.MEDIA_DETACHED,this.onMediaDetached,this),e.on(pe.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(pe.MEDIA_DETACHED,this.onMediaDetached,this),e.off(pe.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,o;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(o=t.tracks.video)==null?void 0:o.buffer}createData(){var e;return{v:1,sf:MA.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Gr(t,this.createData());const r=t.ot===oa.INIT||t.ot===oa.VIDEO||t.ot===oa.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:o}=this;o&&(t=Object.keys(t).reduce((f,y)=>(o.includes(y)&&(f[y]=t[y]),f),{}));const l={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),Sb(e.headers,t,l)):e.url=Ib(e.url,t,l)}getNextFrag(e){var t;const r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){const o=e.sn-r.startSN;return r.fragments[o+1]}}getNextPart(e){var t;const{index:r,fragment:o}=e,l=(t=this.hls.levels[o.level])==null||(t=t.details)==null?void 0:t.partList;if(l){const{sn:f}=o;for(let y=l.length-1;y>=0;y--){const g=l[y];if(g.index===r&&g.fragment.sn===f)return l[y+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return oa.TIMED_TEXT;if(e.sn==="initSegment")return oa.INIT;if(t==="audio")return oa.AUDIO;if(t==="main")return this.hls.audioTracks.length?oa.VIDEO:oa.MUXED}getTopBandwidth(e){let t=0,r;const o=this.hls;if(e===oa.AUDIO)r=o.audioTracks;else{const l=o.maxAutoLevel,f=l>-1?l+1:o.levels.length;r=o.levels.slice(0,f)}return r.forEach(l=>{l.bitrate>t&&(t=l.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,r=e===oa.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:nr.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(l){this.loader=void 0,this.loader=new r(l)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(l,f,y){t(l),this.loader.load(l,f,y)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(l){this.loader=void 0,this.loader=new r(l)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(l,f,y){t(l),this.loader.load(l,f,y)}}}}const Db=3e5;class Lb extends Ba{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.on(pe.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.off(pe.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if((r==null?void 0:r.action)===wi.SendAlternateToPenaltyBox&&r.flags===Sa.MoveAllAlternatesMatchingHost){const o=this.levels;let l=this._pathwayPriority,f=this.pathwayId;if(t.context){const{groupId:y,pathwayId:g,type:p}=t.context;y&&o?f=this.getPathwayForGroupId(y,p,f):g&&(f=g)}f in this.penalizedPathways||(this.penalizedPathways[f]=performance.now()),!l&&o&&(l=this.pathways()),l&&l.length>1&&(this.updatePathwayPriority(l),r.resolved=this.pathwayId!==f),t.details===wt.BUFFER_APPEND_ERROR&&!t.fatal?r.resolved=!0:r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${f} levels: ${o&&o.length} priorities: ${qr(l)} penalized: ${qr(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const r=this.penalizedPathways,o=performance.now();Object.keys(r).forEach(l=>{o-r[l]>Db&&delete r[l]});for(let l=0;l<e.length;l++){const f=e[l];if(f in r)continue;if(f===this.pathwayId)return;const y=this.hls.nextLoadLevel,g=this.hls.levels[y];if(t=this.getLevelsForPathway(f),t.length>0){this.log(`Setting Pathway to "${f}"`),this.pathwayId=f,xE(t),this.hls.trigger(pe.LEVELS_UPDATED,{levels:t});const p=this.hls.levels[y];g&&p&&this.levels&&(p.attrs["STABLE-VARIANT-ID"]!==g.attrs["STABLE-VARIANT-ID"]&&p.bitrate!==g.bitrate&&this.log(`Unstable Pathways change from bitrate ${g.bitrate} to ${p.bitrate}`),this.hls.nextLoadLevel=y);break}}}getPathwayForGroupId(e,t,r){const o=this.getLevelsForPathway(r).concat(this.levels||[]);for(let l=0;l<o.length;l++)if(t===or.AUDIO_TRACK&&o[l].hasAudioGroup(e)||t===or.SUBTITLE_TRACK&&o[l].hasSubtitleGroup(e))return o[l].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},o={};e.forEach(l=>{const{ID:f,"BASE-ID":y,"URI-REPLACEMENT":g}=l;if(t.some(m=>m.pathwayId===f))return;const p=this.getLevelsForPathway(y).map(m=>{const u=new ti(m.attrs);u["PATHWAY-ID"]=f;const d=u.AUDIO&&`${u.AUDIO}_clone_${f}`,S=u.SUBTITLES&&`${u.SUBTITLES}_clone_${f}`;d&&(r[u.AUDIO]=d,u.AUDIO=d),S&&(o[u.SUBTITLES]=S,u.SUBTITLES=S);const _=f0(m.uri,u["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",g),E=new jc({attrs:u,audioCodec:m.audioCodec,bitrate:m.bitrate,height:m.height,name:m.name,url:_,videoCodec:m.videoCodec,width:m.width});if(m.audioGroups)for(let b=1;b<m.audioGroups.length;b++)E.addGroupId("audio",`${m.audioGroups[b]}_clone_${f}`);if(m.subtitleGroups)for(let b=1;b<m.subtitleGroups.length;b++)E.addGroupId("text",`${m.subtitleGroups[b]}_clone_${f}`);return E});t.push(...p),Dv(this.audioTracks,r,g,f),Dv(this.subtitleTracks,o,g,f)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let o;try{o=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(o.protocol!=="data:"){const m=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;o.searchParams.set("_HLS_pathway",this.pathwayId),o.searchParams.set("_HLS_throughput",""+m)}const l={responseType:"json",url:o.href},f=t.steeringManifestLoadPolicy.default,y=f.errorRetry||f.timeoutRetry||{},g={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:y.maxNumRetry||0,retryDelay:y.retryDelayMs||0,maxRetryDelay:y.maxRetryDelayMs||0},p={onSuccess:(m,u,d,S)=>{this.log(`Loaded steering manifest: "${o}"`);const _=m.data;if((_==null?void 0:_.VERSION)!==1){this.log(`Steering VERSION ${_.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=_.TTL;const{"RELOAD-URI":E,"PATHWAY-CLONES":b,"PATHWAY-PRIORITY":I}=_;if(E)try{this.uri=new self.URL(E,o).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${E}`);return}this.scheduleRefresh(this.uri||d.url),b&&this.clonePathways(b);const T={steeringManifest:_,url:o.toString()};this.hls.trigger(pe.STEERING_MANIFEST_LOADED,T),I&&this.updatePathwayPriority(I)},onError:(m,u,d,S)=>{if(this.log(`Error loading steering manifest: ${m.code} ${m.text} (${u.url})`),this.stopLoad(),m.code===410){this.enabled=!1,this.log(`Steering manifest ${u.url} no longer available`);return}let _=this.timeToLoad*1e3;if(m.code===429){const E=this.loader;if(typeof(E==null?void 0:E.getResponseHeader)=="function"){const b=E.getResponseHeader("Retry-After");b&&(_=parseFloat(b)*1e3)}this.log(`Steering manifest ${u.url} rate limited`);return}this.scheduleRefresh(this.uri||u.url,_)},onTimeout:(m,u,d)=>{this.log(`Timeout loading steering manifest (${u.url})`),this.scheduleRefresh(this.uri||u.url)}};this.log(`Requesting steering manifest: ${o}`),this.loader.load(l,g,p)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const o=(r=this.hls)==null?void 0:r.media;if(o&&!o.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Dv(h,e,t,r){h&&Object.keys(e).forEach(o=>{const l=h.filter(f=>f.groupId===o).map(f=>{const y=Gr({},f);return y.details=void 0,y.attrs=new ti(y.attrs),y.url=y.attrs.URI=f0(f.url,f.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),y.groupId=y.attrs["GROUP-ID"]=e[o],y.attrs["PATHWAY-ID"]=r,y});h.push(...l)})}function f0(h,e,t,r){const{HOST:o,PARAMS:l,[t]:f}=r;let y;e&&(y=f==null?void 0:f[e],y&&(h=y));const g=new self.URL(h);return o&&!y&&(g.host=o),l&&Object.keys(l).sort().forEach(p=>{p&&g.searchParams.set(p,l[p])}),g.href}class Mu extends Ba{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Mu.CDMCleanupPromise?[Mu.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:r,initData:o}=t,l=`"${t.type}" event: init data type: "${r}"`;if(this.debug(l),o!==null){if(!this.keyFormatPromise){let f=Object.keys(this.keySystemAccessPromises);f.length||(f=Bc(this.config));const y=f.map(_g).filter(g=>!!g);this.keyFormatPromise=this.getKeyFormatPromise(y)}this.keyFormatPromise.then(f=>{const y=Nd(f);if(r!=="sinf"||y!==ni.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${r}" for selected key-system ${y}`);return}let g;try{const S=_i(new Uint8Array(o)),_=Em(JSON.parse(S).sinf),E=aE(_);if(!E)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");g=new Uint8Array(E.subarray(8,24))}catch(S){this.warn(`${l} Failed to parse sinf: ${S}`);return}const p=Oi(g),{keyIdToKeySessionPromise:m,mediaKeySessions:u}=this;let d=m[p];for(let S=0;S<u.length;S++){const _=u[S],E=_.decryptdata;if(!E.keyId)continue;const b=Oi(E.keyId);if(Vd(g,E.keyId)||E.uri.replace(/-/g,"").indexOf(p)!==-1){if(d=m[b],!d)continue;if(E.pssh)break;delete m[b],E.pssh=new Uint8Array(o),E.keyId=g,d=m[p]=d.then(()=>this.generateRequestWithPreferredKeySession(_,r,o,"encrypted-event-key-match")),d.catch(I=>this.handleError(I));break}}d||this.handleError(new Error(`Key ID ${p} not encountered in playlist. Key-system sessions ${u.length}.`))}).catch(f=>this.handleError(f))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(pe.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(pe.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(pe.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(pe.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(pe.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(pe.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(pe.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(pe.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,o=t==null?void 0:t[e];if(o)return o.licenseUrl;if(e===ni.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t==null?void 0:t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(f,y,g)=>!!f&&g.indexOf(f)===y,o=t.map(f=>f.audioCodec).filter(r),l=t.map(f=>f.videoCodec).filter(r);return o.length+l.length===0&&l.push("avc1.42e01e"),new Promise((f,y)=>{const g=p=>{const m=p.shift();this.getMediaKeysPromise(m,o,l).then(u=>f({keySystem:m,mediaKeys:u})).catch(u=>{p.length?g(p):u instanceof Ta?y(u):y(new Ta({type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_NO_ACCESS,error:u,fatal:!0},u.message))})};g(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let o=`Configured requestMediaKeySystemAccess is not a function ${r}`;return _E===null&&self.location.protocol==="http:"&&(o=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(o))}return r(e,t)}getMediaKeysPromise(e,t,r){var o;const l=u_(e,t,r,this.config.drmSystemOptions||{});let f=this.keySystemAccessPromises[e],y=(o=f)==null?void 0:o.keySystemAccess;if(!y){this.log(`Requesting encrypted media "${e}" key-system access with config: ${qr(l)}`),y=this.requestMediaKeySystemAccess(e,l);const g=f=this.keySystemAccessPromises[e]={keySystemAccess:y};return y.catch(p=>{this.log(`Failed to obtain access to key-system "${e}": ${p}`)}),y.then(p=>{this.log(`Access for key-system "${p.keySystem}" obtained`);const m=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const u=g.mediaKeys=p.createMediaKeys().then(d=>(this.log(`Media-keys created for "${e}"`),g.hasMediaKeys=!0,m.then(S=>S?this.setMediaKeysServerCertificate(d,e,S):d)));return u.catch(d=>{this.error(`Failed to create media-keys for "${e}"}: ${d}`)}),u})}return y.then(()=>f.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${Oi(e.keyId||[])} keyUri: ${e.uri}`);const o=r.createSession(),l={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:o,keyStatus:"status-pending"};return this.mediaKeySessions.push(l),l}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),o=_d(t),l="cenc";this.keyIdToKeySessionPromise[o]=this.generateRequestWithPreferredKeySession(r,l,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyId ${Oi(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),r.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>_g(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:o})=>{const l=_g(o);l?t(l):r(new Error(`Unable to find format for key-system "${o}"`))}).catch(r)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Bc(this.config),r=e.map(Nd).filter(o=>!!o&&t.indexOf(o)!==-1);return this.selectKeySystem(r)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let r=0;r<t.length;r++){const o=xb(e,t[r]);if(o)return o}}loadKey(e){const t=e.keyInfo.decryptdata,r=_d(t),o=this.bannedKeyIds[r];if(o||this.getKeyStatus(t)==="internal-error"){const y=Lv(o||"internal-error",t);return this.handleError(y,e.frag),Promise.reject(y)}const l=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${l}`);const f=this.keyIdToKeySessionPromise[r];if(!f){const y=this.getKeySystemForKeyPromise(t).then(({keySystem:g,mediaKeys:p})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${l}`),this.attemptSetMediaKeys(g,p).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:g,mediaKeys:p,decryptdata:t}))))).then(g=>{const p="cenc",m=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(g,p,m,"playlist-key")});return y.catch(g=>this.handleError(g,e.frag)),this.keyIdToKeySessionPromise[r]=y,y}return f.catch(y=>{if(y instanceof Ta){const g=Or({},y.data);this.getKeyStatus(t)==="internal-error"&&(g.decryptdata=t);const p=new Ta(g,y.message);this.handleError(p,e.frag)}}),f}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof Ta){t&&(e.data.frag=t);const r=e.data.decryptdata;this.error(`${e.message}${r?` (${Oi(r.keyId||[])})`:""}`),this.hls.trigger(pe.ERROR,e.data)}else this.error(e.message),this.hls.trigger(pe.ERROR,{type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=_d(e),r=this.keyIdToKeySessionPromise[t];if(!r){const o=Nd(e.keyFormat),l=o?[o]:Bc(this.config);return this.attemptKeySystemAccess(l)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=Bc(this.config)),e.length===0)throw new Ta({type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${qr({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const o=Promise.all(r).then(()=>this.media?this.media.setMediaKeys(t):new Promise((l,f)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return f(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(l).catch(f)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(o),o.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(o),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(l=>r.indexOf(l)===-1)})}generateRequestWithPreferredKeySession(e,t,r,o){var l;const f=(l=this.config.drmSystems)==null||(l=l[e.keySystem])==null?void 0:l.generateRequest;if(f)try{const _=f.call(this.hls,t,r,e);if(!_)throw new Error("Invalid response from configured generateRequest filter");t=_.initDataType,r=_.initData?_.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(_){if(this.warn(_.message),this.hls&&this.hls.config.debug)throw _}if(r===null)return this.log(`Skipping key-session request for "${o}" (no initData)`),Promise.resolve(e);const y=_d(e.decryptdata),g=e.decryptdata.uri;this.log(`Generating key-session request for "${o}" keyId: ${y} URI: ${g} (init data type: ${t} length: ${r.byteLength})`);const p=new Sm,m=e._onmessage=_=>{const E=e.mediaKeysSession;if(!E){p.emit("error",new Error("invalid state"));return}const{messageType:b,message:I}=_;this.log(`"${b}" message event for session "${E.sessionId}" message size: ${I.byteLength}`),b==="license-request"||b==="license-renewal"?this.renewLicense(e,I).catch(T=>{p.eventNames().length?p.emit("error",T):this.handleError(T)}):b==="license-release"?e.keySystem===ni.FAIRPLAY&&this.updateKeySession(e,$g("acknowledged")).then(()=>this.removeSession(e)).catch(T=>this.handleError(T)):this.warn(`unhandled media key message type "${b}"`)},u=(_,E)=>{E.keyStatus=_;let b;_.startsWith("usable")?p.emit("resolved"):_==="internal-error"||_==="output-restricted"||_==="output-downscaled"?b=Lv(_,E.decryptdata):_==="expired"?b=new Error(`key expired (keyId: ${y})`):_==="released"?b=new Error("key released"):_==="status-pending"||this.warn(`unhandled key status change "${_}" (keyId: ${y})`),b&&(p.eventNames().length?p.emit("error",b):this.handleError(b))},d=e._onkeystatuseschange=_=>{if(!e.mediaKeysSession){p.emit("error",new Error("invalid state"));return}const b=this.getKeyStatuses(e);if(!Object.keys(b).some(R=>b[R]!=="status-pending"))return;if(b[y]==="expired"){this.log(`Expired key ${qr(b)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let T=b[y];if(T)u(T,e);else{var A;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(A=e.keyStatusTimeouts)[y]||(A[y]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const O=this.getKeyStatus(e.decryptdata);if(O&&O!=="status-pending")return this.log(`No status for keyId ${y} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${O} from other session.`),u(O,e);this.log(`key status for ${y} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),T="internal-error",u(T,e)},1e3)),this.log(`No status for keyId ${y} (${qr(b)}).`)}};Ki(e.mediaKeysSession,"message",m),Ki(e.mediaKeysSession,"keystatuseschange",d);const S=new Promise((_,E)=>{p.on("error",E),p.on("resolved",_)});return e.mediaKeysSession.generateRequest(t,r).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${y} URI: ${g}`)}).catch(_=>{throw new Ta({type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_NO_SESSION,error:_,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${_}`)}).then(()=>S).catch(_=>(p.removeAllListeners(),this.removeSession(e).then(()=>{throw _}))).then(()=>(p.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((r,o)=>{if(typeof o=="string"&&typeof r=="object"){const y=o;o=r,r=y}const l="buffer"in o?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o);if(e.keySystem===ni.PLAYREADY&&l.length===16){const y=Oi(l);t[y]=r,TE(l)}const f=Oi(l);r==="internal-error"&&(this.bannedKeyIds[f]=r),this.log(`key status change "${r}" for keyStatuses keyId: ${f} key-session "${e.mediaKeysSession.sessionId}"`),t[f]=r}),t}fetchServerCertificate(e){const t=this.config,r=t.loader,o=new r(t),l=this.getServerCertificateUrl(e);return l?(this.log(`Fetching server certificate for "${e}"`),new Promise((f,y)=>{const g={responseType:"arraybuffer",url:l},p=t.certLoadPolicy.default,m={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(d,S,_,E)=>{f(d.data)},onError:(d,S,_,E)=>{y(new Ta({type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:_,response:Or({url:g.url,data:void 0},d)},`"${e}" certificate request failed (${l}). Status: ${d.code} (${d.text})`))},onTimeout:(d,S,_)=>{y(new Ta({type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:_,response:{url:g.url,data:void 0}},`"${e}" certificate request timed out (${l})`))},onAbort:(d,S,_)=>{y(new Error("aborted"))}};o.load(g,m,u)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((o,l)=>{e.setServerCertificate(r).then(f=>{this.log(`setServerCertificate ${f?"success":"not supported by CDM"} (${r.byteLength}) on "${t}"`),o(e)}).catch(f=>{l(new Ta({type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:f,fatal:!0},f.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(o=>{throw new Ta({type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:o,fatal:!1},o.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const o=new DOMParser().parseFromString(r,"application/xml"),l=o.querySelectorAll("HttpHeader");if(l.length>0){let m;for(let u=0,d=l.length;u<d;u++){var f,y;m=l[u];const S=(f=m.querySelector("name"))==null?void 0:f.textContent,_=(y=m.querySelector("value"))==null?void 0:y.textContent;S&&_&&e.setRequestHeader(S,_)}}const g=o.querySelector("Challenge"),p=g==null?void 0:g.textContent;if(!p)throw new Error("Cannot find <Challenge> in key message");return $g(atob(p))}setupLicenseXHR(e,t,r,o){const l=this.config.licenseXhrSetup;return l?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return l.call(this.hls,e,t,r,o)}).catch(f=>{if(!r.decryptdata)throw f;return e.open("POST",t,!0),l.call(this.hls,e,t,r,o)}).then(f=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:f||o})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:o}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((o,l)=>{const f=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${f}`);const y=new XMLHttpRequest;y.responseType="arraybuffer",y.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return l(new Error("invalid state"));if(y.readyState===4)if(y.status===200){this._requestLicenseFailureCount=0;let g=y.response;this.log(`License received ${g instanceof ArrayBuffer?g.byteLength:g}`);const p=this.config.licenseResponseCallback;if(p)try{g=p.call(this.hls,y,f,e)}catch(m){this.error(m)}o(g)}else{const g=r.errorRetry,p=g?g.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>p||y.status>=400&&y.status<500)l(new Ta({type:jn.KEY_SYSTEM_ERROR,details:wt.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:y,response:{url:f,data:void 0,code:y.status,text:y.statusText}},`License Request XHR failed (${f}). Status: ${y.status} (${y.statusText})`));else{const m=p-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${m} attempts left`),this.requestLicense(e,t).then(o,l)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=y,this.setupLicenseXHR(y,f,e,t).then(({xhr:g,licenseChallenge:p})=>{e.keySystem==ni.PLAYREADY&&(p=this.unpackPlayReadyKeyMessage(g,p)),g.send(p)}).catch(l)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,Ki(r,"encrypted",this.onMediaEncrypted),Ki(r,"waitingforkey",this.onWaitingForKey);const o=this.mediaResolved;o?o():this.mediaKeys=r.mediaKeys}onMediaDetached(){const e=this.media;e&&(la(e,"encrypted",this.onMediaEncrypted),la(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const r=this.media,o=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,el.clearKeyUriToKeyIdMap();const l=o.length;Mu.CDMCleanupPromise=Promise.all(o.map(f=>this.removeSession(f)).concat((r==null||(e=r.setMediaKeys(null))==null?void 0:e.catch(f=>{this.log(`Could not clear media keys: ${f}`),this.hls&&this.hls.trigger(pe.ERROR,{type:jn.OTHER_ERROR,details:wt.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${f}`)})}))||Promise.resolve())).catch(f=>{this.log(`Could not close sessions and clear media keys: ${f}`),this.hls&&this.hls.trigger(pe.ERROR,{type:jn.OTHER_ERROR,details:wt.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${f}`)})}).then(()=>{l&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((o,l)=>(o.indexOf(l.keyFormat)===-1&&o.push(l.keyFormat),o),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r,decryptdata:o}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${Oi((o==null?void 0:o.keyId)||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const l=this.mediaKeySessions.indexOf(e);l>-1&&this.mediaKeySessions.splice(l,1);const{keyStatusTimeouts:f}=e;f&&Object.keys(f).forEach(p=>self.clearTimeout(f[p]));const{drmSystemOptions:y}=this.config;return(f_(y)?new Promise((p,m)=>{self.setTimeout(()=>m(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(p).catch(m)}):Promise.resolve()).catch(p=>{this.log(`Could not remove session: ${p}`),this.hls&&this.hls.trigger(pe.ERROR,{type:jn.OTHER_ERROR,details:wt.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${p}`)})}).then(()=>t.close()).catch(p=>{this.log(`Could not close session: ${p}`),this.hls&&this.hls.trigger(pe.ERROR,{type:jn.OTHER_ERROR,details:wt.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${p}`)})})}return Promise.resolve()}}Mu.CDMCleanupPromise=void 0;function _d(h){if(!h)throw new Error("Could not read keyId of undefined decryptdata");if(h.keyId===null)throw new Error("keyId is null");return Oi(h.keyId)}function xb(h,e){if(h.keyId&&e.mediaKeysSession.keyStatuses.has(h.keyId))return e.mediaKeysSession.keyStatuses.get(h.keyId);if(h.matches(e.decryptdata))return e.keyStatus}class Ta extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function Lv(h,e){const t=h==="output-restricted",r=t?wt.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:wt.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new Ta({type:jn.KEY_SYSTEM_ERROR,details:r,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${h}"`)}class Nb{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const o=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=o,o&&typeof o.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){const o=performance.now();if(t){if(this.lastTime){const l=o-this.lastTime,f=r-this.lastDroppedFrames,y=t-this.lastDecodedFrames,g=1e3*f/l,p=this.hls;if(p.trigger(pe.FPS_DROP,{currentDropped:f,currentDecoded:y,totalDroppedFrames:r}),g>0&&f>p.config.fpsDroppedMonitoringThreshold*y){let m=p.currentLevel;p.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+m),m>0&&(p.autoLevelCapping===-1||p.autoLevelCapping>=m)&&(m=m-1,p.trigger(pe.FPS_DROP_LEVEL_CAPPING,{level:m,droppedLevel:p.currentLevel}),p.autoLevelCapping=m,this.streamController.nextLevelSwitch())}}this.lastTime=o,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function d0(h,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=h,e.dispatchEvent(t)}function h0(h,e){const t=h.mode;if(t==="disabled"&&(h.mode="hidden"),h.cues&&!h.cues.getCueById(e.id))try{if(h.addCue(e),!h.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){Mr.debug(`[texttrack-utils]: ${r}`);try{const o=new self.TextTrackCue(e.startTime,e.endTime,e.text);o.id=e.id,h.addCue(o)}catch(o){Mr.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${o}`)}}t==="disabled"&&(h.mode=t)}function Nu(h,e){const t=h.mode;if(t==="disabled"&&(h.mode="hidden"),h.cues)for(let r=h.cues.length;r--;)e&&h.cues[r].removeEventListener("enter",e),h.removeCue(h.cues[r]);t==="disabled"&&(h.mode=t)}function im(h,e,t,r){const o=h.mode;if(o==="disabled"&&(h.mode="hidden"),h.cues&&h.cues.length>0){const l=Ob(h.cues,e,t);for(let f=0;f<l.length;f++)(!r||r(l[f]))&&h.removeCue(l[f])}o==="disabled"&&(h.mode=o)}function wb(h,e){if(e<=h[0].startTime)return 0;const t=h.length-1;if(e>h[t].endTime)return-1;let r=0,o=t,l;for(;r<=o;)if(l=Math.floor((o+r)/2),e<h[l].startTime)o=l-1;else if(e>h[l].startTime&&r<t)r=l+1;else return l;return h[r].startTime-e<e-h[o].startTime?r:o}function Ob(h,e,t){const r=[],o=wb(h,e);if(o>-1)for(let l=o,f=h.length;l<f;l++){const y=h[l];if(y.startTime>=e&&y.endTime<=t)r.push(y);else if(y.startTime>t)return r}return r}function Pd(h){const e=[];for(let t=0;t<h.length;t++){const r=h[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(h[t])}return e}class Mb extends Dm{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=Pd(this.media.textTracks);for(let l=0;l<r.length;l++)if(r[l].mode==="hidden")t=r[l];else if(r[l].mode==="showing"){t=r[l];break}const o=this.findTrackForTextTrack(t);this.subtitleTrack!==o&&this.setSubtitleTrack(o)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.on(pe.LEVEL_LOADING,this.onLevelLoading,this),e.on(pe.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(pe.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(pe.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.off(pe.LEVEL_LOADING,this.onLevelLoading,this),e.off(pe.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(pe.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(pe.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const r=this.media;if(!r)return;const o=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,o)return;Pd(r.textTracks).forEach(f=>{Nu(f)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:o,details:l}=t,f=this.tracksInGroup[r];if(!f||f.groupId!==o){this.warn(`Subtitle track with id:${r} and group:${o} not found in active group ${f==null?void 0:f.groupId}`);return}const y=f.details;f.details=t.details,this.log(`Subtitle track ${r} "${f.name}" lang:${f.lang} group:${o} loaded [${l.startSN}-${l.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,y)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,o=this.groupIds;let l=this.currentTrack;if(!r||(o==null?void 0:o.length)!==(r==null?void 0:r.length)||r!=null&&r.some(f=>(o==null?void 0:o.indexOf(f))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const f=this.tracks.filter(m=>!r||r.indexOf(m.groupId)!==-1);if(f.length)this.selectDefaultTrack&&!f.some(m=>m.default)&&(this.selectDefaultTrack=!1),f.forEach((m,u)=>{m.id=u});else if(!l&&!this.tracksInGroup.length)return;this.tracksInGroup=f;const y=this.hls.config.subtitlePreference;if(!l&&y){this.selectDefaultTrack=!1;const m=Ms(y,f);if(m>-1)l=f[m];else{const u=Ms(y,this.tracks);l=this.tracks[u]}}let g=this.findTrackId(l);g===-1&&l&&(g=this.findTrackId(null));const p={subtitleTracks:f};this.log(`Updating subtitle tracks, ${f.length} track(s) found in "${r==null?void 0:r.join(",")}" group-id`),this.hls.trigger(pe.SUBTITLE_TRACKS_UPDATED,p),g!==-1&&this.trackId===-1&&this.setSubtitleTrack(g)}}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let o=0;o<t.length;o++){const l=t[o];if(!(r&&!l.default||!r&&!e)&&(!e||Ol(l,e)))return o}if(e){for(let o=0;o<t.length;o++){const l=t[o];if($c(e.attrs,l.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return o}for(let o=0;o<t.length;o++){const l=t[o];if($c(e.attrs,l.attrs,["LANGUAGE"]))return o}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const o=t[r];if(em(o,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===or.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&Ol(e,r))return r;const o=Ms(e,this.tracksInGroup);if(o>-1){const l=this.tracksInGroup[o];return this.setSubtitleTrack(o),l}else{if(r)return null;{const l=Ms(e,t);if(l>-1)return t[l]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,o=e.groupId,l=this.getUrlWithDirectives(e.url,t),f=e.details,y=f==null?void 0:f.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${o}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${y&&f.live?" age "+y.toFixed(1)+(f.type&&" "+f.type||""):""} ${l}`),this.hls.trigger(pe.SUBTITLE_TRACK_LOADING,{url:l,id:r,groupId:o,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Pd(e.textTracks),r=this.currentTrack;let o;if(r&&(o=t.filter(l=>em(r,l))[0],o||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(l=>{l.mode!=="disabled"&&l!==o&&(l.mode="disabled")}),o){const l=this.subtitleDisplay?"showing":"hidden";o.mode!==l&&(o.mode=l)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!Nn(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,o=t[e]||null;if(this.trackId=e,this.currentTrack=o,this.toggleTrackModes(),!o){this.hls.trigger(pe.SUBTITLE_TRACK_SWITCH,{id:e});return}const l=!!o.details&&!o.details.live;if(e===this.trackId&&o===r&&l)return;this.log(`Switching to subtitle-track ${e}`+(o?` "${o.name}" lang:${o.lang} group:${o.groupId}`:""));const{id:f,groupId:y="",name:g,type:p,url:m}=o;this.hls.trigger(pe.SUBTITLE_TRACK_SWITCH,{id:f,groupId:y,name:g,type:p,url:m});const u=this.switchParams(o.url,r==null?void 0:r.details,o.details);this.loadPlaylist(u)}}function Pb(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,o=>{const l=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(o=="x"?l:l&3|8).toString(16)})}}}function Hc(h){let e=5381,t=h.length;for(;t;)e=e*33^h.charCodeAt(--t);return(e>>>0).toString()}const Pu=.025;let Kd=(function(h){return h[h.Point=0]="Point",h[h.Range=1]="Range",h})({});function kb(h,e,t){return`${h.identifier}-${t+1}-${Hc(e)}`}class Fb{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Ng(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,r=Ng(t,e);return t-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=Nn(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Ng(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Pu))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Kd.Range:Kd.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return Ub(this)}}function Ng(h,e){return h-e.start<e.duration/2&&!(Math.abs(h-(e.start+e.duration))<Pu)?e.start:e.start+e.duration}function g0(h,e,t){const r=new self.URL(h,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function wg(h,e){for(;(t=h.assetList[++e])!=null&&t.error;)var t;return e}function Ub(h){return`["${h.identifier}" ${h.cue.pre?"<pre>":h.cue.post?"<post>":""}${h.timelineStart.toFixed(2)}-${h.resumeTime.toFixed(2)}]`}function xu(h){const e=h.timelineStart,t=h.duration||0;return`["${h.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class Bb{constructor(e,t,r,o){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(pe.PLAYOUT_LIMIT_REACHED,{})};const l=this.hls=new e(t);this.interstitial=r,this.assetItem=o;const f=()=>{this.hasDetails=!0};l.once(pe.LEVEL_LOADED,f),l.once(pe.AUDIO_TRACK_LOADED,f),l.once(pe.SUBTITLE_TRACK_LOADED,f),l.on(pe.MEDIA_ATTACHING,(y,{media:g})=>{this.removeMediaListeners(),this.mediaAttached=g,this.interstitial.playoutLimit&&(g.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&l.on(pe.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,l.trigger(pe.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=g0(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const r=Math.min(this._bufferedEosTime||1/0,this.duration),o=this.timelineOffset,l=nr.bufferInfo(e,o,0);return this.getAssetTime(l.end)>=r-.02}reachedPlayout(e){const r=this.interstitial.playoutLimit;return this.startOffset+e>=r}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=nr.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const r=t-this.startOffset;if(r>0&&r<e)return r}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const r=e-t;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){var o;(o=this.hls)==null||o.on(e,t)}once(e,t,r){var o;(o=this.hls)==null||o.once(e,t)}off(e,t,r){var o;(o=this.hls)==null||o.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${xu(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const xv=.033;class Gb extends Ba{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,o)=>e<=o.startOffset&&t>o.startOffset?(delete o.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const o=this.items;if(o)for(o[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(l=o[r])!=null&&l.event;){var l;r--}return r}findItemIndexAtTime(e,t){const r=this.items;if(r)for(let o=0;o<r.length;o++){let l=r[o];if(t&&t!=="primary"&&(l=l[t]),e===l.start||e>l.start&&e<l.end)return o}return-1}findJumpRestrictedIndex(e,t){const r=this.items;if(r)for(let o=e;o<=t&&r[o];o++){const l=r[o].event;if(l!=null&&l.restrictions.jump&&!l.appendInPlace)return o}return-1}findEventIndex(e){const t=this.items;if(t)for(let o=t.length;o--;){var r;if(((r=t[o].event)==null?void 0:r.identifier)===e)return o}return-1}findAssetIndex(e,t){const r=e.assetList,o=r.length;if(o>1)for(let l=0;l<o;l++){const f=r[l];if(!f.error){const y=f.timelineStart;if(t===y||t>y&&(t<y+(f.duration||0)||l===o-1))return l}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const r=t.assetList,o=r[r.length-1];if(o)return o.identifier}return null}parseInterstitialDateRanges(e,t){const r=e.main.details,{dateRanges:o}=r,l=this.events,f=this.parseDateRanges(o,{url:r.url},t),y=Object.keys(o),g=l?l.filter(p=>!y.includes(p.identifier)):[];f.length&&f.sort((p,m)=>{const u=p.cue.pre,d=p.cue.post,S=m.cue.pre,_=m.cue.post;if(u&&!S)return-1;if(S&&!u||d&&!_)return 1;if(_&&!d)return-1;if(!u&&!S&&!d&&!_){const E=p.startTime,b=m.startTime;if(E!==b)return E-b}return p.dateRange.tagOrder-m.dateRange.tagOrder}),this.events=f,g.forEach(p=>{this.removeEvent(p)}),this.updateSchedule(e,g)}updateSchedule(e,t=[],r=!1){const o=this.events||[];if(o.length||t.length||this.length<2){const l=this.items,f=this.parseSchedule(o,e);(r||t.length||(l==null?void 0:l.length)!==f.length||f.some((g,p)=>Math.abs(g.playout.start-l[p].playout.start)>.005||Math.abs(g.playout.end-l[p].playout.end)>.005))&&(this.items=f,this.onScheduleUpdate(t,l))}}parseDateRanges(e,t,r){const o=[],l=Object.keys(e);for(let f=0;f<l.length;f++){const y=l[f],g=e[y];if(g.isInterstitial){let p=this.eventMap[y];p?p.setDateRange(g):(p=new Fb(g,t),this.eventMap[y]=p,r===!1&&(p.appendInPlace=r)),o.push(p)}}return o}parseSchedule(e,t){const r=[],o=t.main.details,l=o.live?1/0:o.edge;let f=0;if(e=e.filter(g=>!g.error&&!(g.cue.once&&g.hasPlayed)),e.length){this.resolveOffsets(e,t);let g=0,p=0;if(e.forEach((m,u)=>{const d=m.cue.pre,S=m.cue.post,_=e[u-1]||null,E=m.appendInPlace,b=S?l:m.startOffset,I=m.duration,T=m.timelineOccupancy===Kd.Range?I:0,A=m.resumptionOffset,R=(_==null?void 0:_.startTime)===b,O=b+m.cumulativeDuration;let H=E?O+I:b+A;if(d||!S&&b<=0){const Z=p;p+=T,m.timelineStart=O;const $=f;f+=I,r.push({event:m,start:O,end:H,playout:{start:$,end:f},integrated:{start:Z,end:p}})}else if(b<=l){if(!R){const F=b-g;if(F>xv){const W=g,fe=p;p+=F;const ne=f;f+=F;const de={previousEvent:e[u-1]||null,nextEvent:m,start:W,end:W+F,playout:{start:ne,end:f},integrated:{start:fe,end:p}};r.push(de)}else F>0&&_&&(_.cumulativeDuration+=F,r[r.length-1].end=b)}S&&(H=O),m.timelineStart=O;const Z=p;p+=T;const $=f;f+=I,r.push({event:m,start:O,end:H,playout:{start:$,end:f},integrated:{start:Z,end:p}})}else return;const U=m.resumeTime;S||U>l?g=l:g=U}),g<l){var y;const m=g,u=p,d=l-g;p+=d;const S=f;f+=d,r.push({previousEvent:((y=r[r.length-1])==null?void 0:y.event)||null,nextEvent:null,start:g,end:m+d,playout:{start:S,end:f},integrated:{start:u,end:p}})}this.setDurations(l,f,p)}else r.push({previousEvent:null,nextEvent:null,start:0,end:l,playout:{start:0,end:l},integrated:{start:0,end:l}}),this.setDurations(l,l,l);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){const r=t.main.details,o=r.live?1/0:r.edge;let l=0,f=-1;e.forEach((y,g)=>{const p=y.cue.pre,m=y.cue.post,u=p?0:m?o:y.startTime;this.updateAssetDurations(y),f===u?y.cumulativeDuration=l:(l=0,f=u),!m&&y.snapOptions.in&&(y.resumeAnchor=Ml(null,r.fragments,y.startOffset+y.resumptionOffset,0,0)||void 0),y.appendInPlace&&!y.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(y,t)||(y.appendInPlace=!1)),!y.appendInPlace&&g+1<e.length&&e[g+1].startTime-e[g].resumeTime<xv&&(e[g+1].appendInPlace=!1,e[g+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${y}`));const S=Nn(y.resumeOffset)?y.resumeOffset:y.duration;l+=S})}primaryCanResumeInPlaceAt(e,t){const r=e.resumeTime,o=e.startTime+e.resumptionOffset;return Math.abs(r-o)>Pu?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${o}`),!1):!Object.keys(t).some(f=>{const y=t[f].details,g=y.edge;if(r>=g)return this.log(`"${e.identifier}" resumption ${r} past ${f} playlist end ${g}`),!1;const p=Ml(null,y.fragments,r);if(!p)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${f} playlist (${y.fragStart}-${y.fragmentEnd})`),!0;const m=f==="audio"?.175:0;return Math.abs(p.start-r)<Pu+m||Math.abs(p.end-r)<Pu+m?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${f} fragment bounds (${p.start}-${p.end} sn: ${p.sn} cc: ${p.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let r=0,o=!1,l=!1;for(let f=0;f<e.assetList.length;f++){const y=e.assetList[f],g=t+r;y.startOffset=r,y.timelineStart=g,o||(o=y.duration===null),l||(l=!!y.error);const p=y.error?0:y.duration||0;r+=p}o&&!l?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function ss(h){return`[${h.event?'"'+h.event.identifier+'"':"primary"}: ${h.start.toFixed(2)}-${h.end.toFixed(2)}]`}class Zb{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const r=e.assetListUrl;let o;try{o=g0(r,this.hls.sessionId,e.baseUrl)}catch(d){const S=this.assignAssetListError(e,wt.ASSET_LIST_LOAD_ERROR,d,r);this.hls.trigger(pe.ERROR,S);return}t&&o.protocol!=="data:"&&o.searchParams.set("_HLS_start_offset",""+t);const l=this.hls.config,f=l.loader,y=new f(l),g={responseType:"json",url:o.href},p=l.interstitialAssetListLoadPolicy.default,m={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(d,S,_,E)=>{const b=d.data,I=b==null?void 0:b.ASSETS;if(!Array.isArray(I)){const T=this.assignAssetListError(e,wt.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),_.url,S,E);this.hls.trigger(pe.ERROR,T);return}e.assetListResponse=b,this.hls.trigger(pe.ASSET_LIST_LOADED,{event:e,assetListResponse:b,networkDetails:E})},onError:(d,S,_,E)=>{const b=this.assignAssetListError(e,wt.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${d.code} ${d.text} (${S.url})`),S.url,E,_);this.hls.trigger(pe.ERROR,b)},onTimeout:(d,S,_)=>{const E=this.assignAssetListError(e,wt.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${S.url})`),S.url,d,_);this.hls.trigger(pe.ERROR,E)}};return y.load(g,m,u),this.hls.trigger(pe.ASSET_LIST_LOADING,{event:e}),y}assignAssetListError(e,t,r,o,l,f){return e.error=r,{type:jn.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:o,error:r,networkDetails:f,stats:l}}}function Nv(h){var e;h==null||(e=h.play())==null||e.catch(()=>{})}function Ad(h,e){return`[${h}] Advancing timeline position to ${e}`}class Hb extends Ba{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled||!this.schedule)return;const o=r-this.timelinePos;if(Math.abs(o)<1/7056e5)return;const f=o<=-.01;this.timelinePos=r,this.bufferedPos=r;const y=this.playingItem;if(!y){this.checkBuffer();return}if(f&&this.schedule.resetErrorsInRange(r,r-o)&&this.updateSchedule(!0),this.checkBuffer(),f&&r<y.start||r>=y.end){var g;const S=this.findItemIndex(y);let _=this.schedule.findItemIndexAtTime(r);if(_===-1&&(_=S+(f?-1:1),this.log(`seeked ${f?"back ":""}to position not covered by schedule ${r} (resolving from ${S} to ${_})`)),!this.isInterstitial(y)&&(g=this.media)!=null&&g.paused&&(this.shouldPlay=!1),!f&&_>S){const E=this.schedule.findJumpRestrictedIndex(S+1,_);if(E>S){this.setSchedulePosition(E);return}}this.setSchedulePosition(_);return}const p=this.playingAsset;if(!p){if(this.playingLastItem&&this.isInterstitial(y)){const S=y.event.assetList[0];S&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,S))}return}const m=p.timelineStart,u=p.duration||0;if(f&&r<m||r>=m+u){var d;(d=y.event)!=null&&d.appendInPlace&&(this.clearAssetPlayers(y.event,y),this.flushFrontBuffer(r)),this.setScheduleToAssetAtTime(r,p)}},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const o=this.playingItem;if(!o||this.playingLastItem)return;if(r>=o.end){this.timelinePos=o.end;const y=this.findItemIndex(o);this.setSchedulePosition(y+1)}const l=this.playingAsset;if(!l)return;const f=l.timelineStart+(l.duration||0);r>=f&&this.setScheduleToAssetAtTime(r,l)},this.onScheduleUpdate=(r,o)=>{const l=this.schedule;if(!l)return;const f=this.playingItem,y=l.events||[],g=l.items||[],p=l.durations,m=r.map(E=>E.identifier),u=!!(y.length||m.length);(u||o)&&this.log(`INTERSTITIALS_UPDATED (${y.length}): ${y}
Schedule: ${g.map(E=>ss(E))} pos: ${this.timelinePos}`),m.length&&this.log(`Removed events ${m}`);let d=null,S=null;f&&(d=this.updateItem(f,this.timelinePos),this.itemsMatch(f,d)?this.playingItem=d:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const _=this.bufferingItem;if(_&&(S=this.updateItem(_,this.bufferedPos),this.itemsMatch(_,S)?this.bufferingItem=S:_.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(_.event,null))),r.forEach(E=>{E.assetList.forEach(b=>{this.clearAssetPlayer(b.identifier,null)})}),this.playerQueue.forEach(E=>{if(E.interstitial.appendInPlace){const b=E.assetItem.timelineStart,I=E.timelineOffset-b;if(I)try{E.timelineOffset=b}catch(T){Math.abs(I)>Pu&&this.warn(`${T} ("${E.assetId}" ${E.timelineOffset}->${b})`)}}}),u||o){if(this.hls.trigger(pe.INTERSTITIALS_UPDATED,{events:y.slice(0),schedule:g.slice(0),durations:p,removedIds:m}),this.isInterstitial(f)&&m.includes(f.event.identifier)){this.warn(`Interstitial "${f.event.identifier}" removed while playing`),this.primaryFallback(f.event);return}f&&this.trimInPlace(d,f),_&&S!==d&&this.trimInPlace(S,_),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new Zb(e),this.schedule=new Gb(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(pe.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(pe.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(pe.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(pe.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(pe.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(pe.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(pe.BUFFER_APPENDED,this.onBufferAppended,this),e.on(pe.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(pe.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(pe.MEDIA_ENDED,this.onMediaEnded,this),e.on(pe.ERROR,this.onError,this),e.on(pe.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(pe.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(pe.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(pe.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(pe.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(pe.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(pe.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(pe.BUFFER_CODECS,this.onBufferCodecs,this),e.off(pe.BUFFER_APPENDED,this.onBufferAppended,this),e.off(pe.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(pe.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(pe.MEDIA_ENDED,this.onMediaEnded,this),e.off(pe.ERROR,this.onError,this),e.off(pe.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){la(e,"play",this.onPlay),la(e,"pause",this.onPause),la(e,"seeking",this.onSeeking),la(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const r=this.media=t.media;Ki(r,"seeking",this.onSeeking),Ki(r,"timeupdate",this.onTimeupdate),Ki(r,"play",this.onPlay),Ki(r,"pause",this.onPause)}onMediaAttached(e,t){const r=this.effectivePlayingItem,o=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!o){this.clearScheduleState();const l=this.findItemIndex(r);this.setSchedulePosition(l)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const r=!!t.transferMedia,o=this.media;if(this.media=null,!r&&(o&&this.removeMediaListeners(o),this.detachedData)){const l=this.getBufferingPlayer();l&&(this.log(`Removing schedule state for detachedData and ${l}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,l.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,r=u=>u&&e.getAssetPlayer(u.identifier),o=(u,d,S,_,E)=>{if(u){let b=u[d].start;const I=u.event;if(I){if(d==="playout"||I.timelineOccupancy!==Kd.Point){const T=r(S);(T==null?void 0:T.interstitial)===I&&(b+=T.assetItem.startOffset+T[E])}}else{const T=_==="bufferedPos"?f():e[_];b+=T-u.start}return b}return 0},l=(u,d)=>{var S;if(u!==0&&d!=="primary"&&(S=e.schedule)!=null&&S.length){var _;const E=e.schedule.findItemIndexAtTime(u),b=(_=e.schedule.items)==null?void 0:_[E];if(b){const I=b[d].start-b.start;return u+I}}return u},f=()=>{const u=e.bufferedPos;return u===Number.MAX_VALUE?y("primary"):Math.max(u,0)},y=u=>{var d,S;return(d=e.primaryDetails)!=null&&d.live?e.primaryDetails.edge:((S=e.schedule)==null?void 0:S.durations[u])||0},g=(u,d)=>{var S,_;const E=e.effectivePlayingItem;if(E!=null&&(S=E.event)!=null&&S.restrictions.skip||!e.schedule)return;e.log(`seek to ${u} "${d}"`);const b=e.effectivePlayingItem,I=e.schedule.findItemIndexAtTime(u,d),T=(_=e.schedule.items)==null?void 0:_[I],A=e.getBufferingPlayer(),R=A==null?void 0:A.interstitial,O=R==null?void 0:R.appendInPlace,H=b&&e.itemsMatch(b,T);if(b&&(O||H)){const U=r(e.playingAsset),Z=(U==null?void 0:U.media)||e.primaryMedia;if(Z){const $=d==="primary"?Z.currentTime:o(b,d,e.playingAsset,"timelinePos","currentTime"),F=u-$,W=(O?$:Z.currentTime)+F;if(W>=0&&(!U||O||W<=U.duration)){Z.currentTime=W;return}}}if(T){let U=u;if(d!=="primary"){const $=T[d].start,F=u-$;U=T.start+F}const Z=!e.isInterstitial(T);if((!e.isInterstitial(b)||b.event.appendInPlace)&&(Z||T.event.appendInPlace)){const $=e.media||(O?A==null?void 0:A.media:null);$&&($.currentTime=U)}else if(b){const $=e.findItemIndex(b);if(I>$){const W=e.schedule.findJumpRestrictedIndex($+1,I);if(W>$){e.setSchedulePosition(W);return}}let F=0;if(Z)e.timelinePos=U,e.checkBuffer();else{const W=T.event.assetList,fe=u-(T[d]||T).start;for(let ne=W.length;ne--;){const de=W[ne];if(de.duration&&fe>=de.startOffset&&fe<de.startOffset+de.duration){F=ne;break}}}e.setSchedulePosition(I,F)}}},p=()=>{const u=e.effectivePlayingItem;if(e.isInterstitial(u))return u;const d=t();return e.isInterstitial(d)?d:null},m={get bufferedEnd(){const u=t(),d=e.bufferingItem;if(d&&d===u){var S;return o(d,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-d.playout.start||((S=e.bufferingAsset)==null?void 0:S.startOffset)||0}return 0},get currentTime(){const u=p(),d=e.effectivePlayingItem;return d&&d===u?o(d,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-d.playout.start:0},set currentTime(u){const d=p(),S=e.effectivePlayingItem;S&&S===d&&g(u+S.playout.start,"playout")},get duration(){const u=p();return u?u.playout.end-u.playout.start:0},get assetPlayers(){var u;const d=(u=p())==null?void 0:u.event.assetList;return d?d.map(S=>e.getAssetPlayer(S.identifier)):[]},get playingIndex(){var u;const d=(u=p())==null?void 0:u.event;return d&&e.effectivePlayingAsset?d.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return p()}};return this.manager={get events(){var u;return((u=e.schedule)==null||(u=u.events)==null?void 0:u.slice(0))||[]},get schedule(){var u;return((u=e.schedule)==null||(u=u.items)==null?void 0:u.slice(0))||[]},get interstitialPlayer(){return p()?m:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const u=t();return e.findItemIndex(u)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const u=e.effectivePlayingItem;return e.findItemIndex(u)},primary:{get bufferedEnd(){return f()},get currentTime(){const u=e.timelinePos;return u>0?u:0},set currentTime(u){g(u,"primary")},get duration(){return y("primary")},get seekableStart(){var u;return((u=e.primaryDetails)==null?void 0:u.fragmentStart)||0}},integrated:{get bufferedEnd(){return o(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return o(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(u){g(u,"integrated")},get duration(){return y("integrated")},get seekableStart(){var u;return l(((u=e.primaryDetails)==null?void 0:u.fragmentStart)||0,"integrated")}},skip:()=>{const u=e.effectivePlayingItem,d=u==null?void 0:u.event;if(d&&!d.restrictions.skip){const S=e.findItemIndex(u);if(d.appendInPlace){const _=u.playout.start+u.event.duration;g(_+.001,"playout")}else e.advanceAfterAssetEnded(d,S,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!r?!1:this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let o=this.media;!o&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(o=this.primaryMedia);const l=(t=o)==null?void 0:t.currentTime;if(!(l===void 0||!Nn(l)))return l}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){const r=e.interstitial.appendInPlace,o=e.media;if(r&&o===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&o){this.detachedData={media:o};return}const l=e.transferMedia();this.log(`transfer MediaSource from ${e} ${qr(l)}`),this.detachedData=l}else t&&o&&(this.shouldPlay||(this.shouldPlay=!o.paused))}transferMediaTo(e,t){var r,o;if(e.media===t)return;let l=null;const f=this.hls,y=e!==f,g=y&&e.interstitial.appendInPlace,p=(r=this.detachedData)==null?void 0:r.mediaSource;let m;if(f.media)g&&(l=f.transferMedia(),this.detachedData=l),m="Primary";else if(p){const _=this.getBufferingPlayer();_?(l=_.transferMedia(),m=`${_}`):m="detached MediaSource"}else m="detached media";if(!l){if(p)l=this.detachedData,this.log(`using detachedData: MediaSource ${qr(l)}`);else if(!this.detachedData||f.media===t){const _=this.playerQueue;_.length>1&&_.forEach(E=>{if(y&&E.interstitial.appendInPlace!==g){const b=E.interstitial;this.clearInterstitial(E.interstitial,null),b.appendInPlace=!1,b.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${b}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const u=l&&"mediaSource"in l&&((o=l.mediaSource)==null?void 0:o.readyState)!=="closed",d=u&&l?l:t;this.log(`${u?"transfering MediaSource":"attaching media"} to ${y?e:"Primary"} from ${m} (media.currentTime: ${t.currentTime})`);const S=this.schedule;if(d===l&&S){const _=y&&e.assetId===S.assetIdAtEnd;d.overrides={duration:S.duration,endOfStream:!y||_,cueRemoval:!y}}e.attachMedia(d)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e==null?void 0:e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,o=this.effectivePlayingItem;if(r===-1){const l=this.hls.startPosition;if(this.log(Ad("checkStart",l)),this.timelinePos=l,t.length&&t[0].cue.pre){const f=e.findEventIndex(t[0].identifier);this.setSchedulePosition(f)}else if(l>=0||!this.primaryLive){const f=this.timelinePos=l>0?l:0,y=e.findItemIndexAtTime(f);this.setSchedulePosition(y)}}else if(o&&!this.playingItem){const l=e.findItemIndex(o);this.setSchedulePosition(l)}}advanceAssetBuffering(e,t){const r=e.event,o=r.findAssetIndex(t),l=wg(r,o);if(!r.isAssetPastPlayoutLimit(l))this.bufferedToEvent(e,l);else if(this.schedule){var f;const y=(f=this.schedule.items)==null?void 0:f[this.findItemIndex(e)+1];y&&this.bufferedToItem(y)}}advanceAfterAssetEnded(e,t,r){const o=wg(e,r);if(e.isAssetPastPlayoutLimit(o)){if(this.schedule){const l=this.schedule.items;if(l){const f=t+1,y=l.length;if(f>=y){this.setSchedulePosition(-1);return}const g=e.resumeTime;this.timelinePos<g&&(this.log(Ad("advanceAfterAssetEnded",g)),this.timelinePos=g,e.appendInPlace&&this.advanceInPlace(g),this.checkBuffer(this.bufferedPos<g)),this.setSchedulePosition(f)}}}else{if(e.appendInPlace){const l=e.assetList[o];l&&this.advanceInPlace(l.timelineStart)}this.setSchedulePosition(t,o)}}setScheduleToAssetAtTime(e,t){const r=this.schedule;if(!r)return;const o=t.parentIdentifier,l=r.getEvent(o);if(l){const f=r.findEventIndex(o),y=r.findAssetIndex(l,e);this.advanceAfterAssetEnded(l,f,y-1)}}setSchedulePosition(e,t){var r;const o=(r=this.schedule)==null?void 0:r.items;if(!o||this.playbackDisabled)return;const l=e>=0?o[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${l&&ss(l)}) pos: ${this.timelinePos}`);const f=this.waitingItem||this.playingItem,y=this.playingLastItem;if(this.isInterstitial(f)){const m=f.event,u=this.playingAsset,d=u==null?void 0:u.identifier,S=d?this.getAssetPlayer(d):null;if(S&&d&&(!this.eventItemsMatch(f,l)||t!==void 0&&d!==m.assetList[t].identifier)){var g;const _=m.findAssetIndex(u);if(this.log(`INTERSTITIAL_ASSET_ENDED ${_+1}/${m.assetList.length} ${xu(u)}`),this.endedAsset=u,this.playingAsset=null,this.hls.trigger(pe.INTERSTITIAL_ASSET_ENDED,{asset:u,assetListIndex:_,event:m,schedule:o.slice(0),scheduleIndex:e,player:S}),f!==this.playingItem){this.itemsMatch(f,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(m,this.findItemIndex(this.playingItem),_);return}this.retreiveMediaSource(d,l),S.media&&!((g=this.detachedData)!=null&&g.mediaSource)&&S.detachMedia()}if(!this.eventItemsMatch(f,l)&&(this.endedItem=f,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${m} ${ss(f)}`),m.hasPlayed=!0,this.hls.trigger(pe.INTERSTITIAL_ENDED,{event:m,schedule:o.slice(0),scheduleIndex:e}),m.cue.once)){var p;this.updateSchedule();const _=(p=this.schedule)==null?void 0:p.items;if(l&&_){const E=this.findItemIndex(l);this.advanceSchedule(E,_,t,f,y)}return}}this.advanceSchedule(e,o,t,f,y)}advanceSchedule(e,t,r,o,l){const f=this.schedule;if(!f)return;const y=t[e]||null,g=this.primaryMedia,p=this.playerQueue;if(p.length&&p.forEach(m=>{const u=m.interstitial,d=f.findEventIndex(u.identifier);(d<e||d>e+1)&&this.clearInterstitial(u,y)}),this.isInterstitial(y)){this.timelinePos=Math.min(Math.max(this.timelinePos,y.start),y.end);const m=y.event;if(r===void 0){r=f.findAssetIndex(m,this.timelinePos);const _=wg(m,r-1);if(m.isAssetPastPlayoutLimit(_)||m.appendInPlace&&this.timelinePos===y.end){this.advanceAfterAssetEnded(m,e,r);return}r=_}const u=this.waitingItem;this.assetsBuffered(y,g)||this.setBufferingItem(y);let d=this.preloadAssets(m,r);if(this.eventItemsMatch(y,u||o)||(this.waitingItem=y,this.log(`INTERSTITIAL_STARTED ${ss(y)} ${m.appendInPlace?"append in place":""}`),this.hls.trigger(pe.INTERSTITIAL_STARTED,{event:m,schedule:t.slice(0),scheduleIndex:e})),!m.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${m}`);return}if(m.assetListLoader&&(m.assetListLoader.destroy(),m.assetListLoader=void 0),!g){this.log(`Waiting for attachMedia to start Interstitial ${m}`);return}this.waitingItem=this.endedItem=null,this.playingItem=y;const S=m.assetList[r];if(!S){this.advanceAfterAssetEnded(m,e,r||0);return}if(d||(d=this.getAssetPlayer(S.identifier)),d===null||d.destroyed){const _=m.assetList.length;this.warn(`asset ${r+1}/${_} player destroyed ${m}`),d=this.createAssetPlayer(m,S,r),d.loadSource()}if(!this.eventItemsMatch(y,this.bufferingItem)&&m.appendInPlace&&this.isAssetBuffered(S))return;this.startAssetPlayer(d,r,t,e,g),this.shouldPlay&&Nv(d.media)}else y?(this.resumePrimary(y,e,o),this.shouldPlay&&Nv(this.hls.media)):l&&this.isInterstitial(o)&&(this.endedItem=null,this.playingItem=o,o.event.appendInPlace||this.attachPrimary(f.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var o,l;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${ss(e)}`),!((o=this.detachedData)!=null&&o.mediaSource)){let y=this.timelinePos;(y<e.start||y>=e.end)&&(y=this.getPrimaryResumption(e,t),this.log(Ad("resumePrimary",y)),this.timelinePos=y),this.attachPrimary(y,e)}if(!r)return;const f=(l=this.schedule)==null?void 0:l.items;f&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${ss(e)}`),this.hls.trigger(pe.INTERSTITIALS_PRIMARY_RESUMED,{schedule:f.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const r=e.start;if(this.primaryLive){const o=this.primaryDetails;if(t===0)return this.hls.startPosition;if(o&&(r<o.fragmentStart||r>o.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:nr.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const o=this.primaryMedia;if(!o)return;const l=this.hls;l.media?this.checkBuffer():(this.transferMediaTo(l,o),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(Ad("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;const o=this.hls;!o.loadingEnabled||!o.media||Math.abs((((r=o.mainForwardBufferInfo)==null?void 0:r.start)||o.media.currentTime)-e)>.5?o.startLoad(e,t):o.bufferingEnabled||o.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(pe.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(pe.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const r=this.hls.levels[t.level];if(!r.details)return;const o=Or(Or({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=o,this.schedule.parseInterstitialDateRanges(o,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const r=this.hls.audioTracks[t.id],o=this.mediaSelection;if(!o){this.altSelection=Or(Or({},this.altSelection),{},{audio:r});return}const l=Or(Or({},o),{},{audio:r});this.mediaSelection=l}onSubtitleTrackUpdated(e,t){const r=this.hls.subtitleTracks[t.id],o=this.mediaSelection;if(!o){this.altSelection=Or(Or({},this.altSelection),{},{subtitles:r});return}const l=Or(Or({},o),{},{subtitles:r});this.mediaSelection=l}onAudioTrackSwitching(e,t){const r=Gy(t);this.playerQueue.forEach(({hls:o})=>o&&(o.setAudioOption(t)||o.setAudioOption(r)))}onSubtitleTrackSwitch(e,t){const r=Gy(t);this.playerQueue.forEach(({hls:o})=>o&&(o.setSubtitleOption(t)||t.id!==-1&&o.setSubtitleOption(r)))}onBufferCodecs(e,t){const r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const o=this.timelinePos;this.bufferedPos=o,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let o=0;o<t.length;o++){const l=t[o];if(l.cue.post){var r;const f=this.schedule.findEventIndex(l.identifier),y=(r=this.schedule.items)==null?void 0:r[f];this.isInterstitial(y)&&this.eventItemsMatch(y,this.bufferingItem)&&this.bufferedToItem(y,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){var r;const o=(r=this.schedule)==null?void 0:r.items;if(e&&o){const l=this.findItemIndex(e,t);return o[l]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((l,f)=>{e.event.isAssetPastPlayoutLimit(f)&&this.clearAssetPlayer(l.identifier,null)});const r=e.end+.25,o=nr.bufferInfo(this.primaryMedia,r,0);(o.end>r||(o.nextStart||0)>r)&&(this.log(`trim buffered interstitial ${ss(e)} (was ${ss(t)})`),this.attachPrimary(r,null,!0),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const r=this.mediaSelection;r&&((t=this.schedule)==null||t.updateSchedule(r,[],e))}checkBuffer(e){var t;const r=(t=this.schedule)==null?void 0:t.items;if(!r)return;const o=nr.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=o.len<1),this.updateBufferedPos(o.end,r,e)}updateBufferedPos(e,t,r){const o=this.schedule,l=this.bufferingItem;if(this.bufferedPos>e||!o)return;if(t.length===1&&this.itemsMatch(t[0],l)){this.bufferedPos=e;return}const f=this.playingItem,y=this.findItemIndex(f);let g=o.findItemIndexAtTime(e);if(this.bufferedPos<e){var p;const m=this.findItemIndex(l),u=Math.min(m+1,t.length-1),d=t[u];if((g===-1&&l&&e>=l.end||(p=d.event)!=null&&p.appendInPlace&&e+.01>=d.start)&&(g=u),this.isInterstitial(l)){const S=l.event;if(u-y>1&&S.appendInPlace===!1||S.assetList.length===0&&S.assetListLoader)return}if(this.bufferedPos=e,g>m&&g>y)this.bufferedToItem(d);else{const S=this.primaryDetails;this.primaryLive&&S&&e>S.edge-S.targetduration&&d.start<S.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(d)&&this.preloadAssets(d.event,0)}}else r&&f&&!this.itemsMatch(f,l)&&(g===y?this.bufferedToItem(f):g===y+1&&this.bufferedToItem(t[g]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(o=>{const l=this.getAssetPlayer(o.identifier);return!(l!=null&&l.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,r=this.schedule;if(!this.itemsMatch(e,t)&&r){const{items:o,events:l}=r;if(!o||!l)return t;const f=this.isInterstitial(e),y=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const g=y?y.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${ss(e)}`+(t?` (${g.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(f){const p=r.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((m,u)=>{const d=this.getAssetPlayer(m.identifier);d&&(u===p&&d.loadSource(),d.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(p=>p.pauseBuffering());this.hls.trigger(pe.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:l.slice(0),schedule:o.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;const o=this.detachedData;o?o.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){const r=e.event,o=r.assetList.length===0&&!r.assetListLoader,l=r.cue.once;if(o||!l){const f=this.preloadAssets(r,t);if(f!=null&&f.interstitial.appendInPlace){const y=this.primaryMedia;y&&this.bufferAssetPlayer(f,y)}}}preloadAssets(e,t){const r=e.assetUrl,o=e.assetList.length,l=o===0&&!e.assetListLoader,f=e.cue.once;if(l){const g=e.timelineStart;if(e.appendInPlace){var y;const d=this.playingItem;!this.isInterstitial(d)&&(d==null||(y=d.nextEvent)==null?void 0:y.identifier)===e.identifier&&this.flushFrontBuffer(g+.25)}let p,m=0;if(!this.playingItem&&this.primaryLive&&(m=this.hls.startPosition,m===-1&&(m=this.hls.liveSyncPosition||0)),m&&!(e.cue.pre||e.cue.post)){const d=m-g;d>0&&(p=Math.round(d*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:o} ${e}${p?` live-start: ${m} start-offset: ${p}`:""}`),r)return this.createAsset(e,0,0,g,e.duration,r);const u=this.assetListLoader.loadAssetList(e,p);u&&(e.assetListLoader=u)}else if(!f&&o){for(let p=t;p<o;p++){const m=e.assetList[p],u=this.getAssetPlayerQueueIndex(m.identifier);(u===-1||this.playerQueue[u].destroyed)&&!m.error&&this.createAssetPlayer(e,m,p)}const g=e.assetList[t];if(g){const p=this.getAssetPlayer(g.identifier);return p&&p.loadSource(),p}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(o=>{this.hls.trigger(pe.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:o})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,o,l,f){const y={parentIdentifier:e.identifier,identifier:kb(e,f,t),duration:l,startOffset:r,timelineStart:o,uri:f};return this.createAssetPlayer(e,y,t)}createAssetPlayer(e,t,r){const o=this.hls,l=o.userConfig;let f=l.videoPreference;const y=o.loadLevelObj||o.levels[o.currentLevel];(f||y)&&(f=Gr({},f),y.videoCodec&&(f.videoCodec=y.videoCodec),y.videoRange&&(f.allowedVideoRanges=[y.videoRange]));const g=o.audioTracks[o.audioTrack],p=o.subtitleTracks[o.subtitleTrack];let m=0;if(this.primaryLive||e.appendInPlace){const R=this.timelinePos-t.timelineStart;if(R>1){const O=t.duration;O&&R<O&&(m=R)}}const u=t.identifier,d=Or(Or({},l),{},{maxMaxBufferLength:Math.min(180,o.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:o.sessionId,assetPlayerId:u,abrEwmaDefaultEstimate:o.bandwidthEstimate,interstitialsController:void 0,startPosition:m,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:f,audioPreference:g||l.audioPreference,subtitlePreference:p||l.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(d.timelineOffset=t.timelineStart));const S=d.cmcd;S!=null&&S.sessionId&&S.contentId&&(d.cmcd=Gr({},S,{contentId:Hc(t.uri)})),this.getAssetPlayer(u)&&this.warn(`Duplicate date range identifier ${e} and asset ${u}`);const _=new Bb(this.HlsPlayerClass,d,e,t);this.playerQueue.push(_),e.assetList[r]=t;let E=!0;const b=R=>{if(R.live){var O;const Z=new Error(`Interstitials MUST be VOD assets ${e}`),$={fatal:!0,type:jn.OTHER_ERROR,details:wt.INTERSTITIAL_ASSET_ITEM_ERROR,error:Z},F=((O=this.schedule)==null?void 0:O.findEventIndex(e.identifier))||-1;this.handleAssetItemError($,e,F,r,Z.message);return}const H=R.edge-R.fragmentStart,U=t.duration;(E||U===null||H>U)&&(E=!1,this.log(`Interstitial asset "${u}" duration change ${U} > ${H}`),t.duration=H,this.updateSchedule())};_.on(pe.LEVEL_UPDATED,(R,{details:O})=>b(O)),_.on(pe.LEVEL_PTS_UPDATED,(R,{details:O})=>b(O)),_.on(pe.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const I=(R,O)=>{const H=this.getAssetPlayer(u);if(H&&O.tracks){H.off(pe.BUFFER_CODECS,I),H.tracks=O.tracks;const U=this.primaryMedia;this.bufferingAsset===H.assetItem&&U&&!H.media&&this.bufferAssetPlayer(H,U)}};_.on(pe.BUFFER_CODECS,I);const T=()=>{var R;const O=this.getAssetPlayer(u);if(this.log(`buffered to end of asset ${O}`),!O||!this.schedule)return;const H=this.schedule.findEventIndex(e.identifier),U=(R=this.schedule.items)==null?void 0:R[H];this.isInterstitial(U)&&this.advanceAssetBuffering(U,t)};_.on(pe.BUFFERED_TO_END,T);const A=R=>()=>{if(!this.getAssetPlayer(u)||!this.schedule)return;this.shouldPlay=!0;const H=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,H,R)};return _.once(pe.MEDIA_ENDED,A(r)),_.once(pe.PLAYOUT_LIMIT_REACHED,A(1/0)),_.on(pe.ERROR,(R,O)=>{if(!this.schedule)return;const H=this.getAssetPlayer(u);if(O.details===wt.BUFFER_STALLED_ERROR){if(H!=null&&H.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(O,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${O.error} ${e}`)}),_.on(pe.DESTROYING,()=>{if(!this.getAssetPlayer(u)||!this.schedule)return;const O=new Error(`Asset player destroyed unexpectedly ${u}`),H={fatal:!0,type:jn.OTHER_ERROR,details:wt.INTERSTITIAL_ASSET_ITEM_ERROR,error:O};this.handleAssetItemError(H,e,this.schedule.findEventIndex(e.identifier),r,O.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${xu(t)}`),this.hls.trigger(pe.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:_}),_}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){const o=this.playerQueue[r];this.log(`clear ${o} toSegment: ${t&&ss(t)}`),this.transferMediaFromPlayer(o,t),this.playerQueue.splice(r,1),o.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,o,l){const{interstitial:f,assetItem:y,assetId:g}=e,p=f.assetList.length,m=this.playingAsset;this.endedAsset=null,this.playingAsset=y,(!m||m.identifier!==g)&&(m&&(this.clearAssetPlayer(m.identifier,r[o]),delete m.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${p} ${xu(y)}`),this.hls.trigger(pe.INTERSTITIAL_ASSET_STARTED,{asset:y,assetListIndex:t,event:f,schedule:r.slice(0),scheduleIndex:o,player:e})),this.bufferAssetPlayer(e,l)}bufferAssetPlayer(e,t){var r,o;if(!this.schedule)return;const{interstitial:l,assetItem:f}=e,y=this.schedule.findEventIndex(l.identifier),g=(r=this.schedule.items)==null?void 0:r[y];if(!g)return;e.loadSource(),this.setBufferingItem(g),this.bufferingAsset=f;const p=this.getBufferingPlayer();if(p===e)return;const m=l.appendInPlace;if(m&&(p==null?void 0:p.interstitial.appendInPlace)===!1)return;const u=(p==null?void 0:p.tracks)||((o=this.detachedData)==null?void 0:o.tracks)||this.requiredTracks;if(m&&f!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(u&&!Wv(u,e.tracks)){const d=new Error(`Asset ${xu(f)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(u)}')`),S={fatal:!0,type:jn.OTHER_ERROR,details:wt.INTERSTITIAL_ASSET_ITEM_ERROR,error:d},_=l.findAssetIndex(f);this.handleAssetItemError(S,l,y,_,d.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,r=this.primaryMedia;if(!t||!r)return;const o=r.currentTime,l=t.findAssetIndex(e,o),f=e.assetList[l];if(f){const y=this.getAssetPlayer(f.identifier);if(y){const g=y.currentTime||o-f.timelineStart,p=y.duration-g;if(this.warn(`Stalled at ${g} of ${g+p} in ${y} ${e} (media.currentTime: ${o})`),g&&(p/r.playbackRate<.5||y.bufferedInPlaceToEnd(r))&&y.hls){const m=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,m,l)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,r,o,l){if(e.details===wt.BUFFER_STALLED_ERROR)return;const f=t.assetList[o]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${f&&xu(f)} ${e.error}`),!this.schedule)return;const y=(f==null?void 0:f.identifier)||"",g=this.getAssetPlayerQueueIndex(y),p=this.playerQueue[g]||null,m=this.schedule.items,u=Gr({},e,{fatal:!1,errorAction:wu(!0),asset:f,assetListIndex:o,event:t,schedule:m,scheduleIndex:r,player:p});if(this.hls.trigger(pe.INTERSTITIAL_ASSET_ERROR,u),!e.fatal)return;const d=this.playingAsset,S=this.bufferingAsset,_=new Error(l);if(f&&(this.clearAssetPlayer(y,null),f.error=_),!t.assetList.some(E=>!E.error))t.error=_;else for(let E=o;E<t.assetList.length;E++)this.resetAssetPlayer(t.assetList[E].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):d&&d.identifier===y?this.advanceAfterAssetEnded(t,r,o):S&&S.identifier===y&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,S)}primaryFallback(e){const t=e.timelineStart,r=this.effectivePlayingItem;let o=this.timelinePos;if(r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${o} playing: ${ss(r)} error: ${e.error}`),o===-1&&(o=this.hls.startPosition);const f=this.updateItem(r,o);this.itemsMatch(r,f)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(o===-1){this.checkStart();return}if(!this.schedule)return;const l=this.schedule.findItemIndexAtTime(o);this.setSchedulePosition(l)}onAssetListLoaded(e,t){var r,o;const l=t.event,f=l.identifier,y=t.assetListResponse.ASSETS;if(!((r=this.schedule)!=null&&r.hasEvent(f)))return;const g=l.timelineStart,p=l.duration;let m=0;y.forEach((E,b)=>{const I=parseFloat(E.DURATION);this.createAsset(l,b,m,g+m,I,E.URI),m+=I}),l.duration=m,this.log(`Loaded asset-list with duration: ${m} (was: ${p}) ${l}`);const u=this.waitingItem,d=(u==null?void 0:u.event.identifier)===f;this.updateSchedule();const S=(o=this.bufferingItem)==null?void 0:o.event;if(d){var _;const E=this.schedule.findEventIndex(f),b=(_=this.schedule.items)==null?void 0:_[E];if(b){if(!this.playingItem&&this.timelinePos>b.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==E){l.error=new Error(`Interstitial ${y.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${l}`),this.log(l.error.message),this.updateSchedule(!0),this.primaryFallback(l);return}this.setBufferingItem(b)}this.setSchedulePosition(E)}else if((S==null?void 0:S.identifier)===f){const E=l.assetList[0];if(E){const b=this.getAssetPlayer(E.identifier);if(S.appendInPlace){const I=this.primaryMedia;b&&I&&this.bufferAssetPlayer(b,I)}else b&&b.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case wt.ASSET_LIST_PARSING_ERROR:case wt.ASSET_LIST_LOAD_ERROR:case wt.ASSET_LIST_LOAD_TIMEOUT:{const r=t.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break}case wt.BUFFER_STALLED_ERROR:{const r=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&r.event.appendInPlace){this.handleInPlaceStall(r.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const wv=500;class Vb extends Tm{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",Pn.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.on(pe.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(pe.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(pe.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(pe.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(pe.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.off(pe.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(pe.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(pe.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(pe.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(pe.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=nn.IDLE,this.setInterval(wv),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:o}=t;if(this.fragContextChanged(r)||(hi(r)&&(this.fragPrevious=r),this.state=nn.IDLE),!o)return;const l=this.tracksBuffered[this.currentTrackId];if(!l)return;let f;const y=r.start;for(let p=0;p<l.length;p++)if(y>=l[p].start&&y<=l[p].end){f=l[p];break}const g=r.start+r.duration;f?f.end=g:(f={start:y,end:g},l.push(f)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:r,endOffset:o}=t;if(r===0&&o!==Number.POSITIVE_INFINITY){const l=o-1;if(l<=0)return;t.endOffsetSubtitles=Math.max(0,l),this.tracksBuffered.forEach(f=>{for(let y=0;y<f.length;){if(f[y].end<=l){f.shift();continue}else if(f[y].start<l)f[y].start=l;else break;y++}}),this.fragmentTracker.removeFragmentsInRange(r,l,Pn.SUBTITLE)}}onError(e,t){const r=t.frag;(r==null?void 0:r.type)===Pn.SUBTITLE&&(t.details===wt.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==nn.STOPPED&&(this.state=nn.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&JE(this.levels,t)){this.levels=t.map(r=>new jc(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const o=new jc(r);return this.tracksBuffered[o.id]=[],o}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Pn.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const o=this.levels[this.currentTrackId];o!=null&&o.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,o&&this.state!==nn.STOPPED&&this.setInterval(wv)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:o,levels:l}=this,{details:f,id:y}=t;if(!l){this.warn(`Subtitle tracks were reset while loading level ${y}`);return}const g=l[y];if(y>=l.length||!g)return;this.log(`Subtitle track ${y} loaded [${f.startSN},${f.endSN}]${f.lastPartSn?`[part-${f.lastPartSn}-${f.lastPartIndex}]`:""},duration:${f.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let p=0;if(f.live||(r=g.details)!=null&&r.live){if(f.deltaUpdateFailed)return;const u=this.mainDetails;if(!u){this.startFragRequested=!1;return}const d=u.fragments[0];if(!g.details)f.hasProgramDateTime&&u.hasProgramDateTime?(jd(f,u),p=f.fragmentStart):d&&(p=d.start,Xg(f,p));else{var m;p=this.alignPlaylists(f,g.details,(m=this.levelLastLoaded)==null?void 0:m.details),p===0&&d&&(p=d.start,Xg(f,p))}u&&!this.startFragRequested&&this.setStartPosition(u,p)}g.details=f,this.levelLastLoaded=g,y===o&&(this.hls.trigger(pe.SUBTITLE_TRACK_UPDATED,{details:f,id:y,groupId:t.groupId}),this.tick(),f.live&&!this.fragCurrent&&this.media&&this.state===nn.IDLE&&(Ml(null,f.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),g.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,o=t.decryptdata,l=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&o!=null&&o.key&&o.iv&&Ou(o.method)){const f=performance.now();this.decrypter.decrypt(new Uint8Array(r),o.key.buffer,o.iv.buffer,vm(o.method)).catch(y=>{throw l.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.FRAG_DECRYPT_ERROR,fatal:!1,error:y,reason:y.message,frag:t}),y}).then(y=>{const g=performance.now();l.trigger(pe.FRAG_DECRYPTED,{frag:t,payload:y,stats:{tstart:f,tdecrypt:g}})}).catch(y=>{this.warn(`${y.name}: ${y.message}`),this.state=nn.IDLE})}}doTick(){if(!this.media){this.state=nn.IDLE;return}if(this.state===nn.IDLE){const{currentTrackId:e,levels:t}=this,r=t==null?void 0:t[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;const{config:o}=this,l=this.getLoadPosition(),f=nr.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],l,o.maxBufferHole),{end:y,len:g}=f,p=r.details,m=this.hls.maxBufferLength+p.levelTargetDuration;if(g>m)return;const u=p.fragments,d=u.length,S=p.edge;let _=null;const E=this.fragPrevious;if(y<S){const T=o.maxFragLookUpTolerance,A=y>S-T?0:T;_=Ml(E,u,Math.max(u[0].start,y),A),!_&&E&&E.start<u[0].start&&(_=u[0])}else _=u[d-1];if(_=this.filterReplacedPrimary(_,r.details),!_)return;const b=_.sn-p.startSN,I=u[b-1];if(I&&I.cc===_.cc&&this.fragmentTracker.getState(I)===Ai.NOT_LOADED&&(_=I),this.fragmentTracker.getState(_)===Ai.NOT_LOADED){const T=this.mapToInitFragWhenRequired(_);T&&this.loadFragment(T,r,y)}}}loadFragment(e,t,r){hi(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new Yb(this.tracksBuffered[this.currentTrackId]||[])}}class Yb{constructor(e){this.buffered=void 0;const t=(r,o,l)=>{if(o=o>>>0,o>l-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${o}) is greater than the maximum bound (${l})`);return e[o][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}const jb={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},m0=h=>String.fromCharCode(jb[h]||h),os=15,fo=100,qb={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Kb={17:2,18:4,21:6,22:8,23:10,19:13,20:15},zb={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},$b={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Wb=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Xb{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;Mr.log(`${this.time} [${e}] ${r}`)}}}const Nl=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class p0{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const o=t[r];e.hasOwnProperty(o)&&(this[o]=e[o])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Qb{constructor(){this.uchar=" ",this.penState=new p0}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Jb{constructor(e){this.chars=[],this.pos=0,this.currPenState=new p0,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<fo;t++)this.chars.push(new Qb);this.logger=e}equals(e){for(let t=0;t<fo;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<fo;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<fo;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>fo&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=fo)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=m0(e);if(this.pos>=fo){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<fo;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<fo;r++){const o=this.chars[r].uchar;o!==" "&&(t=!1),e.push(o)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Og{constructor(e){this.rows=[],this.currRow=os-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<os;t++)this.rows.push(new Jb(e));this.logger=e}reset(){for(let e=0;e<os;e++)this.rows[e].clear();this.currRow=os-1}equals(e){let t=!0;for(let r=0;r<os;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<os;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<os;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+qr(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let y=0;y<os;y++)this.rows[y].clear();const l=this.currRow+1-this.nrRollUpRows,f=this.lastOutputScreen;if(f){const y=f.rows[l].cueStartTime,g=this.logger.time;if(y!==null&&g!==null&&y<g)for(let p=0;p<this.nrRollUpRows;p++)this.rows[t-this.nrRollUpRows+p+1].copy(f.rows[l+p])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const l=e.indent,f=Math.max(l-1,0);r.setCursor(e.indent),e.color=r.chars[f].penState.foreground}const o={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(o)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+qr(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",o=-1;for(let l=0;l<os;l++){const f=this.rows[l].getTextString();f&&(o=l+1,e?t.push("Row "+o+": '"+f+"'"):t.push(f.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class Ov{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Og(r),this.nonDisplayedMemory=new Og(r),this.lastOutputScreen=new Og(r),this.currRollUpRow=this.displayedMemory.rows[os-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[os-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,o=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=o[r]}this.logger.log(2,"MIDROW: "+qr(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Mv{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=tR(),this.logger=void 0;const o=this.logger=new Xb;this.channels=[null,new Ov(e,t,o),new Ov(e+1,r,o)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const o=t[r]&127,l=t[r+1]&127;let f=!1,y=null;if(o===0&&l===0)continue;this.logger.log(3,()=>"["+Nl([t[r],t[r+1]])+"] -> ("+Nl([o,l])+")");const g=this.cmdHistory;if(o>=16&&o<=31){if(eR(o,l,g)){bd(null,null,g),this.logger.log(3,()=>"Repeated command ("+Nl([o,l])+") is dropped");continue}bd(o,l,this.cmdHistory),f=this.parseCmd(o,l),f||(f=this.parseMidrow(o,l)),f||(f=this.parsePAC(o,l)),f||(f=this.parseBackgroundAttributes(o,l))}else bd(null,null,g);if(!f&&(y=this.parseChars(o,l),y)){const m=this.currentChannel;m&&m>0?this.channels[m].insertChars(y):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!f&&!y&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Nl([o,l])+" orig: "+Nl([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,o=(e===23||e===31)&&t>=33&&t<=35;if(!(r||o))return!1;const l=e===20||e===21||e===23?1:2,f=this.channels[l];return e===20||e===21||e===28||e===29?t===32?f.ccRCL():t===33?f.ccBS():t===34?f.ccAOF():t===35?f.ccAON():t===36?f.ccDER():t===37?f.ccRU(2):t===38?f.ccRU(3):t===39?f.ccRU(4):t===40?f.ccFON():t===41?f.ccRDC():t===42?f.ccTR():t===43?f.ccRTD():t===44?f.ccEDM():t===45?f.ccCR():t===46?f.ccENM():t===47&&f.ccEOC():f.ccTO(t-32),this.currentChannel=l,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const o=this.channels[r];return o?(o.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Nl([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const o=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,l=(e===16||e===24)&&t>=64&&t<=95;if(!(o||l))return!1;const f=e<=23?1:2;t>=64&&t<=95?r=f===1?qb[e]:zb[e]:r=f===1?Kb[e]:$b[e];const y=this.channels[f];return y?(y.setPAC(this.interpretPAC(r,t)),this.currentChannel=f,!0):!1}interpretPAC(e,t){let r;const o={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,o.underline=(r&1)===1,r<=13?o.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(o.italics=!0,o.color="white"):o.indent=Math.floor((r-16)/2)*4,o}parseChars(e,t){let r,o=null,l=null;if(e>=25?(r=2,l=e-8):(r=1,l=e),l>=17&&l<=19){let f;l===17?f=t+80:l===18?f=t+112:f=t+144,this.logger.log(2,()=>"Special char '"+m0(f)+"' in channel "+r),o=[f]}else e>=32&&e<=127&&(o=t===0?[e]:[e,t]);return o&&this.logger.log(3,()=>"Char codes =  "+Nl(o).join(",")),o}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,o=(e===23||e===31)&&t>=45&&t<=47;if(!(r||o))return!1;let l;const f={};e===16||e===24?(l=Math.floor((t-32)/2),f.background=Wb[l],t%2===1&&(f.background=f.background+"_semi")):t===45?f.background="transparent":(f.foreground="black",t===47&&(f.underline=!0));const y=e<=23?1:2;return this.channels[y].setBkgData(f),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}bd(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function bd(h,e,t){t.a=h,t.b=e}function eR(h,e,t){return t.a===h&&t.b===e}function tR(){return{a:null,b:null}}var wm=(function(){if(Yd!=null&&Yd.VTTCue)return self.VTTCue;const h=["","lr","rl"],e=["start","middle","end","left","right"];function t(y,g){if(typeof g!="string"||!Array.isArray(y))return!1;const p=g.toLowerCase();return~y.indexOf(p)?p:!1}function r(y){return t(h,y)}function o(y){return t(e,y)}function l(y,...g){let p=1;for(;p<arguments.length;p++){const m=arguments[p];for(const u in m)y[u]=m[u]}return y}function f(y,g,p){const m=this,u={enumerable:!0};m.hasBeenReset=!1;let d="",S=!1,_=y,E=g,b=p,I=null,T="",A=!0,R="auto",O="start",H=50,U="middle",Z=50,$="middle";Object.defineProperty(m,"id",l({},u,{get:function(){return d},set:function(F){d=""+F}})),Object.defineProperty(m,"pauseOnExit",l({},u,{get:function(){return S},set:function(F){S=!!F}})),Object.defineProperty(m,"startTime",l({},u,{get:function(){return _},set:function(F){if(typeof F!="number")throw new TypeError("Start time must be set to a number.");_=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"endTime",l({},u,{get:function(){return E},set:function(F){if(typeof F!="number")throw new TypeError("End time must be set to a number.");E=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"text",l({},u,{get:function(){return b},set:function(F){b=""+F,this.hasBeenReset=!0}})),Object.defineProperty(m,"region",l({},u,{get:function(){return I},set:function(F){I=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"vertical",l({},u,{get:function(){return T},set:function(F){const W=r(F);if(W===!1)throw new SyntaxError("An invalid or illegal string was specified.");T=W,this.hasBeenReset=!0}})),Object.defineProperty(m,"snapToLines",l({},u,{get:function(){return A},set:function(F){A=!!F,this.hasBeenReset=!0}})),Object.defineProperty(m,"line",l({},u,{get:function(){return R},set:function(F){if(typeof F!="number"&&F!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");R=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"lineAlign",l({},u,{get:function(){return O},set:function(F){const W=o(F);if(!W)throw new SyntaxError("An invalid or illegal string was specified.");O=W,this.hasBeenReset=!0}})),Object.defineProperty(m,"position",l({},u,{get:function(){return H},set:function(F){if(F<0||F>100)throw new Error("Position must be between 0 and 100.");H=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"positionAlign",l({},u,{get:function(){return U},set:function(F){const W=o(F);if(!W)throw new SyntaxError("An invalid or illegal string was specified.");U=W,this.hasBeenReset=!0}})),Object.defineProperty(m,"size",l({},u,{get:function(){return Z},set:function(F){if(F<0||F>100)throw new Error("Size must be between 0 and 100.");Z=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"align",l({},u,{get:function(){return $},set:function(F){const W=o(F);if(!W)throw new SyntaxError("An invalid or illegal string was specified.");$=W,this.hasBeenReset=!0}})),m.displayState=void 0}return f.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},f})();class nR{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function y0(h){function e(r,o,l,f){return(r|0)*3600+(o|0)*60+(l|0)+parseFloat(f||0)}const t=h.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class rR{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let o=0;o<r.length;++o)if(t===r[o]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function v0(h,e,t,r){const o=r?h.split(r):[h];for(const l in o){if(typeof o[l]!="string")continue;const f=o[l].split(t);if(f.length!==2)continue;const y=f[0],g=f[1];e(y,g)}}const am=new wm(0,0,""),Rd=am.align==="middle"?"middle":"center";function iR(h,e,t){const r=h;function o(){const y=y0(h);if(y===null)throw new Error("Malformed timestamp: "+r);return h=h.replace(/^[^\sa-zA-Z-]+/,""),y}function l(y,g){const p=new rR;v0(y,function(d,S){let _;switch(d){case"region":for(let E=t.length-1;E>=0;E--)if(t[E].id===S){p.set(d,t[E].region);break}break;case"vertical":p.alt(d,S,["rl","lr"]);break;case"line":_=S.split(","),p.integer(d,_[0]),p.percent(d,_[0])&&p.set("snapToLines",!1),p.alt(d,_[0],["auto"]),_.length===2&&p.alt("lineAlign",_[1],["start",Rd,"end"]);break;case"position":_=S.split(","),p.percent(d,_[0]),_.length===2&&p.alt("positionAlign",_[1],["start",Rd,"end","line-left","line-right","auto"]);break;case"size":p.percent(d,S);break;case"align":p.alt(d,S,["start",Rd,"end","left","right"]);break}},/:/,/\s/),g.region=p.get("region",null),g.vertical=p.get("vertical","");let m=p.get("line","auto");m==="auto"&&am.line===-1&&(m=-1),g.line=m,g.lineAlign=p.get("lineAlign","start"),g.snapToLines=p.get("snapToLines",!0),g.size=p.get("size",100),g.align=p.get("align",Rd);let u=p.get("position","auto");u==="auto"&&am.position===50&&(u=g.align==="start"||g.align==="left"?0:g.align==="end"||g.align==="right"?100:50),g.position=u}function f(){h=h.replace(/^\s+/,"")}if(f(),e.startTime=o(),f(),h.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);h=h.slice(3),f(),e.endTime=o(),f(),l(h,e)}function E0(h){return h.replace(/<br(?: \/)?>/gi,`
`)}class aR{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new nR,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let l=t.buffer,f=0;for(l=E0(l);f<l.length&&l[f]!=="\r"&&l[f]!==`
`;)++f;const y=l.slice(0,f);return l[f]==="\r"&&++f,l[f]===`
`&&++f,t.buffer=l.slice(f),y}function o(l){v0(l,function(f,y){},/:/)}try{let l="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;l=r();const y=l.match(/^()?WEBVTT([ \t].*)?$/);if(!(y!=null&&y[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let f=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(f?f=!1:l=r(),t.state){case"HEADER":/:/.test(l)?o(l):l||(t.state="ID");continue;case"NOTE":l||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(l)){t.state="NOTE";break}if(!l)continue;if(t.cue=new wm(0,0,""),t.state="CUE",l.indexOf("-->")===-1){t.cue.id=l;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{iR(l,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const y=l.indexOf("-->")!==-1;if(!l||y&&(f=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=l}continue;case"BADCUE":l||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const sR=/\r\n|\n\r|\n|\r/g,Mg=function(e,t,r=0){return e.slice(r,r+t.length)===t},oR=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),o=parseInt(e.slice(-9,-7)),l=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Nn(t)||!Nn(r)||!Nn(o)||!Nn(l))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*o,t+=3600*1e3*l,t};function Om(h,e,t){return Hc(h.toString())+Hc(e.toString())+Hc(t)}const lR=function(e,t,r){let o=e[t],l=e[o.prevCC];if(!l||!l.new&&o.new){e.ccOffset=e.presentationOffset=o.start,o.new=!1;return}for(;(f=l)!=null&&f.new;){var f;e.ccOffset+=o.start-l.start,o.new=!1,o=l,l=e[o.prevCC]}e.presentationOffset=r};function uR(h,e,t,r,o,l,f){const y=new aR,g=ba(new Uint8Array(h)).trim().replace(sR,`
`).split(`
`),p=[],m=e?mA(e.baseTime,e.timescale):0;let u="00:00.000",d=0,S=0,_,E=!0;y.oncue=function(b){const I=t[r];let T=t.ccOffset;const A=(d-m)/9e4;if(I!=null&&I.new&&(S!==void 0?T=t.ccOffset=I.start:lR(t,r,A)),A){if(!e){_=new Error("Missing initPTS for VTT MPEGTS");return}T=A-t.presentationOffset}const R=b.endTime-b.startTime,O=_a((b.startTime+T-S)*9e4,o*9e4)/9e4;b.startTime=Math.max(O,0),b.endTime=Math.max(O+R,0);const H=b.text.trim();b.text=decodeURIComponent(encodeURIComponent(H)),b.id||(b.id=Om(b.startTime,b.endTime,H)),b.endTime>0&&p.push(b)},y.onparsingerror=function(b){_=b},y.onflush=function(){if(_){f(_);return}l(p)},g.forEach(b=>{if(E)if(Mg(b,"X-TIMESTAMP-MAP=")){E=!1,b.slice(16).split(",").forEach(I=>{Mg(I,"LOCAL:")?u=I.slice(6):Mg(I,"MPEGTS:")&&(d=parseInt(I.slice(7)))});try{S=oR(u)/1e3}catch(I){_=I}return}else b===""&&(E=!1);y.parse(b+`
`)}),y.flush()}const Pg="stpp.ttml.im1t",T0=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,S0=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,cR={left:"start",center:"center",right:"end",start:"start",end:"end"};function Pv(h,e,t,r){const o=sr(new Uint8Array(h),["mdat"]);if(o.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const l=o.map(y=>ba(y)),f=gA(e.baseTime,1,e.timescale);try{l.forEach(y=>t(fR(y,f)))}catch(y){r(y)}}function fR(h,e){const o=new DOMParser().parseFromString(h,"text/xml").getElementsByTagName("tt")[0];if(!o)throw new Error("Invalid ttml");const l={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},f=Object.keys(l).reduce((u,d)=>(u[d]=o.getAttribute(`ttp:${d}`)||l[d],u),{}),y=o.getAttribute("xml:space")!=="preserve",g=kv(kg(o,"styling","style")),p=kv(kg(o,"layout","region")),m=kg(o,"body","[begin]");return[].map.call(m,u=>{const d=_0(u,y);if(!d||!u.hasAttribute("begin"))return null;const S=Ug(u.getAttribute("begin"),f),_=Ug(u.getAttribute("dur"),f);let E=Ug(u.getAttribute("end"),f);if(S===null)throw Fv(u);if(E===null){if(_===null)throw Fv(u);E=S+_}const b=new wm(S-e,E-e,d);b.id=Om(b.startTime,b.endTime,b.text);const I=p[u.getAttribute("region")],T=g[u.getAttribute("style")],A=dR(I,T,g),{textAlign:R}=A;if(R){const O=cR[R];O&&(b.lineAlign=O),b.align=R}return Gr(b,A),b}).filter(u=>u!==null)}function kg(h,e,t){const r=h.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function kv(h){return h.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function _0(h,e){return[].slice.call(h.childNodes).reduce((t,r,o)=>{var l;return r.nodeName==="br"&&o?t+`
`:(l=r.childNodes)!=null&&l.length?_0(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function dR(h,e,t){const r="http://www.w3.org/ns/ttml#styling";let o=null;const l=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],f=h!=null&&h.hasAttribute("style")?h.getAttribute("style"):null;return f&&t.hasOwnProperty(f)&&(o=t[f]),l.reduce((y,g)=>{const p=Fg(e,r,g)||Fg(h,r,g)||Fg(o,r,g);return p&&(y[g]=p),y},{})}function Fg(h,e,t){return h&&h.hasAttributeNS(e,t)?h.getAttributeNS(e,t):null}function Fv(h){return new Error(`Could not parse ttml timestamp ${h}`)}function Ug(h,e){if(!h)return null;let t=y0(h);return t===null&&(T0.test(h)?t=hR(h,e):S0.test(h)&&(t=gR(h,e))),t}function hR(h,e){const t=T0.exec(h),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function gR(h,e){const t=S0.exec(h),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class Id{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class mR{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Bv(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(pe.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(pe.FRAG_LOADING,this.onFragLoading,this),e.on(pe.FRAG_LOADED,this.onFragLoaded,this),e.on(pe.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(pe.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(pe.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(pe.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(pe.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(pe.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(pe.FRAG_LOADING,this.onFragLoading,this),e.off(pe.FRAG_LOADED,this.onFragLoaded,this),e.off(pe.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(pe.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(pe.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(pe.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(pe.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Id(this,"textTrack1"),t=new Id(this,"textTrack2"),r=new Id(this,"textTrack3"),o=new Id(this,"textTrack4");this.cea608Parser1=new Mv(1,e,t),this.cea608Parser2=new Mv(3,r,o)}addCues(e,t,r,o,l){let f=!1;for(let y=l.length;y--;){const g=l[y],p=pR(g[0],g[1],t,r);if(p>=0&&(g[0]=Math.min(g[0],t),g[1]=Math.max(g[1],r),f=!0,p/(r-t)>.5))return}if(f||l.push([t,r]),this.config.renderTextTracksNatively){const y=this.captionsTracks[e];this.Cues.newCue(y,t,r,o)}else{const y=this.Cues.newCue(null,t,r,o);this.hls.trigger(pe.CUES_PARSED,{type:"captions",cues:y,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:o,timescale:l,trackId:f}){const{unparsedVttFrags:y}=this;r===Pn.MAIN&&(this.initPTS[t.cc]={baseTime:o,timescale:l,trackId:f}),y.length&&(this.unparsedVttFrags=[],y.forEach(g=>{this.initPTS[g.frag.cc]?this.onFragLoaded(pe.FRAG_LOADED,g):this.hls.trigger(pe.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:g.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let o=0;o<r.textTracks.length;o++){const l=r.textTracks[o];if(Uv(l,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return l}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:o}=this,{label:l,languageCode:f}=t[e],y=this.getExistingTrack(l,f);if(y)r[e]=y,Nu(r[e]),d0(r[e],o);else{const g=this.createTextTrack("captions",l,f);g&&(g[e]=!0,r[e]=g)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,o={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=o,this.hls.trigger(pe.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[o]})}createTextTrack(e,t,r){const o=this.media;if(o)return o.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const r=!!t.transferMedia;if(this.media=null,r)return;const{captionsTracks:o}=this;Object.keys(o).forEach(l=>{Nu(o[l]),delete o[l]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Bv(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)Nu(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],o=r.some(l=>l.textCodec===Pg);if(this.config.enableWebVTT||o&&this.config.enableIMSC1){if(JE(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const f=this.media,y=f?Pd(f.textTracks):null;if(this.tracks.forEach((g,p)=>{let m;if(y){let u=null;for(let d=0;d<y.length;d++)if(y[d]&&Uv(y[d],g)){u=y[d],y[d]=null;break}u&&(m=u)}if(m)Nu(m);else{const u=A0(g);m=this.createTextTrack(u,g.name,g.lang),m&&(m.mode="disabled")}m&&this.textTracks.push(m)}),y!=null&&y.length){const g=y.filter(p=>p!==null).map(p=>p.label);g.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${g.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const f=this.tracks.map(y=>({label:y.name,kind:y.type.toLowerCase(),default:y.default,subtitleTrack:y}));this.hls.trigger(pe.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:f})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const o=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!o)return;const l=`textTrack${o[1]}`,f=this.captionsProperties[l];f&&(f.label=r.name,r.lang&&(f.languageCode=r.lang),f.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Pn.MAIN){var r,o;const{cea608Parser1:l,cea608Parser2:f,lastSn:y}=this,{cc:g,sn:p}=t.frag,m=(r=(o=t.part)==null?void 0:o.index)!=null?r:-1;l&&f&&(p!==y+1||p===y&&m!==this.lastPartIndex+1||g!==this.lastCc)&&(l.reset(),f.reset()),this.lastCc=g,this.lastSn=p,this.lastPartIndex=m}}onFragLoaded(e,t){const{frag:r,payload:o}=t;if(r.type===Pn.SUBTITLE)if(o.byteLength){const l=r.decryptdata,f="stats"in t;if(l==null||!l.encrypted||f){const y=this.tracks[r.level],g=this.vttCCs;g[r.cc]||(g[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),y&&y.textCodec===Pg?this._parseIMSC1(r,o):this._parseVTTs(t)}}else this.hls.trigger(pe.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;Pv(t,this.initPTS[e.cc],o=>{this._appendCues(o,e.level),r.trigger(pe.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},o=>{r.logger.log(`Failed to parse IMSC1: ${o}`),r.trigger(pe.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:o})})}_parseVTTs(e){var t;const{frag:r,payload:o}=e,{initPTS:l,unparsedVttFrags:f}=this,y=l.length-1;if(!l[r.cc]&&y===-1){f.push(e);return}const g=this.hls,p=(t=r.initSegment)!=null&&t.data?Ua(r.initSegment.data,new Uint8Array(o)).buffer:o;uR(p,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,m=>{this._appendCues(m,r.level),g.trigger(pe.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},m=>{const u=m.message==="Missing initPTS for VTT MPEGTS";u?f.push(e):this._fallbackToIMSC1(r,o),g.logger.log(`Failed to parse VTT cue: ${m}`),!(u&&y>r.cc)&&g.trigger(pe.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:m})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||Pv(t,this.initPTS[e.cc],()=>{r.textCodec=Pg,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const o=this.textTracks[t];if(!o||o.mode==="disabled")return;e.forEach(l=>h0(o,l))}else{const o=this.tracks[t];if(!o)return;const l=o.default?"default":"subtitles"+t;r.trigger(pe.CUES_PARSED,{type:"subtitles",cues:e,track:l})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===Pn.SUBTITLE&&this.onFragLoaded(pe.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:o}=t;if(!(r.type===Pn.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let l=0;l<o.length;l++){const f=o[l].bytes;if(f){this.cea608Parser1||this.initCea608Parsers();const y=this.extractCea608Data(f);this.cea608Parser1.addData(o[l].pts,y[0]),this.cea608Parser2.addData(o[l].pts,y[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:o,type:l}){const{media:f}=this;if(!(!f||f.currentTime<r)){if(!l||l==="video"){const{captionsTracks:y}=this;Object.keys(y).forEach(g=>im(y[g],t,r))}if(this.config.renderTextTracksNatively&&t===0&&o!==void 0){const{textTracks:y}=this;Object.keys(y).forEach(g=>im(y[g],t,o))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let o=2;for(let l=0;l<r;l++){const f=e[o++],y=127&e[o++],g=127&e[o++];if(y===0&&g===0)continue;if((4&f)!==0){const m=3&f;(m===0||m===1)&&(t[m].push(y),t[m].push(g))}}return t}}function A0(h){return h.characteristics&&/transcribes-spoken-dialog/gi.test(h.characteristics)&&/describes-music-and-sound/gi.test(h.characteristics)?"captions":"subtitles"}function Uv(h,e){return!!h&&h.kind===A0(e)&&em(e,h)}function pR(h,e,t,r){return Math.min(e,r)-Math.max(h,t)}function Bv(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const yR=/\s/,vR={newCue(h,e,t,r){const o=[];let l,f,y,g,p;const m=self.VTTCue||self.TextTrackCue;for(let d=0;d<r.rows.length;d++)if(l=r.rows[d],y=!0,g=0,p="",!l.isEmpty()){var u;for(let E=0;E<l.chars.length;E++)yR.test(l.chars[E].uchar)&&y?g++:(p+=l.chars[E].uchar,y=!1);l.cueStartTime=e,e===t&&(t+=1e-4),g>=16?g--:g++;const S=E0(p.trim()),_=Om(e,t,S);h!=null&&(u=h.cues)!=null&&u.getCueById(_)||(f=new m(e,t,S),f.id=_,f.line=d+1,f.align="left",f.position=10+Math.min(80,Math.floor(g*8/32)*10),o.push(f))}return h&&o.length&&(o.sort((d,S)=>d.line==="auto"||S.line==="auto"?0:d.line>8&&S.line>8?S.line-d.line:d.line-S.line),o.forEach(d=>h0(h,d))),o}};function ER(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const TR=/(\d+)-(\d+)\/(\d+)/;class Gv{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||bR,this.controller=new self.AbortController,this.stats=new fm}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const o=this.stats;if(o.loading.start)throw new Error("Loader can only be used once.");o.loading.start=self.performance.now();const l=SR(e,this.controller.signal),f=e.responseType==="arraybuffer",y=f?"byteLength":"length",{maxTimeToFirstByteMs:g,maxLoadTimeMs:p}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,l),self.clearTimeout(this.requestTimeout),t.timeout=g&&Nn(g)?g:p,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(o,e,this.response))},t.timeout),(zc(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(u=>{var d;this.response=this.loader=u;const S=Math.max(self.performance.now(),o.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=p,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(o,e,this.response))},p-(S-o.loading.start)),!u.ok){const{status:E,statusText:b}=u;throw new RR(b||"fetch, bad network response",E,u)}o.loading.first=S,o.total=AR(u.headers)||o.total;const _=(d=this.callbacks)==null?void 0:d.onProgress;return _&&Nn(t.highWaterMark)?this.loadProgressively(u,o,e,t.highWaterMark,_):f?u.arrayBuffer():e.responseType==="json"?u.json():u.text()}).then(u=>{var d,S;const _=this.response;if(!_)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),o.loading.end=Math.max(self.performance.now(),o.loading.first);const E=u[y];E&&(o.loaded=o.total=E);const b={url:_.url,data:u,code:_.status},I=(d=this.callbacks)==null?void 0:d.onProgress;I&&!Nn(t.highWaterMark)&&I(o,e,u,_),(S=this.callbacks)==null||S.onSuccess(b,o,e,_)}).catch(u=>{var d;if(self.clearTimeout(this.requestTimeout),o.aborted)return;const S=u&&u.code||0,_=u?u.message:null;(d=this.callbacks)==null||d.onError({code:S,text:_},e,u?u.details:null,o)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,o=0,l){const f=new OE,y=e.body.getReader(),g=()=>y.read().then(p=>{if(p.done)return f.dataLength&&l(t,r,f.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const m=p.value,u=m.length;return t.loaded+=u,u<o||f.dataLength?(f.push(m),f.dataLength>=o&&l(t,r,f.flush().buffer,e)):l(t,r,m.buffer,e),g()}).catch(()=>Promise.reject());return g()}}function SR(h,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Gr({},h.headers))};return h.rangeEnd&&t.headers.set("Range","bytes="+h.rangeStart+"-"+String(h.rangeEnd-1)),t}function _R(h){const e=TR.exec(h);if(e)return parseInt(e[2])-parseInt(e[1])+1}function AR(h){const e=h.get("Content-Range");if(e){const r=_R(e);if(Nn(r))return r}const t=h.get("Content-Length");if(t)return parseInt(t)}function bR(h,e){return new self.Request(h.url,e)}class RR extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const IR=/^age:\s*[\d.]+\s*$/im;class b0{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new fm,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,o=this.stats;o.loading.first=0,o.loaded=0,o.aborted=!1;const l=this.xhrSetup;l?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return l(r,t.url)}).catch(f=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),l(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(f=>{var y;(y=this.callbacks)==null||y.onError({code:r.status,text:f.message},t,r,o)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const o=t.headers,{maxTimeToFirstByteMs:l,maxLoadTimeMs:f}=r.loadPolicy;if(o)for(const y in o)e.setRequestHeader(y,o[y]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=l&&Nn(l)?l:f,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const o=t.readyState,l=this.config;if(!r.aborted&&o>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),l.timeout!==l.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),l.timeout=l.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),l.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),o===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const p=t.status,m=t.responseType==="text"?t.responseText:null;if(p>=200&&p<300){const _=m??t.response;if(_!=null){var f,y;r.loading.end=Math.max(self.performance.now(),r.loading.first);const E=t.responseType==="arraybuffer"?_.byteLength:_.length;r.loaded=r.total=E,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const b=(f=this.callbacks)==null?void 0:f.onProgress;b&&b(r,e,_,t);const I={url:t.responseURL,data:_,code:p};(y=this.callbacks)==null||y.onSuccess(I,r,e,t);return}}const u=l.loadPolicy.errorRetry,d=r.retry,S={url:e.url,data:void 0,code:p};if(Hd(u,d,!1,S))this.retry(u);else{var g;Mr.error(`${p} while loading ${e.url}`),(g=this.callbacks)==null||g.onError({code:p,text:t.statusText},e,t,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Hd(e,t,!0))this.retry(e);else{var r;Mr.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const o=this.callbacks;o&&(this.abortInternal(),o.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=mm(e,r.retry),r.retry++,Mr.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&IR.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const CR={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},DR=Or(Or({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:b0,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:GS,bufferController:xA,capLevelController:Lm,errorController:jS,fpsController:Nb,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:_E,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:CR},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},LR()),{},{subtitleStreamController:Vb,subtitleTrackController:Mb,timelineController:mR,audioStreamController:IA,audioTrackController:CA,emeController:Mu,cmcdController:Cb,contentSteeringController:Lb,interstitialsController:Hb});function LR(){return{cueHandler:vR,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function xR(h,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=sm(h),o=["manifest","level","frag"],l=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return o.forEach(f=>{const y=`${f==="level"?"playlist":f}LoadPolicy`,g=e[y]===void 0,p=[];l.forEach(m=>{const u=`${f}Loading${m}`,d=e[u];if(d!==void 0&&g){p.push(u);const S=r[y].default;switch(e[y]={default:S},m){case"TimeOut":S.maxLoadTimeMs=d,S.maxTimeToFirstByteMs=d;break;case"MaxRetry":S.errorRetry.maxNumRetry=d,S.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":S.errorRetry.retryDelayMs=d,S.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":S.errorRetry.maxRetryDelayMs=d,S.timeoutRetry.maxRetryDelayMs=d;break}}}),p.length&&t.warn(`hls.js config: "${p.join('", "')}" setting(s) are deprecated, use "${y}": ${qr(e[y])}`)}),Or(Or({},r),e)}function sm(h){return h&&typeof h=="object"?Array.isArray(h)?h.map(sm):Object.keys(h).reduce((e,t)=>(e[t]=sm(h[t]),e),{}):h}function NR(h,e){const t=h.loader;t!==Gv&&t!==b0?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),h.progressive=!1):ER()&&(h.loader=Gv,h.progressive=!0,h.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const kd=2,wR=.1,OR=.05,MR=100;class PR extends yE{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(pe.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(pe.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(pe.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(MR),this.mediaSource=t.mediaSource;const r=this.media=t.media;Ki(r,"playing",this.onMediaPlaying),Ki(r,"waiting",this.onMediaWaiting),Ki(r,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:r}=this;r&&(la(r,"playing",this.onMediaPlaying),la(r,"waiting",this.onMediaWaiting),la(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var r,o;const l=(r=this.hls)==null?void 0:r.config;if(!l)return;const f=this.media;if(!f)return;const{seeking:y}=f,g=this.seeking&&!y,p=!this.seeking&&y,m=f.paused&&!y||f.ended||f.playbackRate===0;if(this.seeking=y,e!==t){t&&(this.ended=0),this.moved=!0,y||(this.nudgeRetry=0,l.nudgeOnVideoHole&&!m&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(p||g){g&&this.stallResolved(e);return}if(m){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&f.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(pe.MEDIA_ENDED,{stalled:!1}));return}if(!nr.getBuffered(f).length){this.nudgeRetry=0;return}const u=nr.bufferInfo(f,e,0),d=u.nextStart||0,S=this.fragmentTracker;if(y&&S&&this.hls){const H=Zv(this.hls.inFlightFragments,e),U=u.len>kd,Z=!d||H||d-e>kd&&!S.getPartialFragment(e);if(U||Z)return;this.moved=!1}const _=(o=this.hls)==null?void 0:o.latestLevelDetails;if(!this.moved&&this.stalled!==null&&S){if(!(u.len>0)&&!d)return;const U=Math.max(d,u.start||0)-e,$=!!(_!=null&&_.live)?_.targetduration*2:kd,F=Cd(e,S);if(U>0&&(U<=$||F)){f.paused||this._trySkipBufferHole(F);return}}const E=l.detectStallWithCurrentTimeMs,b=self.performance.now(),I=this.waiting;let T=this.stalled;if(T===null)if(I>0&&b-I<E)T=this.stalled=I;else{this.stalled=b;return}const A=b-T;if(!y&&(A>=E||I)&&this.hls){var R;if(((R=this.mediaSource)==null?void 0:R.readyState)==="ended"&&!(_!=null&&_.live)&&Math.abs(e-((_==null?void 0:_.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(pe.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(u),!this.media||!this.hls)return}const O=nr.bufferInfo(f,e,l.maxBufferHole);this._tryFixBufferStall(O,A,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(pe.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var r;const o=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&o&&o.length>1&&e>o.end(0)){const l=nr.bufferedInfo(nr.timeRangesToArray(this.buffered.audio),e,0);if(l.len>1&&t>=l.start){const f=nr.timeRangesToArray(o),y=nr.bufferedInfo(f,t,0).bufferedIndex;if(y>-1&&y<f.length-1){const g=nr.bufferedInfo(f,e,0).bufferedIndex,p=f[y].end,m=f[y+1].start;if((g===-1||g>y)&&m-p<1&&e-p<2){const u=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${p} -> ${m} buffered index: ${g}`);this.warn(u.message),this.media.currentTime+=1e-6;let d=Cd(e,this.fragmentTracker);d&&"fragment"in d?d=d.fragment:d||(d=void 0);const S=nr.bufferInfo(this.media,e,0);this.hls.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:u,reason:u.message,frag:d,buffer:S.len,bufferInfo:S})}}}}}_tryFixBufferStall(e,t,r){var o,l;const{fragmentTracker:f,media:y}=this,g=(o=this.hls)==null?void 0:o.config;if(!y||!f||!g)return;const p=(l=this.hls)==null?void 0:l.latestLevelDetails,m=Cd(r,f);if((m||p!=null&&p.live&&r<p.fragmentStart)&&(this._trySkipBufferHole(m)||!this.media))return;const u=e.buffered,d=this.adjacentTraversal(e,r);(u&&u.length>1&&e.len>g.maxBufferHole||e.nextStart&&(e.nextStart-r<g.maxBufferHole||d))&&(t>g.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const r=this.fragmentTracker,o=e.nextStart;if(r&&o){const l=r.getFragAtPos(t,Pn.MAIN),f=r.getFragAtPos(o,Pn.MAIN);if(l&&f)return f.sn-l.sn<2}return!1}_reportStall(e){const{hls:t,media:r,stallReported:o,stalled:l}=this;if(!o&&l!==null&&r&&t){this.stallReported=!0;const f=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${qr(e)})`);this.warn(f.message),t.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.BUFFER_STALLED_ERROR,fatal:!1,error:f,buffer:e.len,bufferInfo:e,stalled:{start:l}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:r,media:o}=this,l=(t=this.hls)==null?void 0:t.config;if(!o||!r||!l)return 0;const f=o.currentTime,y=nr.bufferInfo(o,f,0),g=f<y.start?y.start:y.nextStart;if(g&&this.hls){const m=y.len<=l.maxBufferHole,u=y.len>0&&y.len<1&&o.readyState<3,d=g-f;if(d>0&&(m||u)){if(d>l.maxBufferHole){let _=!1;if(f===0){const E=r.getAppendedFrag(0,Pn.MAIN);E&&g<E.end&&(_=!0)}if(!_&&e){var p;if(!((p=this.hls.loadLevelObj)!=null&&p.details)||Zv(this.hls.inFlightFragments,g))return 0;let b=!1,I=e.end;for(;I<g;){const T=Cd(I,r);if(T)I+=T.duration;else{b=!0;break}}if(b)return 0}}const S=Math.max(g+OR,f+wR);if(this.warn(`skipping hole, adjusting currentTime from ${f} to ${S}`),this.moved=!0,o.currentTime=S,!(e!=null&&e.gap)){const _=new Error(`fragment loaded with buffer holes, seeking from ${f} to ${S}`),E={type:jn.MEDIA_ERROR,details:wt.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:_,reason:_.message,buffer:y.len,bufferInfo:y};e&&("fragment"in e?E.part=e:E.frag=e),this.hls.trigger(pe.ERROR,E)}return S}}return 0}_tryNudgeBuffer(e){const{hls:t,media:r,nudgeRetry:o}=this,l=t==null?void 0:t.config;if(!r||!l)return 0;const f=r.currentTime;if(this.nudgeRetry++,o<l.nudgeMaxRetry){const y=f+(o+1)*l.nudgeOffset,g=new Error(`Nudging 'currentTime' from ${f} to ${y}`);this.warn(g.message),r.currentTime=y,t.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.BUFFER_NUDGE_ON_STALL,error:g,fatal:!1,buffer:e.len,bufferInfo:e})}else{const y=new Error(`Playhead still not moving while enough data buffered @${f} after ${l.nudgeMaxRetry} nudges`);this.error(y.message),t.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.BUFFER_STALLED_ERROR,error:y,fatal:!0,buffer:e.len,bufferInfo:e})}}}function Zv(h,e){const t=Hv(h.main);if(t&&t.start<=e)return t;const r=Hv(h.audio);return r&&r.start<=e?r:null}function Hv(h){if(!h)return null;switch(h.state){case nn.IDLE:case nn.STOPPED:case nn.ENDED:case nn.ERROR:return null}return h.frag}function Cd(h,e){return e.getAppendedFrag(h,Pn.MAIN)||e.getPartialFragment(h)}const kR=.25;function om(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Bg(h,e,t,r,o){let l=new h(e,t,"");try{l.value=r,o&&(l.type=o)}catch{l=new h(e,t,qr(o?Or({type:o},r):r))}return l}const Dd=(()=>{const h=om();try{h&&new h(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class FR{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(pe.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(pe.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(pe.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(pe.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(pe.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(pe.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(pe.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(pe.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var r;this.media=t.media,((r=t.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&Nu(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return d0(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:r,enableID3MetadataCues:o}=this.hls.config;if(!r&&!o)return;const{samples:l}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const f=om();if(f)for(let y=0;y<l.length;y++){const g=l[y].type;if(g===Aa.emsg&&!r||!o)continue;const p=GE(l[y].data),m=l[y].pts;let u=m+l[y].duration;u>Dd&&(u=Dd),u-m<=0&&(u=m+kR);for(let S=0;S<p.length;S++){const _=p[S];if(!ZE(_)){this.updateId3CueEnds(m,g);const E=Bg(f,m,u,_,g);E&&this.id3Track.addCue(E)}}}}updateId3CueEnds(e,t){var r;const o=(r=this.id3Track)==null?void 0:r.cues;if(o)for(let l=o.length;l--;){const f=o[l];f.type===t&&f.startTime<e&&f.endTime===Dd&&(f.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:o}){const{id3Track:l,hls:f}=this;if(!f)return;const{config:{enableEmsgMetadataCues:y,enableID3MetadataCues:g}}=f;if(l&&(y||g)){let p;o==="audio"?p=m=>m.type===Aa.audioId3&&g:o==="video"?p=m=>m.type===Aa.emsg&&y:p=m=>m.type===Aa.audioId3&&g||m.type===Aa.emsg&&y,im(l,t,r,p)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:r,timelineOffset:o,enableDateRangeMetadataCues:l,interstitialsController:f}=this.hls.config;if(!l)return;const y=om();if(r&&o&&!f){const{fragmentStart:E,fragmentEnd:b}=e;let I=this.assetCue;I?(I.startTime=E,I.endTime=b):y&&(I=this.assetCue=Bg(y,E,b,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),I&&(I.id=r,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(I),I.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:g}=this,{dateRanges:p}=e,m=Object.keys(p);let u=this.dateRangeCuesAppended;if(g&&t){var d;if((d=g.cues)!=null&&d.length){const E=Object.keys(u).filter(b=>!m.includes(b));for(let b=E.length;b--;){var S;const I=E[b],T=(S=u[I])==null?void 0:S.cues;delete u[I],T&&Object.keys(T).forEach(A=>{const R=T[A];if(R){R.removeEventListener("enter",this.onEventCueEnter);try{g.removeCue(R)}catch{}}})}}else u=this.dateRangeCuesAppended={}}const _=e.fragments[e.fragments.length-1];if(!(m.length===0||!Nn(_==null?void 0:_.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let E=0;E<m.length;E++){const b=m[E],I=p[b],T=I.startTime,A=u[b],R=(A==null?void 0:A.cues)||{};let O=(A==null?void 0:A.durationKnown)||!1,H=Dd;const{duration:U,endDate:Z}=I;if(Z&&U!==null)H=T+U,O=!0;else if(I.endOnNext&&!O){const F=m.reduce((W,fe)=>{if(fe!==I.id){const ne=p[fe];if(ne.class===I.class&&ne.startDate>I.startDate&&(!W||I.startDate<W.startDate))return ne}return W},null);F&&(H=F.startTime,O=!0)}const $=Object.keys(I.attr);for(let F=0;F<$.length;F++){const W=$[F];if(!i_(W))continue;const fe=R[W];if(fe)O&&!(A!=null&&A.durationKnown)?fe.endTime=H:Math.abs(fe.startTime-T)>.01&&(fe.startTime=T,fe.endTime=H);else if(y){let ne=I.attr[W];a_(W)&&(ne=Xv(ne));const Te=Bg(y,T,H,{key:W,data:ne},Aa.dateRange);Te&&(Te.id=b,this.id3Track.addCue(Te),R[W]=Te,f&&(W==="X-ASSET-LIST"||W==="X-ASSET-URL")&&Te.addEventListener("enter",this.onEventCueEnter))}}u[b]={cues:R,dateRange:I,durationKnown:O}}}}}class UR{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,r=this.levelDetails;if(!t||!r)return;this.currentTime=t.currentTime;const o=this.computeLatency();if(o===null)return;this._latency=o;const{lowLatencyMode:l,maxLiveSyncPlaybackRate:f}=this.config;if(!l||f===1||!r.live)return;const y=this.targetLatency;if(y===null)return;const g=o-y,p=Math.min(this.maxLatency,y+r.targetduration);if(g<p&&g>.05&&this.forwardBufferLength>1){const u=Math.min(2,Math.max(1,f)),d=Math.round(2/(1+Math.exp(-.75*g-this.edgeStalled))*20)/20,S=Math.min(u,Math.max(1,d));this.changeMediaPlaybackRate(t,S)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:r,targetduration:o}=e,{liveSyncDuration:l,liveSyncDurationCount:f,lowLatencyMode:y}=this.config,g=this.hls.userConfig;let p=y&&r||t;(this._targetLatencyUpdated||g.liveSyncDuration||g.liveSyncDurationCount||p===0)&&(p=l!==void 0?l:f*o);const m=o;return p+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,m)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const r=this.levelDetails;if(r===null)return null;const o=r.edge,l=e-t-this.edgeStalled,f=o-r.totalduration,y=o-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(f,l),y)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(pe.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(pe.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(pe.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(pe.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var r;t.details===wt.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var r,o;e.playbackRate!==t&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(o=this.targetLatency)==null?void 0:o.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class BR extends Dm{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.on(pe.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(pe.FRAG_BUFFERED,this.onFragBuffered,this),e.on(pe.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.off(pe.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(pe.FRAG_BUFFERED,this.onFragBuffered,this),e.off(pe.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=this.hls.config.preferManagedMediaSource,o=[],l={},f={};let y=!1,g=!1,p=!1;t.levels.forEach(m=>{const u=m.attrs;let{audioCodec:d,videoCodec:S}=m;d&&(m.audioCodec=d=Ud(d,r)||void 0),S&&(S=m.videoCodec=SS(S));const{width:_,height:E,unknownCodecs:b}=m,I=(b==null?void 0:b.length)||0;if(y||(y=!!(_&&E)),g||(g=!!S),p||(p=!!d),I||d&&!this.isAudioSupported(d)||S&&!this.isVideoSupported(S)){this.log(`Some or all CODECS not supported "${u.CODECS}"`);return}const{CODECS:T,"FRAME-RATE":A,"HDCP-LEVEL":R,"PATHWAY-ID":O,RESOLUTION:H,"VIDEO-RANGE":U}=u,$=`${`${O||"."}-`}${m.bitrate}-${H}-${A}-${T}-${U}-${R}`;if(l[$])if(l[$].uri!==m.url&&!m.attrs["PATHWAY-ID"]){const F=f[$]+=1;m.attrs["PATHWAY-ID"]=new Array(F+1).join(".");const W=this.createLevel(m);l[$]=W,o.push(W)}else l[$].addGroupId("audio",u.AUDIO),l[$].addGroupId("text",u.SUBTITLES);else{const F=this.createLevel(m);l[$]=F,f[$]=1,o.push(F)}}),this.filterAndSortMediaOptions(o,t,y,g,p)}createLevel(e){const t=new jc(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const o=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(o.message),t.supportedResult=uE(o,[])}return t}isAudioSupported(e){return Vc(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Vc(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,r,o,l){var f;let y=[],g=[],p=e;const m=((f=t.stats)==null?void 0:f.parsing)||{};if((r||o)&&l&&(p=p.filter(({videoCodec:T,videoRange:A,width:R,height:O})=>(!!T||!!(R&&O))&&NS(A))),p.length===0){Promise.resolve().then(()=>{if(this.hls){let T="no level with compatible codecs found in manifest",A=T;t.levels.length&&(A=`one or more CODECS in variant not supported: ${qr(t.levels.map(O=>O.attrs.CODECS).filter((O,H,U)=>U.indexOf(O)===H))}`,this.warn(A),T+=` (${A})`);const R=new Error(T);this.hls.trigger(pe.ERROR,{type:jn.MEDIA_ERROR,details:wt.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:R,reason:A})}}),m.end=performance.now();return}t.audioTracks&&(y=t.audioTracks.filter(T=>!T.audioCodec||this.isAudioSupported(T.audioCodec)),Vv(y)),t.subtitles&&(g=t.subtitles,Vv(g));const u=p.slice(0);p.sort((T,A)=>{if(T.attrs["HDCP-LEVEL"]!==A.attrs["HDCP-LEVEL"])return(T.attrs["HDCP-LEVEL"]||"")>(A.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&T.height!==A.height)return T.height-A.height;if(T.frameRate!==A.frameRate)return T.frameRate-A.frameRate;if(T.videoRange!==A.videoRange)return Bd.indexOf(T.videoRange)-Bd.indexOf(A.videoRange);if(T.videoCodec!==A.videoCodec){const R=My(T.videoCodec),O=My(A.videoCodec);if(R!==O)return O-R}if(T.uri===A.uri&&T.codecSet!==A.codecSet){const R=Fd(T.codecSet),O=Fd(A.codecSet);if(R!==O)return O-R}return T.averageBitrate!==A.averageBitrate?T.averageBitrate-A.averageBitrate:0});let d=u[0];if(this.steering&&(p=this.steering.filterParsedLevels(p),p.length!==u.length)){for(let T=0;T<u.length;T++)if(u[T].pathwayId===p[0].pathwayId){d=u[T];break}}this._levels=p;for(let T=0;T<p.length;T++)if(p[T]===d){var S;this._firstLevel=T;const A=d.bitrate,R=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${p.length} level(s) found, first bitrate: ${A}`),((S=this.hls.userConfig)==null?void 0:S.abrEwmaDefaultEstimate)===void 0){const O=Math.min(A,this.hls.config.abrEwmaDefaultEstimateMax);O>R&&R===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=O)}break}const _=l&&!o,E=this.hls.config,b=!!(E.audioStreamController&&E.audioTrackController),I={levels:p,audioTracks:y,subtitleTracks:g,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:l,video:o,altAudio:b&&!_&&y.some(T=>!!T.url)};m.end=performance.now(),this.hls.trigger(pe.MANIFEST_PARSED,I)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const m=new Error("invalid level idx"),u=e<0;if(this.hls.trigger(pe.ERROR,{type:jn.OTHER_ERROR,details:wt.LEVEL_SWITCH_ERROR,level:e,fatal:u,error:m,reason:m.message}),u)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,o=this.currentLevel,l=o?o.attrs["PATHWAY-ID"]:void 0,f=t[e],y=f.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=f,r===e&&o&&l===y)return;this.log(`Switching to level ${e} (${f.height?f.height+"p ":""}${f.videoRange?f.videoRange+" ":""}${f.codecSet?f.codecSet+" ":""}@${f.bitrate})${y?" with Pathway "+y:""} from level ${r}${l?" with Pathway "+l:""}`);const g={level:e,attrs:f.attrs,details:f.details,bitrate:f.bitrate,averageBitrate:f.averageBitrate,maxBitrate:f.maxBitrate,realBitrate:f.realBitrate,width:f.width,height:f.height,codecSet:f.codecSet,audioCodec:f.audioCodec,videoCodec:f.videoCodec,audioGroups:f.audioGroups,subtitleGroups:f.subtitleGroups,loaded:f.loaded,loadError:f.loadError,fragmentError:f.fragmentError,name:f.name,id:f.id,uri:f.uri,url:f.url,urlId:0,audioGroupIds:f.audioGroupIds,textGroupIds:f.textGroupIds};this.hls.trigger(pe.LEVEL_SWITCHING,g);const p=f.details;if(!p||p.live){const m=this.switchParams(f.uri,o==null?void 0:o.details,p);this.loadPlaylist(m)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),r=e.filter(o=>t.indexOf(o)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=r}}onError(e,t){t.fatal||!t.context||t.context.type===or.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Pn.MAIN){const r=t.elementaryStreams;if(!Object.keys(r).some(l=>!!r[l]))return;const o=this._levels[t.level];o!=null&&o.loadError&&(this.log(`Resetting level error count of ${o.loadError} on frag buffered`),o.loadError=0)}}onLevelLoaded(e,t){var r;const{level:o,details:l}=t,f=t.levelInfo;if(!f){var y;this.warn(`Invalid level index ${o}`),(y=t.deliveryDirectives)!=null&&y.skip&&(l.deltaUpdateFailed=!0);return}if(f===this.currentLevel||t.withoutMultiVariant){f.fragmentError===0&&(f.loadError=0);let g=f.details;g===t.details&&g.advanced&&(g=void 0),this.playlistLoaded(o,t,g)}else(r=t.deliveryDirectives)!=null&&r.skip&&(l.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=this.getUrlWithDirectives(e.uri,t),o=this.currentLevelIndex,l=e.attrs["PATHWAY-ID"],f=e.details,y=f==null?void 0:f.age;this.log(`Loading level index ${o}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${l?" Pathway "+l:""}${y&&f.live?" age "+y.toFixed(1)+(f.type&&" "+f.type||""):""} ${r}`),this.hls.trigger(pe.LEVEL_LOADING,{url:r,level:o,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const r=this._levels.filter((l,f)=>f!==e?!0:(this.steering&&this.steering.removeLevel(l),l===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,l.details&&l.details.fragments.forEach(y=>y.level=-1)),!1));xE(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const o=r.length-1;this._firstLevel=Math.min(this._firstLevel,o),this._startLevel&&(this._startLevel=Math.min(this._startLevel,o)),this.hls.trigger(pe.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(pe.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function Vv(h){const e={};h.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}function R0(){return self.SourceBuffer||self.WebKitSourceBuffer}function I0(){if(!tl())return!1;const e=R0();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function GR(){if(!I0())return!1;const h=tl();return typeof(h==null?void 0:h.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>h.isTypeSupported(Yc(e,"video")))||["mp4a.40.2","fLaC"].some(e=>h.isTypeSupported(Yc(e,"audio"))))}function ZR(){var h;const e=R0();return typeof(e==null||(h=e.prototype)==null?void 0:h.changeType)=="function"}const HR=100;class VR extends Tm{constructor(e,t,r){super(e,t,r,"stream-controller",Pn.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const o=this.media,l=o?o.currentTime:null;if(l===null||!Nn(l)||(this.log(`Media seeked to ${l.toFixed(3)}`),!this.getBufferedFrag(l)))return;const f=this.getFwdBufferInfoAtPos(o,l,Pn.MAIN,0);if(f===null||f.len===0){this.warn(`Main forward buffer length at ${l} on "seeked" event ${f?f.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.on(pe.LEVEL_LOADING,this.onLevelLoading,this),e.on(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.on(pe.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(pe.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(pe.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(pe.BUFFER_CREATED,this.onBufferCreated,this),e.on(pe.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(pe.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(pe.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(pe.MANIFEST_PARSED,this.onManifestParsed,this),e.off(pe.LEVEL_LOADED,this.onLevelLoaded,this),e.off(pe.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(pe.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(pe.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(pe.BUFFER_CREATED,this.onBufferCreated,this),e.off(pe.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(pe.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(pe.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:r,hls:o}=this;if(this.stopLoad(),this.setInterval(HR),this.level=-1,!this.startFragRequested){let l=o.startLevel;l===-1&&(o.config.testBandwidth&&this.levels.length>1?(l=0,this.bitrateTest=!0):l=o.firstAutoLevel),o.nextLoadLevel=l,this.level=o.loadLevel,this._hasEnoughToStart=!!t}r>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=nn.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=nn.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case nn.WAITING_LEVEL:{const{levels:e,level:t}=this,r=e==null?void 0:e[t],o=r==null?void 0:r.details;if(o&&(!o.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(o))break;this.state=nn.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=nn.IDLE;break}break}case nn.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===nn.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:o}=this;if(t===null||!o&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const l=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[l]))return;const f=r[l],y=this.getMainFwdBufferInfo();if(y===null)return;const g=this.getLevelDetails();if(g&&this._streamEnded(y,g)){const E={};this.altAudio===2&&(E.type="video"),this.hls.trigger(pe.BUFFER_EOS,E),this.state=nn.ENDED;return}if(!this.buffering)return;e.loadLevel!==l&&e.manualLevel===-1&&this.log(`Adapting to level ${l} from level ${this.level}`),this.level=e.nextLoadLevel=l;const p=f.details;if(!p||this.state===nn.WAITING_LEVEL||this.waitForLive(f)){this.level=l,this.state=nn.WAITING_LEVEL,this.startFragRequested=!1;return}const m=y.len,u=this.getMaxBufferLength(f.maxBitrate);if(m>=u)return;this.backtrackFragment&&this.backtrackFragment.start>y.end&&(this.backtrackFragment=null);const d=this.backtrackFragment?this.backtrackFragment.start:y.end;let S=this.getNextFragment(d,p);if(this.couldBacktrack&&!this.fragPrevious&&S&&hi(S)&&this.fragmentTracker.getState(S)!==Ai.OK){var _;const b=((_=this.backtrackFragment)!=null?_:S).sn-p.startSN,I=p.fragments[b-1];I&&S.cc===I.cc&&(S=I,this.fragmentTracker.removeFragment(I))}else this.backtrackFragment&&y.len&&(this.backtrackFragment=null);if(S&&this.isLoopLoading(S,d)){if(!S.gap){const b=this.audioOnly&&!this.altAudio?jr.AUDIO:jr.VIDEO,I=(b===jr.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;I&&this.afterBufferFlushed(I,b,Pn.MAIN)}S=this.getNextFragmentLoopLoading(S,p,y,Pn.MAIN,u)}S&&(S.initSegment&&!S.initSegment.data&&!this.bitrateTest&&(S=S.initSegment),this.loadFragment(S,f,d))}loadFragment(e,t,r){const o=this.fragmentTracker.getState(e);o===Ai.NOT_LOADED||o===Ai.PARTIAL?hi(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,r):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Pn.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const o=this.getAppendedFrag(t.currentTime);o&&o.start>1&&this.flushMainBuffer(0,o.start-1);const l=this.getLevelDetails();if(l!=null&&l.live){const y=this.getMainFwdBufferInfo();if(!y||y.len<l.targetduration*2)return}if(!t.paused&&e){const y=this.hls.nextLoadLevel,g=e[y],p=this.fragLastKbps;p&&this.fragCurrent?r=this.fragCurrent.duration*g.maxBitrate/(1e3*p)+1:r=0}else r=0;const f=this.getBufferedFrag(t.currentTime+r);if(f){const y=this.followingBufferedFrag(f);if(y){this.abortCurrentFrag();const g=y.maxStartPTS?y.maxStartPTS:y.start,p=y.duration,m=Math.max(f.end,g+Math.min(Math.max(p-this.config.maxFragLookUpTolerance,p*(this.couldBacktrack?.5:.125)),p*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case nn.KEY_LOADING:case nn.FRAG_LOADING:case nn.FRAG_LOADING_WAITING_RETRY:case nn.PARSING:case nn.PARSED:this.state=nn.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;Ki(r,"playing",this.onMediaPlaying),Ki(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:r}=this;r&&(la(r,"playing",this.onMediaPlaying),la(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(pe.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let r=!1,o=!1;for(let l=0;l<t.levels.length;l++){const f=t.levels[l].audioCodec;f&&(r=r||f.indexOf("mp4a.40.2")!==-1,o=o||f.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=r&&o&&!ZR(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==nn.IDLE)return;const o=t.levelInfo;(!o.details||o.details.live&&(this.levelLastLoaded!==o||o.details.expired)||this.waitForCdnTuneIn(o.details))&&(this.state=nn.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:o,startFragRequested:l}=this,f=t.level,y=t.details,g=y.totalduration;if(!o){this.warn(`Levels were reset while loading level ${f}`);return}this.log(`Level ${f} loaded [${y.startSN},${y.endSN}]${y.lastPartSn?`[part-${y.lastPartSn}-${y.lastPartIndex}]`:""}, cc [${y.startCC}, ${y.endCC}] duration:${g}`);const p=t.levelInfo,m=this.fragCurrent;m&&(this.state===nn.FRAG_LOADING||this.state===nn.FRAG_LOADING_WAITING_RETRY)&&m.level!==t.level&&m.loader&&this.abortCurrentFrag();let u=0;if(y.live||(r=p.details)!=null&&r.live){var d;if(this.checkLiveUpdate(y),y.deltaUpdateFailed)return;u=this.alignPlaylists(y,p.details,(d=this.levelLastLoaded)==null?void 0:d.details)}if(p.details=y,this.levelLastLoaded=p,l||this.setStartPosition(y,u),this.hls.trigger(pe.LEVEL_UPDATED,{details:y,level:f}),this.state===nn.WAITING_LEVEL){if(this.waitForCdnTuneIn(y))return;this.state=nn.IDLE}l&&y.live&&this.synchronizeToLiveEdge(y),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const o=this.hls.liveSyncPosition,l=this.getLoadPosition(),f=e.fragmentStart,y=e.edge,g=l>=f-t.maxFragLookUpTolerance&&l<=y;if(o!==null&&r.duration>o&&(l<o||!g)){const m=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!g&&r.readyState<4||l<y-m)&&(this._hasEnoughToStart||(this.nextLoadPosition=o),r.readyState))if(this.warn(`Playback: ${l.toFixed(3)} is located too far from the end of live sliding playlist: ${y}, reset currentTime to : ${o.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var p;const u=nr.bufferInfo(r,o,0);if(!((p=u.buffered)!=null&&p.length)){r.currentTime=o;return}if(u.start<=l){r.currentTime=o;return}const{nextStart:S}=nr.bufferedInfo(u.buffered,l,0);S&&(r.currentTime=S)}else r.currentTime=o}}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:o,payload:l}=e,{levels:f}=this;if(!f){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const y=f[r.level];if(!y){this.warn(`Level ${r.level} not found on progress`);return}const g=y.details;if(!g){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const p=y.videoCodec,m=g.PTSKnown||!g.live,u=(t=r.initSegment)==null?void 0:t.data,d=this._getAudioCodec(y),S=this.transmuxer=this.transmuxer||new QE(this.hls,Pn.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),_=o?o.index:-1,E=_!==-1,b=new ym(r.level,r.sn,r.stats.chunkCount,l.byteLength,_,E),I=this.initPTS[r.cc];S.push(l,u,d,p,r,o,g.totalduration,m,b,I)}onAudioTrackSwitching(e,t){const r=this.hls,o=this.altAudio!==0;if(Gd(t.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const f=this.fragCurrent;f&&(this.log("Switching to main audio track, cancel main fragment load"),f.abortRequests(),this.fragmentTracker.removeFragment(f)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(o){this.altAudio=0,this.fragmentTracker.removeAllFragments(),r.once(pe.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(pe.AUDIO_TRACK_SWITCHED,t)}),r.trigger(pe.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(pe.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=Gd(t.url,this.hls);if(r){const o=this.videoBuffer;o&&this.mediaBuffer!==o&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=o)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,t){const r=t.tracks;let o,l,f=!1;for(const y in r){const g=r[y];if(g.id==="main"){if(l=y,o=g,y==="video"){const p=r[y];p&&(this.videoBuffer=p.buffer)}}else f=!0}f&&o?(this.log(`Alternate track found, use ${l}.buffered to schedule main fragment loading`),this.mediaBuffer=o.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:o}=t,l=r.type===Pn.MAIN;if(l){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${o?" p: "+o.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===nn.PARSED&&(this.state=nn.IDLE);return}const y=o?o.stats:r.stats;this.fragLastKbps=Math.round(8*y.total/(y.buffering.end-y.loading.first)),hi(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,o)}const f=this.media;f&&(!this._hasEnoughToStart&&nr.getBuffered(f).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),l&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var r;if(t.fatal){this.state=nn.ERROR;return}switch(t.details){case wt.FRAG_GAP:case wt.FRAG_PARSING_ERROR:case wt.FRAG_DECRYPT_ERROR:case wt.FRAG_LOAD_ERROR:case wt.FRAG_LOAD_TIMEOUT:case wt.KEY_LOAD_ERROR:case wt.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Pn.MAIN,t);break;case wt.LEVEL_LOAD_ERROR:case wt.LEVEL_LOAD_TIMEOUT:case wt.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===nn.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===or.LEVEL&&(this.state=nn.IDLE);break;case wt.BUFFER_ADD_CODEC_ERROR:case wt.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case wt.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case wt.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=nn.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==jr.AUDIO||!this.altAudio){const r=(t===jr.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,t,Pn.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const o=this.timelineOffset;o&&r&&(r+=o);const l=this.getLevelDetails(),f=nr.getBuffered(e),y=f.length?f.start(0):0,g=y-r,p=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||g>0&&(g<p||this.loadingParts&&g<2*((l==null?void 0:l.partTarget)||0)))&&(this.log(`adjusting start position by ${g} to match buffer start`),r+=g,this.startPosition=r),t<r&&(this.log(`seek to target start position ${r} from current time ${t} buffer start ${y}`),e.currentTime=r)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:o}=this,l=r==null?void 0:r.frag;if(!l||this.fragContextChanged(l))return;t.fragmentError=0,this.state=nn.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const f=l.stats;f.parsing.start=f.parsing.end=f.buffering.start=f.buffering.end=self.performance.now(),o.trigger(pe.FRAG_LOADED,r),l.bitrateTest=!1}).catch(r=>{this.state===nn.STOPPED||this.state===nn.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:r}=this,{remuxResult:o,chunkMeta:l}=e,f=this.getCurrentContext(l);if(!f){this.resetWhenMissingContext(l);return}const{frag:y,part:g,level:p}=f,{video:m,text:u,id3:d,initSegment:S}=o,{details:_}=p,E=this.altAudio?void 0:o.audio;if(this.fragContextChanged(y)){this.fragmentTracker.removeFragment(y);return}if(this.state=nn.PARSING,S){const b=S.tracks;if(b){const R=y.initSegment||y;if(this.unhandledEncryptionError(S,y))return;this._bufferInitSegment(p,b,R,l),r.trigger(pe.FRAG_PARSING_INIT_SEGMENT,{frag:R,id:t,tracks:b})}const I=S.initPTS,T=S.timescale,A=this.initPTS[y.cc];if(Nn(I)&&(!A||A.baseTime!==I||A.timescale!==T)){const R=S.trackId;this.initPTS[y.cc]={baseTime:I,timescale:T,trackId:R},r.trigger(pe.INIT_PTS_FOUND,{frag:y,id:t,initPTS:I,timescale:T,trackId:R})}}if(m&&_){E&&m.type==="audiovideo"&&this.logMuxedErr(y);const b=_.fragments[y.sn-1-_.startSN],I=y.sn===_.startSN,T=!b||y.cc>b.cc;if(o.independent!==!1){const{startPTS:A,endPTS:R,startDTS:O,endDTS:H}=m;if(g)g.elementaryStreams[m.type]={startPTS:A,endPTS:R,startDTS:O,endDTS:H};else if(m.firstKeyFrame&&m.independent&&l.id===1&&!T&&(this.couldBacktrack=!0),m.dropped&&m.independent){const U=this.getMainFwdBufferInfo(),Z=(U?U.end:this.getLoadPosition())+this.config.maxBufferHole,$=m.firstKeyFramePTS?m.firstKeyFramePTS:A;if(!I&&Z<$-this.config.maxBufferHole&&!T){this.backtrack(y);return}else T&&(y.gap=!0);y.setElementaryStreamInfo(m.type,y.start,R,y.start,H,!0)}else I&&A-(_.appliedTimelineOffset||0)>kd&&(y.gap=!0);y.setElementaryStreamInfo(m.type,A,R,O,H),this.backtrackFragment&&(this.backtrackFragment=y),this.bufferFragmentData(m,y,g,l,I||T)}else if(I||T)y.gap=!0;else{this.backtrack(y);return}}if(E){const{startPTS:b,endPTS:I,startDTS:T,endDTS:A}=E;g&&(g.elementaryStreams[jr.AUDIO]={startPTS:b,endPTS:I,startDTS:T,endDTS:A}),y.setElementaryStreamInfo(jr.AUDIO,b,I,T,A),this.bufferFragmentData(E,y,g,l)}if(_&&d!=null&&d.samples.length){const b={id:t,frag:y,details:_,samples:d.samples};r.trigger(pe.FRAG_PARSING_METADATA,b)}if(_&&u){const b={id:t,frag:y,details:_,samples:u.samples};r.trigger(pe.FRAG_PARSING_USERDATA,b)}}logMuxedErr(e){this.warn(`${hi(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,r,o){if(this.state!==nn.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));const{audio:l,video:f,audiovideo:y}=t;if(l){const p=e.audioCodec;let m=Ld(l.codec,p);m==="mp4a"&&(m="mp4a.40.5");const u=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){m&&(m.indexOf("mp4a.40.5")!==-1?m="mp4a.40.2":m="mp4a.40.5");const d=l.metadata;d&&"channelCount"in d&&(d.channelCount||1)!==1&&u.indexOf("firefox")===-1&&(m="mp4a.40.5")}m&&m.indexOf("mp4a.40.5")!==-1&&u.indexOf("android")!==-1&&l.container!=="audio/mpeg"&&(m="mp4a.40.2",this.log(`Android: force audio codec to ${m}`)),p&&p!==m&&this.log(`Swapping manifest audio codec "${p}" for "${m}"`),l.levelCodec=m,l.id=Pn.MAIN,this.log(`Init audio buffer, container:${l.container}, codecs[selected/level/parsed]=[${m||""}/${p||""}/${l.codec}]`),delete t.audiovideo}if(f){f.levelCodec=e.videoCodec,f.id=Pn.MAIN;const p=f.codec;if((p==null?void 0:p.length)===4)switch(p){case"hvc1":case"hev1":f.codec="hvc1.1.6.L120.90";break;case"av01":f.codec="av01.0.04M.08";break;case"avc1":f.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${f.container}, codecs[level/parsed]=[${e.videoCodec||""}/${p}]${f.codec!==p?" parsed-corrected="+f.codec:""}${f.supplemental?" supplemental="+f.supplemental:""}`),delete t.audiovideo}y&&(this.log(`Init audiovideo buffer, container:${y.container}, codecs[level/parsed]=[${e.codecs}/${y.codec}]`),delete t.video,delete t.audio);const g=Object.keys(t);if(g.length){if(this.hls.trigger(pe.BUFFER_CODECS,t),!this.hls)return;g.forEach(p=>{const u=t[p].initSegment;u!=null&&u.byteLength&&this.hls.trigger(pe.BUFFER_APPENDING,{type:p,data:u,frag:r,part:null,chunkMeta:o,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Pn.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,r=e==null?void 0:e[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=nn.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(nr.isBuffered(e,r)?t=this.getAppendedFrag(r):nr.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const o=this.fragPlaying,l=t.level;(!o||t.sn!==o.sn||o.level!==l)&&(this.fragPlaying=t,this.hls.trigger(pe.FRAG_CHANGED,{frag:t}),(!o||o.level!==l)&&this.hls.trigger(pe.LEVEL_SWITCHED,{level:l}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Nn(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Nn(t)){const r=this.getLevelDetails(),o=this.currentFrag||(r?Ml(null,r.fragments,t):null);if(o){const l=o.programDateTime;if(l!==null){const f=l+(t-o.start)*1e3;return new Date(f)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class YR extends Ba{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyIdToKeyInfo){const o=this.keyIdToKeyInfo[r].loader;if(o){var t;if(e&&e!==((t=o.context)==null?void 0:t.frag.type))return;o.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=wt.KEY_LOAD_ERROR,r,o,l){return new ho({type:jn.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:l,error:r,networkDetails:o})}loadClear(e,t,r){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let o=0,l=t.length;o<l;o++){const f=t[o];if(e.cc<=f.cc&&(!hi(e)||!hi(f)||e.sn<f.sn)||!r&&o==l-1)return this.emeController.selectKeySystemFormat(f).then(y=>{if(!this.emeController)return;f.setKeyFormat(y);const g=Nd(y);if(g)return this.emeController.getKeySystemAccess([g])})}if(this.config.requireKeySystemAccessOnStart){const o=Bc(this.config);if(o.length)return this.emeController.getKeySystemAccess(o)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,o;t&&e.setKeyFormat(t);const l=e.decryptdata;if(!l){const p=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,wt.KEY_LOAD_ERROR,p))}const f=l.uri;if(!f)return Promise.reject(this.createKeyLoadError(e,wt.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${f}"`)));const y=Gg(l);let g=this.keyIdToKeyInfo[y];if((r=g)!=null&&r.decryptdata.key)return l.key=g.decryptdata.key,Promise.resolve({frag:e,keyInfo:g});if(this.emeController&&(o=g)!=null&&o.keyLoadPromise)switch(this.emeController.getKeyStatus(g.decryptdata)){case"usable":case"usable-in-future":return g.keyLoadPromise.then(m=>{const{keyInfo:u}=m;return l.key=u.decryptdata.key,{frag:e,keyInfo:u}})}switch(this.log(`${this.keyIdToKeyInfo[y]?"Rel":"L"}oading${l.keyId?" keyId: "+Oi(l.keyId):""} URI: ${l.uri} from ${e.type} ${e.level}`),g=this.keyIdToKeyInfo[y]={decryptdata:l,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},l.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return l.keyFormat==="identity"?this.loadKeyHTTP(g,e):this.loadKeyEME(g,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(g,e);default:return Promise.reject(this.createKeyLoadError(e,wt.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${l.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var o;if(!e.decryptdata.keyId&&(o=t.initSegment)!=null&&o.data){const f=uS(t.initSegment.data);if(f.length){let y=f[0];y.some(g=>g!==0)?(this.log(`Using keyId found in init segment ${Oi(y)}`),el.setKeyIdForUri(e.decryptdata.uri,y)):(y=el.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${Oi(y)}`)),e.decryptdata.keyId=y}}if(!e.decryptdata.keyId&&!hi(t))return Promise.resolve(r);const l=this.emeController.loadKey(r);return(e.keyLoadPromise=l.then(f=>(e.mediaKeySessionContext=f,r))).catch(f=>{throw e.keyLoadPromise=null,"data"in f&&(f.data.frag=t),f})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,o=r.loader,l=new o(r);return t.keyLoader=e.loader=l,e.keyLoadPromise=new Promise((f,y)=>{const g={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},p=r.keyLoadPolicy.default,m={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(d,S,_,E)=>{const{frag:b,keyInfo:I}=_,T=Gg(I.decryptdata);if(!b.decryptdata||I!==this.keyIdToKeyInfo[T])return y(this.createKeyLoadError(b,wt.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),E));I.decryptdata.key=b.decryptdata.key=new Uint8Array(d.data),b.keyLoader=null,I.loader=null,f({frag:b,keyInfo:I})},onError:(d,S,_,E)=>{this.resetLoader(S),y(this.createKeyLoadError(t,wt.KEY_LOAD_ERROR,new Error(`HTTP Error ${d.code} loading key ${d.text}`),_,Or({url:g.url,data:void 0},d)))},onTimeout:(d,S,_)=>{this.resetLoader(S),y(this.createKeyLoadError(t,wt.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),_))},onAbort:(d,S,_)=>{this.resetLoader(S),y(this.createKeyLoadError(t,wt.INTERNAL_ABORTED,new Error("key loading aborted"),_))}};l.load(g,m,u)})}resetLoader(e){const{frag:t,keyInfo:r,url:o}=e,l=r.loader;t.keyLoader===l&&(t.keyLoader=null,r.loader=null);const f=Gg(r.decryptdata)||o;delete this.keyIdToKeyInfo[f],l&&l.destroy()}}function Gg(h){if(h.keyFormat!==Mi.FAIRPLAY){const e=h.keyId;if(e)return Oi(e)}return h.uri}function Yv(h){const{type:e}=h;switch(e){case or.AUDIO_TRACK:return Pn.AUDIO;case or.SUBTITLE_TRACK:return Pn.SUBTITLE;default:return Pn.MAIN}}function Zg(h,e){let t=h.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class jR{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.on(pe.LEVEL_LOADING,this.onLevelLoading,this),e.on(pe.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(pe.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(pe.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(pe.MANIFEST_LOADING,this.onManifestLoading,this),e.off(pe.LEVEL_LOADING,this.onLevelLoading,this),e.off(pe.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(pe.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(pe.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,o=t.loader,l=r||o,f=new l(t);return this.loaders[e.type]=f,f}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:or.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:r,level:o,pathwayId:l,url:f,deliveryDirectives:y,levelInfo:g}=t;this.load({id:r,level:o,pathwayId:l,responseType:"text",type:or.LEVEL,url:f,deliveryDirectives:y,levelOrTrack:g})}onAudioTrackLoading(e,t){const{id:r,groupId:o,url:l,deliveryDirectives:f,track:y}=t;this.load({id:r,groupId:o,level:null,responseType:"text",type:or.AUDIO_TRACK,url:l,deliveryDirectives:f,levelOrTrack:y})}onSubtitleTrackLoading(e,t){const{id:r,groupId:o,url:l,deliveryDirectives:f,track:y}=t;this.load({id:r,groupId:o,level:null,responseType:"text",type:or.SUBTITLE_TRACK,url:l,deliveryDirectives:f,levelOrTrack:y})}onLevelsUpdated(e,t){const r=this.loaders[or.LEVEL];if(r){const o=r.context;o&&!t.levels.some(l=>l===o.levelOrTrack)&&(r.abort(),delete this.loaders[or.LEVEL])}}load(e){var t;const r=this.hls.config;let o=this.getInternalLoader(e);if(o){const p=this.hls.logger,m=o.context;if(m&&m.levelOrTrack===e.levelOrTrack&&(m.url===e.url||m.deliveryDirectives&&!e.deliveryDirectives)){m.url===e.url?p.log(`[playlist-loader]: ignore ${e.url} ongoing request`):p.log(`[playlist-loader]: ignore ${e.url} in favor of ${m.url}`);return}p.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),o.abort()}let l;if(e.type===or.MANIFEST?l=r.manifestLoadPolicy.default:l=Gr({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(e),Nn((t=e.deliveryDirectives)==null?void 0:t.part)){let p;if(e.type===or.LEVEL&&e.level!==null?p=this.hls.levels[e.level].details:e.type===or.AUDIO_TRACK&&e.id!==null?p=this.hls.audioTracks[e.id].details:e.type===or.SUBTITLE_TRACK&&e.id!==null&&(p=this.hls.subtitleTracks[e.id].details),p){const m=p.partTarget,u=p.targetduration;if(m&&u){const d=Math.max(m*3,u*.8)*1e3;l=Gr({},l,{maxTimeToFirstByteMs:Math.min(d,l.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(d,l.maxTimeToFirstByteMs)})}}}const f=l.errorRetry||l.timeoutRetry||{},y={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:f.maxNumRetry||0,retryDelay:f.retryDelayMs||0,maxRetryDelay:f.maxRetryDelayMs||0},g={onSuccess:(p,m,u,d)=>{const S=this.getInternalLoader(u);this.resetInternalLoader(u.type);const _=p.data;m.parsing.start=performance.now(),Ps.isMediaPlaylist(_)||u.type!==or.MANIFEST?this.handleTrackOrLevelPlaylist(p,m,u,d||null,S):this.handleMasterPlaylist(p,m,u,d)},onError:(p,m,u,d)=>{this.handleNetworkError(m,u,!1,p,d)},onTimeout:(p,m,u)=>{this.handleNetworkError(m,u,!0,void 0,p)}};o.load(e,y,g)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,r,o){const l=this.hls,f=e.data,y=Zg(e,r),g=Ps.parseMasterPlaylist(f,y);if(g.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,r,g.playlistParsingError,o,t);return}const{contentSteering:p,levels:m,sessionData:u,sessionKeys:d,startTimeOffset:S,variableList:_}=g;this.variableList=_,m.forEach(T=>{const{unknownCodecs:A}=T;if(A){const{preferManagedMediaSource:R}=this.hls.config;let{audioCodec:O,videoCodec:H}=T;for(let U=A.length;U--;){const Z=A[U];Vc(Z,"audio",R)?(T.audioCodec=O=O?`${O},${Z}`:Z,ku.audio[O.substring(0,4)]=2,A.splice(U,1)):Vc(Z,"video",R)&&(T.videoCodec=H=H?`${H},${Z}`:Z,ku.video[H.substring(0,4)]=2,A.splice(U,1))}}});const{AUDIO:E=[],SUBTITLES:b,"CLOSED-CAPTIONS":I}=Ps.parseMasterPlaylistMedia(f,y,g);E.length&&!E.some(A=>!A.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),E.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ti({}),bitrate:0,url:""})),l.trigger(pe.MANIFEST_LOADED,{levels:m,audioTracks:E,subtitles:b,captions:I,contentSteering:p,url:y,stats:t,networkDetails:o,sessionData:u,sessionKeys:d,startTimeOffset:S,variableList:_})}handleTrackOrLevelPlaylist(e,t,r,o,l){const f=this.hls,{id:y,level:g,type:p}=r,m=Zg(e,r),u=Nn(g)?g:Nn(y)?y:0,d=Yv(r),S=Ps.parseLevelPlaylist(e.data,m,u,d,0,this.variableList);if(p===or.MANIFEST){const _={attrs:new ti({}),bitrate:0,details:S,name:"",url:m};S.requestScheduled=t.loading.start+CE(S,0),f.trigger(pe.MANIFEST_LOADED,{levels:[_],audioTracks:[],url:m,stats:t,networkDetails:o,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=S,this.handlePlaylistLoaded(S,e,t,r,o,l)}handleManifestParsingError(e,t,r,o,l){this.hls.trigger(pe.ERROR,{type:jn.NETWORK_ERROR,details:wt.MANIFEST_PARSING_ERROR,fatal:t.type===or.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:o,stats:l})}handleNetworkError(e,t,r=!1,o,l){let f=`A network ${r?"timeout":"error"+(o?" (status "+o.code+")":"")} occurred while loading ${e.type}`;e.type===or.LEVEL?f+=`: ${e.level} id: ${e.id}`:(e.type===or.AUDIO_TRACK||e.type===or.SUBTITLE_TRACK)&&(f+=` id: ${e.id} group-id: "${e.groupId}"`);const y=new Error(f);this.hls.logger.warn(`[playlist-loader]: ${f}`);let g=wt.UNKNOWN,p=!1;const m=this.getInternalLoader(e);switch(e.type){case or.MANIFEST:g=r?wt.MANIFEST_LOAD_TIMEOUT:wt.MANIFEST_LOAD_ERROR,p=!0;break;case or.LEVEL:g=r?wt.LEVEL_LOAD_TIMEOUT:wt.LEVEL_LOAD_ERROR,p=!1;break;case or.AUDIO_TRACK:g=r?wt.AUDIO_TRACK_LOAD_TIMEOUT:wt.AUDIO_TRACK_LOAD_ERROR,p=!1;break;case or.SUBTITLE_TRACK:g=r?wt.SUBTITLE_TRACK_LOAD_TIMEOUT:wt.SUBTITLE_LOAD_ERROR,p=!1;break}m&&this.resetInternalLoader(e.type);const u={type:jn.NETWORK_ERROR,details:g,fatal:p,url:e.url,loader:m,context:e,error:y,networkDetails:t,stats:l};if(o){const d=(t==null?void 0:t.url)||e.url;u.response=Or({url:d,data:void 0},o)}this.hls.trigger(pe.ERROR,u)}handlePlaylistLoaded(e,t,r,o,l,f){const y=this.hls,{type:g,level:p,levelOrTrack:m,id:u,groupId:d,deliveryDirectives:S}=o,_=Zg(t,o),E=Yv(o);let b=typeof o.level=="number"&&E===Pn.MAIN?p:void 0;const I=e.playlistParsingError;if(I){if(this.hls.logger.warn(`${I} ${e.url}`),!y.config.ignorePlaylistParsingErrors){y.trigger(pe.ERROR,{type:jn.NETWORK_ERROR,details:wt.LEVEL_PARSING_ERROR,fatal:!1,url:_,error:I,reason:I.message,response:t,context:o,level:b,parent:E,networkDetails:l,stats:r});return}e.playlistParsingError=null}if(!e.fragments.length){const T=e.playlistParsingError=new Error("No Segments found in Playlist");y.trigger(pe.ERROR,{type:jn.NETWORK_ERROR,details:wt.LEVEL_EMPTY_ERROR,fatal:!1,url:_,error:T,reason:T.message,response:t,context:o,level:b,parent:E,networkDetails:l,stats:r});return}switch(e.live&&f&&(f.getCacheAge&&(e.ageHeader=f.getCacheAge()||0),(!f.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),g){case or.MANIFEST:case or.LEVEL:if(b){if(!m)b=0;else if(m!==y.levels[b]){const T=y.levels.indexOf(m);T>-1&&(b=T)}}y.trigger(pe.LEVEL_LOADED,{details:e,levelInfo:m||y.levels[0],level:b||0,id:u||0,stats:r,networkDetails:l,deliveryDirectives:S,withoutMultiVariant:g===or.MANIFEST});break;case or.AUDIO_TRACK:y.trigger(pe.AUDIO_TRACK_LOADED,{details:e,track:m,id:u||0,groupId:d||"",stats:r,networkDetails:l,deliveryDirectives:S});break;case or.SUBTITLE_TRACK:y.trigger(pe.SUBTITLE_TRACK_LOADED,{details:e,track:m,id:u||0,groupId:d||"",stats:r,networkDetails:l,deliveryDirectives:S});break}}}class ls{static get version(){return qc}static isMSESupported(){return I0()}static isSupported(){return GR()}static getMediaSource(){return tl()}static get Events(){return pe}static get MetadataSchema(){return Aa}static get ErrorTypes(){return jn}static get ErrorDetails(){return wt}static get DefaultConfig(){return ls.defaultConfig?ls.defaultConfig:DR}static set DefaultConfig(e){ls.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Sm,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=XT(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=xR(ls.DefaultConfig,e,t);this.userConfig=e,r.progressive&&NR(r,t);const{abrController:o,bufferController:l,capLevelController:f,errorController:y,fpsController:g}=r,p=new y(this),m=this.abrController=new o(this),u=new qS(this),d=r.interstitialsController,S=d?this.interstitialsController=new d(this,ls):null,_=this.bufferController=new l(this,u),E=this.capLevelController=new f(this),b=new g(this),I=new jR(this),T=r.contentSteeringController,A=T?new T(this):null,R=this.levelController=new BR(this,A),O=new FR(this),H=new YR(this.config,this.logger),U=this.streamController=new VR(this,u,H),Z=this.gapController=new PR(this,u);E.setStreamController(U),b.setStreamController(U);const $=[I,R,U];S&&$.splice(1,0,S),A&&$.splice(1,0,A),this.networkControllers=$;const F=[m,_,Z,E,b,O,u];this.audioTrackController=this.createController(r.audioTrackController,$);const W=r.audioStreamController;W&&$.push(this.audioStreamController=new W(this,u,H)),this.subtitleTrackController=this.createController(r.subtitleTrackController,$);const fe=r.subtitleStreamController;fe&&$.push(this.subtititleStreamController=new fe(this,u,H)),this.createController(r.timelineController,F),H.emeController=this.emeController=this.createController(r.emeController,F),this.cmcdController=this.createController(r.cmcdController,F),this.latencyController=this.createController(UR,F),this.coreComponents=F,$.push(p);const ne=p.onErrorOut;typeof ne=="function"&&this.on(pe.ERROR,ne,p),this.on(pe.MANIFEST_LOADED,I.onManifestLoaded,I)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,o){this._emitter.off(e,t,r,o)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const o=e===pe.ERROR;this.trigger(pe.ERROR,{type:jn.OTHER_ERROR,details:wt.INTERNAL_EXCEPTION,fatal:o,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(pe.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const l=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(pe.ERROR,{type:jn.OTHER_ERROR,details:wt.ATTACH_MEDIA_ERROR,fatal:!0,error:l});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,r=t?e.media:e,o=t?e:{media:r};this._media=r,this.trigger(pe.MEDIA_ATTACHING,o)}detachMedia(){this.logger.log("detachMedia"),this.trigger(pe.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(pe.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,r=this._url,o=this._url=cm.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${o}`),t&&r&&(r!==o||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(pe.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),!(!this.started||!this.networkControllers));r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Pn.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Pn.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Pn.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=Pb()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){xS(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let o=0;o<r;o++)if(e[o].maxBitrate>=t)return o;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let o;if(t===-1&&e!=null&&e.length?o=e.length-1:o=t,r)for(let l=o;l--;){const f=e[l].attrs["HDCP-LEVEL"];if(f&&f<=r)return l}return o}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const r=dE(t);return cE(e,r,navigator.mediaCapabilities)}}ls.defaultConfig=void 0;var Hg={exports:{}};/*! For license information please see dash.all.min.js.LICENSE.txt */var jv;function qR(){return jv||(jv=1,(function(h,e){(function(t,r){h.exports=r()})(self,(function(){return(function(){var t={4593:function(f,y){var g,p,m,u,d,S=function(b){for(var I=[],T=0;T<b.length;++T){var A=b.charCodeAt(T);A<128?I.push(A):A<2048?(I.push(192|A>>6),I.push(128|63&A)):A<65536?(I.push(224|A>>12),I.push(128|63&A>>6),I.push(128|63&A)):(I.push(240|A>>18),I.push(128|63&A>>12),I.push(128|63&A>>6),I.push(128|63&A))}return I},_=function(b){for(var I=[],T=0;T<b.length;){var A=b[T++];A<128||(A<224?(A=(31&A)<<6,A|=63&b[T++]):A<240?(A=(15&A)<<12,A|=(63&b[T++])<<6,A|=63&b[T++]):(A=(7&A)<<18,A|=(63&b[T++])<<12,A|=(63&b[T++])<<6,A|=63&b[T++])),I.push(String.fromCharCode(A))}return I.join("")},E={};g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=function(b){for(var I=0,T=[],A=0|b.length/3;0<A--;){var R=(b[I]<<16)+(b[I+1]<<8)+b[I+2];I+=3,T.push(g.charAt(63&R>>18)),T.push(g.charAt(63&R>>12)),T.push(g.charAt(63&R>>6)),T.push(g.charAt(63&R))}return b.length-I==2?(R=(b[I]<<16)+(b[I+1]<<8),T.push(g.charAt(63&R>>18)),T.push(g.charAt(63&R>>12)),T.push(g.charAt(63&R>>6)),T.push("=")):b.length-I==1&&(R=b[I]<<16,T.push(g.charAt(63&R>>18)),T.push(g.charAt(63&R>>12)),T.push("==")),T.join("")},m=(function(){for(var b=[],I=0;I<g.length;++I)b[g.charCodeAt(I)]=I;return b[61]=0,b})(),u=function(b){for(var I=0,T=[],A=0|b.length/4;0<A--;){var R=(m[b.charCodeAt(I)]<<18)+(m[b.charCodeAt(I+1)]<<12)+(m[b.charCodeAt(I+2)]<<6)+m[b.charCodeAt(I+3)];T.push(255&R>>16),T.push(255&R>>8),T.push(255&R),I+=4}return T&&(b.charAt(I-2)=="="?(T.pop(),T.pop()):b.charAt(I-1)=="="&&T.pop()),T},d={encode:function(b){for(var I=[],T=0;T<b.length;++T)I.push(b.charCodeAt(T));return I},decode:function(b){for(var I=0;I<s.length;++I)a[I]=String.fromCharCode(a[I]);return a.join("")}},E.decodeArray=function(b){var I=u(b);return new Uint8Array(I)},E.encodeASCII=function(b){var I=d.encode(b);return p(I)},E.decodeASCII=function(b){var I=u(b);return d.decode(I)},E.encode=function(b){var I=S(b);return p(I)},E.decode=function(b){var I=u(b);return _(I)},y.decode=E.decode,y.decodeArray=E.decodeArray,y.encode=E.encode,y.encodeASCII=E.encodeASCII},452:function(f,y){(function(g){var p={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},m=function(F){var W=F;return p.hasOwnProperty(F)&&(W=p[F]),String.fromCharCode(W)},u=15,d=32,S={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},_={17:2,18:4,21:6,22:8,23:10,19:13,20:15},E={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},b={25:2,26:4,29:6,30:8,31:10,27:13,28:15},I=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],T={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(F){this.time=F},log:function(F,W){var fe=this.verboseFilter[F];this.verboseLevel>=fe&&console.log(this.time+" ["+F+"] "+W)}},A=function(F){for(var W=[],fe=0;fe<F.length;fe++)W.push(F[fe].toString(16));return W},R=function(F,W,fe,ne,de){this.foreground=F||"white",this.underline=W||!1,this.italics=fe||!1,this.background=ne||"black",this.flash=de||!1};R.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(F){for(var W=["foreground","underline","italics","background","flash"],fe=0;fe<W.length;fe++){var ne=W[fe];F.hasOwnProperty(ne)&&(this[ne]=F[ne])}},isDefault:function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},equals:function(F){return this.foreground===F.foreground&&this.underline===F.underline&&this.italics===F.italics&&this.background===F.background&&this.flash===F.flash},copy:function(F){this.foreground=F.foreground,this.underline=F.underline,this.italics=F.italics,this.background=F.background,this.flash=F.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var O=function(F,W,fe,ne,de,Te){this.uchar=F||" ",this.penState=new R(W,fe,ne,de,Te)};O.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(F,W){this.uchar=F,this.penState.copy(W)},setPenState:function(F){this.penState.copy(F)},equals:function(F){return this.uchar===F.uchar&&this.penState.equals(F.penState)},copy:function(F){this.uchar=F.uchar,this.penState.copy(F.penState)},isEmpty:function(){return this.uchar===" "&&this.penState.isDefault()}};var H=function(){this.chars=[];for(var F=0;F<d;F++)this.chars.push(new O);this.pos=0,this.currPenState=new R};H.prototype={equals:function(F){for(var W=!0,fe=0;fe<d;fe++)if(!this.chars[fe].equals(F.chars[fe])){W=!1;break}return W},copy:function(F){for(var W=0;W<d;W++)this.chars[W].copy(F.chars[W])},isEmpty:function(){for(var F=!0,W=0;W<d;W++)if(!this.chars[W].isEmpty()){F=!1;break}return F},setCursor:function(F){this.pos!==F&&(this.pos=F),this.pos<0?(T.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>d&&(T.log("ERROR","Too large cursor position "+this.pos),this.pos=d)},moveCursor:function(F){var W=this.pos+F;if(F>1)for(var fe=this.pos+1;fe<W+1;fe++)this.chars[fe].setPenState(this.currPenState);this.setCursor(W)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(F){F>=144&&this.backSpace();var W=m(F);this.pos>=d?T.log("ERROR","Cannot insert "+F.toString(16)+" ("+W+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(W,this.currPenState),this.moveCursor(1))},clearFromPos:function(F){var W;for(W=F;W<d;W++)this.chars[W].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var F=[],W=!0,fe=0;fe<d;fe++){var ne=this.chars[fe].uchar;ne!==" "&&(W=!1),F.push(ne)}return W?"":F.join("")},setPenStyles:function(F){this.currPenState.setStyles(F),this.chars[this.pos].setPenState(this.currPenState)}};var U=function(){this.rows=[];for(var F=0;F<u;F++)this.rows.push(new H);this.currRow=14,this.nrRollUpRows=null,this.reset()};U.prototype={reset:function(){for(var F=0;F<u;F++)this.rows[F].clear();this.currRow=14},equals:function(F){for(var W=!0,fe=0;fe<u;fe++)if(!this.rows[fe].equals(F.rows[fe])){W=!1;break}return W},copy:function(F){for(var W=0;W<u;W++)this.rows[W].copy(F.rows[W])},isEmpty:function(){for(var F=!0,W=0;W<u;W++)if(!this.rows[W].isEmpty()){F=!1;break}return F},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(F){this.rows[this.currRow].insertChar(F)},setPen:function(F){this.rows[this.currRow].setPenStyles(F)},moveCursor:function(F){this.rows[this.currRow].moveCursor(F)},setCursor:function(F){T.log("INFO","setCursor: "+F),this.rows[this.currRow].setCursor(F)},setPAC:function(F){T.log("INFO","pacData = "+JSON.stringify(F));var W=F.row-1;this.nrRollUpRows&&W<this.nrRollUpRows-1&&(W=this.nrRollUpRows-1),this.currRow=W;var fe=this.rows[this.currRow];if(F.indent!==null){var ne=F.indent,de=Math.max(ne-1,0);fe.setCursor(F.indent),F.color=fe.chars[de].penState.foreground}var Te={foreground:F.color,underline:F.underline,italics:F.italics,background:"black",flash:!1};this.setPen(Te)},setBkgData:function(F){T.log("INFO","bkgData = "+JSON.stringify(F)),this.backSpace(),this.setPen(F),this.insertChar(32)},setRollUpRows:function(F){this.nrRollUpRows=F},rollUp:function(){if(this.nrRollUpRows!==null){T.log("TEXT",this.getDisplayText());var F=this.currRow+1-this.nrRollUpRows,W=this.rows.splice(F,1)[0];W.clear(),this.rows.splice(this.currRow,0,W),T.log("INFO","Rolling up")}else T.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(F){F=F||!1;for(var W=[],fe="",ne=-1,de=0;de<u;de++){var Te=this.rows[de].getTextString();Te&&(ne=de+1,F?W.push("Row "+ne+': "'+Te+'"'):W.push(Te.trim()))}return W.length>0&&(fe=F?"["+W.join(" | ")+"]":W.join(`
`)),fe},getTextAndFormat:function(){return this.rows}};var Z=function(F,W){this.chNr=F,this.outputFilter=W,this.mode=null,this.verbose=0,this.displayedMemory=new U,this.nonDisplayedMemory=new U,this.lastOutputScreen=new U,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};Z.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(F){this.outputFilter=F},setPAC:function(F){this.writeScreen.setPAC(F)},setBkgData:function(F){this.writeScreen.setBkgData(F)},setMode:function(F){F!==this.mode&&(this.mode=F,T.log("INFO","MODE="+F),this.mode=="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=F)},insertChars:function(F){for(var W=0;W<F.length;W++)this.writeScreen.insertChar(F[W]);var fe=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";T.log("INFO",fe+": "+this.writeScreen.getDisplayText(!0)),this.mode!=="MODE_PAINT-ON"&&this.mode!=="MODE_ROLL-UP"||(T.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){T.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){T.log("INFO","BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){T.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(F){T.log("INFO","RU("+F+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(F)},cc_FON:function(){T.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){T.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){T.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){T.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){T.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){T.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){T.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(T.log("INFO","EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var F=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=F,this.writeScreen=this.nonDisplayedMemory,T.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(F){T.log("INFO","TO("+F+") - Tab Offset"),this.writeScreen.moveCursor(F)},cc_MIDROW:function(F){var W={flash:!1};if(W.underline=F%2==1,W.italics=F>=46,W.italics)W.foreground="white";else{var fe=Math.floor(F/2)-16;W.foreground=["white","green","blue","cyan","red","yellow","magenta"][fe]}T.log("INFO","MIDROW: "+JSON.stringify(W)),this.writeScreen.setPen(W)},outputDataUpdate:function(){var F=T.time;F!==null&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(F,this.displayedMemory),this.cueStartTime!==null||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,F,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:F):this.cueStartTime=F,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(F){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,F,this.displayedMemory),this.cueStartTime=F))}};var $=function(F,W,fe){this.field=F||1,this.outputs=[W,fe],this.channels=[new Z(1,W),new Z(2,fe)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};$.prototype={getHandler:function(F){return this.channels[F].getHandler()},setHandler:function(F,W){this.channels[F].setHandler(W)},addData:function(F,W){var fe,ne,de,Te=!1;this.lastTime=F,T.setTime(F);for(var me=0;me<W.length;me+=2)ne=127&W[me],de=127&W[me+1],ne>=16&&ne<=31&&ne===this.lastCmdA&&de===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,T.log("DEBUG","Repeated command ("+A([ne,de])+") is dropped")):ne!==0||de!==0?(T.log("DATA","["+A([W[me],W[me+1]])+"] -> ("+A([ne,de])+")"),(fe=this.parseCmd(ne,de))||(fe=this.parseMidrow(ne,de)),fe||(fe=this.parsePAC(ne,de)),fe||(fe=this.parseBackgroundAttributes(ne,de)),fe||(Te=this.parseChars(ne,de))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(Te):T.log("WARNING","No channel found yet. TEXT-MODE?")),fe?this.dataCounters.cmd+=2:Te?this.dataCounters.char+=2:(this.dataCounters.other+=2,T.log("WARNING","Couldn't parse cleaned data "+A([ne,de])+" orig: "+A([W[me],W[me+1]])))):this.dataCounters.padding+=2},parseCmd:function(F,W){var fe;if(!((F===20||F===21||F===28||F===29)&&32<=W&&W<=47||(F===23||F===31)&&33<=W&&W<=35))return!1;fe=F===20||F===21||F===23?1:2;var ne=this.channels[fe-1];return F===20||F===21||F===28||F===29?W===32?ne.cc_RCL():W===33?ne.cc_BS():W===34?ne.cc_AOF():W===35?ne.cc_AON():W===36?ne.cc_DER():W===37?ne.cc_RU(2):W===38?ne.cc_RU(3):W===39?ne.cc_RU(4):W===40?ne.cc_FON():W===41?ne.cc_RDC():W===42?ne.cc_TR():W===43?ne.cc_RTD():W===44?ne.cc_EDM():W===45?ne.cc_CR():W===46?ne.cc_ENM():W===47&&ne.cc_EOC():ne.cc_TO(W-32),this.lastCmdA=F,this.lastCmdB=W,this.currChNr=fe,!0},parseMidrow:function(F,W){var fe=null;if((F===17||F===25)&&32<=W&&W<=47){if((fe=F===17?1:2)!==this.currChNr)return T.log("ERROR","Mismatch channel in midrow parsing"),!1;var ne=this.channels[fe-1];return ne.insertChars([32]),ne.cc_MIDROW(W),T.log("DEBUG","MIDROW ("+A([F,W])+")"),this.lastCmdA=F,this.lastCmdB=W,!0}return!1},parsePAC:function(F,W){var fe,ne;if(!((17<=F&&F<=23||25<=F&&F<=31)&&64<=W&&W<=127||(F===16||F===24)&&64<=W&&W<=95))return!1;fe=F<=23?1:2,ne=64<=W&&W<=95?fe===1?S[F]:E[F]:fe===1?_[F]:b[F];var de=this.interpretPAC(ne,W);return this.channels[fe-1].setPAC(de),this.lastCmdA=F,this.lastCmdB=W,this.currChNr=fe,!0},interpretPAC:function(F,W){var fe,ne={color:null,italics:!1,indent:null,underline:!1,row:F};return fe=W>95?W-96:W-64,ne.underline=(1&fe)==1,fe<=13?ne.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(fe/2)]:fe<=15?(ne.italics=!0,ne.color="white"):ne.indent=4*Math.floor((fe-16)/2),ne},parseChars:function(F,W){var fe=null,ne=null,de=null;if(F>=25?(fe=2,de=F-8):(fe=1,de=F),17<=de&&de<=19){var Te;Te=de===17?W+80:de===18?W+112:W+144,T.log("INFO","Special char '"+m(Te)+"' in channel "+fe),ne=[Te],this.lastCmdA=F,this.lastCmdB=W}else 32<=F&&F<=127&&(ne=W===0?[F]:[F,W],this.lastCmdA=null,this.lastCmdB=null);if(ne){var me=A(ne);T.log("DEBUG","Char codes =  "+me.join(","))}return ne},parseBackgroundAttributes:function(F,W){var fe,ne,de;return((F===16||F===24)&&32<=W&&W<=47||(F===23||F===31)&&45<=W&&W<=47)&&(fe={},F===16||F===24?(ne=Math.floor((W-32)/2),fe.background=I[ne],W%2==1&&(fe.background=fe.background+"_semi")):W===45?fe.background="transparent":(fe.foreground="black",W===47&&(fe.underline=!0)),de=F<24?1:2,this.channels[de-1].setBkgData(fe),this.lastCmdA=F,this.lastCmdB=W,!0)},reset:function(){for(var F=0;F<this.channels.length;F++)this.channels[F]&&this.channels[F].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(F){for(var W=0;W<this.channels.length;W++)this.channels[W]&&this.channels[W].cueSplitAtTime(F)}},g.logger=T,g.PenState=R,g.CaptionScreen=U,g.Cea608Parser=$,g.findCea608Nalus=function(F,W,fe){for(var ne=0,de=W,Te=[],me=function(ee,_e,Ze,Ke){if(ee!==4||_e<8)return null;var De=Ze.getUint8(Ke),Ge=Ze.getUint16(Ke+1),Et=Ze.getUint32(Ke+3),vt=Ze.getUint8(Ke+7);return De==181&&Ge==49&&Et==1195456820&&vt==3};de<W+fe;){if(ne=F.getUint32(de),(31&F.getUint8(de+4))==6)for(var X=de+5,Ie=-1;X<de+4+ne-1;){Ie=0;for(var Be=255;Be===255;)Ie+=Be=F.getUint8(X),X++;var qe=0;for(Be=255;Be===255;)qe+=Be=F.getUint8(X),X++;me(Ie,qe,F,X)&&Te.push([X,qe]),X+=qe}de+=ne+4}return Te},g.extractCea608DataFromRange=function(F,W){var fe=W[0],ne=[[],[]];fe+=8;var de=31&F.getUint8(fe);fe+=2;for(var Te=0;Te<de;Te++){var me=F.getUint8(fe),X=4&me,Ie=3&me;fe++;var Be=F.getUint8(fe);fe++;var qe=F.getUint8(fe);fe++,X&&(127&Be)+(127&qe)!=0&&(Ie===0?(ne[0].push(Be),ne[0].push(qe)):Ie===1&&(ne[1].push(Be),ne[1].push(qe)))}return ne}})(y)},8416:function(f,y,g){var p=g(1139),m=g(5448),u=g(6398),d=g(2032),S=(g(5530),typeof window<"u"&&window||g.g),_=S.dashjs;_||(_=S.dashjs={}),_.MediaPlayer=p.Z,_.FactoryMaker=m.Z,_.Debug=u.Z,_.Version=(0,d.e)()},6398:function(f,y,g){var p=g(5595),m=g(8512),u=g(5448),d=1,S=2,_=3,E=4,b=5;function I(A){A=A||{};var R,O,H,U,Z=this.context,$=(0,p.Z)(Z).getInstance(),F=A.settings,W=[];function fe(Be){return Be&&Be.bind?Be.bind(window.console):window.console.log.bind(window.console)}function ne(){for(var Be=arguments.length,qe=new Array(Be),ee=0;ee<Be;ee++)qe[ee]=arguments[ee];Ie.apply(void 0,[d,this].concat(qe))}function de(){for(var Be=arguments.length,qe=new Array(Be),ee=0;ee<Be;ee++)qe[ee]=arguments[ee];Ie.apply(void 0,[S,this].concat(qe))}function Te(){for(var Be=arguments.length,qe=new Array(Be),ee=0;ee<Be;ee++)qe[ee]=arguments[ee];Ie.apply(void 0,[_,this].concat(qe))}function me(){for(var Be=arguments.length,qe=new Array(Be),ee=0;ee<Be;ee++)qe[ee]=arguments[ee];Ie.apply(void 0,[E,this].concat(qe))}function X(){for(var Be=arguments.length,qe=new Array(Be),ee=0;ee<Be;ee++)qe[ee]=arguments[ee];Ie.apply(void 0,[b,this].concat(qe))}function Ie(Be,qe){var ee="",_e=null;O&&(_e=new Date().getTime(),ee+="["+(_e-U)+"]"),H&&qe&&qe.getClassName&&(ee+="["+qe.getClassName()+"]",qe.getType&&(ee+="["+qe.getType()+"]")),ee.length>0&&(ee+=" ");for(var Ze=arguments.length,Ke=new Array(Ze>2?Ze-2:0),De=2;De<Ze;De++)Ke[De-2]=arguments[De];Array.apply(null,Ke).forEach((function(Ge){ee+=Ge+" "})),W[Be]&&F&&F.get().debug.logLevel>=Be&&W[Be](ee),F&&F.get().debug.dispatchEvent&&$.trigger(m.Z.LOG,{message:ee,level:Be})}return R={getLogger:function(Be){return{fatal:ne.bind(Be),error:de.bind(Be),warn:Te.bind(Be),info:me.bind(Be),debug:X.bind(Be)}},setLogTimestampVisible:function(Be){O=Be},setCalleeNameVisible:function(Be){H=Be}},O=!0,H=!0,U=new Date().getTime(),typeof window<"u"&&window.console&&(W[d]=fe(window.console.error),W[S]=fe(window.console.error),W[_]=fe(window.console.warn),W[E]=fe(window.console.info),W[b]=fe(window.console.debug)),R}I.__dashjs_factory_name="Debug";var T=u.Z.getSingletonFactory(I);T.LOG_LEVEL_NONE=0,T.LOG_LEVEL_FATAL=d,T.LOG_LEVEL_ERROR=S,T.LOG_LEVEL_WARNING=_,T.LOG_LEVEL_INFO=E,T.LOG_LEVEL_DEBUG=b,u.Z.updateSingletonFactory(I.__dashjs_factory_name,T),y.Z=T},5595:function(f,y,g){var p=g(5448),m=g(8825);function u(){var S={};function _(b,I,T){var A=-1;return S[b]&&S[b].some((function(R,O){if(R&&R.callback===I&&(!T||T===R.scope))return A=O,!0})),A}var E={on:function(b,I,T){var A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(!b)throw new Error("event type cannot be null or undefined");if(!I||typeof I!="function")throw new Error("listener must be a function: "+I);var R=A.priority||0;if(!(_(b,I,T)>=0)){S[b]=S[b]||[];var O={callback:I,scope:T,priority:R};T&&T.getStreamId&&(O.streamId=T.getStreamId()),T&&T.getType&&(O.mediaType=T.getType()),A&&A.mode&&(O.mode=A.mode);var H=S[b].some((function(U,Z){if(U&&R>U.priority)return S[b].splice(Z,0,O),!0}));H||S[b].push(O)}},off:function(b,I,T){if(b&&I&&S[b]){var A=_(b,I,T);A<0||(S[b][A]=null)}},trigger:function(b){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(b&&S[b]){if((I=I||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");I.type=b,T.streamId&&(I.streamId=T.streamId),T.mediaType&&(I.mediaType=T.mediaType),S[b].filter((function(A){return!(!A||T.streamId&&A.streamId&&A.streamId!==T.streamId||T.mediaType&&A.mediaType&&A.mediaType!==T.mediaType||T.mode&&A.mode&&A.mode!==T.mode||!A.mode&&T.mode&&T.mode===m.Z.EVENT_MODE_ON_RECEIVE)})).forEach((function(A){return A&&A.callback.call(A.scope,I)}))}},reset:function(){S={}}};return E}u.__dashjs_factory_name="EventBus";var d=p.Z.getSingletonFactory(u);d.EVENT_PRIORITY_LOW=0,d.EVENT_PRIORITY_HIGH=5e3,p.Z.updateSingletonFactory(u.__dashjs_factory_name,d),y.Z=d},5448:function(f,y){var g=(function(){var p,m=[],u={},d={};function S(I,T){for(var A in m){var R=m[A];if(R.context===I&&R.name===T)return R.instance}return null}function _(I,T){return T[I]}function E(I,T,A){I in A&&(A[I]=T)}function b(I,T,A){var R,O=I.__dashjs_factory_name,H=T[O];if(H){var U=H.instance;if(!H.override)return U.apply({context:T,factory:p},A);for(var Z in R=I.apply({context:T},A),U=U.apply({context:T,factory:p,parent:R},A))R.hasOwnProperty(Z)&&(R[Z]=U[Z])}else R=I.apply({context:T},A);return R.getClassName=function(){return O},R}return p={extend:function(I,T,A,R){!R[I]&&T&&(R[I]={instance:T,override:A})},getSingletonInstance:S,setSingletonInstance:function(I,T,A){for(var R in m){var O=m[R];if(O.context===I&&O.name===T)return void(m[R].instance=A)}m.push({name:T,context:I,instance:A})},deleteSingletonInstances:function(I){m=m.filter((function(T){return T.context!==I}))},getSingletonFactory:function(I){var T=_(I.__dashjs_factory_name,u);return T||(T=function(A){var R;return A===void 0&&(A={}),{getInstance:function(){return R||(R=S(A,I.__dashjs_factory_name)),R||(R=b(I,A,arguments),m.push({name:I.__dashjs_factory_name,context:A,instance:R})),R}}},u[I.__dashjs_factory_name]=T),T},getSingletonFactoryByName:function(I){return _(I,u)},updateSingletonFactory:function(I,T){E(I,T,u)},getClassFactory:function(I){var T=_(I.__dashjs_factory_name,d);return T||(T=function(A){return A===void 0&&(A={}),{create:function(){return b(I,A,arguments)}}},d[I.__dashjs_factory_name]=T),T},getClassFactoryByName:function(I){return _(I,d)},updateClassFactory:function(I,T){E(I,T,d)}},p})();y.Z=g},1264:function(f,y,g){var p=g(5448),m=g(703),u=g(6398),d=g(3393),S=g(7855),_=g(5595),E=g(8512);function b(R){return b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},b(R)}function I(R,O,H){return O in R?Object.defineProperty(R,O,{value:H,enumerable:!0,configurable:!0,writable:!0}):R[O]=H,R}function T(){var R,O,H=this.context,U=(0,_.Z)(H).getInstance(),Z={"streaming.delay.liveDelay":E.Z.SETTING_UPDATED_LIVE_DELAY,"streaming.delay.liveDelayFragmentCount":E.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,"streaming.liveCatchup.enabled":E.Z.SETTING_UPDATED_CATCHUP_ENABLED,"streaming.liveCatchup.playbackRate.min":E.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,"streaming.liveCatchup.playbackRate.max":E.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX},$={debug:{logLevel:u.Z.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,manifestUpdateRetryInterval:100,liveUpdateTimeThresholdInMilliseconds:0,cacheInitSegments:!1,applyServiceDescription:!0,applyProducerReferenceTime:!0,applyContentSteering:!0,eventControllerRefreshDelay:100,enableManifestDurationMismatchFix:!0,parseInbandPrft:!1,enableManifestTimescaleMismatchFix:!1,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1,detectPlayreadyMessageFormat:!0},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0,avoidCurrentTimeRangePruning:!1,useChangeTypeForTrackSwitch:!0,mediaSourceDurationInfinity:!0,resetSourceBuffersForTrackSwitch:!1},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0,enableStallFix:!1,stallSeek:.1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0,dispatchForManualRendering:!1,extendSegmentedCues:!0,imsc:{displayForcedOnlyMode:!1,enableRollUp:!0},webvtt:{customRenderingEnabled:!1}},liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN},playbackBufferMin:.5,enabled:null,mode:d.Z.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},saveLastMediaSettingsForCurrentStreamingSession:!0,cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:d.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:d.Z.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:d.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:2e4,fragmentRequestProgressTimeout:-1,manifestRequestTimeout:1e4,retryIntervals:(R={},I(R,S.w.MPD_TYPE,500),I(R,S.w.XLINK_EXPANSION_TYPE,500),I(R,S.w.MEDIA_SEGMENT_TYPE,1e3),I(R,S.w.INIT_SEGMENT_TYPE,1e3),I(R,S.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),I(R,S.w.INDEX_SEGMENT_TYPE,1e3),I(R,S.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),I(R,S.w.LICENSE,1e3),I(R,S.w.OTHER_TYPE,1e3),I(R,"lowLatencyReductionFactor",10),R),retryAttempts:(O={},I(O,S.w.MPD_TYPE,3),I(O,S.w.XLINK_EXPANSION_TYPE,1),I(O,S.w.MEDIA_SEGMENT_TYPE,3),I(O,S.w.INIT_SEGMENT_TYPE,3),I(O,S.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),I(O,S.w.INDEX_SEGMENT_TYPE,3),I(O,S.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),I(O,S.w.LICENSE,3),I(O,S.w.OTHER_TYPE,3),I(O,"lowLatencyMultiplyFactor",5),O),abr:{movingAverageMethod:d.Z.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:d.Z.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!0},abrRulesParameters:{abandonRequestsRule:{graceTimeThreshold:500,abandonMultiplier:1.8,minLengthToAverage:5}},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:d.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:d.Z.CMCD_MODE_QUERY,enabledKeys:["br","d","ot","tb","bl","dl","mtp","nor","nrr","su","bs","rtp","cid","pr","sf","sid","st","v"]},cmsd:{enabled:!1,abr:{applyMb:!1,etpWeightRatio:0}}},errors:{recoverAttempts:{mediaErrorDecode:5}}},F=m.Z.clone($);function W(fe,ne,de){for(var Te in fe)fe.hasOwnProperty(Te)&&(ne.hasOwnProperty(Te)?b(fe[Te])!=="object"||fe[Te]instanceof Array||fe[Te]===null?(ne[Te]=m.Z.clone(fe[Te]),Z[de+Te]&&U.trigger(Z[de+Te])):W(fe[Te],ne[Te],de.slice()+Te+"."):console.error("Settings parameter "+de+Te+" is not supported"))}return{get:function(){return F},update:function(fe){b(fe)==="object"&&W(fe,F,"")},reset:function(){F=m.Z.clone($)}}}T.__dashjs_factory_name="Settings";var A=p.Z.getSingletonFactory(T);y.Z=A},703:function(f,y,g){var p=g(3875),m=g.n(p),u=g(1067);function d(E){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},d(E)}function S(E,b){for(var I=0;I<b.length;I++){var T=b[I];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(E,T.key,T)}}var _=(function(){function E(){(function(T,A){if(!(T instanceof A))throw new TypeError("Cannot call a class as a function")})(this,E)}var b,I;return b=E,I=[{key:"mixin",value:function(T,A,R){var O,H={};if(T)for(var U in A)A.hasOwnProperty(U)&&(O=A[U],U in T&&(T[U]===O||U in H&&H[U]===O)||(d(T[U])==="object"&&T[U]!==null?T[U]=E.mixin(T[U],O,R):T[U]=R(O)));return T}},{key:"clone",value:function(T){if(!T||d(T)!=="object")return T;var A;if(T instanceof Array){A=[];for(var R=0,O=T.length;R<O;++R)R in T&&A.push(E.clone(T[R]))}else A={};return E.mixin(A,T,E.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(T,A){try{if(!A||A.length===0)return T;var R=new URL(T);return A.forEach((function(O){O.key&&O.value&&R.searchParams.set(O.key,O.value)})),R.href}catch{return T}}},{key:"parseHttpHeaders",value:function(T){var A={};if(!T)return A;for(var R=T.trim().split(`\r
`),O=0,H=R.length;O<H;O++){var U=R[O],Z=U.indexOf(": ");Z>0&&(A[U.substring(0,Z)]=U.substring(Z+2))}return A}},{key:"generateUuid",value:function(){var T=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(A){var R=(T+16*Math.random())%16|0;return T=Math.floor(T/16),(A=="x"?R:3&R|8).toString(16)}))}},{key:"generateHashCode",value:function(T){var A=0;if(T.length===0)return A;for(var R=0;R<T.length;R++)A=(A<<5)-A+T.charCodeAt(R),A|=0;return A}},{key:"getRelativeUrl",value:function(T,A){try{var R=new URL(T),O=new URL(A);if(R.protocol=O.protocol,R.origin!==O.origin)return A;var H=m().relative(R.pathname.substr(0,R.pathname.lastIndexOf("/")),O.pathname.substr(0,O.pathname.lastIndexOf("/"))),U=H.length===0?1:0;return H+=O.pathname.substr(O.pathname.lastIndexOf("/")+U,O.pathname.length-1),O.pathname.length<H.length?O.pathname:H}catch{return A}}},{key:"parseUserAgent",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;try{var A=T===null&&typeof navigator<"u"?navigator.userAgent.toLowerCase():"";return(0,u.UAParser)(A)}catch{return{}}}},{key:"stringHasProtocol",value:function(T){return/(http(s?)):\/\//i.test(T)}}],I&&S(b,I),E})();y.Z=_},2032:function(f,y,g){function p(){return"4.7.4"}g.d(y,{e:function(){return p}})},2230:function(f,y){function g(m,u){for(var d=0;d<u.length;d++){var S=u[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(m,S.key,S)}}var p=(function(){function m(){(function(S,_){if(!(S instanceof _))throw new TypeError("Cannot call a class as a function")})(this,m)}var u,d;return u=m,(d=[{key:"extend",value:function(S,_){if(S){var E=!!_&&_.override,b=!!_&&_.publicOnly;for(var I in S)!S.hasOwnProperty(I)||this[I]&&!E||b&&S[I].indexOf("public_")===-1||(this[I]=S[I])}}}])&&g(u.prototype,d),m})();y.Z=p},4351:function(f,y,g){function p(_){return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},p(_)}function m(_,E){return m=Object.setPrototypeOf||function(b,I){return b.__proto__=I,b},m(_,E)}function u(_,E){return!E||p(E)!=="object"&&typeof E!="function"?(function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b})(_):E}function d(_){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)},d(_)}var S=(function(_){(function(A,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(R&&R.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),R&&m(A,R)})(T,_);var E,b,I=(E=T,b=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var A,R=d(E);if(b){var O=d(this).constructor;A=Reflect.construct(R,arguments,O)}else A=R.apply(this,arguments);return u(this,A)});function T(){var A;return(function(R,O){if(!(R instanceof O))throw new TypeError("Cannot call a class as a function")})(this,T),(A=I.call(this)).ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",A.BUFFERING_COMPLETED="bufferingCompleted",A.BUFFER_CLEARED="bufferCleared",A.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",A.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",A.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",A.CMSD_STATIC_HEADER="cmsdStaticHeader",A.CURRENT_TRACK_CHANGED="currentTrackChanged",A.DATA_UPDATE_COMPLETED="dataUpdateCompleted",A.INBAND_EVENTS="inbandEvents",A.INITIAL_STREAM_SWITCH="initialStreamSwitch",A.INIT_FRAGMENT_LOADED="initFragmentLoaded",A.INIT_FRAGMENT_NEEDED="initFragmentNeeded",A.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",A.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",A.LOADING_COMPLETED="loadingCompleted",A.LOADING_PROGRESS="loadingProgress",A.LOADING_DATA_PROGRESS="loadingDataProgress",A.LOADING_ABANDONED="loadingAborted",A.MANIFEST_UPDATED="manifestUpdated",A.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",A.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",A.QUOTA_EXCEEDED="quotaExceeded",A.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",A.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",A.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD="serviceLocationBlacklistAdd",A.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",A.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD="serviceLocationLocationBlacklistAdd",A.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED="serviceLocationLocationBlacklistChanged",A.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",A.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",A.SOURCE_BUFFER_ERROR="sourceBufferError",A.STREAMS_COMPOSED="streamsComposed",A.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",A.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",A.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",A.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",A.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",A.URL_RESOLUTION_FAILED="urlResolutionFailed",A.VIDEO_CHUNK_RECEIVED="videoChunkReceived",A.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",A.XLINK_ELEMENT_LOADED="xlinkElementLoaded",A.XLINK_READY="xlinkReady",A.SEEK_TARGET="seekTarget",A.SETTING_UPDATED_LIVE_DELAY="settingUpdatedLiveDelay",A.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT="settingUpdatedLiveDelayFragmentCount",A.SETTING_UPDATED_CATCHUP_ENABLED="settingUpdatedCatchupEnabled",A.SETTING_UPDATED_PLAYBACK_RATE_MIN="settingUpdatedPlaybackRateMin",A.SETTING_UPDATED_PLAYBACK_RATE_MAX="settingUpdatedPlaybackRateMax",A}return T})(g(8342).Z);y.Z=S},8512:function(f,y,g){function p(b){return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},p(b)}function m(b,I){if(!(b instanceof I))throw new TypeError("Cannot call a class as a function")}function u(b,I){return u=Object.setPrototypeOf||function(T,A){return T.__proto__=A,T},u(b,I)}function d(b,I){return!I||p(I)!=="object"&&typeof I!="function"?(function(T){if(T===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T})(b):I}function S(b){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(I){return I.__proto__||Object.getPrototypeOf(I)},S(b)}var _=(function(b){(function(O,H){if(typeof H!="function"&&H!==null)throw new TypeError("Super expression must either be null or a function");O.prototype=Object.create(H&&H.prototype,{constructor:{value:O,writable:!0,configurable:!0}}),H&&u(O,H)})(R,b);var I,T,A=(I=R,T=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var O,H=S(I);if(T){var U=S(this).constructor;O=Reflect.construct(H,arguments,U)}else O=H.apply(this,arguments);return d(this,O)});function R(){return m(this,R),A.apply(this,arguments)}return R})(g(4351).Z),E=new _;y.Z=E},8342:function(f,y){function g(m,u){for(var d=0;d<u.length;d++){var S=u[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(m,S.key,S)}}var p=(function(){function m(){(function(S,_){if(!(S instanceof _))throw new TypeError("Cannot call a class as a function")})(this,m)}var u,d;return u=m,(d=[{key:"extend",value:function(S,_){if(S){var E=!!_&&_.override,b=!!_&&_.publicOnly;for(var I in S)!S.hasOwnProperty(I)||this[I]&&!E||b&&S[I].indexOf("public_")===-1||(this[I]=S[I])}}}])&&g(u.prototype,d),m})();y.Z=p},9326:function(f,y,g){var p=g(3186),m=g(7855),u=g(5448),d=g(8825),S=g(7387),_=g(1553);function E(b){var I,T,A,R,O,H=(b=b||{}).eventBus,U=b.debug,Z=b.urlUtils,$=b.type,F=b.streamInfo,W=b.segmentsController,fe=b.timelineConverter,ne=b.baseURLController;function de(){return $}function Te(){A=null}function me(ee,_e,Ze){var Ke,De,Ge=ne.resolve(Ze.path),Et={};return Ge&&_e!==Ge.url&&Z.isRelative(_e)?(Ke=Ge.url,De=Ge.serviceLocation,Et=Ge.queryParams,_e&&(Ke=Z.resolve(_e,Ke))):Ke=_e,!Z.isRelative(Ke)&&(ee.url=Ke,ee.serviceLocation=De,ee.queryParams=Et,!0)}function X(ee,_e){if(_e==null)return null;var Ze=new p.Z,Ke=_e.representation,De=Ke.adaptation.period.mpd.manifest.Period_asArray[Ke.adaptation.period.index].AdaptationSet_asArray[Ke.adaptation.index].Representation_asArray[Ke.index].bandwidth,Ge=_e.media;return Ge=(0,S.vi)(Ge,"Number",_e.replacementNumber),Ge=(0,S.vi)(Ge,"Time",_e.replacementTime),Ge=(0,S.vi)(Ge,"Bandwidth",De),Ge=(0,S.Aj)(Ge,Ke.id),Ge=(0,S.eR)(Ge),Ze.mediaType=de(),Ze.type=m.w.MEDIA_SEGMENT_TYPE,Ze.range=_e.mediaRange,Ze.startTime=_e.presentationStartTime,Ze.mediaStartTime=_e.mediaStartTime,Ze.duration=_e.duration,Ze.timescale=Ke.timescale,Ze.availabilityStartTime=_e.availabilityStartTime,Ze.availabilityEndTime=_e.availabilityEndTime,Ze.availabilityTimeComplete=Ke.availabilityTimeComplete,Ze.wallStartTime=_e.wallStartTime,Ze.quality=Ke.index,Ze.index=_e.index,Ze.mediaInfo=ee,Ze.adaptationIndex=Ke.adaptation.index,Ze.representationId=Ke.id,me(Ze,Ge,Ke)?Ze:void 0}function Ie(ee,_e,Ze){var Ke=null;if(!_e||!_e.segmentInfoType)return Ke;var De=W.getSegmentByTime(_e,Ze);return De&&(A=De,T.debug("Index for time "+Ze+" is "+De.index),Ke=X(ee,De)),Ke}function Be(ee,_e,Ze){var Ke=null,De=W.getSegmentByIndex(_e,Ze,A?A.mediaStartTime:-1);if(De)Ke=X(ee,De),A=De;else{if(R&&!O)return T.debug(de()+" No segment found at index: "+Ze+". Wait for next loop"),null;O=!0}return Ke}function qe(){T.debug("Dynamic stream complete"),O=!0}return I={getCurrentIndex:function(){return A?A.index:-1},getInitRequest:function(ee,_e){return _e?(function(Ze,Ke,De){var Ge=new p.Z,Et=Ke.adaptation.period,vt=Et.start;if(Ge.mediaType=De,Ge.type=m.w.INIT_SEGMENT_TYPE,Ge.range=Ke.range,Ge.availabilityStartTime=fe.calcAvailabilityStartTimeFromPresentationTime(vt,Ke,R),Ge.availabilityEndTime=fe.calcAvailabilityEndTimeFromPresentationTime(vt+Et.duration,Ke,R),Ge.quality=Ke.index,Ge.mediaInfo=Ze,Ge.representationId=Ke.id,me(Ge,Ke.initialization,Ke))return Ge.url=(0,S.vi)(Ge.url,"Bandwidth",Ke.bandwidth),Ge})(ee,_e,de()):null},getNextSegmentRequest:function(ee,_e){return _e&&_e.segmentInfoType?Be(ee,_e,A?A.index+1:0):null},getNextSegmentRequestIdempotent:function(ee,_e){var Ze=A?A.index+1:0,Ke=W.getSegmentByIndex(_e,Ze,A?A.mediaStartTime:-1);return Ke?X(ee,Ke):null},getSegmentRequestForTime:Ie,getStreamId:function(){return F.id},getStreamInfo:function(){return F},getType:de,getValidTimeAheadOfTargetTime:function(ee,_e,Ze,Ke){try{if(isNaN(ee)||!_e||!Ze)return NaN;if(ee<0&&(ee=0),isNaN(Ke)&&(Ke=.5),Ie(_e,Ze,ee))return ee;if(Ze.adaptation.period.start+Ze.adaptation.period.duration<ee)return NaN;for(var De=isFinite(Ze.adaptation.period.duration)?Ze.adaptation.period.start+Ze.adaptation.period.duration:ee+30,Ge=Math.min(ee+Ke,De),Et=NaN,vt=null;Ge<=De;){var et=null;if(Ge<=De&&(et=Ie(_e,Ze,Ge)),et){Et=Ge,vt=et;break}Ge+=Ke}if(vt){var gt=vt.startTime+vt.duration;return ee>vt.startTime&&gt-ee>Ke?ee:!isNaN(vt.startTime)&&ee<vt.startTime&&Et>vt.startTime?vt.startTime+.001:Math.min(gt-Ke,Et)}return Et}catch{return NaN}},initialize:function(ee){R=ee,O=!1,W.initialize(ee)},isLastSegmentRequested:function(ee,_e){return!ee||!A?!1:O?!0:!isFinite(ee.adaptation.period.duration)||A.presentationStartTime+A.duration>_e?!1:ee.mediaFinishedInformation&&!isNaN(ee.mediaFinishedInformation.numberOfSegments)&&!isNaN(A.index)&&A.index>=ee.mediaFinishedInformation.numberOfSegments-1&&(!R||ee.segmentInfoType===_.Z.SEGMENT_TEMPLATE||R&&ee.segmentInfoType===_.Z.SEGMENT_LIST&&ee.adaptation.period.nextPeriodId)?!0:!!(R&&ee.adaptation.period.nextPeriodId&&ee.segmentInfoType===_.Z.SEGMENT_TIMELINE&&ee.mediaFinishedInformation&&!isNaN(ee.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&A&&!isNaN(A.mediaStartTime)&&!isNaN(A.duration)&&A.mediaStartTime+A.duration>=ee.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)},repeatSegmentRequest:function(ee,_e){return _e&&_e.segmentInfoType?Be(ee,_e,A?A.index:0):null},reset:function(){Te(),H.off(d.Z.DYNAMIC_TO_STATIC,qe,I)}},T=U.getLogger(I),Te(),H.on(d.Z.DYNAMIC_TO_STATIC,qe,I),I}E.__dashjs_factory_name="DashHandler",y.Z=u.Z.getClassFactory(E)},1553:function(f,y){function g(m,u){for(var d=0;d<u.length;d++){var S=u[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(m,S.key,S)}}var p=new((function(){function m(){(function(S,_){if(!(S instanceof _))throw new TypeError("Cannot call a class as a function")})(this,m),this.init()}var u,d;return u=m,(d=[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.ESSENTIAL_PROPERTY_ASARRAY="EssentialProperty_asArray",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.SUPPLEMENTAL_PROPERTY_ASARRAY="SupplementalProperty_asArray",this.INBAND_EVENT_STREAM="InbandEventStream",this.PRODUCER_REFERENCE_TIME="ProducerReferenceTime",this.INBAND="inband",this.TYPE="type",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.VIEWPOINT_ASARRAY="Viewpoint_asArray",this.ROLE_ASARRAY="Role_asArray",this.REPRESENTATION_ASARRAY="Representation_asArray",this.PRODUCERREFERENCETIME_ASARRAY="ProducerReferenceTime_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.DVB_URL="dvb:url",this.DVB_MIMETYPE="dvb:mimeType",this.DVB_FONTFAMILY="dvb:fontFamily",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.SERVICE_DESCRIPTION_OPERATING_QUALITY="OperatingQuality",this.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH="OperatingBandwidth",this.PATCH_LOCATION="PatchLocation",this.PATCH_LOCATION_AS_ARRAY="PatchLocation_asArray",this.LOCATION="Location",this.LOCATION_AS_ARRAY="Location_asArray",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId",this.WALL_CLOCK_TIME="wallClockTime",this.PRESENTATION_TIME="presentationTime",this.LABEL="Label",this.GROUP_LABEL="GroupLabel",this.CONTENT_STEERING="ContentSteering",this.CONTENT_STEERING_AS_ARRAY="ContentSteering_asArray",this.DEFAULT_SERVICE_LOCATION="defaultServiceLocation",this.QUERY_BEFORE_START="queryBeforeStart",this.CLIENT_REQUIREMENT="clientRequirement",this.TTL="ttl",this.CONTENT_STEERING_RESPONSE={VERSION:"VERSION",TTL:"TTL",RELOAD_URI:"RELOAD-URI",PATHWAY_PRIORITY:"PATHWAY-PRIORITY",PATHWAY_CLONES:"PATHWAY-CLONES",BASE_ID:"BASE-ID",ID:"ID",URI_REPLACEMENT:"URI-REPLACEMENT",HOST:"HOST",PARAMS:"PARAMS"},this.PRODUCER_REFERENCE_TIME_TYPE={ENCODER:"encoder",CAPTURED:"captured",APPLICATION:"application"},this.SEGMENT_ALIGNMENT="segmentAlignment",this.SUB_SEGMENT_ALIGNMENT="subsegmentAlignment"}}])&&g(u.prototype,d),m})());y.Z=p},7802:function(f,y,g){var p=g(5448),m=g(1724),u=g(3636),d=g(1736),S=g(5246);function _(b){b=b||{};var I,T,A=this.context,R=b.dashConstants,O=b.type,H=b.segmentBaseController;function U(Z){return Z?Z.segments?T[R.SEGMENT_BASE]:T[Z.segmentInfoType]:null}return I={initialize:function(Z){T[R.SEGMENT_TIMELINE]=(0,m.Z)(A).create(b,Z),T[R.SEGMENT_TEMPLATE]=(0,u.Z)(A).create(b,Z),T[R.SEGMENT_LIST]=(0,d.Z)(A).create(b,Z),T[R.SEGMENT_BASE]=(0,S.Z)(A).create(b,Z)},updateInitData:function(Z,$){return $?Promise.resolve():H.getSegmentBaseInitSegment({representation:Z,mediaType:O})},updateSegmentData:function(Z,$){return $?Promise.resolve():H.getSegmentList({mimeType:Z.mimeType,representation:Z,mediaType:O})},getSegmentByIndex:function(Z,$,F){var W=U(Z);return W?W.getSegmentByIndex(Z,$,F):null},getSegmentByTime:function(Z,$){var F=U(Z);return F?F.getSegmentByTime(Z,$):null},getMediaFinishedInformation:function(Z){var $=U(Z);return $?$.getMediaFinishedInformation(Z):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}},T={},I}_.__dashjs_factory_name="SegmentsController";var E=p.Z.getClassFactory(_);y.Z=E},1736:function(f,y,g){var p=g(5448),m=g(3393),u=g(7387);function d(_,E){var b=(_=_||{}).timelineConverter;function I(){if(!b||!b.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(m.Z.MISSING_CONFIG_ERROR)}function T(A,R){if(I(),!A)return null;var O=A.adaptation.period.mpd.manifest.Period_asArray[A.adaptation.period.index].AdaptationSet_asArray[A.adaptation.index].Representation_asArray[A.index].SegmentList,H=O.SegmentURL_asArray.length,U=A&&!isNaN(A.startNumber)?A.startNumber:1,Z=Math.max(U-1,0),$=Math.max(R-Z,0),F=null;if($<H){var W=O.SegmentURL_asArray[$];(F=(0,u.NF)(b,E,A,R))&&(F.replacementTime=(U+R-1)*A.segmentDuration,F.media=W.media?W.media:"",F.mediaRange=W.mediaRange,F.indexRange=W.indexRange)}return F}return{getSegmentByIndex:T,getSegmentByTime:function(A,R){if(I(),!A)return null;var O=A.segmentDuration;if(isNaN(O))return null;var H=b.calcPeriodRelativeTimeFromMpdRelativeTime(A,R);return T(A,Math.floor(H/O))},getMediaFinishedInformation:function(A){var R={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!A)return R;var O=A.adaptation.period.mpd.manifest.Period_asArray[A.adaptation.period.index].AdaptationSet_asArray[A.adaptation.index].Representation_asArray[A.index].SegmentList,H=A&&!isNaN(A.startNumber)?A.startNumber:1,U=Math.max(H-1,0);return R.numberOfSegments=U+O.SegmentURL_asArray.length,R}}}d.__dashjs_factory_name="ListSegmentsGetter";var S=p.Z.getClassFactory(d);y.Z=S},5246:function(f,y,g){var p=g(5448),m=g(3393);function u(S){var _=(S=S||{}).timelineConverter;function E(){if(!_||!_.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(m.Z.MISSING_CONFIG_ERROR)}function b(I,T){if(E(),!I)return null;var A,R=I.segments?I.segments.length:-1;if(T<R&&(A=I.segments[T])&&A.index===T)return A;for(var O=0;O<R;O++)if((A=I.segments[O])&&A.index===T)return A;return null}return{getSegmentByIndex:b,getSegmentByTime:function(I,T){E();var A=(function(R,O){if(!R)return-1;var H,U,Z,$,F,W=R.segments,fe=W?W.length:null,ne=-1;if(W&&fe>0){for(F=0;F<fe;F++)if(Z=(U=W[F]).presentationStartTime,O+(H=($=U.duration)/2)>=Z&&O-H<Z+$){ne=U.index;break}}return ne})(I,T);return b(I,A)},getMediaFinishedInformation:function(I){var T={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return I&&I.segments&&(T.numberOfSegments=I.segments.length),T}}}u.__dashjs_factory_name="SegmentBaseGetter";var d=p.Z.getClassFactory(u);y.Z=d},7387:function(f,y,g){g.d(y,{Aj:function(){return d},NF:function(){return b},TJ:function(){return I},eR:function(){return u},vi:function(){return S}});var p=g(2011);function m(T,A){for(;T.length<A;)T="0"+T;return T}function u(T){return T&&T.split("$$").join("$")}function d(T,A){if(!A||!T||T.indexOf("$RepresentationID$")===-1)return T;var R=A.toString();return T.split("$RepresentationID$").join(R)}function S(T,A,R){var O,H,U,Z,$,F,W=A.length,fe=2;if(!T)return T;for(;;){if((O=T.indexOf("$"+A))<0||(H=T.indexOf("$",O+W))<0)return T;if((U=T.indexOf("%0",O+W))>O&&U<H)switch(Z=T.charAt(H-1),$=parseInt(T.substring(U+fe,H-1),10),Z){case"d":case"i":case"u":F=m(R.toString(),$);break;case"x":F=m(R.toString(16),$);break;case"X":F=m(R.toString(16),$).toUpperCase();break;case"o":F=m(R.toString(8),$);break;default:return T}else F=R;T=T.substring(0,O)+F+T.substring(H+1)}}function _(T,A,R,O,H,U,Z,$){var F,W=new p.Z;return W.representation=T,W.duration=A,W.presentationStartTime=R,W.mediaStartTime=O,W.availabilityStartTime=H.calcAvailabilityStartTimeFromPresentationTime(U,T,Z),W.availabilityEndTime=H.calcAvailabilityEndTimeFromPresentationTime(U+A,T,Z),W.wallStartTime=H.calcWallTimeForSegment(W,Z),W.replacementNumber=(F=$,W.representation.startNumber+F),W.index=$,W}function E(T,A,R,O){var H=A.adaptation.period;if(isFinite(H.duration)&&H.start+H.duration<=R.presentationStartTime)return!1;if(O){if(A.availabilityTimeOffset==="INF")return!0;var U=T.getClientReferenceTime();return R.availabilityStartTime.getTime()<=U&&(!isFinite(R.availabilityEndTime)||R.availabilityEndTime.getTime()>=U)}return!0}function b(T,A,R,O){var H,U,Z;H=R.segmentDuration,isNaN(H)&&(H=R.adaptation.period.duration),U=parseFloat((R.adaptation.period.start+O*H).toFixed(5)),Z=parseFloat((U+H).toFixed(5));var $=_(R,H,U,T.calcMediaTimeFromPresentationTime(U,R),T,Z,A,O);return E(T,R,$,A)?$:null}function I(T,A,R,O,H,U,Z,$,F,W){var fe,ne,de=O/U,Te=H/U;return fe=T.calcPresentationTimeFromMediaTime(de,R),E(T,R,ne=_(R,Te,fe,de,T,fe+Te,A,F),A)?(ne.replacementTime=W||O,Z=S(Z,"Number",ne.replacementNumber),Z=S(Z,"Time",ne.replacementTime),ne.media=Z,ne.mediaRange=$,ne):null}},3636:function(f,y,g){var p=g(5448),m=g(3393),u=g(7387);function d(_,E){var b=(_=_||{}).timelineConverter;function I(){if(!b||!b.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(m.Z.MISSING_CONFIG_ERROR)}function T(A,R){if(I(),!A)return null;var O=A.adaptation.period.mpd.manifest.Period_asArray[A.adaptation.period.index].AdaptationSet_asArray[A.adaptation.index].Representation_asArray[A.index].SegmentTemplate;R=Math.max(R,0);var H=(0,u.NF)(b,E,A,R);if(H){H.replacementTime=Math.round((R-1)*A.segmentDuration*A.timescale,10);var U=O.media;U=(0,u.vi)(U,"Number",H.replacementNumber),U=(0,u.vi)(U,"Time",H.replacementTime),H.media=U}return H}return{getSegmentByIndex:T,getSegmentByTime:function(A,R){if(I(),!A)return null;var O=A.segmentDuration;if(isNaN(O))return null;var H=b.calcPeriodRelativeTimeFromMpdRelativeTime(A,R);return T(A,Math.floor(H/O))},getMediaFinishedInformation:function(A){var R={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!A)return R;var O=A.segmentDuration;return isNaN(O)?R.numberOfSegments=1:R.numberOfSegments=Math.ceil(A.adaptation.period.duration/O),R}}}d.__dashjs_factory_name="TemplateSegmentsGetter";var S=p.Z.getClassFactory(d);y.Z=S},1724:function(f,y,g){var p=g(5448),m=g(3393),u=g(7387);function d(_,E){var b=(_=_||{}).timelineConverter,I=_.dashMetrics;function T(){if(!b)throw new Error(m.Z.MISSING_CONFIG_ERROR)}function A(O,H){var U,Z,$,F,W,fe,ne,de=O.adaptation.period.mpd.manifest.Period_asArray[O.adaptation.period.index].AdaptationSet_asArray[O.adaptation.index].Representation_asArray[O.index].SegmentTemplate||O.adaptation.period.mpd.manifest.Period_asArray[O.adaptation.period.index].AdaptationSet_asArray[O.adaptation.index].Representation_asArray[O.index].SegmentList,Te=de.SegmentTimeline,me=de.SegmentURL_asArray,X=0,Ie=-1;ne=O.timescale;var Be=!1;for($=0,F=(U=Te.S_asArray).length;$<F&&!Be;$++)for(fe=0,(Z=U[$]).hasOwnProperty("r")&&(fe=Z.r),Z.hasOwnProperty("t")&&(X=Z.t),fe<0&&(fe=R(O,U[$+1],Z,ne,X/ne)),W=0;W<=fe&&!Be;W++)(Be=H(X,de,me,Z,ne,++Ie,$))&&(O.segmentDuration=Z.d/ne),X+=Z.d}function R(O,H,U,Z,$){var F;if(H&&H.hasOwnProperty("t"))F=H.t/Z;else try{var W=0;if(isNaN(O.adaptation.period.start)||isNaN(O.adaptation.period.duration)||!isFinite(O.adaptation.period.duration)){var fe=I.getCurrentDVRInfo();W=isNaN(fe.end)?0:fe.end}else W=O.adaptation.period.start+O.adaptation.period.duration;F=b.calcMediaTimeFromPresentationTime(W,O),O.segmentDuration=U.d/Z}catch{F=0}return Math.max(Math.ceil((F-$)/(U.d/Z))-1,0)}return{getSegmentByIndex:function(O,H,U){if(T(),!O)return null;var Z=null,$=!1;return A(O,(function(F,W,fe,ne,de,Te,me){if($||U<0){var X=W.media,Ie=ne.mediaRange;return fe&&(X=fe[me].media||"",Ie=fe[me].mediaRange),Z=(0,u.TJ)(b,E,O,F,ne.d,de,X,Ie,Te,ne.tManifest),!0}return F>=U*de-.5*ne.d&&($=!0),!1})),Z},getSegmentByTime:function(O,H){if(T(),!O)return null;H===void 0&&(H=null);var U=null,Z=b.calcMediaTimeFromPresentationTime(H,O);return A(O,(function($,F,W,fe,ne,de,Te){var me=parseFloat((Z*ne).toPrecision(15));if(me<$+fe.d&&me>=$){var X=F.media,Ie=fe.mediaRange;return W&&(X=W[Te].media||"",Ie=W[Te].mediaRange),U=(0,u.TJ)(b,E,O,$,fe.d,ne,X,Ie,de,fe.tManifest),!0}return!1})),U},getMediaFinishedInformation:function(O){if(!O)return 0;var H,U,Z,$,F,W,fe,ne=(O.adaptation.period.mpd.manifest.Period_asArray[O.adaptation.period.index].AdaptationSet_asArray[O.adaptation.index].Representation_asArray[O.index].SegmentTemplate||O.adaptation.period.mpd.manifest.Period_asArray[O.adaptation.period.index].AdaptationSet_asArray[O.adaptation.index].Representation_asArray[O.index].SegmentList).SegmentTimeline,de=0,Te=0,me=0;for(fe=O.timescale,$=(H=ne.S_asArray).length,Z=0;Z<$;Z++)for(W=0,(U=H[Z]).hasOwnProperty("r")&&(W=U.r),U.hasOwnProperty("t")&&(Te=(de=U.t)/fe),W<0&&(W=R(O,H[Z+1],U,fe,Te)),F=0;F<=W;F++)me++,Te=(de+=U.d)/fe;return{numberOfSegments:me,mediaTimeOfLastSignaledSegment:Te}}}}d.__dashjs_factory_name="TimelineSegmentsGetter";var S=p.Z.getClassFactory(d);y.Z=S},2011:function(f,y){y.Z=function g(){(function(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")})(this,g),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null}},2610:function(f,y){y.Z=function g(){(function(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")})(this,g),this.schemeIdUri="",this.value=""}},1139:function(f,y,g){g.d(y,{Z:function(){return es}});var p=g(452),m=g.n(p),u=g(3393),d=g(1553),S=g(3860),_=g(5595),E=g(8512),b=g(5448),I=g(6398),T=g(8825);function A(){var D,C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le,Me,le,Re,ue,xe,P,te,J,Q=this.context,j=(0,_.Z)(Q).getInstance();function Ae(){ae(),se=!1,ge=0,ie=0,Le=0,P=!1,Me=!0,le=!1,te=!1,Re=NaN,be=NaN,k&&(j.off(E.Z.DATA_UPDATE_COMPLETED,lt,D),j.off(E.Z.LOADING_PROGRESS,pn,D),j.off(E.Z.MANIFEST_UPDATED,bt,D),j.off(E.Z.STREAMS_COMPOSED,we,D),j.off(T.Z.PLAYBACK_ENDED,xt,D),j.off(T.Z.STREAM_INITIALIZING,ot,D),j.off(T.Z.REPRESENTATION_SWITCH,$e,D),j.off(T.Z.BUFFER_LEVEL_STATE_CHANGED,Ct,D),Nt(),k.removeEventListener("canplay",Bt),k.removeEventListener("canplaythrough",Ft),k.removeEventListener("play",vn),k.removeEventListener("waiting",yn),k.removeEventListener("playing",Fn),k.removeEventListener("pause",Zn),k.removeEventListener("error",an),k.removeEventListener("seeking",st),k.removeEventListener("seeked",Mt),k.removeEventListener("timeupdate",Tt),k.removeEventListener("progress",jt),k.removeEventListener("ratechange",en),k.removeEventListener("loadedmetadata",_n),k.removeEventListener("loadeddata",En),k.removeEventListener("stalled",Tn),k.removeEventListener("ended",An),k.removeEventListener("volumechange",Ln)),re=null,k=null,z=null,oe=null}function ve(){var Ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return parseFloat((Ce(Ue)-je()).toFixed(5))}function Ce(Ue){var ft=Ue||z;return ft.start+ft.duration}function Ee(){var Ue=arguments.length>0&&arguments[0]!==void 0&&arguments[0];z&&k&&k.getElement()?(Ue&&oe&&We(je()),k.play()):se=!0}function ae(){z&&k&&k.pause()}function Se(Ue){var ft=arguments.length>1&&arguments[1]!==void 0&&arguments[1],zt=arguments.length>2&&arguments[2]!==void 0&&arguments[2],tn=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(z&&k&&k.getElement()){var Hn=isNaN(Re)?k.getTime():Re;Ue!==Hn&&((ue=zt===!0)||(Re=Ue),C.info("Requesting seek to time: "+Ue+(ue?" (internal)":"")),oe&&tn&&We(Ue),k.setCurrentTime(Ue,ft))}}function Pe(){if(z&&k&&oe){var Ue=x&&x.hasVideoTrack()?u.Z.VIDEO:u.Z.AUDIO,ft=q.getCurrentDVRInfo(Ue);return ft&&ft.range?ft.range.end:0}}function We(Ue){var ft=new Date(K.getClientReferenceTime()),zt=Y.getRegularPeriods()[0],tn=K.calcPresentationTimeFromWallTime(ft,zt);ge=tn-Ue}function je(){return z&&k?k.getTime():null}function Xe(){return z&&k?k.isPaused():null}function ze(){return z&&k?k.isSeeking():null}function St(){return z&&k?k.isStalled():null}function At(){return z&&k?k.getPlaybackRate():null}function pt(){return z&&k?k.getEnded():null}function yt(){return oe}function un(){var Ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!Xe()&&oe&&k.getReadyState()!==0&&!ze()&&!P){Ue||(Ue=x.hasVideoTrack()?u.Z.VIDEO:u.Z.AUDIO);var ft=je(),zt=Ve(ft,Ue),tn=!isNaN(zt)&&zt!==ft;tn&&!ze()&&(St()||xe||k.getReadyState()===1)&&(C.debug("UpdateCurrentTime: Seek to actual time: ".concat(zt," from currentTime: ").concat(ft)),Se(zt,!1,!1))}}function Ve(Ue,ft){var zt=q.getCurrentDVRInfo(ft),tn=zt?zt.range:null;return tn?Ue>tn.end?Math.max(tn.end-ge,tn.start):Ue>0&&Ue+.25<tn.start&&Math.abs(Ue-tn.start)<31536e4?le?Math.max(tn.end-ge,tn.start):tn.start:Ue:NaN}function tt(){re===null&&(re=setInterval((function(){(function(){if(j.trigger(E.Z.WALLCLOCK_TIME_UPDATED,{isDynamic:oe,time:new Date}),yt()){var Ue=Date.now();(isNaN(be)||Ue>be+J.get().streaming.liveUpdateTimeThresholdInMilliseconds)&&(x.addDVRMetric(),Xe()?(function(){var ft=Date.now();(!Ne||ft>Ne+500)&&(Ne=ft,Tt())})():un(),be=Ue)}})()}),J.get().streaming.wallclockTimeUpdateInterval))}function Nt(){clearInterval(re),re=null}function lt(Ue){var ft=Y.convertRepresentationToRepresentationInfo(Ue.currentRepresentation),zt=ft?ft.mediaInfo.streamInfo:null;zt!==null&&z.id===zt.id&&(z=zt)}function Bt(){j.trigger(E.Z.CAN_PLAY)}function Ft(){j.trigger(E.Z.CAN_PLAY_THROUGH)}function Ct(Ue){Ue.streamId===x.getActiveStreamInfo().id&&(xe=Ue.state===S.Z.BUFFER_EMPTY,J.get().streaming.buffer.setStallState&&k.setStallState(Ue.mediaType,Ue.state===S.Z.BUFFER_EMPTY))}function vn(){C.info("Native video element event: play"),un(),tt(),j.trigger(E.Z.PLAYBACK_STARTED,{startTime:je()})}function yn(){C.info("Native video element event: waiting"),j.trigger(E.Z.PLAYBACK_WAITING,{playingTime:je()})}function Fn(){C.info("Native video element event: playing"),ue=!1,j.trigger(E.Z.PLAYBACK_PLAYING,{playingTime:je()})}function Zn(){C.info("Native video element event: pause"),j.trigger(E.Z.PLAYBACK_PAUSED,{ended:pt()})}function st(){if(!ue){var Ue=je();isNaN(Re)||Re===Ue||(Ue=Re),Re=NaN,C.info("Seeking to: "+Ue),tt(),j.trigger(E.Z.PLAYBACK_SEEKING,{seekTime:Ue,streamId:z.id})}}function Mt(){C.info("Native video element event: seeked"),ue=!1,j.trigger(E.Z.PLAYBACK_SEEKED)}function Tt(){z&&j.trigger(E.Z.PLAYBACK_TIME_UPDATED,{timeToEnd:ve(),time:je(),streamId:z.id})}function jt(){j.trigger(E.Z.PLAYBACK_PROGRESS,{streamId:z.id})}function en(){var Ue=At();C.info("Native video element event: ratechange: ",Ue),j.trigger(E.Z.PLAYBACK_RATE_CHANGED,{playbackRate:Ue})}function _n(){C.info("Native video element event: loadedmetadata"),j.trigger(E.Z.PLAYBACK_METADATA_LOADED),tt()}function En(){C.info("Native video element event: loadeddata"),j.trigger(E.Z.PLAYBACK_LOADED_DATA)}function An(){C.info("Native video element event: ended"),ae(),Nt();var Ue=x?x.getActiveStreamInfo():null;Ue&&j.trigger(E.Z.PLAYBACK_ENDED,{isLast:Ue.isLast})}function Ln(){j.trigger(E.Z.PLAYBACK_VOLUME_CHANGED)}function xt(Ue){if(re&&Ue.isLast){C.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var ft=Ue.seekTime?Ue.seekTime:Ce();k.setCurrentTime(ft),ae(),Nt()}}function an(Ue){var ft=Ue.target||Ue.srcElement;j.trigger(E.Z.PLAYBACK_ERROR,{error:ft.error})}function mn(){oe=!1}function pn(Ue){if(Ue.stream===!1&&le&&!isNaN(Ue.request.duration)){var ft=1.2*Ue.request.duration;ft>ge&&(C.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",ft.toFixed(2)),ge=ft,ie=ft)}}function Tn(Ue){j.trigger(E.Z.PLAYBACK_STALLED,{e:Ue})}function ot(Ue){var ft;(ft=Ue.mediaInfo)&&ft.supplementalProperties&&ft.supplementalProperties[u.Z.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME]&&ft.supplementalProperties[u.Z.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME].value==="true"&&(C.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),le=!0)}function $e(Ue){var ft=x.getActiveStreamInfo();Ue&&ft&&Ue.currentRepresentation&&Ue.streamId&&Ue.streamId===ft.id&&Ue.mediaType&&(Ue.mediaType===u.Z.VIDEO||Ue.mediaType===u.Z.AUDIO)&&(Me=Ue.currentRepresentation.availabilityTimeComplete,(le=!Me)&&!te&&(te=!0))}function bt(){P=!0}function we(){P=!1}return D={initialize:function(Ue,ft){z=Ue,ft!==!0&&(k.addEventListener("canplay",Bt),k.addEventListener("canplaythrough",Ft),k.addEventListener("play",vn),k.addEventListener("waiting",yn),k.addEventListener("playing",Fn),k.addEventListener("pause",Zn),k.addEventListener("error",an),k.addEventListener("seeking",st),k.addEventListener("seeked",Mt),k.addEventListener("timeupdate",Tt),k.addEventListener("progress",jt),k.addEventListener("ratechange",en),k.addEventListener("loadedmetadata",_n),k.addEventListener("loadeddata",En),k.addEventListener("stalled",Tn),k.addEventListener("ended",An),k.addEventListener("volumechange",Ln),oe=z.manifestInfo.isDynamic,xe=!1,ue=!1,j.on(E.Z.DATA_UPDATE_COMPLETED,lt,D),j.on(E.Z.LOADING_PROGRESS,pn,D),j.on(E.Z.MANIFEST_UPDATED,bt,D),j.on(E.Z.STREAMS_COMPOSED,we,D),j.on(T.Z.PLAYBACK_ENDED,xt,D,{priority:_.Z.EVENT_PRIORITY_HIGH}),j.on(T.Z.STREAM_INITIALIZING,ot,D),j.on(T.Z.REPRESENTATION_SWITCH,$e,D),j.on(T.Z.BUFFER_LEVEL_STATE_CHANGED,Ct,D),j.on(T.Z.DYNAMIC_TO_STATIC,mn,D),se&&(se=!1,Ee()))},setConfig:function(Ue){Ue&&(Ue.streamController&&(x=Ue.streamController),Ue.serviceDescriptionController&&(B=Ue.serviceDescriptionController),Ue.dashMetrics&&(q=Ue.dashMetrics),Ue.adapter&&(Y=Ue.adapter),Ue.videoModel&&(k=Ue.videoModel),Ue.timelineConverter&&(K=Ue.timelineConverter),Ue.settings&&(J=Ue.settings))},getTimeToStreamEnd:ve,getBufferLevel:function(){var Ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,ft=null;return x.getActiveStreamProcessors().forEach((function(zt){if(!Ue||Ue.length===0||Ue.indexOf(zt.getType())===-1){var tn=zt.getBufferLevel();ft=ft===null?tn:Math.min(ft,tn)}})),ft},getPlaybackStalled:function(){return xe},getTime:je,getLowLatencyModeEnabled:function(){return le},getInitialCatchupModeActivated:function(){return te},getIsManifestUpdateInProgress:function(){return P},getPlaybackRate:At,getPlayedRanges:function(){return z&&k?k.getPlayedRanges():null},getEnded:pt,getIsDynamic:yt,getStreamController:function(){return x},computeAndSetLiveDelay:function(Ue,ft){var zt,tn,Hn,cr=!isNaN(Ue)&&isFinite(Ue)?Ue:NaN,$r=Y.getSuggestedPresentationDelay(),fr=B.getServiceDescriptionSettings();return zt=isNaN(J.get().streaming.delay.liveDelay)?J.get().streaming.delay.liveDelayFragmentCount===null||isNaN(J.get().streaming.delay.liveDelayFragmentCount)||isNaN(cr)?fr&&!isNaN(fr.liveDelay)&&fr.liveDelay>0?fr.liveDelay:J.get().streaming.delay.useSuggestedPresentationDelay===!0&&$r!==null&&!isNaN($r)&&$r>0?$r:isNaN(cr)?ft&&!isNaN(ft.minBufferTime)?4*ft.minBufferTime:4*z.manifestInfo.minBufferTime:4*cr:cr*J.get().streaming.delay.liveDelayFragmentCount:J.get().streaming.delay.liveDelay,(Hn=Y.getAvailabilityStartTime())!==null&&(Le=Hn),tn=ft&&ft.dvrWindowSize>0?Math.min(zt,ft.dvrWindowSize):zt,ge=tn,ie=tn,tn},getLiveDelay:function(){return ge},getOriginalLiveDelay:function(){return ie},getCurrentLiveLatency:function(){if(!oe||isNaN(Le))return NaN;var Ue=je();if(isNaN(Ue)||Ue===0)return 0;var ft=new Date().getTime()+1e3*K.getClientTimeOffset();return Math.max(((ft-Le-1e3*Ue)/1e3).toFixed(3),0)},play:Ee,isPaused:Xe,isStalled:St,pause:ae,isSeeking:ze,getStreamEndTime:Ce,seek:Se,seekToOriginalLive:function(){var Ue=arguments.length>0&&arguments[0]!==void 0&&arguments[0],ft=arguments.length>1&&arguments[1]!==void 0&&arguments[1],zt=arguments.length>2&&arguments[2]!==void 0&&arguments[2],tn=Pe();if(tn!==0){var Hn=tn-(ge=ie);Se(Hn,Ue,ft,zt)}},seekToCurrentLive:function(){var Ue=arguments.length>0&&arguments[0]!==void 0&&arguments[0],ft=arguments.length>1&&arguments[1]!==void 0&&arguments[1],zt=arguments.length>2&&arguments[2]!==void 0&&arguments[2],tn=Pe();if(tn!==0){var Hn=tn-ge;Se(Hn,Ue,ft,zt)}},reset:Ae,updateCurrentTime:un,getAvailabilityStartTime:function(){return Le}},C=(0,I.Z)(Q).getInstance().getLogger(D),Ae(),D}A.__dashjs_factory_name="PlaybackController";var R=b.Z.getSingletonFactory(A),O=g(3186),H="loading",U="executed",Z="failed";function $(D){var C,x,B,q,Y=(D=D||{}).eventBus,k=D.events,K=D.dashMetrics,re=D.fragmentLoader,ge=D.debug,ie=D.streamInfo,z=D.type;function oe(P){var te;return!!P&&(te=!1,B.some((function(J){if(Q=P,j=J,!isNaN(Q.index)&&Q.startTime===j.startTime&&Q.adaptationIndex===j.adaptationIndex&&Q.type===j.type||(function(Ae,ve){return isNaN(Ae.index)&&isNaN(ve.index)&&Ae.quality===ve.quality})(P,J)||(function(Ae,ve){return Ae.action===O.Z.ACTION_COMPLETE&&Ae.action===ve.action})(P,J))return te=!0;var Q,j})),te)}function se(P){return isNaN(P.duration)?.25:Math.min(P.duration/8,.5)}function Ne(P){B=B.filter((function(te){var J=se(te);return isNaN(te.startTime)||P!==void 0&&te.startTime>=P-J}))}function be(P,te){te<=P+.5||(B=B.filter((function(J){var Q=se(J);return isNaN(J.startTime)||J.startTime>=te-Q||isNaN(J.duration)||J.startTime+J.duration<=P+Q})))}function Le(P,te,J){for(var Q=P.length-1;Q>=0;Q--){var j=P[Q],Ae=j.startTime,ve=Ae+j.duration;if(J=isNaN(J)?se(j):J,!isNaN(Ae)&&!isNaN(ve)&&te+J>=Ae&&te-J<ve||isNaN(Ae)&&isNaN(te))return j}return null}function Me(P,te){K.addSchedulingInfo(P,te),K.addRequestsQueue(P.mediaType,q,B)}function le(P){P.sender===re&&(q.splice(q.indexOf(P.request),1),P.response&&!P.error&&B.push(P.request),Me(P.request,P.error?Z:U),Y.trigger(k.FRAGMENT_LOADING_COMPLETED,{request:P.request,response:P.response,error:P.error,sender:this},{streamId:ie.id,mediaType:z}))}function Re(P){P.sender===re&&Y.trigger(k.FRAGMENT_LOADING_PROGRESS,{request:P.request,response:P.response,error:P.error,sender:this},{streamId:ie.id,mediaType:z})}function ue(P){P.sender===re&&Y.trigger(k.FRAGMENT_LOADING_ABANDONED,{request:P.request},{streamId:ie.id,mediaType:z})}function xe(){B=[],q=[]}return C={getStreamId:function(){return ie.id},getType:function(){return z},getRequests:function(P){var te=P?P.state instanceof Array?P.state:[P.state]:[],J=[];return te.forEach((function(Q){var j=(function(Ae){var ve;switch(Ae){case H:ve=q;break;case U:ve=B;break;default:ve=[]}return ve})(Q);J=J.concat((function(Ae,ve){return ve.hasOwnProperty("time")?[Le(Ae,ve.time,ve.threshold)]:Ae.filter((function(Ce){for(var Ee in ve)if(Ee!=="state"&&ve.hasOwnProperty(Ee)&&Ce[Ee]!=ve[Ee])return!1;return!0}))})(j,P))})),J},isFragmentLoaded:oe,isFragmentLoadedOrPending:function(P){var te,J=!1,Q=0;if(!(J=oe(P)))for(Q=0;Q<q.length;Q++)te=q[Q],P.url===te.url&&P.startTime===te.startTime&&(J=!0);return J},removeExecutedRequestsBeforeTime:Ne,removeExecutedRequestsAfterTime:function(P){B=B.filter((function(te){return isNaN(te.startTime)||P!==void 0&&te.startTime<P}))},syncExecutedRequestsWithBufferedRange:function(P,te){if(P&&P.length!==0){for(var J=0,Q=0,j=P.length;Q<j;Q++)be(J,P.start(Q)),J=P.end(Q);te>0&&be(J,te)}else Ne()},abortRequests:function(){x.debug("abort requests"),re.abort(),q=[]},executeRequest:function(P){P.action===O.Z.ACTION_DOWNLOAD?(Me(P,H),q.push(P),(function(te){Y.trigger(k.FRAGMENT_LOADING_STARTED,{request:te},{streamId:ie.id,mediaType:z}),re.load(te)})(P)):x.warn("Unknown request action.")},reset:function(){Y.off(k.LOADING_COMPLETED,le,this),Y.off(k.LOADING_DATA_PROGRESS,Re,this),Y.off(k.LOADING_ABANDONED,ue,this),re&&re.reset(),xe()},resetInitialSettings:xe,addExecutedRequest:function(P){B.push(P)}},x=ge.getLogger(C),xe(),Y.on(k.LOADING_COMPLETED,le,C),Y.on(k.LOADING_DATA_PROGRESS,Re,C),Y.on(k.LOADING_ABANDONED,ue,C),C}$.__dashjs_factory_name="FragmentModel";var F=b.Z.getClassFactory($);F.FRAGMENT_MODEL_LOADING=H,F.FRAGMENT_MODEL_EXECUTED=U,F.FRAGMENT_MODEL_CANCELED="canceled",F.FRAGMENT_MODEL_FAILED=Z,b.Z.updateClassFactory($.__dashjs_factory_name,F);var W=F,fe=g(5459);function ne(D){return ne=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},ne(D)}function de(D,C){return de=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},de(D,C)}function Te(D,C){return!C||ne(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function me(D){return me=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},me(D)}var X=new((function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&de(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=me(C);if(x){var K=me(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return Te(this,Y)});function q(){var Y;return(function(k,K){if(!(k instanceof K))throw new TypeError("Cannot call a class as a function")})(this,q),(Y=B.call(this)).MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,Y.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,Y.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,Y.SEGMENT_BASE_LOADER_ERROR_CODE=15,Y.TIME_SYNC_FAILED_ERROR_CODE=16,Y.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,Y.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,Y.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,Y.APPEND_ERROR_CODE=20,Y.REMOVE_ERROR_CODE=21,Y.DATA_UPDATE_FAILED_ERROR_CODE=22,Y.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,Y.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,Y.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,Y.DOWNLOAD_ERROR_ID_SIDX_CODE=26,Y.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,Y.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,Y.DOWNLOAD_ERROR_ID_XLINK_CODE=29,Y.MANIFEST_ERROR_ID_PARSE_CODE=31,Y.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,Y.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,Y.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,Y.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,Y.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",Y.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",Y.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",Y.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",Y.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",Y.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",Y.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",Y.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",Y.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",Y.APPEND_ERROR_MESSAGE="chunk is not defined",Y.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",Y.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",Y.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",Y.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",Y.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",Y.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",Y}return q})(g(2230).Z)),Ie=g(1264),Be=g(7855);function qe(D){var C,x,B,q,Y,k,K=this.context,re=(0,Ie.Z)(K).getInstance(),ge=D.textController,ie=D.eventBus,z=[],oe=[],se=!1,Ne=D.mediaSource,be=null;function Le(j){return new Promise((function(Ae){Q((function(){q.changeType&&q.changeType(j),Ae()}))}))}function Me(j){return q=ge.getTextSourceBuffer(j),Promise.resolve()}function le(){if(typeof q.addEventListener=="function")try{q.addEventListener("updateend",te,!1),q.addEventListener("error",J,!1),q.addEventListener("abort",J,!1)}catch{k=setInterval(te,50)}else k=setInterval(te,50)}function Re(j){return new Promise((function(Ae){q&&re.get().streaming.buffer.useAppendWindow?Q((function(){try{if(!q)return void Ae();var ve=Ne.duration,Ce=0;j&&!isNaN(j.start)&&!isNaN(j.duration)&&isFinite(j.duration)&&(ve=j.start+j.duration),j&&!isNaN(j.start)&&(Ce=j.start),q.appendWindowEnd===ve&&q.appendWindowStart===Ce||(q.appendWindowStart=0,q.appendWindowEnd=ve+.01,q.appendWindowStart=Math.max(Ce-.1,0),B.debug("Updated append window for ".concat(Y.type,". Set start to ").concat(q.appendWindowStart," and end to ").concat(q.appendWindowEnd))),Ae()}catch{B.warn("Failed to set append window"),Ae()}})):Ae()}))}function ue(j){return new Promise((function(Ae){q?Q((function(){try{q.timestampOffset===j||isNaN(j)||(q.timestampOffset=j,B.debug("Set MSE timestamp offset to ".concat(j))),Ae()}catch{Ae()}})):Ae()}))}function xe(){if(!se&&oe.length>0){se=!0;var j=oe[0];oe.splice(0,1);var Ae=function(){se=!1,oe.length>0&&xe.call(this),j&&j.data&&j.data.segmentType&&j.data.segmentType!==Be.w.INIT_SEGMENT_TYPE&&delete j.data.bytes,j.promise.resolve({chunk:j.data})};try{be=j.request,j.data.bytes.byteLength===0?Ae.call(this):(q.appendBuffer?q.appendBuffer(j.data.bytes):q.append(j.data.bytes,j.data),Q(Ae.bind(this)))}catch(ve){B.fatal('SourceBuffer append failed "'+ve+'"'),oe.length>0?xe():se=!1,delete j.data.bytes,j.promise.reject({chunk:j.data,error:new fe.Z(ve.code,ve.message)})}}}function P(){z.length>0&&(q.updating||(z.shift()(),P()))}function te(){q.updating||P()}function J(j){var Ae,ve,Ce=j.target||{};Ae=E.Z.SOURCE_BUFFER_ERROR,ve={error:Ce,lastRequestAppended:be},ie.trigger(Ae,ve,{streamId:Y.streamInfo.id,mediaType:x})}function Q(j){z.push(j),q.updating||P()}return C={getType:function(){return x},getAllBufferRanges:function(){try{return q.buffered}catch(j){return B.error("getAllBufferRanges exception: "+j.message),null}},getBuffer:function(){return q},append:function(j){var Ae=this,ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new Promise((function(Ce,Ee){j?(oe.push({data:j,promise:{resolve:Ce,reject:Ee},request:ve}),Q(xe.bind(Ae))):Ee({chunk:j,error:new fe.Z(X.APPEND_ERROR_CODE,X.APPEND_ERROR_MESSAGE)})}))},remove:function(j){return new Promise((function(Ae,ve){var Ce=j.start,Ee=j.end;Ce>=0&&Ee>Ce?Q((function(){try{q.remove(Ce,Ee),Q((function(){Ae({from:Ce,to:Ee,unintended:!1}),j.resolve&&j.resolve()}))}catch(ae){ve({from:Ce,to:Ee,unintended:!1,error:new fe.Z(X.REMOVE_ERROR_CODE,X.REMOVE_ERROR_MESSAGE)}),j.reject&&j.reject(ae)}})):Ae()}))},abort:function(){return new Promise((function(j){try{oe=[],Ne.readyState==="open"?Q((function(){try{q&&q.abort(),j()}catch{j()}})):(q&&q.setTextTrack&&Ne.readyState==="ended"&&q.abort(),j())}catch{j()}}))},reset:function(){if(q){try{z=[],(function(){try{typeof q.removeEventListener=="function"&&(q.removeEventListener("updateend",te,!1),q.removeEventListener("error",J,!1),q.removeEventListener("abort",J,!1)),clearInterval(k)}catch(j){B.error(j)}})(),se=!1,oe=[],q.getClassName&&q.getClassName()==="TextSourceBuffer"||(B.debug("Removing sourcebuffer from media source"),Ne.removeSourceBuffer(q))}catch{}q=null}be=null},updateTimestampOffset:ue,initializeForStreamSwitch:function(j,Ae,ve){x=(Y=j).type;var Ce=Y.codec;(function(ae){q=ae.getBuffer()})(ve),le();var Ee=[];return Ee.push(new Promise((function(ae){Q((function(){var Se=q.appendWindowStart,Pe=q.appendWindowEnd;q&&(q.abort(),q.appendWindowStart=Se,q.appendWindowEnd=Pe),ae()}))}))),Ee.push(Re(Y.streamInfo)),re.get().streaming.buffer.useChangeTypeForTrackSwitch&&Ee.push(Le(Ce)),Ae&&Ae.MSETimeOffset!==void 0&&Ee.push(ue(Ae.MSETimeOffset)),Promise.all(Ee)},initializeForFirstUse:function(j,Ae,ve){x=(Y=Ae).type;var Ce=Y.codec;try{if(Ce.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return Me(j);q=Ne.addSourceBuffer(Ce),le();var Ee=[];return Ee.push(Re(Y.streamInfo)),ve&&ve.MSETimeOffset!==void 0&&Ee.push(ue(ve.MSETimeOffset)),Promise.all(Ee)}catch(ae){return Y.type==u.Z.TEXT&&!Y.isFragmented||Ce.indexOf('codecs="stpp')!==-1||Ce.indexOf('codecs="vtt')!==-1||Ce.indexOf("text/vtt")!==-1?Me(j):Promise.reject(ae)}},updateAppendWindow:Re,changeType:Le},B=(0,I.Z)(K).getInstance().getLogger(C),C}qe.__dashjs_factory_name="SourceBufferSink";var ee=b.Z.getClassFactory(qe);function _e(D){var C,x,B,q=this.context,Y=[],k=D;function K(re,ge){return Y=Y.filter((function(ie){return!((isNaN(ge)||ie.start<ge)&&(isNaN(re)||ie.end>re))})),Promise.resolve()}return C={getAllBufferRanges:function(){for(var re=[],ge=0;ge<Y.length;ge++){var ie=Y[ge];re.length===0||ie.start>re[re.length-1].end?re.push({start:ie.start,end:ie.end}):re[re.length-1].end=ie.end}var z={start:function(oe){return re[oe].start},end:function(oe){return re[oe].end}};return Object.defineProperty(z,"length",{get:function(){return re.length}}),z},append:function(re){return re.segmentType!=="InitializationSegment"?(Y.push(re),Y.sort((function(ge,ie){return ge.start-ie.start})),B=null):B=re,x.debug("PreBufferSink appended chunk s: "+re.start+"; e: "+re.end),k&&k({chunk:re}),Promise.resolve()},remove:K,abort:function(){return Promise.resolve()},discharge:function(re,ge){var ie=(function(z,oe){return Y.filter((function(se){return(isNaN(oe)||se.start<oe)&&(isNaN(z)||se.end>z)}))})(re,ge);return B&&(ie.push(B),B=null),K(re,ge),ie},reset:function(){Y=[],B=null,k=null},updateTimestampOffset:function(){return Promise.resolve()},waitForUpdateEnd:function(re){re()},getBuffer:function(){return this}},x=(0,I.Z)(q).getInstance().getLogger(C),C}_e.__dashjs_factory_name="PreBufferSink";var Ze=b.Z.getClassFactory(_e);function Ke(){var D={};return{save:function(C){var x=C.streamId,B=C.representationId;D[x]=D[x]||{},D[x][B]=C},extract:function(C,x){return D&&D[C]&&D[C][x]?D[C][x]:null},reset:function(){D={}}}}Ke.__dashjs_factory_name="InitCache";var De=b.Z.getSingletonFactory(Ke),Ge=.01,Et="BufferController";function vt(D){D=D||{};var C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le,Me,le,Re,ue,xe,P=this.context,te=(0,_.Z)(P).getInstance(),J=D.errHandler,Q=D.fragmentModel,j=D.representationController,Ae=D.adapter,ve=D.textController,Ce=D.abrController,Ee=D.playbackController,ae=D.streamInfo,Se=D.type,Pe=D.settings;function We($e){var bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new Promise((function(we,Ue){k=$e,ge&&bt&&typeof ge.discharge=="function"?(ie=ge,Xe(bt).then((function(){we()})).catch((function(ft){Ue(ft)}))):we()}))}function je($e){return Ae.convertRepresentationToRepresentationInfo(j.getRepresentationForQuality($e))}function Xe($e){var bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return new Promise((function(we,Ue){le&&$e?k?(z=!1,St($e,bt).then((function(ft){we(ft)})).catch((function(ft){Ue(ft)}))):(z=!0,ze().then((function(ft){we(ft)})).catch((function(ft){Ue(ft)}))):we(null)}))}function ze(){var $e=this;return new Promise((function(bt,we){var Ue=Ce.getQualityFor(Se,ae.id);ge=Ze(P).create(Ve.bind($e)),_n(je(Ue)).then((function(){bt(ge)})).catch((function(){we()}))}))}function St($e,bt){return new Promise((function(we,Ue){var ft=Ce.getQualityFor(Se,ae.id);ge=ee(P).create({mediaSource:k,textController:ve,eventBus:te}),(function(zt,tn,Hn){var cr=je(Hn);return tn&&tn[Se]&&(Se===u.Z.VIDEO||Se===u.Z.AUDIO)?ge.initializeForStreamSwitch(zt,cr,tn[Se]):ge.initializeForFirstUse(ae,zt,cr)})($e,bt,ft).then((function(){return _n(je(ft))})).then((function(){we(ge)})).catch((function(zt){x.fatal("Caught error on create SourceBuffer: "+zt),J.error(new fe.Z(X.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,X.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+Se)),Ue(zt)}))}))}function At($e){Pe.get().streaming.cacheInitSegments&&(x.info("Init fragment finished loading saving to",Se+"'s init cache"),le.save($e.chunk)),x.debug("Append Init fragment",Se," with representationId:",$e.chunk.representationId," and quality:",$e.chunk.quality,", data size:",$e.chunk.bytes.byteLength),yt($e.chunk)}function pt($e){yt($e.chunk,$e.request)}function yt($e){var bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;ge&&(ge.append($e,bt).then((function(we){Ve(we)})).catch((function(we){Ve(we)})),$e.mediaInfo.type===u.Z.VIDEO&&Tn(E.Z.VIDEO_CHUNK_RECEIVED,{chunk:$e}))}function un($e){if($e&&$e.length>0)for(var bt=0,we=$e.length;bt<we;bt++)x.debug("Buffered range: "+$e.start(bt)+" - "+$e.end(bt)+", currentTime = ",Ee.getTime())}function Ve($e){if($e.error)return $e.error.code===22&&(function(){if(Me=!0,Y=.8*an(),x.warn("Quota exceeded, Critical Buffer: "+Y),Y>0){var Ue=Math.max(.2*Y,1),ft=Y-Ue,zt=Math.min(Pe.get().streaming.buffer.bufferTimeAtTopQuality,.9*ft),tn=Math.min(Pe.get().streaming.buffer.bufferTimeAtTopQualityLongForm,.9*ft),Hn={streaming:{buffer:{bufferToKeep:parseFloat(Ue.toFixed(5)),bufferTimeAtTopQuality:parseFloat(zt.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(tn.toFixed(5))}}};Pe.update(Hn)}})(),void($e.error.code!==22&&pn()||(x.warn("Clearing playback buffer to overcome quota exceed situation"),Tn(E.Z.QUOTA_EXCEEDED,{criticalBufferLevel:Y,quotaExceededTime:$e.chunk.start}),Tt(Mt())));if(ge&&(vn(),Me=!1,(Ne=$e.chunk)&&Ne.endFragment)){Ne&&!isNaN(Ne.index)&&(K=Math.max(Ne.index,K),yn());var bt=ge.getAllBufferRanges();Ne.segmentType===Be.w.MEDIA_SEGMENT_TYPE&&(un(bt),lt(),(function(){if(!isNaN(xe)&&!z)if(Se===u.Z.AUDIO||Se===u.Z.VIDEO){var Ue=Ee.getTime(),ft=Ct(Ue,0),zt=Ct(xe,0);if(ft&&zt&&ft.start===zt.start)xe=NaN;else{var tn=j.getCurrentRepresentation().segmentDuration,Hn=Ct(xe,tn);Hn&&(Pe.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(Ue-xe)>tn?xe<=Hn.end&&Ee.seek(Math.max(xe,Hn.start),!1,!0):Ue<Hn.start&&Ee.seek(Hn.start,!1,!0))}}else xe=NaN})());var we=!1;oe&&(oe.indexOf(Ne)>0&&(we=!0),oe=null),Ne&&!we&&Tn(E.Z.BYTES_APPENDED_END_FRAGMENT,{quality:Ne.quality,startTime:Ne.start,index:Ne.index,bufferedRanges:bt,segmentType:Ne.segmentType,mediaType:Se})}}function tt(){return new Promise((function($e,bt){var we=Nt();if(!we||we.length===0)return lt(),void $e();Tt(we).then((function(){$e()})).catch((function(Ue){bt(Ue)}))}))}function Nt($e){var bt=[],we=ge.getAllBufferRanges();if(!we||we.length===0)return bt;if(!$e&&$e!==0||isNaN($e))bt.push({start:we.start(0),end:we.end(we.length-1)+.5});else{var Ue=(function(zt,tn){var Hn=Pe.get().streaming.buffer.bufferToKeep,cr=tn.start(0);if(zt-cr>Hn){var $r=Math.max(0,zt-Hn),fr=Q.getRequests({state:W.FRAGMENT_MODEL_EXECUTED,time:zt,threshold:Ge})[0];if(fr&&($r=Math.min(fr.startTime,$r)),$r>0)return{start:cr,end:$r}}return null})($e,we),ft=(function(zt,tn){var Hn=tn.end(tn.length-1)+.5,cr=mn(zt),$r=ae.manifestInfo.duration>=Pe.get().streaming.buffer.longFormContentDurationThreshold?Pe.get().streaming.buffer.bufferTimeAtTopQualityLongForm:Pe.get().streaming.buffer.bufferTimeAtTopQuality,fr=isNaN(cr)?zt:Math.min(cr,zt+$r);if(fr>=tn.end(tn.length-1))return null;var Ri=Q.getRequests({state:W.FRAGMENT_MODEL_EXECUTED,time:zt,threshold:Ge})[0];if(Ri&&(fr=Math.max(Ri.startTime+Ri.duration,fr)),Pe.get().streaming.buffer.avoidCurrentTimeRangePruning){for(var ei=0;ei<tn.length;ei++)if(tn.start(ei)<=zt&&zt<=tn.end(ei)&&tn.start(ei)<=fr&&fr<=tn.end(ei)){var ea=fr;fr=ei+1<tn.length?tn.start(ei+1):tn.end(ei)+1,x.debug("Buffered range ["+tn.start(ei)+", "+tn.end(ei)+"] overlaps with targetTime "+zt+" and range to be pruned ["+ea+", "+Hn+"], using ["+fr+", "+Hn+"] instead"+(fr<Hn?"":" (no actual pruning)"));break}}return fr<tn.end(tn.length-1)?{start:fr,end:Hn}:null})($e,we);Ue&&bt.push(Ue),ft&&bt.push(ft)}return bt}function lt(){(!ue||Se===u.Z.TEXT&&ve.isTextEnabled())&&vn()}function Bt(){Fn()}function Ft(){Fn(),xe=NaN}function Ct($e,bt){if(!ge)return null;var we,Ue,ft=ge.getAllBufferRanges(),zt=0,tn=0,Hn=null,cr=null,$r=0,fr=isNaN(bt)?.15:bt;if(ft!=null){for(Ue=0,we=ft.length;Ue<we;Ue++)if(zt=ft.start(Ue),tn=ft.end(Ue),Hn===null)$r=Math.abs(zt-$e),($e>=zt&&$e<tn||$r<=fr)&&(Hn=zt,cr=tn);else{if(!(($r=zt-cr)<=fr))break;cr=tn}if(Hn!==null)return{start:Hn,end:cr}}return null}function vn(){if(Ee){var $e=Ee.getTime()||0;z&&($e=isNaN(xe)?0:xe);var bt=Pe.get().streaming.gaps.jumpGaps&&!isNaN(Pe.get().streaming.gaps.smallGapLimit)?Pe.get().streaming.gaps.smallGapLimit:NaN;q=Math.max((function(we,Ue){var ft;return Pe.get().streaming.gaps.jumpGaps&&(Ue=Pe.get().streaming.gaps.smallGapLimit),(ft=Ct(we,Ue))===null?0:ft.end-we})($e,bt),0),Tn(E.Z.BUFFER_LEVEL_UPDATED,{mediaType:Se,bufferLevel:q}),Fn()}}function yn(){var $e=K>=re-1,bt=Ee.getTimeToStreamEnd(ae)-q<1e-5;!$e&&!bt||B||(xt(!0),x.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(ae.id," and type ").concat(Se)))}function Fn(){Se!==u.Z.AUDIO&&Se!==u.Z.VIDEO||((!Ee.getLowLatencyModeEnabled()&&q<Pe.get().streaming.buffer.stallThreshold||q===0)&&!B?Zn(S.Z.BUFFER_EMPTY):(B||q>=Pe.get().streaming.buffer.stallThreshold||Ee.getLowLatencyModeEnabled()&&q>0)&&Zn(S.Z.BUFFER_LOADED))}function Zn($e){se===$e||$e===S.Z.BUFFER_EMPTY&&Ee.getTime()===0||Se===u.Z.TEXT&&!ve.isTextEnabled()||(se=$e,Tn(E.Z.BUFFER_LEVEL_STATE_CHANGED,{state:$e}),Tn($e===S.Z.BUFFER_LOADED?E.Z.BUFFER_LOADED:E.Z.BUFFER_EMPTY),x.debug($e===S.Z.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function st(){ge&&Se!==u.Z.TEXT&&(B||Tt(Mt()))}function Mt(){var $e=[],bt=ge.getAllBufferRanges();if(!bt||bt.length===0)return $e;var we=Ee.getTime(),Ue=Math.max(0,we-Pe.get().streaming.buffer.bufferToKeep),ft=Q.getRequests({state:W.FRAGMENT_MODEL_EXECUTED,time:we,threshold:Ge})[0];if(ft)Ue=Math.min(ft.startTime,Ue);else if(we===0&&Ee.getIsDynamic())return[];if(bt.start(0)<=Ue){for(var zt={start:0,end:Ue},tn=0;tn<bt.length&&bt.end(tn)<=Ue;tn++)zt.end=bt.end(tn);zt.start<zt.end&&$e.push(zt)}return $e}function Tt($e){return new Promise((function(bt,we){if($e&&ge&&$e.length!==0){var Ue=[];$e.forEach((function(ft){Ue.push((function(zt){return new Promise((function(tn,Hn){zt.resolve=tn,zt.reject=Hn,Re.push(zt)}))})(ft))})),Le||jt(),Promise.all(Ue).then((function(){bt()})).catch((function(ft){we(ft)}))}else bt()}))}function jt(){try{if(Re.length===0||!ge)return x.debug("Nothing to prune, halt pruning"),Re=[],void(Le=!1);var $e=ge.getBuffer();if(!$e||!$e.buffered||$e.buffered.length===0)return x.debug("SourceBuffer is empty (or does not exist), halt pruning"),Re=[],void(Le=!1);var bt=Re.shift();x.debug("".concat(Se,": Removing buffer from: ").concat(bt.start," to ").concat(bt.end)),Le=!0,Ee.getTime()<bt.end&&xt(!1),ge.remove(bt).then((function(we){en(we)})).catch((function(we){en(we)}))}catch{Le=!1}}function en($e){x.debug("onRemoved buffer from:",$e.from,"to",$e.to),ge&&(un(ge.getAllBufferRanges()),Re.length===0&&(Le=!1,vn()),$e.unintended&&(x.warn("Detected unintended removal from:",$e.from,"to",$e.to,"setting streamprocessor time to",$e.from),Tn(E.Z.SEEK_TARGET,{time:$e.from})),Le?jt():(ue?ue=!1:vn(),Tn(E.Z.BUFFER_CLEARED,{from:$e.from,to:$e.to,unintended:$e.unintended,hasEnoughSpaceToAppend:pn(),quotaExceeded:Me})))}function _n($e){return new Promise((function(bt){$e&&$e.MSETimeOffset!==void 0&&ge&&ge.updateTimestampOffset?ge.updateTimestampOffset($e.MSETimeOffset).then((function(){bt()})).catch((function(){bt()})):bt()}))}function En(){return ge&&!B?ge.updateAppendWindow(ae):Promise.resolve()}function An(){++be*(Pe.get().streaming.wallclockTimeUpdateInterval/1e3)>=Pe.get().streaming.buffer.bufferPruningInterval&&(be=0,st())}function Ln(){Fn()}function xt($e){(B=$e)?Tn(E.Z.BUFFERING_COMPLETED):re=Number.POSITIVE_INFINITY}function an(){try{var $e,bt,we=ge.getAllBufferRanges(),Ue=0;if(!we)return Ue;for(bt=0,$e=we.length;bt<$e;bt++)Ue+=we.end(bt)-we.start(bt);return Ue}catch{return 0}}function mn($e){try{var bt=$e,we=ge.getAllBufferRanges();if(!we||we.length===0)return NaN;for(var Ue=0;bt===$e&&Ue<we.length;){var ft=we.start(Ue),zt=we.end(Ue);bt>=ft&&bt<=zt&&(bt=zt),Ue+=1}return bt===$e?NaN:bt}catch{}}function pn(){var $e=an();return isNaN($e)||$e<Y}function Tn($e,bt){var we=bt||{};te.trigger($e,we,{streamId:ae.id,mediaType:Se})}function ot($e,bt){if(Y=Number.POSITIVE_INFINITY,se=void 0,re=Number.POSITIVE_INFINITY,K=0,Ne=null,B=!1,Le=!1,Me=!1,q=0,be=0,Re=[],xe=NaN,z=!1,ge){var we=ge;ge=null,$e||bt||we.abort().then((function(){we.reset(bt),we=null}))}ue=!1}return C={initialize:function($e){We($e),te.on(E.Z.INIT_FRAGMENT_LOADED,At,C),te.on(E.Z.MEDIA_FRAGMENT_LOADED,pt,C),te.on(E.Z.WALLCLOCK_TIME_UPDATED,An,C),te.on(T.Z.PLAYBACK_PLAYING,Ft,C),te.on(T.Z.PLAYBACK_PROGRESS,lt,C),te.on(T.Z.PLAYBACK_TIME_UPDATED,lt,C),te.on(T.Z.PLAYBACK_RATE_CHANGED,Ln,C),te.on(T.Z.PLAYBACK_STALLED,Bt,C)},getStreamId:function(){return ae.id},getType:function(){return Se},getBufferControllerType:function(){return Et},createBufferSink:Xe,dischargePreBuffer:function(){if(ge&&ie&&typeof ie.discharge=="function"){var $e=ie.getAllBufferRanges();if($e.length>0){for(var bt="Beginning "+Se+"PreBuffer discharge, adding buffer for:",we=0;we<$e.length;we++)bt+=" start: "+$e.start(we)+", end: "+$e.end(we)+";";x.debug(bt)}else x.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");oe=[];for(var Ue=ie.discharge(),ft=null,zt=0;zt<Ue.length;zt++){var tn=Ue[zt];if(tn.segmentType!==Be.w.INIT_SEGMENT_TYPE){var Hn=le.extract(tn.streamId,tn.representationId);Hn&&ft!==Hn&&(oe.push(Hn),ge.append(Hn),ft=Hn)}oe.push(tn),ge.append(tn)}ie.reset(),ie=null}},getBuffer:function(){return ge},getBufferLevel:function(){return q},getRangeAt:Ct,hasBufferAtTime:function($e){try{var bt=ge.getAllBufferRanges();if(!bt||bt.length===0)return!1;for(var we=0;we<bt.length;){var Ue=bt.start(we),ft=bt.end(we);if($e>=Ue&&$e<=ft)return!0;we+=1}return!1}catch(zt){return x.error(zt),!1}},pruneBuffer:st,setMediaSource:We,getMediaSource:function(){return k},appendInitSegmentFromCache:function($e){var bt=le.extract(ae.id,$e);return!!bt&&(x.info("Append Init fragment",Se," with representationId:",bt.representationId," and quality:",bt.quality,", data size:",bt.bytes.byteLength),yt(bt),!0)},getIsBufferingCompleted:function(){return B},setIsBufferingCompleted:xt,getIsPruningInProgress:function(){return Le},reset:function($e,bt){te.off(E.Z.INIT_FRAGMENT_LOADED,At,this),te.off(E.Z.MEDIA_FRAGMENT_LOADED,pt,this),te.off(E.Z.WALLCLOCK_TIME_UPDATED,An,this),te.off(T.Z.PLAYBACK_PLAYING,Ft,this),te.off(T.Z.PLAYBACK_PROGRESS,lt,this),te.off(T.Z.PLAYBACK_TIME_UPDATED,lt,this),te.off(T.Z.PLAYBACK_RATE_CHANGED,Ln,this),te.off(T.Z.PLAYBACK_STALLED,Bt,this),ot($e,bt)},prepareForPlaybackSeek:function(){return B&&xt(!1),ge.abort()},prepareForReplacementTrackSwitch:function($e){return new Promise((function(bt,we){ge.abort().then((function(){return En()})).then((function(){return Pe.get().streaming.buffer.useChangeTypeForTrackSwitch?ge.changeType($e):Promise.resolve()})).then((function(){return tt()})).then((function(){xt(!1),bt()})).catch((function(Ue){we(Ue)}))}))},prepareForNonReplacementTrackSwitch:function($e){return new Promise((function(bt,we){En().then((function(){return Pe.get().streaming.buffer.useChangeTypeForTrackSwitch?ge.changeType($e):Promise.resolve()})).then((function(){bt()})).catch((function(Ue){we(Ue)}))}))},prepareForForceReplacementQualitySwitch:function($e){return new Promise((function(bt,we){ge.abort().then((function(){return En()})).then((function(){return tt()})).then((function(){return _n($e)})).then((function(){xt(!1),bt()})).catch((function(Ue){we(Ue)}))}))},updateAppendWindow:En,getAllRangesWithSafetyFactor:Nt,getContinuousBufferTimeForTargetTime:mn,clearBuffers:Tt,pruneAllSafely:tt,updateBufferTimestampOffset:_n,setSeekTarget:function($e){xe=$e},segmentRequestingCompleted:function($e){isNaN($e)||(re=$e,yn())}},x=(0,I.Z)(P).getInstance().getLogger(C),le=De(P).getInstance(),ot(),C}vt.__dashjs_factory_name=Et;var et=b.Z.getClassFactory(vt),gt="NotFragmentedTextBufferController";function Oe(D){D=D||{};var C,x,B,q,Y,k,K=this.context,re=(0,_.Z)(K).getInstance(),ge=D.textController,ie=D.errHandler,z=D.streamInfo,oe=D.type;function se(Le){q=Le}function Ne(Le){var Me,le;x!==Le&&(x=Le)&&(Me=E.Z.BUFFERING_COMPLETED,le={},re.trigger(Me,le,{streamId:z.id,mediaType:oe}))}function be(Le){Le.chunk.bytes&&!x&&(k.save(Le.chunk),Y.append(Le.chunk),Ne(!0))}return C={initialize:function(Le){se(Le)},getStreamId:function(){return z.id},getType:function(){return oe},getBufferControllerType:function(){return gt},createBufferSink:function(Le){return new Promise((function(Me,le){try{(Y=ee(K).create({mediaSource:q,textController:ge,eventBus:re})).initializeForFirstUse(z,Le),B||(Y.getBuffer()&&typeof Y.getBuffer().initialize=="function"&&Y.getBuffer().initialize(),B=!0),Me(Y)}catch(Re){ie.error(new fe.Z(X.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,X.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+oe)),le(Re)}}))},dischargePreBuffer:function(){},getBuffer:function(){return Y},getBufferLevel:function(){return 0},getRangeAt:function(){return null},pruneBuffer:function(){},hasBufferAtTime:function(){return!0},getAllRangesWithSafetyFactor:function(){return[]},getContinuousBufferTimeForTargetTime:function(){return Number.POSITIVE_INFINITY},setMediaSource:se,getMediaSource:function(){return q},appendInitSegmentFromCache:function(Le){return k.extract(z.id,Le)!==null},getIsBufferingCompleted:function(){return x},setIsBufferingCompleted:Ne,getIsPruningInProgress:function(){return!1},reset:function(Le){re.off(E.Z.INIT_FRAGMENT_LOADED,be,C),!Le&&Y&&(Y.abort(),Y.reset(),Y=null)},clearBuffers:function(){return Promise.resolve()},prepareForPlaybackSeek:function(){return Promise.resolve()},prepareForReplacementTrackSwitch:function(){return x=!1,Promise.resolve()},setSeekTarget:function(){},updateAppendWindow:function(){return Promise.resolve()},pruneAllSafely:function(){return Promise.resolve()},updateBufferTimestampOffset:function(){return Promise.resolve()},segmentRequestingCompleted:function(){}},B=!1,q=null,x=!1,k=De(K).getInstance(),re.on(E.Z.INIT_FRAGMENT_LOADED,be,C),C}Oe.__dashjs_factory_name=gt;var Fe=b.Z.getClassFactory(Oe);function it(D){D=D||{};var C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne=this.context,be=(0,_.Z)(Ne).getInstance(),Le=D.dashMetrics,Me=D.mediaPlayerModel,le=D.fragmentModel,Re=D.abrController,ue=D.playbackController,xe=D.textController,P=D.type,te=D.bufferController,J=D.representationController,Q=D.settings;function j(){oe=!0}function Ae(){oe=!1}function ve(St){if(!te.getIsBufferingCompleted()){Ce();var At=isNaN(St)?0:St;Y=setTimeout(Ee,At)}}function Ce(){Y&&(clearTimeout(Y),Y=null)}function Ee(){try{if((function(){try{return P===u.Z.TEXT&&!xe.isTextEnabled()||ue.isPaused()&&(!ue.getStreamController().getInitialPlayback()||!ue.getStreamController().getAutoPlay())&&!Q.get().streaming.scheduling.scheduleWhilePaused}catch{return!1}})())return void Ce();if((function(){try{return!!oe&&J.getCurrentRepresentationInfo()&&(isNaN(ge)||ie||(pt=x.id,yt=Re.getMaxAllowedIndexFor(P,pt),!(!isNaN(re)&&re==yt||(B.info("Top quality "+P+" index has changed from "+re+" to "+yt),re=yt,0)))||(function(){var un=J.getCurrentRepresentationInfo();return!P||!un||Le.getCurrentBufferLevel(P)<ae()})())}catch{return!1}var pt,yt})()){var St=!1;se&&(St=Re.checkPlaybackQuality(P,x.id)),St||(At=J.getCurrentRepresentationInfo(),z||At.quality!==ge||ie?(ie?(B.debug("Switch track for "+P+", representation id = "+At.id),ie=!1):B.debug("Quality has changed, get init request for representationid = "+At.id),be.trigger(E.Z.INIT_FRAGMENT_NEEDED,{representationId:At.id,sender:C},{streamId:x.id,mediaType:P}),se=!1,z=!1):(B.debug("Media segment needed for ".concat(P," and stream id ").concat(x.id)),be.trigger(E.Z.MEDIA_FRAGMENT_NEEDED,{},{streamId:x.id,mediaType:P}),se=!0))}else ve(ue.getLowLatencyModeEnabled()?Q.get().streaming.scheduling.lowLatencyTimeout:Q.get().streaming.scheduling.defaultTimeout)}catch{ve(ue.getLowLatencyModeEnabled()?Q.get().streaming.scheduling.lowLatencyTimeout:Q.get().streaming.scheduling.defaultTimeout)}var At}function ae(){var St=NaN,At=J.getCurrentRepresentationInfo();return P&&At&&(St=P===u.Z.TEXT?(function(){try{if(xe.isTextEnabled()){var pt=J.getCurrentRepresentationInfo();if(isNaN(pt.fragmentDuration)){var yt=Le.getCurrentSchedulingInfo(S.Z.SCHEDULING_INFO);return yt?yt.duration:0}return pt.fragmentDuration}return 0}catch{return 0}})():P===u.Z.AUDIO&&k?(function(){try{var pt=Le.getCurrentBufferLevel(u.Z.VIDEO),yt=J.getCurrentRepresentationInfo();return isNaN(yt.fragmentDuration)?pt+1:Math.max(pt+1,yt.fragmentDuration)}catch{return 0}})():(function(){try{var pt=J.getCurrentRepresentationInfo().mediaInfo.streamInfo;return Re.isPlayingAtTopQuality(pt)?pt.manifestInfo.duration>=Q.get().streaming.buffer.longFormContentDurationThreshold?Q.get().streaming.buffer.bufferTimeAtTopQualityLongForm:Q.get().streaming.buffer.bufferTimeAtTopQuality:Me.getStableBufferTime()}catch{return Me.getStableBufferTime()}})()),St}function Se(){Pe(!0)}function Pe(St){if(ue&&le){var At=le.getRequests({state:W.FRAGMENT_MODEL_EXECUTED,time:ue.getTime(),threshold:0})[0];At&&ue.getTime()>=At.startTime&&((!K.mediaInfo||At.mediaInfo.type===K.mediaInfo.type&&At.mediaInfo.index!==K.mediaInfo.index)&&St&&be.trigger(E.Z.TRACK_CHANGE_RENDERED,{mediaType:P,oldMediaInfo:K.mediaInfo,newMediaInfo:At.mediaInfo,streamId:x.id}),At.quality===K.quality&&At.adaptationIndex===K.adaptationIndex||!St||(B.debug("Quality change rendered for streamId ".concat(x.id," and type ").concat(P)),be.trigger(E.Z.QUALITY_CHANGE_RENDERED,{mediaType:P,oldQuality:K.quality,newQuality:At.quality,streamId:x.id})),K={mediaInfo:At.mediaInfo,quality:At.quality,adaptationIndex:At.adaptationIndex})}}function We(){le.abortRequests(),Ce()}function je(){Q.get().streaming.scheduling.scheduleWhilePaused||ve()}function Xe(St){Le.updatePlayListTraceMetrics({playbackspeed:St.playbackRate.toString()})}function ze(){se=!0,q=0,ge=NaN,K={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},re=NaN,ie=!1,z=!1,oe=!0}return C={initialize:function(St){k=St,be.on(E.Z.URL_RESOLUTION_FAILED,We,C),be.on(T.Z.PLAYBACK_STARTED,je,C),be.on(T.Z.PLAYBACK_RATE_CHANGED,Xe,C),be.on(T.Z.PLAYBACK_TIME_UPDATED,Se,C),be.on(T.Z.MANAGED_MEDIA_SOURCE_START_STREAMING,j,C),be.on(T.Z.MANAGED_MEDIA_SOURCE_END_STREAMING,Ae,C)},getType:function(){return P},getStreamId:function(){return x.id},setTimeToLoadDelay:function(St){q=St},getTimeToLoadDelay:function(){return q},setSwitchTrack:function(St){ie=St},getSwitchTrack:function(){return ie},startScheduleTimer:ve,clearScheduleTimer:Ce,reset:function(){be.off(E.Z.URL_RESOLUTION_FAILED,We,C),be.off(T.Z.PLAYBACK_STARTED,je,C),be.off(T.Z.PLAYBACK_RATE_CHANGED,Xe,C),be.off(T.Z.PLAYBACK_TIME_UPDATED,Se,C),be.off(T.Z.MANAGED_MEDIA_SOURCE_START_STREAMING,j,C),be.off(T.Z.MANAGED_MEDIA_SOURCE_END_STREAMING,Ae,C),Ce(),Pe(!1),ze(),x=null},getBufferTarget:ae,getPlaybackController:function(){return ue},setCheckPlaybackQuality:function(St){se=St},setInitSegmentRequired:function(St){z=St},setLastInitializedQuality:function(St){ge=St}},B=(0,I.Z)(Ne).getInstance().getLogger(C),ze(),x=D.streamInfo,C}it.__dashjs_factory_name="ScheduleController";var w=b.Z.getClassFactory(it),N=g(7387);function G(D){var C,x,B,q,Y,k,K=(D=D||{}).eventBus,re=D.events,ge=D.abrController,ie=D.dashMetrics,z=D.playbackController,oe=D.timelineConverter,se=D.type,Ne=D.streamInfo,be=D.dashConstants,Le=D.segmentsController,Me=D.isDynamic,le=D.adapter;function Re(){return se}function ue(){return B}function xe(){return k}function P(){x=null,B=!0,q=[],Y=null}function te(Ce){return new Promise((function(Ee,ae){var Se=Ce.hasInitialization(),Pe=Ce.hasSegments(),We=[];We.push(Le.updateInitData(Ce,Se)),We.push(Le.updateSegmentData(Ce,Pe)),Promise.all(We).then((function(je){var Xe;je[0]&&!je[0].error&&(Ce=(function(ze,St){return St&&!St.error&&St.representation?St.representation:ze})(Ce,je[0])),je[1]&&!je[1].error&&(Ce=(function(ze,St){if(St&&!St.error){var At,pt,yt,un,Ve=St.segments,tt=[],Nt=0;for(At=0,pt=Ve?Ve.length:0;At<pt;At++)yt=Ve[At],(un=(0,N.TJ)(oe,Me,ze,yt.startTime,yt.duration,yt.timescale,yt.media,yt.mediaRange,Nt))&&(tt.push(un),un=null,Nt++);return tt.length>0&&(ze.segments=tt),ze}})(Ce,je[1])),(Xe=Ce).mediaFinishedInformation=Le.getMediaFinishedInformation(Xe),(function(ze){if(ue()){var St,At,pt=ie.getCurrentManifestUpdate(),yt=!1;if(pt){for(var un=0;un<pt.representationInfo.length;un++)if((St=pt.representationInfo[un]).index===ze.index&&St.mediaType===Re()){yt=!0;break}yt||ie.addManifestUpdateRepresentationInfo(ze,Re())}if((function(){for(var tt=0,Nt=q.length;tt<Nt;tt++){var lt=q[tt].segmentInfoType;if(!q[tt].hasInitialization()||(lt===be.SEGMENT_BASE||lt===be.BASE_URL)&&!q[tt].segments)return!1}return!0})()){ge.setPlaybackQuality(se,Ne,(At=k,q.indexOf(At)));var Ve=ie.getCurrentDVRInfo(se);Ve&&ie.updateManifestUpdateInfo({latency:Ve.range.end-z.getTime()}),ie.getCurrentRepresentationSwitch(xe().adaptation.type)||J(),j()}}})(Ce),Ee()})).catch((function(je){ae(je)}))}))}function J(){(function(){if(!(ge&&ie&&z&&oe))throw new Error(u.Z.MISSING_CONFIG_ERROR)})();var Ce=new Date,Ee=xe(),ae=1e3*z.getTime();Ee&&ie.addRepresentationSwitch(Ee.adaptation.type,Ce,ae,Ee.id),K.trigger(T.Z.REPRESENTATION_SWITCH,{mediaType:se,streamId:Ne.id,currentRepresentation:Ee,numberOfRepresentations:q.length},{streamId:Ne.id,mediaType:se})}function Q(Ce){return Ce==null||Ce>=q.length?null:q[Ce]}function j(Ce){B=!1,K.trigger(re.DATA_UPDATE_COMPLETED,{data:x,currentRepresentation:k,error:Ce},{streamId:Ne.id,mediaType:se})}function Ae(Ce){k=Ce,Y=le.convertRepresentationToRepresentationInfo(k)}function ve(Ce){if(Ce.newDuration){var Ee=xe();Ee&&Ee.adaptation.period&&(Ee.adaptation.period.duration=Ce.newDuration)}}return C={getStreamId:function(){return Ne.id},getType:Re,getData:function(){return x},isUpdating:ue,updateData:function(Ce,Ee,ae,Se,Pe){return new Promise((function(We,je){if(B=!0,q=Ee,x=Ce,Ae(Q(Pe)),ae!==u.Z.VIDEO&&ae!==u.Z.AUDIO&&(ae!==u.Z.TEXT||!Se))return j(),void We();for(var Xe=[],ze=0,St=q.length;ze<St;ze++){var At=q[ze];Xe.push(te(At))}Promise.all(Xe).then((function(){Ae(Q(Pe)),We()})).catch((function(pt){je(pt)}))}))},getCurrentRepresentation:xe,getCurrentRepresentationInfo:function(){return Y},getRepresentationForQuality:Q,prepareQualityChange:function(Ce){Ae(Q(Ce)),J()},reset:function(){K.off(T.Z.MANIFEST_VALIDITY_CHANGED,ve,C),P()}},P(),K.on(T.Z.MANIFEST_VALIDITY_CHANGED,ve,C),C}G.__dashjs_factory_name="RepresentationController";var V=b.Z.getClassFactory(G),ye=g(3106),he=g(9326),He=g(7473),ut=g(2594);function Je(D,C){if(!(D instanceof C))throw new TypeError("Cannot call a class as a function")}var Qe=function D(){Je(this,D),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};Qe.INITIAL_PLAYOUT_START_REASON="initial_playout",Qe.SEEK_START_REASON="seek",Qe.RESUME_FROM_PAUSE_START_REASON="resume",Qe.METRICS_COLLECTION_START_REASON="metrics_collection_start";var Ye=function D(){Je(this,D),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};Ye.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",Ye.REBUFFERING_REASON="rebuffering",Ye.USER_REQUEST_STOP_REASON="user_request",Ye.END_OF_PERIOD_STOP_REASON="end_of_period",Ye.END_OF_CONTENT_STOP_REASON="end_of_content",Ye.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",Ye.FAILURE_STOP_REASON="failure";var nt=g(7802);function mt(){return{ntpToUTC:function(D){var C=new Date(Date.UTC(1900,0,1,0,0,0));return new Date(C.getTime()+D).getTime()}}}mt.__dashjs_factory_name="TimeUtils";var Gt=b.Z.getSingletonFactory(mt);function _t(D){D=D||{};var C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le=this.context,Me=(0,_.Z)(Le).getInstance(),le=D.streamInfo,Re=D.type,ue=D.errHandler,xe=D.mimeType,P=D.timelineConverter,te=D.adapter,J=D.manifestModel,Q=D.mediaPlayerModel,j=D.fragmentModel,Ae=D.abrController,ve=D.playbackController,Ce=D.mediaController,Ee=D.textController,ae=D.dashMetrics,Se=D.settings,Pe=D.boxParser,We=D.segmentBlacklistController;function je(){return le.id}function Xe(){return Re}function ze(){return te.getIsTextTrack(re.getData())}function St(){Y=[],q=null,Ne=0,ge=!1,ie=!1,z=!1,be=null}function At(ot){return!isNaN(ot)&&!isNaN(le.duration)&&isFinite(le.duration)&&ot>=le.start+le.duration}function pt(ot){var $e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(ot.sender){if(ve.getIsManifestUpdateInProgress())Nt();else if((!ze()||Ee.isTextEnabled())&&k&&ot.representationId&&!k.appendInitSegmentFromCache(ot.representationId)){var bt=re.getCurrentRepresentation();if(bt.range===0)return void yt();var we=oe?oe.getInitRequest(q,bt):null;we?j.executeRequest(we):$e&&(K.setInitSegmentRequired(!0),Nt())}}}function yt(ot){var $e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(ve.getIsManifestUpdateInProgress()||k.getIsPruningInProgress())Nt();else{var bt=tt();bt?(ge=!1,ie=!1,un(bt)):Ve($e)}}function un(ot){isNaN(ot.startTime+ot.duration)||(Ne=ot.startTime+ot.duration),ot.delayLoadingTime=new Date().getTime()+K.getTimeToLoadDelay(),K.setTimeToLoadDelay(0),(function($e){var bt=$e.url;return $e.range&&(bt=bt.concat("_",$e.range)),We.contains(bt)})(ot)?(x.warn("Fragment request url ".concat(ot.url," for stream id ").concat(le.id," and media type ").concat(Re," is on the ignore list and will be skipped")),Nt()):(x.debug("Next fragment request url for stream id ".concat(le.id," and media type ").concat(Re," is ").concat(ot.url)),j.executeRequest(ot))}function Ve(ot){var $e,bt=re.getCurrentRepresentation();if(!Se.get().streaming.gaps.enableSeekFix||!ge&&ve.getTime()!==0||(B?B&&bt.segmentInfoType===d.Z.SEGMENT_TIMELINE&&($e=oe.getValidTimeAheadOfTargetTime(Ne,q,bt,Se.get().streaming.gaps.threshold)):$e=oe.getValidTimeAheadOfTargetTime(Ne,q,bt,Se.get().streaming.gaps.threshold),isNaN($e)||$e===Ne)){if(oe.isLastSegmentRequested(bt,Ne)){var we=oe.getCurrentIndex();return x.debug("Segment requesting for stream ".concat(le.id," has finished")),Me.trigger(E.Z.STREAM_REQUESTING_COMPLETED,{segmentIndex:we},{streamId:le.id,mediaType:Re}),k.segmentRequestingCompleted(we),void K.clearScheduleTimer()}ot&&Nt()}else ve.isSeeking()||ve.getTime()===0?(x.warn("Adjusting playback time ".concat($e," because of gap in the manifest. Seeking by ").concat($e-Ne)),ve.seek($e,!1,!1)):(x.warn("Adjusting buffering time ".concat($e," because of gap in the manifest. Adjusting time by ").concat($e-Ne)),Tn($e),ot&&Nt())}function tt(){var ot,$e=En();if(isNaN(Ne)||Xe()===u.Z.TEXT&&!Ee.isTextEnabled())return null;if(oe){var bt=re&&$e?re.getRepresentationForQuality($e.quality):null;ot=ge?oe.getSegmentRequestForTime(q,bt,Ne):ie?oe.repeatSegmentRequest(q,bt):oe.getNextSegmentRequest(q,bt)}return ot}function Nt(){K.startScheduleTimer(ve.getLowLatencyModeEnabled()?Se.get().streaming.scheduling.lowLatencyTimeout:Se.get().streaming.scheduling.defaultTimeout)}function lt(ot){ot.error||k.getIsBufferingCompleted()||k.updateBufferTimestampOffset(ot.currentRepresentation)}function Bt(ot){ae.addBufferState(Re,ot.state,K.getBufferTarget()),ot.state!==S.Z.BUFFER_EMPTY||ve.isSeeking()||(x.info("Buffer is empty! Stalling!"),ae.pushPlayListTraceMetrics(new Date,Ye.REBUFFERING_REASON))}function Ft(ot){j.syncExecutedRequestsWithBufferedRange(k.getBuffer().getAllBufferRanges(),le.duration),ot.quotaExceeded&&ot.from>ve.getTime()&&Tn(ot.from),ot.hasEnoughSpaceToAppend&&ot.quotaExceeded&&K.startScheduleTimer()}function Ct(ot){if(ot&&ot.lastRequestAppended&&ot.lastRequestAppended.url){var $e=ot.lastRequestAppended.url;ot.lastRequestAppended.range&&($e=$e.concat("_",ot.lastRequestAppended.range)),x.warn("Blacklisting segment with url ".concat($e)),We.add($e)}}function vn(ot){if(x.debug("Appended bytes for ".concat(ot.mediaType," and stream id ").concat(ot.streamId)),ot.segmentType===Be.w.INIT_SEGMENT_TYPE){var $e=ot.quality;K.setLastInitializedQuality($e),x.info("["+Re+"] lastInitializedRepresentationInfo changed to "+ot.quality)}be?yn(be):K.startScheduleTimer(0)}function yn(ot){var $e=j.getRequests({state:W.FRAGMENT_MODEL_LOADING});if($e&&$e.length>0)return x.debug("Preparing for default quality switch: Waiting for ongoing segment request to be finished before applying switch."),void(be=ot);k.updateBufferTimestampOffset(ot).then((function(){K.setCheckPlaybackQuality(!1),q.segmentAlignment||q.subSegmentAlignment?K.startScheduleTimer():mn(),be=null,z=!1})).catch((function(){be=null,z=!1}))}function Fn(ot){x.info("onFragmentLoadingAbandoned request: "+ot.request.url+" has been aborted"),ve.isSeeking()||K.getSwitchTrack()||z||(x.info("onFragmentLoadingAbandoned request: "+ot.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),ot.request&&ot.request.isInitializationRequest()?K.setInitSegmentRequired(!0):Tn(ot.request.startTime+ot.request.duration/2),K.startScheduleTimer(0))}function Zn(ot){x.info("OnFragmentLoadingCompleted for stream id "+le.id+" and media type "+Re+" - Url:",ot.request?ot.request.url:"undefined",ot.request.range?", Range:"+ot.request.range:""),ze()&&K.startScheduleTimer(0),ot.error&&ot.request.serviceLocation&&(function($e){x.info("Fragment loading completed with an error"),$e&&$e.request&&$e.request.type&&($e.request.type===Be.w.INIT_SEGMENT_TYPE?pt({representationId:$e.request.representationId,sender:{}},!1):$e.request.type===Be.w.MEDIA_SEGMENT_TYPE&&(Tn($e.request.startTime+$e.request.duration/2),yt({},!1)))})(ot)}function st(){Tn(ve.getTime()),_n().startScheduleTimer()}function Mt(ot){var $e=ot.currentTrackInfo;if($e){var bt=Y.find((function(we){return we.index===$e.index&&we.lang===$e.lang}));bt&&en(bt).then((function(){k.setIsBufferingCompleted(!1),Tn(ve.getTime()),K.setInitSegmentRequired(!0),K.startScheduleTimer()}))}}function Tt(ot){Tn(ot.quotaExceededTime),K.clearScheduleTimer()}function jt(){return k?k.getBuffer():null}function en(ot){ot===q||ot&&q&&ot.type!==q.type||(q=ot);var $e=te.getRealAdaptation(le,q),bt=te.getVoRepresentations(q);if(re){var we,Ue=re.getData(),ft=Ae.getMaxAllowedIndexFor(Re,le.id),zt=Ae.getMinAllowedIndexFor(Re,le.id),tn=null;return Ue!==null&&Ue.id===$e.id||Re===u.Z.TEXT?we=Ae.getQualityFor(Re,le.id):(tn=Ae.getThroughputHistory().getAverageThroughput(Re,B)||Ae.getInitialBitrateFor(Re,le.id),we=Ae.getQualityForBitrate(q,tn,le.id)),zt!==void 0&&we<zt&&(we=zt),we>ft&&(we=ft),re.updateData($e,bt,Re,q.isFragmented,we)}return Promise.resolve()}function _n(){return K}function En(ot){var $e;return ot!==void 0?((0,ye.SE)(ot),$e=re?re.getRepresentationForQuality(ot):null):$e=re?re.getCurrentRepresentation():null,te.convertRepresentationToRepresentationInfo($e)}function An(){return!!k&&k.getIsBufferingCompleted()}function Ln(ot){if(Se.get().streaming.enableManifestTimescaleMismatchFix){var $e=ot.chunk,bt=$e.bytes,we=En($e.quality),Ue=re&&we?re.getRepresentationForQuality(we.quality):null;we&&Ue&&(Ue.timescale=Pe.getMediaTimescaleFromMoov(bt))}}function xt(ot){var $e=ot.chunk,bt=$e.bytes,we=$e.quality,Ue=En(we),ft=re&&Ue?re.getRepresentationForQuality(Ue.quality):null;if(Ue&&ft){var zt;if(Se.get().streaming.parseInbandPrft&&ot.request.type===Be.w.MEDIA_SEGMENT_TYPE){var tn=(function(Ri,ei){var ea=Ri.getBoxes("prft"),Is=[];return ea.forEach((function(ts){Is.push((function(ta,ma){var Ti="unknown";switch(ta.flags){case 0:Ti=d.Z.PRODUCER_REFERENCE_TIME_TYPE.ENCODER;break;case 16:Ti=d.Z.PRODUCER_REFERENCE_TIME_TYPE.APPLICATION;break;case 24:Ti=d.Z.PRODUCER_REFERENCE_TIME_TYPE.CAPTURED}var ns=1e3*ta.ntp_timestamp_sec+ta.ntp_timestamp_frac/Math.pow(2,32)*1e3;return{type:Ti,ntpTimestamp:ns=Gt(Le).getInstance().ntpToUTC(ns),mediaTime:ta.media_time/ma}})(ts,ei))})),Is})(zt=zt||Pe.parse(bt),ft.timescale);tn&&tn.length&&Me.trigger(T.Z.INBAND_PRFT,{data:tn},{streamId:le.id,mediaType:Re})}var Hn=te.getEventsFor(Ue.mediaInfo,null,le),cr=te.getEventsFor(Ue,ft,le);if(Hn&&Hn.length>0||cr&&cr.length>0){var $r=j.getRequests({state:W.FRAGMENT_MODEL_EXECUTED,quality:we,index:$e.index})[0],fr=(function(Ri,ei,ea,Is){try{for(var ts={},ta=[],ma=ea.concat(Is),Ti=0,ns=ma.length;Ti<ns;Ti++)ts[ma[Ti].schemeIdUri+"/"+ma[Ti].value]=ma[Ti];var Cs=Ri.getBoxes("emsg");if(!Cs||Cs.length===0)return ta;for(var pi=Ri.getBox("sidx"),ko=!pi||isNaN(pi.earliest_presentation_time)||isNaN(pi.timescale)?ei&&!isNaN(ei.mediaStartTime)?ei.mediaStartTime:0:pi.earliest_presentation_time/pi.timescale,Rl=Math.max(ko,0),Il=re.getCurrentRepresentation(),pa=0,Cl=Cs.length;pa<Cl;pa++){var rs=te.getEvent(Cs[pa],ts,Rl,Il);rs&&ta.push(rs)}return ta}catch{return[]}})(zt=zt||Pe.parse(bt),$r,Hn,cr);Me.trigger(E.Z.INBAND_EVENTS,{events:fr},{streamId:le.id})}}}function an(){var ot=ve.getTime();Se.get().streaming.buffer.flushBufferAtTrackSwitch&&ve.seek(ot+.001,!1,!0),Tn(ot),k.setSeekTarget(ot),K.startScheduleTimer()}function mn(){var ot=ve.getTime(),$e=k.getContinuousBufferTimeForTargetTime(ot);Tn(isNaN($e)?ot:$e),K.startScheduleTimer()}function pn(ot){ot&&!isNaN(ot.time)&&(Tn(ot.time),k.setSeekTarget(ot.time))}function Tn(ot){Ne=ot,ge=!0}return C={initialize:function(ot,$e,bt){se=(0,nt.Z)(Le).create({events:E.Z,eventBus:Me,streamInfo:le,timelineConverter:P,dashConstants:d.Z,segmentBaseController:D.segmentBaseController,type:Re}),oe=(0,he.Z)(Le).create({streamInfo:le,type:Re,timelineConverter:P,dashMetrics:ae,mediaPlayerModel:Q,baseURLController:D.baseURLController,errHandler:ue,segmentsController:se,settings:Se,boxParser:Pe,events:E.Z,eventBus:Me,errors:X,debug:(0,I.Z)(Le).getInstance(),requestModifier:(0,He.Z)(Le).getInstance(),dashConstants:d.Z,constants:u.Z,urlUtils:(0,ut.Z)(Le).getInstance()}),B=le.manifestInfo.isDynamic,oe.initialize(B),Ae.registerStreamType(Re,C),re=V(Le).create({streamInfo:le,type:Re,abrController:Ae,dashMetrics:ae,playbackController:ve,timelineConverter:P,dashConstants:d.Z,events:E.Z,eventBus:Me,errors:X,isDynamic:B,adapter:te,segmentsController:se}),k=(function(we,Ue){return we?we!==u.Z.TEXT||Ue?et(Le).create({streamInfo:le,type:we,mediaPlayerModel:Q,manifestModel:J,fragmentModel:j,errHandler:ue,mediaController:Ce,representationController:re,adapter:te,textController:Ee,abrController:Ae,playbackController:ve,settings:Se}):Fe(Le).create({streamInfo:le,type:we,mimeType:xe,fragmentModel:j,textController:Ee,errHandler:ue,settings:Se}):(ue.error(new fe.Z(X.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,X.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)})(Re,bt),k&&k.initialize(ot),(K=w(Le).create({streamInfo:le,type:Re,mimeType:xe,adapter:te,dashMetrics:ae,mediaPlayerModel:Q,fragmentModel:j,abrController:Ae,playbackController:ve,textController:Ee,mediaController:Ce,bufferController:k,representationController:re,settings:Se})).initialize($e),Ne=0,ge=!1,ie=!1},getStreamId:je,getType:Xe,isUpdating:function(){return!!re&&re.isUpdating()},getBufferController:function(){return k},dischargePreBuffer:function(){k.dischargePreBuffer()},getFragmentModel:function(){return j},getScheduleController:_n,getRepresentationController:function(){return re},getRepresentationInfo:En,getBufferLevel:function(){return k?k.getBufferLevel():0},isBufferingCompleted:An,createBufferSinks:function(ot){var $e=jt();return $e?Promise.resolve($e):k?k.createBufferSink(q,ot):Promise.resolve(null)},updateStreamInfo:function(ot){return le=ot,An()?Promise.resolve():k.updateAppendWindow()},getStreamInfo:function(){return le},selectMediaInfo:en,clearMediaInfoArray:function(){Y=[]},addMediaInfo:function(ot){Y.indexOf(ot)===-1&&Y.push(ot)},prepareTrackSwitch:function(){return new Promise((function(ot){x.debug("Preparing track switch for type ".concat(Re));var $e=Re===u.Z.TEXT||Se.get().streaming.trackSwitchMode[Re]===u.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&ve.getTimeToStreamEnd(le)>Se.get().streaming.buffer.stallThreshold;if(k.getIsBufferingCompleted()&&!$e)return k.prepareForNonReplacementTrackSwitch(q.codec).then((function(){Me.trigger(E.Z.BUFFERING_COMPLETED,{},{streamId:le.id,mediaType:Re})})).catch((function(){Me.trigger(E.Z.BUFFERING_COMPLETED,{},{streamId:le.id,mediaType:Re})})),void ot();K.clearScheduleTimer(),K.setSwitchTrack(!0),$e?(Me.trigger(E.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:Re,streamId:le.id},{mediaType:Re,streamId:le.id}),j.abortRequests(),k.prepareForReplacementTrackSwitch(q.codec).then((function(){var bt=En();return k.updateBufferTimestampOffset(bt)})).then((function(){an(),ot()})).catch((function(){an(),ot()}))):k.prepareForNonReplacementTrackSwitch(q.codec).then((function(){mn(),ot()})).catch((function(){mn(),ot()}))}))},prepareQualityChange:function(ot){be&&x.warn("Canceling queued representation switch to ".concat(be.quality," for ").concat(Re)),x.debug("Preparing quality switch for type ".concat(Re));var $e=ot.newQuality;z=!0,K.clearScheduleTimer(),re.prepareQualityChange($e);var bt=En($e);ot.reason&&ot.reason.forceReplace?(function(we){j.abortRequests(),Me.trigger(E.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:Re,streamId:le.id},{mediaType:Re,streamId:le.id}),K.setCheckPlaybackQuality(!1),k.prepareForForceReplacementQualitySwitch(we).then((function(){an(),be=null,z=!1})).catch((function(){an(),be=null,z=!1}))})(bt):ot&&ot.reason&&ot.reason.forceAbandon?(function(we){k.updateBufferTimestampOffset(we).then((function(){j.abortRequests(),ie=!0,K.setCheckPlaybackQuality(!1),K.startScheduleTimer(),z=!1,be=null})).catch((function(){be=null,z=!1}))})(bt):Se.get().streaming.buffer.fastSwitchEnabled?(function(we){var Ue=ve.getTime(),ft=1.5*(isNaN(we.fragmentDuration)?1:we.fragmentDuration),zt=j.getRequests({state:W.FRAGMENT_MODEL_EXECUTED,time:Ue+ft,threshold:0})[0];if(zt&&!ze()){var tn=k.getBufferLevel(),Hn=Ae.getAbandonmentStateFor(le.id,Re);zt.quality<we.quality&&tn>=ft&&Hn!==S.Z.ABANDON_LOAD?k.updateBufferTimestampOffset(we).then((function(){j.abortRequests(),Tn(Ue+ft),K.setCheckPlaybackQuality(!1),K.startScheduleTimer(),z=!1})).catch((function(){z=!1})):yn(we)}else yn(we)})(bt):yn(bt),ae.pushPlayListTraceMetrics(new Date,Ye.REPRESENTATION_SWITCH_STOP_REASON),ae.createPlaylistTraceMetrics(bt.id,1e3*ve.getTime(),ve.getPlaybackRate())},getMediaInfo:function(){return q},getMediaSource:function(){return k.getMediaSource()},setMediaSource:function(ot){return k.setMediaSource(ot,q)},getBuffer:jt,setExplicitBufferingTime:Tn,finalisePlayList:function(ot,$e){ae.pushPlayListTraceMetrics(ot,$e)},probeNextRequest:function(){var ot=En(),$e=re&&ot?re.getRepresentationForQuality(ot.quality):null;return oe.getNextSegmentRequestIdempotent(q,$e)},prepareInnerPeriodPlaybackSeeking:function(ot){return new Promise((function($e){if(k.hasBufferAtTime(ot.seekTime))return k.pruneBuffer(),At(k.getContinuousBufferTimeForTargetTime(ot.seekTime))&&k.setIsBufferingCompleted(!0),void $e();K.clearScheduleTimer(),j.abortRequests(),k.prepareForPlaybackSeek().then((function(){var bt=k.getAllRangesWithSafetyFactor(ot.seekTime);return k.clearBuffers(bt)})).then((function(){var bt=k.getContinuousBufferTimeForTargetTime(ot.seekTime);if(At(bt))k.setIsBufferingCompleted(!0),$e();else{var we=isNaN(bt)?ot.seekTime:bt;Tn(we),k.setSeekTarget(we);var Ue=[];Ue.push(k.updateAppendWindow());var ft=En();Ue.push(k.updateBufferTimestampOffset(ft)),Promise.all(Ue).then((function(){K.setInitSegmentRequired(!0),K.setCheckPlaybackQuality(!1),K.startScheduleTimer(),$e()}))}})).catch((function(bt){x.error(bt)}))}))},prepareOuterPeriodPlaybackSeeking:function(){return new Promise((function(ot,$e){try{K.clearScheduleTimer(),j.abortRequests(),k.prepareForPlaybackSeek().then((function(){return k.pruneAllSafely()})).then((function(){ot()}))}catch(bt){$e(bt)}}))},reset:function(ot,$e){oe&&oe.reset(),k&&(k.reset(ot,$e),k=null),K&&(K.reset(),K=null),re&&(re.reset(),re=null),se&&(se=null),Ae&&Ae.unRegisterStreamType(je(),Re),Me.off(E.Z.DATA_UPDATE_COMPLETED,lt,C),Me.off(E.Z.INIT_FRAGMENT_NEEDED,pt,C),Me.off(E.Z.MEDIA_FRAGMENT_NEEDED,yt,C),Me.off(E.Z.INIT_FRAGMENT_LOADED,Ln,C),Me.off(E.Z.MEDIA_FRAGMENT_LOADED,xt,C),Me.off(E.Z.BUFFER_LEVEL_STATE_CHANGED,Bt,C),Me.off(E.Z.BUFFER_CLEARED,Ft,C),Me.off(E.Z.SEEK_TARGET,pn,C),Me.off(E.Z.FRAGMENT_LOADING_ABANDONED,Fn,C),Me.off(E.Z.FRAGMENT_LOADING_COMPLETED,Zn,C),Me.off(E.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,st,C),Me.off(E.Z.SET_NON_FRAGMENTED_TEXT,Mt,C),Me.off(E.Z.QUOTA_EXCEEDED,Tt,C),Me.off(E.Z.SOURCE_BUFFER_ERROR,Ct,C),Me.off(E.Z.BYTES_APPENDED_END_FRAGMENT,vn,C),St(),Re=null,le=null}},x=(0,I.Z)(Le).getInstance().getLogger(C),St(),Me.on(E.Z.DATA_UPDATE_COMPLETED,lt,C,{priority:_.Z.EVENT_PRIORITY_HIGH}),Me.on(E.Z.INIT_FRAGMENT_NEEDED,pt,C),Me.on(E.Z.MEDIA_FRAGMENT_NEEDED,yt,C),Me.on(E.Z.INIT_FRAGMENT_LOADED,Ln,C),Me.on(E.Z.MEDIA_FRAGMENT_LOADED,xt,C),Me.on(E.Z.BUFFER_LEVEL_STATE_CHANGED,Bt,C),Me.on(E.Z.BUFFER_CLEARED,Ft,C),Me.on(E.Z.SEEK_TARGET,pn,C),Me.on(E.Z.FRAGMENT_LOADING_ABANDONED,Fn,C),Me.on(E.Z.FRAGMENT_LOADING_COMPLETED,Zn,C),Me.on(E.Z.QUOTA_EXCEEDED,Tt,C),Me.on(E.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,st,C),Me.on(E.Z.SET_NON_FRAGMENTED_TEXT,Mt,C),Me.on(E.Z.SOURCE_BUFFER_ERROR,Ct,C),Me.on(E.Z.BYTES_APPENDED_END_FRAGMENT,vn,C),C}_t.__dashjs_factory_name="StreamProcessor";var gn=b.Z.getClassFactory(_t),Wt=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null},ln=g(9032);function cn(D,C){if(D){if(typeof D=="string")return On(D,C);var x=Object.prototype.toString.call(D).slice(8,-1);return x==="Object"&&D.constructor&&(x=D.constructor.name),x==="Map"||x==="Set"?Array.from(D):x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x)?On(D,C):void 0}}function On(D,C){(C==null||C>D.length)&&(C=D.length);for(var x=0,B=new Array(C);x<C;x++)B[x]=D[x];return B}function zn(D){D=D||{};var C,x,B=this.context,q=D.requestModifier,Y=D.lowLatencyThroughputModel,k=D.boxParser,K=(0,Ie.Z)(B).getInstance();function re(z){var oe,se=new Date,Ne=z.request,be=new Headers;if(Ne.range&&be.append("Range","bytes="+Ne.range),z.headers)for(var Le in z.headers){var Me=z.headers[Le];Me&&be.append(Le,Me)}Ne.requestStartDate||(Ne.requestStartDate=se),q&&q.modifyRequestHeader&&q.modifyRequestHeader({setRequestHeader:function(P,te){be.append(P,te)}},{url:z.url}),typeof window.AbortController=="function"&&(oe=new AbortController,z.abortController=oe,oe.signal.onabort=z.onabort);var le={method:z.method,headers:be,credentials:z.withCredentials?"include":void 0,signal:oe?oe.signal:void 0},Re=K.get().streaming.abr.fetchThroughputCalculationMode,ue=Date.now(),xe=0;new Promise((function(P){if(Re===u.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&Y&&(xe=Y.getThroughputCapacityDelayMS(Ne,1e3*x.getCurrentBufferLevel(Ne.mediaType))))return setTimeout(P,xe);P()})).then((function(){var P=Date.now();fetch(z.url,le).then((function(te){z.response||(z.response={}),z.response.status=te.status,z.response.statusText=te.statusText,z.response.responseURL=te.url,te.ok||z.onerror();var J,Q="",j=(function(lt,Bt){var Ft;if(typeof Symbol>"u"||lt[Symbol.iterator]==null){if(Array.isArray(lt)||(Ft=cn(lt))){Ft&&(lt=Ft);var Ct=0,vn=function(){};return{s:vn,n:function(){return Ct>=lt.length?{done:!0}:{done:!1,value:lt[Ct++]}},e:function(st){throw st},f:vn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var yn,Fn=!0,Zn=!1;return{s:function(){Ft=lt[Symbol.iterator]()},n:function(){var st=Ft.next();return Fn=st.done,st},e:function(st){Zn=!0,yn=st},f:function(){try{Fn||Ft.return==null||Ft.return()}finally{if(Zn)throw yn}}}})(te.headers.keys());try{for(j.s();!(J=j.n()).done;){var Ae=J.value;Q+=Ae+": "+te.headers.get(Ae)+`\r
`}}catch(lt){j.e(lt)}finally{j.f()}if(z.response.responseHeaders=Q,!te.body)return te.arrayBuffer().then((function(lt){z.response.response=lt;var Bt={loaded:lt.byteLength,total:lt.byteLength,stream:!1};z.progress(Bt),z.onload(),z.onend()}));var ve,Ce,Ee,ae,Se=parseInt(te.headers.get("Content-Length"),10),Pe=0,We=!1,je=new Uint8Array,Xe=0;if(Re===u.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&Y){var ze=P,St=0,At=(Ee=te.body.tee(),ae=2,(function(lt){if(Array.isArray(lt))return lt})(Ee)||(function(lt,Bt){if(typeof Symbol<"u"&&Symbol.iterator in Object(lt)){var Ft=[],Ct=!0,vn=!1,yn=void 0;try{for(var Fn,Zn=lt[Symbol.iterator]();!(Ct=(Fn=Zn.next()).done)&&(Ft.push(Fn.value),!Bt||Ft.length!==Bt);Ct=!0);}catch(st){vn=!0,yn=st}finally{try{Ct||Zn.return==null||Zn.return()}finally{if(vn)throw yn}}return Ft}})(Ee,ae)||cn(Ee,ae)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()),pt=At[0],yt=At[1];ve=pt.getReader(),Ce=[],ve.read().then((function lt(Bt){var Ft=Bt.value,Ct=Bt.done;if(St=Date.now(),Ft&&Ft.length){var vn=St-ze,yn=Ft.length;Ce.push({chunkDownloadTimeRelativeMS:St-P,chunkDownloadDurationMS:vn,chunkBytes:yn,kbps:Math.round(8*yn/(vn/1e3)),bufferLevel:x.getCurrentBufferLevel(Ne.mediaType)})}if(Ct){var Fn=St-P,Zn=Ce.reduce((function(st,Mt){return st+Mt.chunkBytes}),0);return Y.addMeasurement(Ne,Fn,Ce,ue,xe,Q),void z.progress({loaded:Zn,total:Zn,lengthComputable:!0,time:Y.getEstimatedDownloadDurationMS(Ne),stream:!0})}return ze=Date.now(),ve.read().then(lt)})),z.reader=yt.getReader()}else z.reader=te.body.getReader();var un=[],Ve=[],tt=[],Nt=!0;ge(z,(function lt(Bt){var Ft=Bt.value;if(Bt.done){if(je){if(Re!==u.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var Ct=null,vn=null;Re===u.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING?(Ct=(function(st,Mt){try{var Tt,jt;Tt=st.filter((function(an,mn){return mn<st.length-1})),jt=Mt.filter((function(an,mn){return mn<Mt.length-1}));var en=[];if(Tt.length>1){for(var _n=0,En=0,An=0;An<Tt.length;An++)if(Tt[An]&&jt[An]){var Ln=jt[An].ts-Tt[An].ts;if(Ln>1)en.push(8*jt[An].bytes/Ln),En=0;else{En===0&&(En=Tt[An].ts,_n=0);var xt=jt[An].ts-En;xt>1?(_n+=jt[An].bytes,en.push(8*_n/xt),En=0):_n+=jt[An].bytes}}if(en.length>0)return en.reduce((function(an,mn){return an+mn}),0)/en.length}return null}catch{return null}})(Ve,tt),Ct&&(vn=8*Pe/Ct)):Re===u.Z.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA&&(vn=ie(un,Pe)),z.progress({loaded:Pe,total:isNaN(Se)?Pe:Se,lengthComputable:!0,time:vn,stream:!0})}z.response.response=je.buffer}return z.onload(),void z.onend()}if(Ft&&Ft.length>0){je=(function(st,Mt){if(st.length===0)return Mt;var Tt=new Uint8Array(st.length+Mt.length);return Tt.set(st),Tt.set(Mt,st.length),Tt})(je,Ft),Pe+=Ft.length,un.push({ts:Date.now(),bytes:Ft.length}),Re===u.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&Nt&&k.findLastTopIsoBoxCompleted(["moof"],je,Xe).found&&(Nt=!1,Ve.push({ts:performance.now(),bytes:Ft.length}));var yn=k.findLastTopIsoBoxCompleted(["moov","mdat"],je,Xe);if(yn.found){var Fn,Zn=yn.lastCompletedOffset+yn.size;Re!==u.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING||Nt||(Nt=!0,tt.push({ts:performance.now(),bytes:je.length})),Zn===je.length?(Fn=je,je=new Uint8Array):(Fn=new Uint8Array(je.subarray(0,Zn)),je=je.subarray(Zn)),z.progress({data:Fn.buffer,lengthComputable:!1,noTrace:!0}),Xe=0}else Xe=yn.lastCompletedOffset,We||(z.progress({lengthComputable:!1,noTrace:!0}),We=!0)}ge(z,lt)}))})).catch((function(te){z.onerror&&z.onerror(te)}))}))}function ge(z,oe){z.reader.read().then(oe).catch((function(se){z.onerror&&z.response.status===200&&z.onerror(se)}))}function ie(z,oe){try{if((z=z.filter((function(be){return be.bytes>oe/4/z.length}))).length>1){var se=0,Ne=(z[z.length-1].ts-z[0].ts)/z.length;return z.forEach((function(be,Le){var Me=z[Le+1];if(Me){var le=Me.ts-be.ts;se+=le<Ne?le:0}})),se}return null}catch{return null}}return C={load:function(z){q&&q.modifyRequest?(0,He.k)(z,q).then((function(){return re(z)})):re(z)},abort:function(z){if(z.abortController)z.abortController.abort();else if(z.reader)try{z.reader.cancel(),z.onabort()}catch{}},calculateDownloadedTime:ie,setup:function(z){x=z.dashMetrics}},C}zn.__dashjs_factory_name="FetchLoader";var ar=b.Z.getClassFactory(zn),er=g(1180);function Rr(D,C){for(var x=0;x<C.length;x++){var B=C[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}var li=(function(){function D(){(function(B,q){if(!(B instanceof q))throw new TypeError("Cannot call a class as a function")})(this,D),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.frameRate=null}var C,x;return C=D,(x=[{key:"hasInitialization",value:function(){return this.initialization!==null||this.range!==null}},{key:"hasSegments",value:function(){return this.segmentInfoType!==d.Z.BASE_URL&&this.segmentInfoType!==d.Z.SEGMENT_BASE&&!this.indexRange}}])&&Rr(C.prototype,x),D})(),gr=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.period=null,this.index=-1,this.type=null},gi=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null};gi.DEFAULT_ID="defaultId";var Zr=gi,ri=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN},ui=g(2610),ii=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.type="",this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN},bi=function D(C,x,B,q){(function(Y,k){if(!(Y instanceof k))throw new TypeError("Cannot call a class as a function")})(this,D),this.url=C||"",this.serviceLocation=x||C||"",this.dvbPriority=B||1,this.dvbWeight=q||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.queryParams={}};bi.DEFAULT_DVB_PRIORITY=1,bi.DEFAULT_DVB_WEIGHT=1;var zi=bi,Us=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0},qt=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.id=null,this.inband=!1,this.type="encoder",this.applicationScheme=null,this.wallClockTime=null,this.presentationTime=NaN,this.UTCTiming=null},Vt=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.defaultServiceLocation=null,this.defaultServiceLocationArray=[],this.queryBeforeStart=!1,this.serverUrl=null,this.clientRequirement=!0};function Kt(D,C){for(var x=0;x<C.length;x++){var B=C[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}var at=(function(){function D(){(function(B,q){if(!(B instanceof q))throw new TypeError("Cannot call a class as a function")})(this,D),this.schemeIdUri=null,this.value=null,this.id=null}var C,x;return C=D,(x=[{key:"init",value:function(B){return B&&(this.schemeIdUri=B.schemeIdUri?B.schemeIdUri:null,this.value=B.value?B.value:null,this.id=B.id?B.id:null,B[d.Z.DVB_URL]&&(this.dvbUrl=B[d.Z.DVB_URL]),B[d.Z.DVB_MIMETYPE]&&(this.dvbMimeType=B[d.Z.DVB_MIMETYPE]),B[d.Z.DVB_FONTFAMILY]&&(this.dvbFontFamily=B[d.Z.DVB_FONTFAMILY])),this}}])&&Kt(C.prototype,x),D})(),Ot=g(3101),ct=g.n(Ot);function It(){return{areEqual:function(D,C){return ct()(D,C)}}}It.__dashjs_factory_name="ObjectUtils";var sn=b.Z.getSingletonFactory(It),fn=g(7803),Rn=function D(C,x){(function(B,q){if(!(B instanceof q))throw new TypeError("Cannot call a class as a function")})(this,D),this.url=C||"",this.serviceLocation=x||null,this.queryParams={}},In=function D(C,x,B){(function(q,Y){if(!(q instanceof Y))throw new TypeError("Cannot call a class as a function")})(this,D),this.url=C||"",this.serviceLocation=x||null,this.ttl=B||NaN,this.queryParams={}};function Jt(D,C){var x=Object.keys(D);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(D);C&&(B=B.filter((function(q){return Object.getOwnPropertyDescriptor(D,q).enumerable}))),x.push.apply(x,B)}return x}function Pt(D){for(var C=1;C<arguments.length;C++){var x=arguments[C]!=null?arguments[C]:{};C%2?Jt(Object(x),!0).forEach((function(B){bn(D,B,x[B])})):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(x)):Jt(Object(x)).forEach((function(B){Object.defineProperty(D,B,Object.getOwnPropertyDescriptor(x,B))}))}return D}function bn(D,C,x){return C in D?Object.defineProperty(D,C,{value:x,enumerable:!0,configurable:!0,writable:!0}):D[C]=x,D}function Sn(D,C){var x;if(typeof Symbol>"u"||D[Symbol.iterator]==null){if(Array.isArray(D)||(x=Gn(D))||C){x&&(D=x);var B=0,q=function(){};return{s:q,n:function(){return B>=D.length?{done:!0}:{done:!1,value:D[B++]}},e:function(re){throw re},f:q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Y,k=!0,K=!1;return{s:function(){x=D[Symbol.iterator]()},n:function(){var re=x.next();return k=re.done,re},e:function(re){K=!0,Y=re},f:function(){try{k||x.return==null||x.return()}finally{if(K)throw Y}}}}function Gn(D,C){if(D){if(typeof D=="string")return tr(D,C);var x=Object.prototype.toString.call(D).slice(8,-1);return x==="Object"&&D.constructor&&(x=D.constructor.name),x==="Map"||x==="Set"?Array.from(D):x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x)?tr(D,C):void 0}}function tr(D,C){(C==null||C>D.length)&&(C=D.length);for(var x=0,B=new Array(C);x<C;x++)B[x]=D[x];return B}function mr(){var D,C,x,B,q=this.context,Y=(0,ut.Z)(q).getInstance(),k=Number.isInteger||function(P){return typeof P=="number"&&isFinite(P)&&Math.floor(P)===P};function K(P,te){if(!P)throw new Error("adaptation is not defined");if(!te)throw new Error("type is not defined");if(P.Representation_asArray&&P.Representation_asArray.length){var J=Le(P.Representation_asArray[0]);if(J&&J.length>0&&fn.Y.indexOf(J[0].schemeIdUri)>=0)return te===u.Z.IMAGE}if(P.ContentComponent_asArray&&P.ContentComponent_asArray.length>0){if(P.ContentComponent_asArray.length>1)return te===u.Z.MUXED;if(P.ContentComponent_asArray[0].contentType===te)return!0}var Q=te===u.Z.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(te);if(P.Representation_asArray&&P.Representation_asArray.length){var j=P.Representation_asArray[0].codecs;if(Q.test(j))return!0}if(P.hasOwnProperty(d.Z.MIME_TYPE))return Q.test(P.mimeType);if(P.Representation_asArray){for(var Ae,ve=0;ve<P.Representation_asArray.length;ve++)if((Ae=P.Representation_asArray[ve]).hasOwnProperty(d.Z.MIME_TYPE))return Q.test(Ae.mimeType)}return!1}function re(P){if(!P)throw new Error("adaptation is not defined");if(P.hasOwnProperty(d.Z.SEGMENT_TEMPLATE)||P.hasOwnProperty(d.Z.SEGMENT_TIMELINE)||P.hasOwnProperty(d.Z.SEGMENT_LIST)||P.hasOwnProperty(d.Z.SEGMENT_BASE))return!0;if(P.Representation_asArray&&P.Representation_asArray.length>0){var te=P.Representation_asArray[0];if(te.hasOwnProperty(d.Z.SEGMENT_TEMPLATE)||te.hasOwnProperty(d.Z.SEGMENT_TIMELINE)||te.hasOwnProperty(d.Z.SEGMENT_LIST)||te.hasOwnProperty(d.Z.SEGMENT_BASE))return!0}return!1}function ge(P){return K(P,u.Z.VIDEO)}function ie(P){return K(P,u.Z.TEXT)}function z(P){return K(P,u.Z.IMAGE)}function oe(P){return P&&Array.isArray(P.Representation_asArray)&&P.Representation_asArray.sort((function(te,J){return te.bandwidth-J.bandwidth})),P}function se(P,te){return P&&P.Period_asArray&&k(te)&&P.Period_asArray[te]?P.Period_asArray[te].AdaptationSet_asArray:[]}function Ne(P){return P&&P.Period_asArray?P.Period_asArray:[]}function be(P){var te=!1;return P&&P.hasOwnProperty("type")&&(te=P.type===d.Z.DYNAMIC),te}function Le(P){return P&&P.EssentialProperty_asArray&&P.EssentialProperty_asArray.length?P.EssentialProperty_asArray.map((function(te){return{schemeIdUri:te.schemeIdUri,value:te.value}})):null}function Me(P){if(!P||!P.S_asArray)return NaN;var te=P.S_asArray[0],J=P.S_asArray[1];return te.hasOwnProperty("d")?te.d:J.t-te.t}function le(P,te){if(!P)throw new Error("Period cannot be null or undefined");var J=Zr.DEFAULT_ID+"_"+te;return P.hasOwnProperty(d.Z.ID)&&P.id.length>0&&P.id!=="__proto__"&&(J=P.id),J}function Re(P,te,J){var Q,j=[];if(!P)return j;for(Q=0;Q<P.length;Q++){var Ae=new Us;if(Ae.timescale=1,Ae.representation=te,!P[Q].hasOwnProperty(u.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");Ae.schemeIdUri=P[Q].schemeIdUri,P[Q].hasOwnProperty(d.Z.TIMESCALE)&&(Ae.timescale=P[Q].timescale),P[Q].hasOwnProperty(d.Z.VALUE)&&(Ae.value=P[Q].value),j.push(Ae),Ae.period=J}return j}function ue(P){var te=[],J=P.BaseURL_asArray||[P.baseUri],Q=!1;return J.some((function(j){if(j){var Ae=new zi,ve=j.__text||j;return Y.isRelative(ve)&&(Q=!0,P.baseUri&&(ve=Y.resolve(ve,P.baseUri))),Ae.url=ve,j.hasOwnProperty(d.Z.SERVICE_LOCATION)&&j.serviceLocation.length?Ae.serviceLocation=j.serviceLocation:Ae.serviceLocation=ve,j.hasOwnProperty(d.Z.DVB_PRIORITY)&&(Ae.dvbPriority=j[d.Z.DVB_PRIORITY]),j.hasOwnProperty(d.Z.DVB_WEIGHT)&&(Ae.dvbWeight=j[d.Z.DVB_WEIGHT]),j.hasOwnProperty(d.Z.AVAILABILITY_TIME_OFFSET)&&(Ae.availabilityTimeOffset=j[d.Z.AVAILABILITY_TIME_OFFSET]),j.hasOwnProperty(d.Z.AVAILABILITY_TIME_COMPLETE)&&(Ae.availabilityTimeComplete=j[d.Z.AVAILABILITY_TIME_COMPLETE]!=="false"),te.push(Ae),Q}})),te}function xe(P){var te=new Vt;return te.serverUrl=P.__text,P.hasOwnProperty(d.Z.DEFAULT_SERVICE_LOCATION)&&(te.defaultServiceLocation=P[d.Z.DEFAULT_SERVICE_LOCATION],te.defaultServiceLocationArray=te.defaultServiceLocation.split(" ")),P.hasOwnProperty(d.Z.QUERY_BEFORE_START)&&(te.queryBeforeStart=P[d.Z.QUERY_BEFORE_START].toLowerCase()==="true"),P.hasOwnProperty(d.Z.CLIENT_REQUIREMENT)&&(te.clientRequirement=P[d.Z.CLIENT_REQUIREMENT].toLowerCase()!=="false"),te}return D={getIsTypeOf:K,getIsText:ie,getIsFragmented:re,getProducerReferenceTimesForAdaptation:function(P){var te=P&&P.hasOwnProperty(d.Z.PRODUCERREFERENCETIME_ASARRAY)?P[d.Z.PRODUCERREFERENCETIME_ASARRAY]:[];(P&&P.hasOwnProperty(d.Z.REPRESENTATION_ASARRAY)?P[d.Z.REPRESENTATION_ASARRAY]:[]).forEach((function(Q){var j;Q.hasOwnProperty(d.Z.PRODUCERREFERENCETIME_ASARRAY)&&te.push.apply(te,(function(Ae){if(Array.isArray(Ae))return tr(Ae)})(j=Q[d.Z.PRODUCERREFERENCETIME_ASARRAY])||(function(Ae){if(typeof Symbol<"u"&&Symbol.iterator in Object(Ae))return Array.from(Ae)})(j)||Gn(j)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})())}));var J=[];return te.forEach((function(Q){var j=new qt;Q.hasOwnProperty(d.Z.ID)&&(j[d.Z.ID]=Q[d.Z.ID],Q.hasOwnProperty(d.Z.WALL_CLOCK_TIME)&&(j[d.Z.WALL_CLOCK_TIME]=Q[d.Z.WALL_CLOCK_TIME],Q.hasOwnProperty(d.Z.PRESENTATION_TIME)&&(j[d.Z.PRESENTATION_TIME]=Q[d.Z.PRESENTATION_TIME],Q.hasOwnProperty(d.Z.INBAND)&&(j[d.Z.INBAND]=Q[d.Z.INBAND]!=="false"),Q.hasOwnProperty(d.Z.TYPE)&&(j[d.Z.TYPE]=Q[d.Z.TYPE]),J.push(j))))})),J},getLanguageForAdaptation:function(P){var te="";return P&&P.hasOwnProperty(d.Z.LANG)&&(te=P.lang),te},getViewpointForAdaptation:function(P){return P&&P.hasOwnProperty(d.Z.VIEWPOINT_ASARRAY)&&P[d.Z.VIEWPOINT_ASARRAY].length?P[d.Z.VIEWPOINT_ASARRAY].map((function(te){return new at().init(te)})):[]},getRolesForAdaptation:function(P){return P&&P.hasOwnProperty(d.Z.ROLE_ASARRAY)&&P[d.Z.ROLE_ASARRAY].length?P[d.Z.ROLE_ASARRAY].map((function(te){return new at().init(te)})):[]},getAccessibilityForAdaptation:function(P){return P&&P.hasOwnProperty(d.Z.ACCESSIBILITY_ASARRAY)&&P[d.Z.ACCESSIBILITY_ASARRAY].length?P[d.Z.ACCESSIBILITY_ASARRAY].map((function(te){return new at().init(te)})):[]},getAudioChannelConfigurationForAdaptation:function(P){return P&&P.hasOwnProperty(d.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&P[d.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?P[d.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map((function(te){return new at().init(te)})):[]},getAudioChannelConfigurationForRepresentation:function(P){return P&&P.hasOwnProperty(d.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&P[d.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?P[d.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map((function(te){return new at().init(te)})):[]},getAdaptationForIndex:function(P,te,J){var Q=se(te,J);return Q.length>0&&k(P)?Q[P]:null},getIndexForAdaptation:function(P,te,J){if(!P)return-1;for(var Q=se(te,J),j=0;j<Q.length;j++)if(sn(q).getInstance().areEqual(Q[j],P))return j;return-1},getAdaptationForId:function(P,te,J){var Q,j,Ae=se(te,J);for(Q=0,j=Ae.length;Q<j;Q++)if(Ae[Q].hasOwnProperty(d.Z.ID)&&Ae[Q].id===P)return Ae[Q];return null},getAdaptationsForType:function(P,te,J){var Q,j,Ae=se(P,te),ve=[];for(Q=0,j=Ae.length;Q<j;Q++)K(Ae[Q],J)&&ve.push(oe(Ae[Q]));return ve},getRealPeriods:Ne,getRealPeriodForIndex:function(P,te){var J=Ne(te);return J.length>0&&k(P)?J[P]:null},getCodec:function(P,te,J){var Q=null;if(P&&P.Representation_asArray&&P.Representation_asArray.length>0){var j=k(te)&&te>=0&&te<P.Representation_asArray.length?P.Representation_asArray[te]:P.Representation_asArray[0];j&&(Q=j.mimeType+';codecs="'+j.codecs+'"',J&&j.width!==void 0&&(Q+=';width="'+j.width+'";height="'+j.height+'"'))}return Q&&(Q=Q.replace(/\sprofiles=[^;]*/g,"")),Q},getSelectionPriority:function(P){try{var te=P&&P.selectionPriority!==void 0?parseInt(P.selectionPriority):1;return isNaN(te)?1:te}catch{return 1}},getMimeType:function(P){return P&&P.Representation_asArray&&P.Representation_asArray.length>0?P.Representation_asArray[0].mimeType:null},getKID:function(P){return P&&P.hasOwnProperty(d.Z.CENC_DEFAULT_KID)?P[d.Z.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(P){if(!P||!Array.isArray(P.Label_asArray))return[];for(var te=[],J=0;J<P.Label_asArray.length;J++)te.push({lang:P.Label_asArray[J].lang,text:P.Label_asArray[J].__text||P.Label_asArray[J]});return te},getContentProtectionData:function(P){return P&&P.hasOwnProperty(d.Z.CONTENTPROTECTION_ASARRAY)&&P.ContentProtection_asArray.length!==0?P.ContentProtection_asArray:null},getIsDynamic:be,getId:function(P){return P&&P[d.Z.ID]||null},hasProfile:function(P,te){var J=!1;return P&&P.profiles&&P.profiles.length>0&&(J=P.profiles.indexOf(te)!==-1),J},getDuration:function(P){return P&&P.hasOwnProperty(d.Z.MEDIA_PRESENTATION_DURATION)?P.mediaPresentationDuration:P&&P.type=="dynamic"?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(P){return P&&P.bandwidth?P.bandwidth:NaN},getManifestUpdatePeriod:function(P){var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,J=NaN;return P&&P.hasOwnProperty(d.Z.MINIMUM_UPDATE_PERIOD)&&(J=P.minimumUpdatePeriod),isNaN(J)?J:Math.max(J-te,1)},getPublishTime:function(P){return P&&P.hasOwnProperty(d.Z.PUBLISH_TIME)?new Date(P[d.Z.PUBLISH_TIME]):null},getRepresentationCount:function(P){return P&&Array.isArray(P.Representation_asArray)?P.Representation_asArray.length:0},getBitrateListForAdaptation:function(P){var te=oe(P);return(te&&Array.isArray(te.Representation_asArray)?te.Representation_asArray:[]).map((function(J){return{bandwidth:J.bandwidth,width:J.width||0,height:J.height||0,scanType:J.scanType||null,id:J.id||null}}))},getRepresentationFor:function(P,te){return te&&te.Representation_asArray&&te.Representation_asArray.length>0&&k(P)?te.Representation_asArray[P]:null},getRepresentationsForAdaptation:function(P){var te,J,Q,j,Ae=[],ve=(function(je){if(je&&je.period&&k(je.period.index)){var Xe=je.period.mpd.manifest.Period_asArray[je.period.index];if(Xe&&Xe.AdaptationSet_asArray&&k(je.index))return oe(Xe.AdaptationSet_asArray[je.index])}})(P);if(ve&&ve.Representation_asArray){if(P&&P.period&&k(P.period.index)){var Ce=ue(P.period.mpd.manifest);Ce&&(J=Ce[0])}for(var Ee=0,ae=ve.Representation_asArray.length;Ee<ae;++Ee){var Se=ve.Representation_asArray[Ee],Pe=new li;if(Pe.index=Ee,Pe.adaptation=P,Se.hasOwnProperty(d.Z.ID)&&(Pe.id=Se.id),Se.hasOwnProperty(d.Z.CODECS)&&(Pe.codecs=Se.codecs),Se.hasOwnProperty(d.Z.MIME_TYPE)&&(Pe.mimeType=Se[d.Z.MIME_TYPE]),Se.hasOwnProperty(d.Z.CODEC_PRIVATE_DATA)&&(Pe.codecPrivateData=Se.codecPrivateData),Se.hasOwnProperty(d.Z.BANDWITH)&&(Pe.bandwidth=Se.bandwidth),Se.hasOwnProperty(d.Z.WIDTH)&&(Pe.width=Se.width),Se.hasOwnProperty(d.Z.HEIGHT)&&(Pe.height=Se.height),Se.hasOwnProperty(d.Z.SCAN_TYPE)&&(Pe.scanType=Se.scanType),Se.hasOwnProperty(d.Z.MAX_PLAYOUT_RATE)&&(Pe.maxPlayoutRate=Se.maxPlayoutRate),Se.hasOwnProperty(d.Z.SEGMENT_BASE)?(te=Se.SegmentBase,Pe.segmentInfoType=d.Z.SEGMENT_BASE):Se.hasOwnProperty(d.Z.SEGMENT_LIST)?(te=Se.SegmentList).hasOwnProperty(d.Z.SEGMENT_TIMELINE)?Pe.segmentInfoType=d.Z.SEGMENT_TIMELINE:Pe.segmentInfoType=d.Z.SEGMENT_LIST:Se.hasOwnProperty(d.Z.SEGMENT_TEMPLATE)?((te=Se.SegmentTemplate).hasOwnProperty(d.Z.SEGMENT_TIMELINE)?Pe.segmentInfoType=d.Z.SEGMENT_TIMELINE:Pe.segmentInfoType=d.Z.SEGMENT_TEMPLATE,te.hasOwnProperty(d.Z.INITIALIZATION_MINUS)&&(Pe.initialization=te.initialization.split("$Bandwidth$").join(Se.bandwidth).split("$RepresentationID$").join(Se.id))):Pe.segmentInfoType=d.Z.BASE_URL,Pe.essentialProperties=Le(Se),te){if(te.hasOwnProperty(d.Z.INITIALIZATION)){var We=te.Initialization;We.hasOwnProperty(d.Z.SOURCE_URL)&&(Pe.initialization=We.sourceURL),We.hasOwnProperty(d.Z.RANGE)&&(Pe.range=We.range)}else ie(ve)&&re(ve)&&ve.mimeType&&ve.mimeType.indexOf("application/mp4")===-1&&(Pe.range=0);te.hasOwnProperty(d.Z.TIMESCALE)&&(Pe.timescale=te.timescale),te.hasOwnProperty(d.Z.DURATION)?Pe.segmentDuration=te.duration/Pe.timescale:Se.hasOwnProperty(d.Z.SEGMENT_TEMPLATE)&&(te=Se.SegmentTemplate).hasOwnProperty(d.Z.SEGMENT_TIMELINE)&&(Pe.segmentDuration=Me(te.SegmentTimeline)/Pe.timescale),te.hasOwnProperty(d.Z.MEDIA)&&(Pe.media=te.media),te.hasOwnProperty(d.Z.START_NUMBER)&&(Pe.startNumber=te.startNumber),te.hasOwnProperty(d.Z.INDEX_RANGE)&&(Pe.indexRange=te.indexRange),te.hasOwnProperty(d.Z.PRESENTATION_TIME_OFFSET)&&(Pe.presentationTimeOffset=te.presentationTimeOffset/Pe.timescale),te.hasOwnProperty(d.Z.AVAILABILITY_TIME_OFFSET)?Pe.availabilityTimeOffset=te.availabilityTimeOffset:J&&J.availabilityTimeOffset!==void 0&&(Pe.availabilityTimeOffset=J.availabilityTimeOffset),te.hasOwnProperty(d.Z.AVAILABILITY_TIME_COMPLETE)?Pe.availabilityTimeComplete=te.availabilityTimeComplete!=="false":J&&J.availabilityTimeComplete!==void 0&&(Pe.availabilityTimeComplete=J.availabilityTimeComplete)}Pe.MSETimeOffset=(j=(Q=Pe).presentationTimeOffset,Q.adaptation.period.start-j),Pe.path=[P.period.index,P.index,Ee],Ae.push(Pe)}}return Ae},getAdaptationsForPeriod:function(P){var te,J,Q,j=P&&k(P.index)?P.mpd.manifest.Period_asArray[P.index]:null,Ae=[];if(j&&j.AdaptationSet_asArray)for(Q=0;Q<j.AdaptationSet_asArray.length;Q++)J=j.AdaptationSet_asArray[Q],te=new gr,J.hasOwnProperty(d.Z.ID)&&(te.id=J.id),te.index=Q,te.period=P,K(J,u.Z.MUXED)?te.type=u.Z.MUXED:K(J,u.Z.AUDIO)?te.type=u.Z.AUDIO:ge(J)?te.type=u.Z.VIDEO:ie(J)?te.type=u.Z.TEXT:z(J)?te.type=u.Z.IMAGE:C.warn("Unknown Adaptation stream type"),Ae.push(te);return Ae},getRegularPeriods:function(P){var te,J,Q=!!P&&be(P.manifest),j=[],Ae=null,ve=null,Ce=null,Ee=null;for(J=0,te=P&&P.manifest&&P.manifest.Period_asArray?P.manifest.Period_asArray.length:0;J<te;J++)(ve=P.manifest.Period_asArray[J]).hasOwnProperty(d.Z.START)?(Ee=new Zr).start=ve.start:Ae!==null&&Ae.hasOwnProperty(d.Z.DURATION)&&Ce!==null?(Ee=new Zr).start=parseFloat((Ce.start+Ce.duration).toFixed(5)):J!==0||Q||((Ee=new Zr).start=0),Ce!==null&&isNaN(Ce.duration)&&(Ee!==null?Ce.duration=parseFloat((Ee.start-Ce.start).toFixed(5)):C.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),Ee!==null&&(Ee.id=le(ve,J),Ee.index=J,Ee.mpd=P,ve.hasOwnProperty(d.Z.DURATION)&&(Ee.duration=ve.duration),Ce&&(Ce.nextPeriodId=Ee.id),j.push(Ee),Ae=ve,Ce=Ee),ve=null,Ee=null;return j.length===0||Ce!==null&&isNaN(Ce.duration)&&(Ce.duration=parseFloat(((function(ae){(function(){if(!x||!x.hasOwnProperty("error"))throw new Error(u.Z.MISSING_CONFIG_ERROR)})();var Se,Pe=be(ae.mpd.manifest);return ae.mpd.manifest.mediaPresentationDuration?Se=ae.mpd.manifest.mediaPresentationDuration:ae.duration?Se=ae.duration:Pe?Se=Number.POSITIVE_INFINITY:x.error(new fe.Z(X.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",ae)),Se})(Ce)-Ce.start).toFixed(5))),j},getMpd:function(P){var te=new ri;return P&&(te.manifest=P,P.hasOwnProperty(d.Z.AVAILABILITY_START_TIME)?te.availabilityStartTime=new Date(P.availabilityStartTime.getTime()):P.loadedTime&&(te.availabilityStartTime=new Date(P.loadedTime.getTime())),P.hasOwnProperty(d.Z.AVAILABILITY_END_TIME)&&(te.availabilityEndTime=new Date(P.availabilityEndTime.getTime())),P.hasOwnProperty(d.Z.MINIMUM_UPDATE_PERIOD)&&(te.minimumUpdatePeriod=P.minimumUpdatePeriod),P.hasOwnProperty(d.Z.MEDIA_PRESENTATION_DURATION)&&(te.mediaPresentationDuration=P.mediaPresentationDuration),P.hasOwnProperty(d.Z.SUGGESTED_PRESENTATION_DELAY)&&(te.suggestedPresentationDelay=P.suggestedPresentationDelay),P.hasOwnProperty(d.Z.TIMESHIFT_BUFFER_DEPTH)&&(te.timeShiftBufferDepth=P.timeShiftBufferDepth),P.hasOwnProperty(d.Z.MAX_SEGMENT_DURATION)&&(te.maxSegmentDuration=P.maxSegmentDuration),P.hasOwnProperty(d.Z.PUBLISH_TIME)&&(te.publishTime=new Date(P.publishTime))),te},getEventsForPeriod:function(P){var te,J,Q=P&&P.mpd&&P.mpd.manifest?P.mpd.manifest:null,j=Q?Q.Period_asArray:null,Ae=j&&P&&k(P.index)?j[P.index].EventStream_asArray:null,ve=[];if(Ae)for(te=0;te<Ae.length;te++){var Ce=new Us;if(Ce.period=P,Ce.timescale=1,!Ae[te].hasOwnProperty(u.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(Ce.schemeIdUri=Ae[te][u.Z.SCHEME_ID_URI],Ae[te].hasOwnProperty(d.Z.TIMESCALE)&&(Ce.timescale=Ae[te][d.Z.TIMESCALE]),Ae[te].hasOwnProperty(d.Z.VALUE)&&(Ce.value=Ae[te][d.Z.VALUE]),Ae[te].hasOwnProperty(d.Z.PRESENTATION_TIME_OFFSET)&&(Ce.presentationTimeOffset=Ae[te][d.Z.PRESENTATION_TIME_OFFSET]),J=0;Ae[te].Event_asArray&&J<Ae[te].Event_asArray.length;J++){var Ee=Ae[te].Event_asArray[J],ae=new ii;ae.presentationTime=0,ae.eventStream=Ce,Ee.hasOwnProperty(d.Z.PRESENTATION_TIME)&&(ae.presentationTime=Ee.presentationTime);var Se=Ce.presentationTimeOffset?Ce.presentationTimeOffset/Ce.timescale:0;ae.calculatedPresentationTime=ae.presentationTime/Ce.timescale+P.start-Se,Ee.hasOwnProperty(d.Z.DURATION)&&(ae.duration=Ee.duration/Ce.timescale),Ee.hasOwnProperty(d.Z.ID)?ae.id=Ee.id:ae.id=null,Ee.Signal&&Ee.Signal.Binary?ae.messageData=B.decodeArray(Ee.Signal.Binary.toString()):ae.messageData=Ee.messageData||Ee.__cdata||Ee.__text,ve.push(ae)}}return ve},getEssentialPropertiesForAdaptation:function(P){var te={};if(P&&P.hasOwnProperty(d.Z.ESSENTIAL_PROPERTY_ASARRAY)){var J,Q=Sn(P.EssentialProperty_asArray);try{for(Q.s();!(J=Q.n()).done;){var j=J.value;j.hasOwnProperty(u.Z.SCHEME_ID_URI)&&(te[j[u.Z.SCHEME_ID_URI]]=Pt({},j))}}catch(Ae){Q.e(Ae)}finally{Q.f()}}return te},getEssentialPropertiesAsArrayForAdaptation:function(P){return P&&P.hasOwnProperty(d.Z.ESSENTIAL_PROPERTY_ASARRAY)&&P.EssentialProperty_asArray.length?P.EssentialProperty_asArray.map((function(te){return new at().init(te)})):[]},getEssentialPropertiesForRepresentation:Le,getEventStreamForAdaptationSet:function(P,te,J){var Q,j,Ae;return P&&P.Period_asArray&&te&&te.period&&k(te.period.index)&&(j=P.Period_asArray[te.period.index])&&j.AdaptationSet_asArray&&k(te.index)&&(Ae=j.AdaptationSet_asArray[te.index])&&(Q=Ae.InbandEventStream_asArray),Re(Q,null,J)},getEventStreamForRepresentation:function(P,te,J){var Q,j,Ae,ve;return P&&P.Period_asArray&&te&&te.adaptation&&te.adaptation.period&&k(te.adaptation.period.index)&&(j=P.Period_asArray[te.adaptation.period.index])&&j.AdaptationSet_asArray&&k(te.adaptation.index)&&(Ae=j.AdaptationSet_asArray[te.adaptation.index])&&Ae.Representation_asArray&&k(te.index)&&(ve=Ae.Representation_asArray[te.index])&&(Q=ve.InbandEventStream_asArray),Re(Q,te,J)},getUTCTimingSources:function(P){var te=be(P),J=!!P&&P.hasOwnProperty(d.Z.AVAILABILITY_START_TIME),Q=P?P.UTCTiming_asArray:null,j=[];return(te||J)&&Q&&Q.forEach((function(Ae){var ve=new ui.Z;Ae.hasOwnProperty(u.Z.SCHEME_ID_URI)&&(ve.schemeIdUri=Ae.schemeIdUri,Ae.hasOwnProperty(d.Z.VALUE)&&(ve.value=Ae.value.toString(),j.push(ve)))})),j},getBaseURLsFromElement:ue,getRepresentationSortFunction:function(){return function(P,te){return P.bandwidth-te.bandwidth}},getContentSteering:function(P){if(P&&P.hasOwnProperty(d.Z.CONTENT_STEERING_AS_ARRAY))return xe(P[d.Z.CONTENT_STEERING_AS_ARRAY][0])},getLocation:function(P){return P&&P.hasOwnProperty(d.Z.LOCATION_AS_ARRAY)?P[d.Z.LOCATION_AS_ARRAY].map((function(te){var J=te.__text||te,Q=te.hasOwnProperty(d.Z.SERVICE_LOCATION)?te[d.Z.SERVICE_LOCATION]:null;return new Rn(J,Q)})):[]},getPatchLocation:function(P){return P&&P.hasOwnProperty(d.Z.PATCH_LOCATION_AS_ARRAY)?P[d.Z.PATCH_LOCATION_AS_ARRAY].map((function(te){var J=te.__text||te,Q=te.hasOwnProperty(d.Z.SERVICE_LOCATION)?te[d.Z.SERVICE_LOCATION]:null,j=te.hasOwnProperty(d.Z.TTL)?1e3*parseFloat(te[d.Z.TTL]):NaN;return new In(J,Q,j)})):[]},getSuggestedPresentationDelay:function(P){return P&&P.hasOwnProperty(d.Z.SUGGESTED_PRESENTATION_DELAY)?P.suggestedPresentationDelay:null},getAvailabilityStartTime:function(P){return P&&P.hasOwnProperty(d.Z.AVAILABILITY_START_TIME)&&P.availabilityStartTime!==null?P.availabilityStartTime.getTime():null},getServiceDescriptions:function(P){var te=[];if(P&&P.hasOwnProperty(d.Z.SERVICE_DESCRIPTION)){var J,Q=Sn(P.ServiceDescription_asArray);try{for(Q.s();!(J=Q.n()).done;){var j=J.value,Ae=null,ve=null,Ce=null,Ee=null,ae=null,Se=null,Pe=null;for(var We in j)j.hasOwnProperty(We)&&(We===d.Z.ID?Ae=j[We]:We===d.Z.SERVICE_DESCRIPTION_SCOPE?ve=j[We].schemeIdUri:We===d.Z.SERVICE_DESCRIPTION_LATENCY?Ce={target:parseInt(j[We].target),max:parseInt(j[We].max),min:parseInt(j[We].min),referenceId:parseInt(j[We].referenceId)}:We===d.Z.SERVICE_DESCRIPTION_PLAYBACK_RATE?Ee={max:parseFloat(j[We].max),min:parseFloat(j[We].min)}:We===d.Z.SERVICE_DESCRIPTION_OPERATING_QUALITY?ae={mediaType:j[We].mediaType,max:parseInt(j[We].max),min:parseInt(j[We].min),target:parseInt(j[We].target),type:j[We].type,maxQualityDifference:parseInt(j[We].maxQualityDifference)}:We===d.Z.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH?Se={mediaType:j[We].mediaType,max:parseInt(j[We].max),min:parseInt(j[We].min),target:parseInt(j[We].target)}:We===d.Z.CONTENT_STEERING&&(Pe=xe(j[We])));te.push({id:Ae,schemeIdUri:ve,latency:Ce,playbackRate:Ee,operatingQuality:ae,operatingBandwidth:Se,contentSteering:Pe})}}catch(je){Q.e(je)}finally{Q.f()}}return te},getSegmentAlignment:function(P){return!(!P||!P.hasOwnProperty(d.Z.SEGMENT_ALIGNMENT))&&P[d.Z.SEGMENT_ALIGNMENT]==="true"},getSubSegmentAlignment:function(P){return!(!P||!P.hasOwnProperty(d.Z.SUB_SEGMENT_ALIGNMENT))&&P[d.Z.SUB_SEGMENT_ALIGNMENT]==="true"},getSupplementalPropertiesForAdaptation:function(P){var te={};if(P&&P.hasOwnProperty(d.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var J,Q=Sn(P.SupplementalProperty_asArray);try{for(Q.s();!(J=Q.n()).done;){var j=J.value;j.hasOwnProperty(u.Z.SCHEME_ID_URI)&&(te[j[u.Z.SCHEME_ID_URI]]=Pt({},j))}}catch(Ae){Q.e(Ae)}finally{Q.f()}}return te},getSupplementalPropertiesAsArrayForAdaptation:function(P){return P&&P.hasOwnProperty(d.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&P.SupplementalProperty_asArray.length?P.SupplementalProperty_asArray.map((function(te){return new at().init(te)})):[]},getSupplementalPropertiesForRepresentation:function(P){var te={};if(P&&P.hasOwnProperty(d.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var J,Q=Sn(P.SupplementalProperty_asArray);try{for(Q.s();!(J=Q.n()).done;){var j=J.value;j.hasOwnProperty(u.Z.SCHEME_ID_URI)&&(te[j[u.Z.SCHEME_ID_URI]]=Pt({},j))}}catch(Ae){Q.e(Ae)}finally{Q.f()}}return te},getSupplementalPropertiesAsArrayForRepresentation:function(P){return P&&P.hasOwnProperty(d.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&P.SupplementalProperty_asArray.length?P.SupplementalProperty_asArray.map((function(te){return new at().init(te)})):[]},setConfig:function(P){P&&(P.errHandler&&(x=P.errHandler),P.BASE64&&(B=P.BASE64))}},C=(0,I.Z)(q).getInstance().getLogger(D),D}mr.__dashjs_factory_name="DashManifestModel";var xn=b.Z.getSingletonFactory(mr),Ht=g(703);function Yt(D,C){var x;if(typeof Symbol>"u"||D[Symbol.iterator]==null){if(Array.isArray(D)||(x=(function(re,ge){if(re){if(typeof re=="string")return hn(re,ge);var ie=Object.prototype.toString.call(re).slice(8,-1);return ie==="Object"&&re.constructor&&(ie=re.constructor.name),ie==="Map"||ie==="Set"?Array.from(re):ie==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ie)?hn(re,ge):void 0}})(D))||C){x&&(D=x);var B=0,q=function(){};return{s:q,n:function(){return B>=D.length?{done:!0}:{done:!1,value:D[B++]}},e:function(re){throw re},f:q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Y,k=!0,K=!1;return{s:function(){x=D[Symbol.iterator]()},n:function(){var re=x.next();return k=re.done,re},e:function(re){K=!0,Y=re},f:function(){try{k||x.return==null||x.return()}finally{if(K)throw Y}}}}function hn(D,C){(C==null||C>D.length)&&(C=D.length);for(var x=0,B=new Array(C);x<C;x++)B[x]=D[x];return B}function Mn(){var D,C,x,B,q,Y,k,K,re,ge,ie=this.context,z=(0,_.Z)(ie).getInstance(),oe=(0,Ie.Z)(ie).getInstance();function se(){x={pr:1,nor:null,st:null,sf:null,sid:"".concat(Ht.Z.generateUuid()),cid:null},re={},K={},ge={},be()}function Ne(){be()}function be(){if(Y){var j=Y.getStreamController();if(j&&typeof j.getActiveStream=="function"){var Ae=j.getActiveStream();Ae&&(k=Ae.getProcessors())}}}function Le(j,Ae){var ve,Ce={},Ee=Yt(Ae);try{for(Ee.s();!(ve=Ee.n()).done;){var ae=ve.value;j[ae]&&(Ce[ae]=j[ae])}}catch(Se){Ee.e(Se)}finally{Ee.f()}return Ce}function Me(j){var Ae=oe.get().streaming.cmcd.enabledKeys;return j.filter((function(ve){return Ae.includes(ve)}))}function le(j){try{return j.type===Be.w.MPD_TYPE?((ve=Re()).ot="m",ve):j.type===Be.w.MEDIA_SEGMENT_TYPE?(Ae=j.mediaType,ge.hasOwnProperty(Ae)||(ge[Ae]=!1),K.hasOwnProperty(Ae)||(K[Ae]=!1),re.hasOwnProperty(Ae)||(re[Ae]=!1),(function(Ce){var Ee,ae=Re(),Se=(function(yt){try{var un=yt.quality,Ve=yt.mediaInfo.bitrateList;return parseInt(Ve[un].bandwidth/1e3)}catch{return null}})(Ce),Pe=(function(yt){try{return isNaN(yt.duration)?NaN:Math.round(1e3*yt.duration)}catch{return null}})(Ce),We=(function(yt){try{return 100*parseInt(B.getThroughputHistory().getSafeAverageThroughput(yt)/100)}catch{return null}})(Ce.mediaType),je=(function(yt){try{var un=x.pr,Ve=q.getCurrentBufferLevel(yt);return isNaN(un)||isNaN(Ve)?null:100*parseInt(Ve/un*10)}catch{return null}})(Ce.mediaType),Xe=ue(Ce.mediaType),ze=(function(yt){try{var un=B.getTopBitrateInfoFor(yt);return Math.round(un.bitrate/1e3)}catch{return null}})(Ce.mediaType),St=x.pr,At=(function(yt){if(k&&k.length!==0){var un,Ve=Yt(k);try{for(Ve.s();!(un=Ve.n()).done;){var tt=un.value;if(tt.getType()===yt)return tt.probeNextRequest()}}catch(Nt){Ve.e(Nt)}finally{Ve.f()}}})(Ce.mediaType);Ce.mediaType===u.Z.VIDEO&&(Ee="v"),Ce.mediaType===u.Z.AUDIO&&(Ee="a"),Ce.mediaType===u.Z.TEXT&&(Ee=Ce.mediaInfo.mimeType==="application/mp4"?"tt":"c");var pt=oe.get().streaming.cmcd.rtp;return pt||(pt=(function(yt){try{var un=Y.getPlaybackRate();un||(un=1);var Ve=yt.quality,tt=yt.mediaType,Nt=yt.mediaInfo,lt=yt.duration;if(!Nt)return NaN;var Bt=ue(tt);Bt===0&&(Bt=500);var Ft=Nt.bitrateList[Ve].bandwidth*lt/1e3/(Bt/un/1e3),Ct=oe.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(oe.get().streaming.cmcd.rtpSafetyFactor)?oe.get().streaming.cmcd.rtpSafetyFactor:5;return 100*(parseInt(Ft*Ct/100)+1)}catch{return NaN}})(Ce)),isNaN(pt)||(ae.rtp=pt),At&&(Ce.url!==At.url?ae.nor=encodeURIComponent(Ht.Z.getRelativeUrl(Ce.url,At.url)):At.range&&(ae.nrr=At.range)),Se&&(ae.br=Se),Ee&&(ae.ot=Ee),isNaN(Pe)||(ae.d=Pe),isNaN(We)||(ae.mtp=We),isNaN(je)||(ae.dl=je),isNaN(Xe)||(ae.bl=Xe),isNaN(ze)||(ae.tb=ze),isNaN(St)||St===1||(ae.pr=St),re[Ce.mediaType]&&(ae.bs=!0,re[Ce.mediaType]=!1),!K[Ce.mediaType]&&ge[Ce.mediaType]||(ae.su=!0,K[Ce.mediaType]=!1,ge[Ce.mediaType]=!0),ae})(j)):j.type===Be.w.INIT_SEGMENT_TYPE?(function(){var Ce=Re();return Ce.ot="i",Ce.su=!0,Ce})():j.type===Be.w.OTHER_TYPE||j.type===Be.w.XLINK_EXPANSION_TYPE?(function(){var Ce=Re();return Ce.ot="o",Ce})():j.type===Be.w.LICENSE?(function(Ce){var Ee=Re();return Ee.ot="k",Ee})():null}catch{return null}var Ae,ve}function Re(){var j={},Ae=oe.get().streaming.cmcd.cid?oe.get().streaming.cmcd.cid:x.cid;return j.v=1,j.sid=oe.get().streaming.cmcd.sid?oe.get().streaming.cmcd.sid:x.sid,j.sid="".concat(j.sid),Ae&&(j.cid="".concat(Ae)),isNaN(x.pr)||x.pr===1||x.pr===null||(j.pr=x.pr),x.st&&(j.st=x.st),x.sf&&(j.sf=x.sf),j}function ue(j){try{var Ae=q.getCurrentBufferLevel(j);return isNaN(Ae)?null:100*parseInt(10*Ae)}catch{return null}}function xe(j){try{x.pr=j.playbackRate}catch{}}function P(j){try{var Ae=D.getIsDynamic(j.data)?"l":"v",ve=j.protocol&&j.protocol==="MSS"?"s":"d";x.st="".concat(Ae),x.sf="".concat(ve)}catch{}}function te(j){try{j.state&&j.mediaType&&j.state===T.Z.BUFFER_EMPTY&&(re[j.mediaType]||(re[j.mediaType]=!0),K[j.mediaType]||(K[j.mediaType]=!0))}catch{}}function J(){for(var j in re)re.hasOwnProperty(j)&&(re[j]=!0);for(var Ae in K)K.hasOwnProperty(Ae)&&(K[Ae]=!0)}function Q(j){try{if(!j)return null;var Ae=Object.keys(j).sort((function(Ee,ae){return Ee.localeCompare(ae)})),ve=Ae.length,Ce=Ae.reduce((function(Ee,ae,Se){return ae==="v"&&j[ae]===1||(typeof j[ae]=="string"&&ae!=="ot"&&ae!=="sf"&&ae!=="st"?Ee+="".concat(ae,"=").concat(JSON.stringify(j[ae])):Ee+="".concat(ae,"=").concat(j[ae]),Se<ve-1&&(Ee+=",")),Ee}),"");return(Ce=Ce.replace(/=true/g,"")).replace(/,\s*$/,"")}catch{return null}}return C={getQueryParameter:function(j){try{if(oe.get().streaming.cmcd&&oe.get().streaming.cmcd.enabled){var Ae=le(j),ve=(function(Ee){try{var ae=oe.get().streaming.cmcd.enabledKeys;return Object.keys(Ee).filter((function(Se){return ae.includes(Se)})).reduce((function(Se,Pe){return Se[Pe]=Ee[Pe],Se}),{})}catch{return Ee}})(Ae),Ce=Q(ve);return z.trigger(er.Z.CMCD_DATA_GENERATED,{url:j.url,mediaType:j.mediaType,cmcdData:Ae,cmcdString:Ce}),{key:"CMCD",value:Ce}}return null}catch{return null}},getHeaderParameters:function(j){try{if(oe.get().streaming.cmcd&&oe.get().streaming.cmcd.enabled){var Ae=le(j),ve=Le(Ae,Me(["br","d","ot","tb"])),Ce=Le(Ae,Me(["bl","dl","mtp","nor","nrr","su"])),Ee=Le(Ae,Me(["bs","rtp"])),ae=Le(Ae,Me(["cid","pr","sf","sid","st","v"])),Se={"CMCD-Object":Q(ve),"CMCD-Request":Q(Ce),"CMCD-Status":Q(Ee),"CMCD-Session":Q(ae)};return z.trigger(er.Z.CMCD_DATA_GENERATED,{url:j.url,mediaType:j.mediaType,cmcdData:Ae,headers:Se}),Se}return null}catch{return null}},setConfig:function(j){j&&(j.abrController&&(B=j.abrController),j.dashMetrics&&(q=j.dashMetrics),j.playbackController&&(Y=j.playbackController))},reset:function(){z.off(T.Z.PLAYBACK_RATE_CHANGED,xe,this),z.off(T.Z.MANIFEST_LOADED,P,this),z.off(T.Z.BUFFER_LEVEL_STATE_CHANGED,te,C),z.off(T.Z.PLAYBACK_SEEKED,J,C),se()},initialize:function(){z.on(T.Z.PLAYBACK_RATE_CHANGED,xe,C),z.on(T.Z.MANIFEST_LOADED,P,C),z.on(T.Z.BUFFER_LEVEL_STATE_CHANGED,te,C),z.on(T.Z.PLAYBACK_SEEKED,J,C),z.on(T.Z.PERIOD_SWITCH_COMPLETED,Ne,C)}},D=xn(ie).getInstance(),se(),C}Mn.__dashjs_factory_name="CmcdModel";var kn=b.Z.getSingletonFactory(Mn);function $n(D){return $n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},$n(D)}function lr(D,C){lr=function(K,re){return new Y(K,void 0,re)};var x=Kr(RegExp),B=RegExp.prototype,q=new WeakMap;function Y(K,re,ge){var ie=x.call(this,K,re);return q.set(ie,ge||q.get(K)),ie}function k(K,re){var ge=q.get(re);return Object.keys(ge).reduce((function(ie,z){return ie[z]=K[ge[z]],ie}),Object.create(null))}return ci(Y,x),Y.prototype.exec=function(K){var re=B.exec.call(this,K);return re&&(re.groups=k(re,this)),re},Y.prototype[Symbol.replace]=function(K,re){if(typeof re=="string"){var ge=q.get(this);return B[Symbol.replace].call(this,K,re.replace(/\$<([^>]+)>/g,(function(z,oe){return"$"+ge[oe]})))}if(typeof re=="function"){var ie=this;return B[Symbol.replace].call(this,K,(function(){var z=[];return z.push.apply(z,arguments),$n(z[z.length-1])!=="object"&&z.push(k(z,ie)),re.apply(this,z)}))}return B[Symbol.replace].call(this,K,re)},lr.apply(this,arguments)}function ci(D,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(C&&C.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),C&&Pr(D,C)}function Kr(D){var C=typeof Map=="function"?new Map:void 0;return Kr=function(x){if(x===null||(B=x,Function.toString.call(B).indexOf("[native code]")===-1))return x;var B;if(typeof x!="function")throw new TypeError("Super expression must either be null or a function");if(C!==void 0){if(C.has(x))return C.get(x);C.set(x,q)}function q(){return Er(x,arguments,fi(this).constructor)}return q.prototype=Object.create(x.prototype,{constructor:{value:q,enumerable:!1,writable:!0,configurable:!0}}),Pr(q,x)},Kr(D)}function Er(D,C,x){return Er=Jr()?Reflect.construct:function(B,q,Y){var k=[null];k.push.apply(k,q);var K=new(Function.bind.apply(B,k));return Y&&Pr(K,Y.prototype),K},Er.apply(null,arguments)}function Jr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}}function Pr(D,C){return Pr=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},Pr(D,C)}function fi(D){return fi=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},fi(D)}var cs="static",Di="dynamic",Pi="cmsd-",zr=Pi+cs,Li=Pi+Di,Bs="stream",Pl=["mb","st","sf","v"],po={video:"v",audio:"a",text:"tt",stream:Bs},rl=/^[-0-9]/;function Ga(){var D,C,x,B,q=this.context,Y=(0,_.Z)(q).getInstance();function k(){x={},B={}}function K(se){se&&Object.keys(se).forEach((function(Ne){Pl.includes(Ne)||delete se[Ne]}))}function re(se){return!se||se.toLowerCase()!=="false"&&(rl.test(se)?parseInt(se,10):se.replace(/["]+/g,""))}function ge(se){try{for(var Ne={},be=se.split(","),Le=0;Le<be.length;Le++){var Me=be[Le].split("="),le=Me[0],Re=re(Me[1]);Ne[le]=Re}return Ne}catch(ue){C.error("Failed to parse CMSD-Static response header value:",ue)}}function ie(se){try{for(var Ne={},be=se.split(","),Le=be[be.length-1].split(";"),Me=1;Me<Le.length;Me++){var le=Le[Me].split("="),Re=le[0],ue=re(le[1]);Ne[Re]=ue}return Ne}catch(xe){return C.error("Failed to parse CMSD-Dynamic response header value:",xe),[]}}function z(se){return po[se]||"o"}function oe(se,Ne,be){var Le=se===cs?x:B,Me=Le[Ne]||{},le=Le[Bs]||{};return Me[be]||le[be]}return D={setConfig:function(){},initialize:function(){},reset:function(){k()},parseResponseHeaders:function(se,Ne){for(var be=null,Le=null,Me=se.split(`\r
`),le=Me.length-1;le>=0;le--){var Re=Me[le].match(lr(/^((?:(?!:)[\s\S])*):[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(.*)$/,{key:1,value:2}));if(Re&&Re.groups){var ue=Re.groups.key.toLowerCase(),xe=Re.groups.value;switch(ue){case zr:be=ge(xe),Y.trigger(E.Z.CMSD_STATIC_HEADER,be);break;case Li:Le||(Le=ie(xe))}}}var P=Bs;return be&&be.ot?P=be.ot:Ne&&(P=z(Ne)),K(x[P]),K(B[P]),be&&(x[P]=Object.assign(x[P]||{},be)),Le&&(B[P]=Object.assign(B[P]||{},Le)),{static:be,dynamic:Le}},getMaxBitrate:function(se){var Ne=z(se);return oe(Di,Ne,"mb")||-1},getEstimatedThroughput:function(se){var Ne=z(se);return oe(Di,Ne,"etp")||null},getResponseDelay:function(se){var Ne=z(se);return oe(Di,Ne,"rd")||null},getRoundTripTime:function(se){var Ne=z(se);return oe(Di,Ne,"rtt")||null}},C=(0,I.Z)(q).getInstance().getLogger(D),k(),D}Ga.__dashjs_factory_name="CmsdModel";var rn=b.Z.getSingletonFactory(Ga);function Cn(){var D,C,x=this.context,B={};function q(){C=(0,I.Z)(x).getInstance().getLogger(D)}function Y(K){for(var re={},ge=0,ie=0,z=0,oe=0,se=K.length,Ne=0;Ne<se;++Ne)ge+=K[Ne].chunkDownloadTimeRelativeMS,ie+=K[Ne].bufferLevel,z+=K[Ne].chunkDownloadTimeRelativeMS*K[Ne].bufferLevel,oe+=K[Ne].chunkDownloadTimeRelativeMS*K[Ne].chunkDownloadTimeRelativeMS;return re.m=(z-ge*ie/se)/(oe-ge*ge/se),re.b=ie/se-re.m*ge/se,function(be){return re.m*be+re.b}}function k(K){var re,ge=!0,ie=K.reduce((function(z,oe){return z+oe.bufferLevelAtSegmentEnd}),0)/K.length;return K.forEach((function(z){Math.abs(z.bufferLevelAtSegmentEnd/z.bufferLevelAtSegmentStart)<.95&&(ge=!1),z.bufferLevelAtSegmentEnd/ie<.8&&(ge=!1),re?re>z.bitrate&&(ge=!1):re=z.bitrate})),ge}return D={setup:q,addMeasurement:function(K,re,ge,ie,z){K&&K.mediaType&&!B[K.mediaType]&&(B[K.mediaType]=[]);var oe=K.mediaInfo.bitrateList.find((function(se){return se.id===K.representationId}));B[K.mediaType].push({index:K.index,repId:K.representationId,mediaType:K.mediaType,requestTimeMS:ie,adjustedAvailabilityStartTimeMS:K.availabilityStartTime.getTime(),segDurationMS:1e3*K.duration,chunksDurationMS:ge.reduce((function(se,Ne){return se+Ne.chunkDownloadDurationMS}),0),segmentBytes:ge.reduce((function(se,Ne){return se+Ne.chunkBytes}),0),bitrate:oe&&oe.bandwidth,bitrateList:K.mediaInfo.bitrateList,chunkMeasurements:ge,fetchDownloadDurationMS:re,throughputCapacityDelayMS:z,getEstimatedBufferLevel:Y(ge.slice(1))}),B[K.mediaType].length>10&&B[K.mediaType].shift()},getThroughputCapacityDelayMS:function(K,re){var ge=B[K.mediaType]&&B[K.mediaType].slice(-3);return!ge||ge.length<3?0:k(ge)?re/4>250?250:re/4:0},getEstimatedDownloadDurationMS:function(K){var re=B[K.mediaType].slice(-1).pop(),ge=B[K.mediaType].slice(-3),ie=re.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;re.bufferLevelAtSegmentStart=re.getEstimatedBufferLevel(ie/2),re.bufferLevelAtSegmentEnd=re.getEstimatedBufferLevel(ie);var z=k(ge),oe=z?.6:.8;if(re.isBufferStable&&1.05*re.segDurationMS<re.fetchDownloadDurationMS)return re.fetchDownloadDurationMS;if(!z||re.segDurationMS<re.fetchDownloadDurationMS||re.adjustedAvailabilityStartTimeMS<=re.requestTimeMS+re.throughputCapacityDelayMS-re.segDurationMS)return .8*re.fetchDownloadDurationMS;for(var se=re.requestTimeMS+re.throughputCapacityDelayMS-re.adjustedAvailabilityStartTimeMS,Ne=0,be=0,Le=0,Me=0;Me<re.chunkMeasurements.length;Me++){var le=re.chunkMeasurements[Me];if(se<be+le.chunkDownloadDurationMS)break;be+=le.chunkDownloadDurationMS,Ne+=le.chunkBytes,Le++}if(se<0&&C.warn("request time was before adjusted availibitly start time"),Ne&&be&&Le>.2*re.chunkMeasurements.length){var Re=Ne/be,ue=re.segmentBytes/Re;return re.fetchDownloadDurationMS<ue?re.fetchDownloadDurationMS*oe:ue*oe}var xe=re.bitrate;return re.bitrateList.some((function(P){if(P.bandwidth>re.bitrate)return xe=P.bandwidth,!0})),xe===re.bitrate?re.fetchDownloadDurationMS*oe:oe*re.segmentBytes*8*1e3/xe}},q(),D}Cn.__dashjs_factory_name="LowLatencyThroughputModel";var Xn=b.Z.getSingletonFactory(Cn),kr=g(5717);function pr(D,C,x){return C in D?Object.defineProperty(D,C,{value:x,enumerable:!0,configurable:!0,writable:!0}):D[C]=x,D}function Fr(D){D=D||{};var C,x,B,q,Y,k,K,re,ge,ie,z,oe=this.context,se=D.errHandler,Ne=D.dashMetrics,be=D.mediaPlayerModel,Le=D.requestModifier,Me=D.boxParser,le=D.errors,Re=D.requestTimeout||0,ue=(0,_.Z)(oe).getInstance(),xe=(0,Ie.Z)(oe).getInstance();function P(te,J){var Q,j=te.request,Ae=[],ve=!0,Ce=!0,Ee=new Date,ae=Ee,Se=0,Pe=null,We=null;if(!Le||!Ne||!se)throw new Error("config object is not correct or missing");var je,Xe=function(Bt){j.requestStartDate=Ee,j.requestEndDate=new Date,j.firstByteDate=j.firstByteDate||Ee,j.fileLoaderType=We;var Ft=Q.response?Q.response.responseURL:null,Ct=Q.response?Q.response.status:null,vn=Q.response&&Q.response.getAllResponseHeaders?Q.response.getAllResponseHeaders():Q.response?Q.response.responseHeaders:null,yn=vn&&xe.get().streaming.cmsd&&xe.get().streaming.cmsd.enabled?K.parseResponseHeaders(vn,j.mediaType):null;Ne.addHttpRequest(j,Ft,Ct,vn,Bt?Ae:null,yn)},ze=function(Bt){Ce=!1,Xe(Bt),j.type===Be.w.MPD_TYPE&&(Ne.addManifestUpdate(j),ue.trigger(E.Z.MANIFEST_LOADING_FINISHED,{request:j}))},St=function(){if(Pe&&(clearTimeout(Pe),Pe=null),x.indexOf(Q)!==-1&&(x.splice(x.indexOf(Q),1),Ce))if(ze(!1),J>0){try{xe.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&j.type===Be.w.MEDIA_SEGMENT_TYPE&&be.getRetryAttemptsForType(Be.w.MEDIA_SEGMENT_TYPE)===J&&ue.trigger(E.Z.ATTEMPT_BACKGROUND_SYNC)}catch{}J--;var Bt={config:te};q.push(Bt),Bt.timeout=setTimeout((function(){q.indexOf(Bt)!==-1&&(q.splice(q.indexOf(Bt),1),P(te,J))}),be.getRetryIntervalsForType(j.type))}else{if(j.type===Be.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;se.error(new fe.Z(Y[j.type],j.url+" is not available",{request:j,response:Q.response})),te.error&&te.error(j,"error",Q.response.statusText,Q.response),te.complete&&te.complete(j,Q.response.statusText)}};j.hasOwnProperty("availabilityTimeComplete")&&j.availabilityTimeComplete===!1&&window.fetch&&j.responseType==="arraybuffer"&&j.type===Be.w.MEDIA_SEGMENT_TYPE?((je=ar(oe).create({requestModifier:Le,lowLatencyThroughputModel:ge,boxParser:Me})).setup({dashMetrics:Ne}),We=u.Z.FILE_LOADER_TYPES.FETCH):(je=(0,ln.Z)(oe).create({requestModifier:Le}),We=u.Z.FILE_LOADER_TYPES.XHR);var At=null,pt=Le.modifyRequestURL?Le.modifyRequestURL(j.url):j.url;if(xe.get().streaming.cmcd&&xe.get().streaming.cmcd.enabled){var yt=xe.get().streaming.cmcd.mode;if(yt===u.Z.CMCD_MODE_QUERY){var un=(function(Bt){try{var Ft=[],Ct=k.getQueryParameter(Bt);return Ct&&Ft.push(Ct),Ft}catch{return[]}})(j);pt=Ht.Z.addAditionalQueryParameterToUrl(pt,un)}else yt===u.Z.CMCD_MODE_HEADER&&(At=k.getHeaderParameters(j))}var Ve=re.getXHRWithCredentialsForType(j.type);if(j.queryParams){var tt=Object.keys(j.queryParams).map((function(Bt){return{key:Bt,value:j.queryParams[Bt]}}));pt=Ht.Z.addAditionalQueryParameterToUrl(pt,tt)}j.url=pt,Q={url:pt,method:Be.w.GET,withCredentials:Ve,request:j,onload:function(){Q.response.status>=200&&Q.response.status<=299&&(ze(!0),te.success&&te.success(Q.response.response,Q.response.statusText,Q.response.responseURL),te.complete&&te.complete(j,Q.response.statusText))},onend:St,onerror:St,progress:function(Bt){var Ft=new Date;ve&&(ve=!1,(!Bt.lengthComputable||Bt.lengthComputable&&Bt.total!==Bt.loaded)&&(j.firstByteDate=Ft)),Bt.lengthComputable&&(j.bytesLoaded=Bt.loaded,j.bytesTotal=Bt.total),Bt.noTrace||(Ae.push({s:ae,d:Bt.time?Bt.time:Ft.getTime()-ae.getTime(),b:[Bt.loaded?Bt.loaded-Se:0]}),ae=Ft,Se=Bt.loaded),Pe&&(clearTimeout(Pe),Pe=null),xe.get().streaming.fragmentRequestProgressTimeout>0&&(Pe=setTimeout((function(){ie.warn("Abort request "+Q.url+" due to progress timeout"),Q.response.onabort=null,Q.loader.abort(Q),St()}),xe.get().streaming.fragmentRequestProgressTimeout)),te.progress&&Bt&&te.progress(Bt)},onabort:function(){Xe(!0),Pe&&(clearTimeout(Pe),Pe=null),te.abort&&te.abort(j)},ontimeout:function(Bt){var Ft;if(Bt.lengthComputable){var Ct=Bt.loaded/Bt.total*100;Ft="Request timeout: loaded: "+Bt.loaded+", out of: "+Bt.total+" : "+Ct.toFixed(3)+"% Completed"}else Ft="Request timeout: non-computable download size";ie.warn(Ft)},loader:je,timeout:Re,headers:At};var Nt=new Date().getTime();if(isNaN(j.delayLoadingTime)||Nt>=j.delayLoadingTime)x.push(Q),je.load(Q);else{var lt={httpRequest:Q};B.push(lt),lt.delayTimeout=setTimeout((function(){if(B.indexOf(lt)!==-1){B.splice(B.indexOf(lt),1);try{Ee=new Date,ae=Ee,x.push(lt.httpRequest),je.load(lt.httpRequest)}catch{lt.httpRequest.onerror()}}}),j.delayLoadingTime-Nt)}}return C={load:function(te){te.request?P(te,be.getRetryAttemptsForType(te.request.type)):te.error&&te.error(te.request,"error")},abort:function(){q.forEach((function(te){clearTimeout(te.timeout),te.config.request&&te.config.abort&&te.config.abort(te.config.request)})),q=[],B.forEach((function(te){return clearTimeout(te.delayTimeout)})),B=[],x.forEach((function(te){te.request.type!==Be.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(te.onloadend=te.onerror=te.onprogress=void 0,te.loader.abort(te))})),x=[]}},ie=(0,I.Z)(oe).getInstance().getLogger(C),x=[],B=[],q=[],k=kn(oe).getInstance(),K=rn(oe).getInstance(),ge=Xn(oe).getInstance(),re=(0,kr.Z)(oe).getInstance(),pr(z={},Be.w.MPD_TYPE,le.DOWNLOAD_ERROR_ID_MANIFEST_CODE),pr(z,Be.w.XLINK_EXPANSION_TYPE,le.DOWNLOAD_ERROR_ID_XLINK_CODE),pr(z,Be.w.INIT_SEGMENT_TYPE,le.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),pr(z,Be.w.MEDIA_SEGMENT_TYPE,le.DOWNLOAD_ERROR_ID_CONTENT_CODE),pr(z,Be.w.INDEX_SEGMENT_TYPE,le.DOWNLOAD_ERROR_ID_CONTENT_CODE),pr(z,Be.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,le.DOWNLOAD_ERROR_ID_CONTENT_CODE),pr(z,Be.w.OTHER_TYPE,le.DOWNLOAD_ERROR_ID_CONTENT_CODE),Y=z,C}Fr.__dashjs_factory_name="HTTPLoader";var _r=b.Z.getClassFactory(Fr);function ki(){var D;function C(){D={}}function x(){C()}return x(),{getLoader:function(B){for(var q in D)if(D.hasOwnProperty(q)&&B.startsWith(q))return D[q];return _r},registerLoader:function(B,q){D[B]=q},unregisterLoader:function(B){D[B]&&delete D[B]},unregisterAllLoader:C,reset:x}}ki.__dashjs_factory_name="SchemeLoaderFactory";var xr=b.Z.getSingletonFactory(ki);function Lr(D){D=D||{};var C,x,B=this.context;return C=xr(B).getInstance(),{load:function(q){if(!x){var Y=C.getLoader(q&&q.request?q.request.url:null);x=Y(B).create({errHandler:D.errHandler,mediaPlayerModel:D.mediaPlayerModel,requestModifier:D.requestModifier,dashMetrics:D.dashMetrics,boxParser:D.boxParser?D.boxParser:null,constants:D.constants?D.constants:null,dashConstants:D.dashConstants?D.dashConstants:null,urlUtils:D.urlUtils?D.urlUtils:null,requestTimeout:isNaN(D.requestTimeout)?0:D.requestTimeout,errors:D.errors})}x.load(q)},abort:function(){x&&x.abort()}}}Lr.__dashjs_factory_name="URLLoader";var vi=b.Z.getClassFactory(Lr);function Ei(D){return Ei=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},Ei(D)}function Bi(D,C){return Bi=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},Bi(D,C)}function $i(D,C){return!C||Ei(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function ua(D){return ua=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},ua(D)}var ca=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&Bi(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=ua(C);if(x){var K=ua(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return $i(this,Y)});function q(Y){var k;return(function(K,re){if(!(K instanceof re))throw new TypeError("Cannot call a class as a function")})(this,q),(k=B.call(this,Y)).checkForExistenceOnly=!0,k}return q})(O.Z);function Gi(D){D=D||{};var C,x,B=this.context,q=D.eventBus,Y=D.events,k=D.urlUtils,K=D.errors,re=D.streamId;return C={checkForExistence:function(ge){var ie=function(oe){q.trigger(Y.CHECK_FOR_EXISTENCE_COMPLETED,{request:ge,exists:oe})};if(ge){var z=new ca(ge.url);x.load({request:z,success:function(){ie(!0)},error:function(){ie(!1)}})}else ie(!1)},load:function(ge){var ie=function(z,oe){q.trigger(Y.LOADING_COMPLETED,{request:ge,response:z||null,error:oe||null,sender:C})};ge?x.load({request:ge,progress:function(z){q.trigger(Y.LOADING_PROGRESS,{request:ge,stream:z.stream,streamId:re}),z.data&&q.trigger(Y.LOADING_DATA_PROGRESS,{request:ge,response:z.data||null,error:null,sender:C})},success:function(z){ie(z)},error:function(z,oe,se){ie(void 0,new fe.Z(K.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,se,oe))},abort:function(z){z&&q.trigger(Y.LOADING_ABANDONED,{mediaType:z.mediaType,request:z,sender:C})}}):ie(void 0,new fe.Z(K.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,K.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){x&&x.abort()},reset:function(){x&&(x.abort(),x=null)}},x=vi(B).create({errHandler:D.errHandler,errors:K,dashMetrics:D.dashMetrics,mediaPlayerModel:D.mediaPlayerModel,requestModifier:D.requestModifier,urlUtils:k,constants:u.Z,boxParser:D.boxParser,dashConstants:D.dashConstants,requestTimeout:D.settings.get().streaming.fragmentRequestTimeout}),C}Gi.__dashjs_factory_name="FragmentLoader";var fs=b.Z.getClassFactory(Gi);function ds(){return{modifyResponseAsync:function(D){return Promise.resolve(D)}}}ds.__dashjs_factory_name="SegmentResponseModifier";var Za=b.Z.getSingletonFactory(ds);function Ha(D){D=D||{};var C,x,B,q=this.context,Y=(0,_.Z)(q).getInstance(),k=D.errHandler,K=D.mediaPlayerModel,re=D.dashMetrics,ge=(0,I.Z)(q).getInstance(),ie=Za(q).getInstance(),z=D.streamInfo;function oe(){return z.id}function se(){for(var be in B)B[be].reset();B={}}function Ne(be){if(be.sender){var Le=be.request,Me=be.response,le=Le.isInitializationRequest(),Re=Le.mediaInfo.streamInfo;if(be.error&&(Le.mediaType===u.Z.AUDIO||Le.mediaType===u.Z.VIDEO||Le.mediaType===u.Z.TEXT&&Le.mediaInfo.isFragmented)&&Y.trigger(E.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD,{entry:be.request.serviceLocation}),Me&&Re){var ue=(function(xe,P,te,J){var Q=new Wt;return Q.streamId=te,Q.mediaInfo=P.mediaInfo,Q.segmentType=P.type,Q.start=P.startTime,Q.duration=P.duration,Q.end=Q.start+Q.duration,Q.bytes=xe,Q.index=P.index,Q.quality=P.quality,Q.representationId=P.representationId,Q.endFragment=J,Q})(Me,Le,z.id,be.type!==E.Z.FRAGMENT_LOADING_PROGRESS);ie.modifyResponseAsync(ue).then((function(xe){Y.trigger(le?E.Z.INIT_FRAGMENT_LOADED:E.Z.MEDIA_FRAGMENT_LOADED,{chunk:xe,request:Le},{streamId:Re.id,mediaType:Le.mediaType})})).catch((function(xe){x.error(xe),Y.trigger(le?E.Z.INIT_FRAGMENT_LOADED:E.Z.MEDIA_FRAGMENT_LOADED,{chunk:ue,request:Le},{streamId:Re.id,mediaType:Le.mediaType})}))}else x.warn("No "+Le.mediaType+" bytes to push or stream is inactive.")}}return C={getStreamId:oe,getModel:function(be){var Le=B[be];return Le||(Le=W(q).create({streamInfo:z,type:be,dashMetrics:re,fragmentLoader:fs(q).create({dashMetrics:re,mediaPlayerModel:K,errHandler:k,requestModifier:(0,He.Z)(q).getInstance(),settings:D.settings,boxParser:D.boxParser,eventBus:Y,events:E.Z,errors:X,dashConstants:D.dashConstants,urlUtils:D.urlUtils,streamId:oe()}),debug:ge,eventBus:Y,events:E.Z}),B[be]=Le),Le},reset:function(){Y.off(T.Z.FRAGMENT_LOADING_COMPLETED,Ne,this),Y.off(T.Z.FRAGMENT_LOADING_PROGRESS,Ne,this),se()}},x=ge.getLogger(C),se(),Y.on(T.Z.FRAGMENT_LOADING_COMPLETED,Ne,C),Y.on(T.Z.FRAGMENT_LOADING_PROGRESS,Ne,C),C}Ha.__dashjs_factory_name="FragmentController";var kl=b.Z.getClassFactory(Ha),il=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null},al=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};function hs(D){var C,x,B=this.context,q=D.streamInfo;function Y(K){x.setTrackByIndex(K)}function k(){x&&x.reset()}return C={getStreamId:function(){return q.id},initialize:function(){x.addTracks();var K=x.getTracks();K&&K.length>0&&Y(0)},provide:function(K,re){if(typeof re=="function"){var ge,ie,z=x.getCurrentTrack();if(!z||z.segmentDuration<=0||K==null)re(null);else{(ie=x.getThumbnailRequestForTime(K))&&(z.segmentDuration=ie.duration),ge=K%z.segmentDuration;var oe=Math.floor(ge*z.tilesHor*z.tilesVert/z.segmentDuration),se=new il;if(se.width=Math.floor(z.widthPerTile),se.height=Math.floor(z.heightPerTile),se.x=Math.floor(oe%z.tilesHor)*z.widthPerTile,se.y=Math.floor(oe/z.tilesHor)*z.heightPerTile,"readThumbnail"in z)return z.readThumbnail(K,(function(be){se.url=be,re(se)}));if(ie)se.url=ie.url,z.segmentDuration=NaN;else{var Ne=Math.floor(K/z.segmentDuration);se.url=(function(be,Le){var Me=Le+be.startNumber,le=(0,N.vi)(be.templateUrl,"Number",Me);return le=(0,N.vi)(le,"Time",(Me-1)*be.segmentDuration*be.timescale),le=(0,N.vi)(le,"Bandwidth",be.bandwidth),(0,N.eR)(le)})(z,Ne)}re(se)}}},setTrackByIndex:Y,getCurrentTrackIndex:function(){return x.getCurrentTrackIndex()},getBitrateList:function(){var K=x.getTracks(),re=0;return K.map((function(ge){var ie=new al;return ie.mediaType=u.Z.IMAGE,ie.qualityIndex=re++,ie.bitrate=ge.bitrate,ie.width=ge.width,ie.height=ge.height,ie}))},reset:k},k(),x=(0,fn.Z)(B).create({streamInfo:q,adapter:D.adapter,baseURLController:D.baseURLController,timelineConverter:D.timelineConverter,debug:D.debug,eventBus:D.eventBus,events:D.events,dashConstants:D.dashConstants,dashMetrics:D.dashMetrics,segmentBaseController:D.segmentBaseController}),C}hs.__dashjs_factory_name="ThumbnailController";var fa=b.Z.getClassFactory(hs),Gs=g(7417);function gs(D){var C;D=D||{};var x=[],B=(0,_.Z)(this.context).getInstance(),q=D.updateEventName,Y=D.addBlacklistEventName;function k(K){x.indexOf(K)===-1&&(x.push(K),B.trigger(q,{entry:K}))}return C={add:k,contains:function(K){return!!(x.length&&K&&K.length)&&x.indexOf(K)!==-1},reset:function(){x=[]}},Y&&B.on(Y,(function(K){k(K.entry)}),C),C}gs.__dashjs_factory_name="BlackListController";var Zi=b.Z.getClassFactory(gs),sl=[u.Z.VIDEO,u.Z.AUDIO,u.Z.TEXT,u.Z.MUXED,u.Z.IMAGE];function Tr(D){D=D||{};var C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le,Me,le,Re=this.context,ue=(0,_.Z)(Re).getInstance(),xe=(0,ut.Z)(Re).getInstance(),P=D.manifestModel,te=D.mediaPlayerModel,J=D.dashMetrics,Q=D.manifestUpdater,j=D.adapter,Ae=D.timelineConverter,ve=D.capabilities,Ce=D.errHandler,Ee=D.abrController,ae=D.playbackController,Se=D.eventController,Pe=D.mediaController,We=D.protectionController,je=D.textController,Xe=D.videoModel,ze=D.streamInfo,St=D.settings;function At(xt,an){return new Promise((function(mn,pn){Ft(),ie=!0,vn();var Tn=Xe.getElement(),ot=[];sl.forEach((function($e){($e!==u.Z.TEXT||xt)&&($e!==u.Z.VIDEO||!Tn||Tn&&/^VIDEO$/i.test(Tn.nodeName))&&ot.push(pt($e,xt))})),Promise.all(ot).then((function(){return $e=an,new Promise((function(bt){var we={},Ue=B.map((function(ft){return ft.createBufferSinks($e)}));Promise.all(Ue).then((function(ft){ft.forEach((function(zt){zt&&(we[zt.getType()]=zt)})),bt(we)})).catch((function(){bt(we)}))}));var $e})).then((function($e){if(ie=!1,B.length===0){var bt="No streams to play.";Ce.error(new fe.Z(X.MANIFEST_ERROR_ID_NOSTREAMS_CODE,bt,P.getValue())),x.fatal(bt)}else yn();xt&&je.createTracks(ze),mn($e)})).catch((function($e){pn($e)}))}))}function pt(xt,an){var mn,pn=j.getAllMediaInfoForType(ze,xt),Tn=[],ot=null;if(!pn||pn.length===0)return x.info("No "+xt+" data."),Promise.resolve();xt===u.Z.VIDEO&&(K=!0),xt===u.Z.AUDIO&&(re=!0);for(var $e=0,bt=pn.length;$e<bt;$e++)ot=pn[$e],xt===u.Z.TEXT&&ot.isEmbedded&&(je.addEmbeddedTrack(ze,ot),Tn.push(ot)),yt(ot)&&Pe.addTrack(ot);if(Tn.length>0&&(Pe.setInitialMediaSettingsForType(xt,ze),je.addMediaInfosToBuffer(ze,xt,Tn)),pn=pn.filter((function(Ue){return!Ue.isEmbedded})),pn.length===0)return Promise.resolve();if(xt===u.Z.IMAGE)return(oe=fa(Re).create({streamInfo:ze,adapter:j,baseURLController:D.baseURLController,timelineConverter:D.timelineConverter,debug:Le,eventBus:ue,events:E.Z,dashConstants:d.Z,dashMetrics:D.dashMetrics,segmentBaseController:D.segmentBaseController})).initialize(),Promise.resolve();ue.trigger(E.Z.STREAM_INITIALIZING,{streamInfo:ze,mediaInfo:ot}),Pe.setInitialMediaSettingsForType(xt,ze);var we=(function(Ue,ft){var zt=Ue&&Ue.length>0?Ue[0]:null,tn=z.getModel(zt?zt.type:null),Hn=zt?zt.type:null,cr=zt?zt.mimeType:null,$r=zt?zt.isFragmented:null,fr=gn(Re).create({streamInfo:ze,type:Hn,mimeType:cr,timelineConverter:Ae,adapter:j,manifestModel:P,mediaPlayerModel:te,fragmentModel:tn,dashMetrics:D.dashMetrics,baseURLController:D.baseURLController,segmentBaseController:D.segmentBaseController,abrController:Ee,playbackController:ae,mediaController:Pe,textController:je,errHandler:Ce,settings:St,boxParser:be,segmentBlacklistController:se});fr.initialize(ft,K,$r),B.push(fr);for(var Ri=0;Ri<Ue.length;Ri++)fr.addMediaInfo(Ue[Ri]);return Hn===u.Z.TEXT&&je.addMediaInfosToBuffer(ze,Hn,Ue,tn),fr})(pn,an);return(mn=Pe.getCurrentTrackFor(xt,ze.id))?(Ee.updateTopQualityIndex(mn),we.selectMediaInfo(xt===u.Z.TEXT&&mn.isEmbedded?pn[0]:mn)):Promise.resolve()}function yt(xt){var an,mn=xt?xt.type:null;return mn===u.Z.MUXED?(an="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",x.fatal(an),Ce.error(new fe.Z(X.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,an,P.getValue())),!1):!(mn!==u.Z.TEXT&&mn!==u.Z.IMAGE&&xt.contentProtection&&!ve.supportsEncryptedMedia()&&(Ce.error(new fe.Z(X.CAPABILITY_MEDIAKEYS_ERROR_CODE,X.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),1))}function un(xt){for(var an=B?B.length:0,mn=0;mn<an;mn++){var pn=B[mn].getFragmentModel();pn.abortRequests(),pn.resetInitialSettings(),B[mn].reset(!1,xt)}je&&je.deactivateStream(ze),B=[],Y=!1,k=!1,An(!1),tt(!1),ue.trigger(E.Z.STREAM_DEACTIVATED,{streamInfo:ze})}function Ve(xt){un(xt),q=!1,K=!1,re=!1,ge={},ie=!1,Me=!1,le=[]}function tt(xt){Me=xt}function Nt(){return ze?ze.start:NaN}function lt(){return ze?ze.id:null}function Bt(){return ze}function Ft(){if(!Xe||!Ee)throw new Error(u.Z.MISSING_CONFIG_ERROR)}function Ct(xt){xt.error&&(Ce.error(xt.error),x.fatal(xt.error.message))}function vn(){if(Se){var xt=j.getEventsFor(ze);xt&&xt.length>0&&Se.addInlineEvents(xt,ze.id)}}function yn(){for(var xt=B.length,an=ge.audio||ge.video?new fe.Z(X.DATA_UPDATE_FAILED_ERROR_CODE,X.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,mn=0;mn<xt;mn++)if(B[mn].isUpdating()||ie)return;if(We){We.clearMediaInfoArray();for(var pn=0;pn<xt&&B[pn];pn++){var Tn=B[pn].getType(),ot=B[pn].getMediaInfo();if(Tn===u.Z.AUDIO||Tn===u.Z.VIDEO||Tn===u.Z.TEXT&&ot.isFragmented){var $e=B[pn].getMediaInfo();$e&&We.initializeForMedia($e)}}We.handleKeySystemFromManifest()}an?Ce.error(an):q||(q=!0,Xe.waitForReadyState(u.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,(function(){ue.trigger(E.Z.STREAM_INITIALIZED,{streamInfo:ze})})))}function Fn(){var xt=jt(),an=xt.length;if(an!==0){for(var mn=0;mn<an;mn++)if(!xt[mn].isBufferingCompleted()&&(xt[mn].getType()===u.Z.AUDIO||xt[mn].getType()===u.Z.VIDEO))return void x.debug("onBufferingCompleted - One streamProcessor has finished but",xt[mn].getType(),"one is not buffering completed");x.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),k=!0,ue.trigger(E.Z.STREAM_BUFFERING_COMPLETED,{streamInfo:ze},{streamInfo:ze})}else x.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}function Zn(xt){ge[xt.mediaType]=xt.error,yn()}function st(xt){Se&&Se.addInbandEvents(xt.events,ze.id)}function Mt(xt){return xt&&xt.type?Tt(xt.type):null}function Tt(xt){return xt?jt().filter((function(an){return an.getType()===xt}))[0]:null}function jt(){for(var xt,an,mn=[],pn=0;pn<B.length;pn++)(xt=(an=B[pn]).getType())!==u.Z.AUDIO&&xt!==u.Z.VIDEO&&xt!==u.Z.TEXT||mn.push(an);return mn}function en(xt,an){var mn=Bt(),pn=an.getStreamInfo();if(!pn||!mn)return!0;var Tn=j.getAdaptationForType(pn.index,xt,pn),ot=j.getAdaptationForType(mn.index,xt,mn);return Tn&&ot?!(!_n(ot)&&_n(Tn)):!Tn&&!ot}function _n(xt){return!!xt&&!!(xt.ContentProtection||xt.Representation_asArray&&xt.Representation_asArray.length>0&&xt.Representation_asArray[0].ContentProtection)}function En(xt,an){var mn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!xt||!xt.hasOwnProperty("getStreamInfo"))return!1;var pn=xt.getStreamInfo(),Tn=mn?mn.getStreamInfo():Bt();if(!pn||!Tn)return!1;var ot=j.getAdaptationForType(pn.index,an,pn),$e=j.getAdaptationForType(Tn.index,an,Tn);if(!ot||!$e)return!ot&&!$e;var bt=ot&&$e&&ot.mimeType===$e.mimeType,we=$e.Representation_asArray.map((function(tn){return tn.codecs})),Ue=ot.Representation_asArray.map((function(tn){return tn.codecs})),ft=Ue.some((function(tn){return we.indexOf(tn)>-1})),zt=Ue.some((function(tn){return we.some((function(Hn){return ve.codecRootCompatibleWithCodec(Hn,tn)}))}));return ft||zt&&bt}function An(xt){Ne=xt}function Ln(){return Ne}return C={initialize:function(){ue.on(E.Z.BUFFERING_COMPLETED,Fn,C),ue.on(E.Z.DATA_UPDATE_COMPLETED,Zn,C),ue.on(E.Z.INBAND_EVENTS,st,C),We&&(ue.on(E.Z.KEY_ERROR,Ct,C),ue.on(E.Z.SERVER_CERTIFICATE_UPDATED,Ct,C),ue.on(E.Z.LICENSE_REQUEST_COMPLETE,Ct,C),ue.on(E.Z.KEY_SYSTEM_SELECTED,Ct,C),ue.on(E.Z.KEY_SESSION_CREATED,Ct,C),ue.on(E.Z.KEY_STATUSES_CHANGED,Ct,C)),je.initializeForStream(ze),ue.trigger(E.Z.STREAM_UPDATED,{streamInfo:ze})},getStreamId:function(){return ze?ze.id:null},activate:function(xt,an){return new Promise((function(mn,pn){if(!Y)return Ln()?(Y=!0,ue.trigger(E.Z.STREAM_ACTIVATED,{streamInfo:ze}),void mn(an)):void(function(Tn,ot){return At(Tn,ot)})(xt,an).then((function(Tn){Y=!0,ue.trigger(E.Z.STREAM_ACTIVATED,{streamInfo:ze}),mn(Tn)})).catch((function(Tn){pn(Tn)}));mn(an)}))},deactivate:un,getIsActive:function(){return Y},getDuration:function(){return ze?ze.duration:NaN},getStartTime:Nt,getId:lt,getStreamInfo:Bt,getHasAudioTrack:function(){return re},getHasVideoTrack:function(){return K},startPreloading:function(xt,an){return new Promise((function(mn,pn){Ln()?pn():(x.info("[startPreloading] Preloading next stream with id ".concat(lt())),An(!0),At(xt,an).then((function(){for(var Tn=0;Tn<B.length&&B[Tn];Tn++)B[Tn].setExplicitBufferingTime(Nt()),B[Tn].getScheduleController().startScheduleTimer();mn()})).catch((function(){An(!1),pn()})))}))},initializeForTextWithMediaSource:function(xt){return new Promise((function(an,mn){pt(u.Z.TEXT,xt).then((function(){return(pn=Tt(u.Z.TEXT))?pn.createBufferSinks():Promise.resolve();var pn})).then((function(){je.createTracks(ze),an()})).catch((function(pn){mn(pn)}))}))},getThumbnailController:function(){return oe},getBitrateListFor:function(xt){if(Ft(),xt===u.Z.IMAGE)return oe?oe.getBitrateList():[];var an=(function(mn){for(var pn=null,Tn=0;Tn<B.length;Tn++)if((pn=B[Tn]).getType()===mn)return pn.getMediaInfo();return null})(xt);return Ee.getBitrateList(an)},updateData:function(xt){return new Promise((function(an){ie=!0,ze=xt,Se&&vn();for(var mn=[],pn=0,Tn=B.length;pn<Tn;pn++){var ot=B[pn],$e=ot.getMediaInfo();mn.push(ot.updateStreamInfo(ze));var bt=j.getAllMediaInfoForType(ze,ot.getType());if(bt=bt.filter((function(ft){return!ft.isEmbedded}))){ot.clearMediaInfoArray();for(var we=0;we<bt.length;we++){var Ue=bt[we];ot.addMediaInfo(bt[we]),j.areMediaInfosEqual($e,Ue)&&(Ee.updateTopQualityIndex(Ue),mn.push(ot.selectMediaInfo(Ue)))}}}Promise.all(mn).then((function(){for(mn=[];le.length>0;){var ft=le.pop(),zt=ft.newMediaInfo,tn=Mt(ft.oldMediaInfo);if(!tn)return;mn.push(tn.prepareTrackSwitch()),mn.push(tn.selectMediaInfo(zt))}return Promise.all(mn)})).then((function(){ie=!1,yn(),ue.trigger(E.Z.STREAM_UPDATED,{streamInfo:ze}),an()}))}))},reset:function(xt){z&&(z.reset(),z=null),Ee&&ze&&Ee.clearDataForStream(ze.id),se&&(se.reset(),se=null),Ve(xt),ze=null,ue.off(E.Z.DATA_UPDATE_COMPLETED,Zn,C),ue.off(E.Z.BUFFERING_COMPLETED,Fn,C),ue.off(E.Z.INBAND_EVENTS,st,C),We&&(ue.off(E.Z.KEY_ERROR,Ct,C),ue.off(E.Z.SERVER_CERTIFICATE_UPDATED,Ct,C),ue.off(E.Z.LICENSE_REQUEST_COMPLETE,Ct,C),ue.off(E.Z.KEY_SYSTEM_SELECTED,Ct,C),ue.off(E.Z.KEY_SESSION_CREATED,Ct,C),ue.off(E.Z.KEY_STATUSES_CHANGED,Ct,C))},getProcessors:jt,setMediaSource:function(xt){return new Promise((function(an,mn){for(var pn=[],Tn=0;Tn<B.length;)yt(B[Tn].getMediaInfo())?(pn.push(B[Tn].setMediaSource(xt)),Tn++):(B[Tn].reset(),B.splice(Tn,1));Promise.all(pn).then((function(){for(var ot=0;ot<B.length;ot++)B[ot].dischargePreBuffer();if(B.length===0){var $e="No streams to play.";Ce.error(new fe.Z(X.MANIFEST_ERROR_ID_NOSTREAMS_CODE,$e+"nostreams",P.getValue())),x.fatal($e)}an()})).catch((function(ot){x.error(ot),mn(ot)}))}))},isMediaCodecCompatible:function(xt){var an=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return En(xt,u.Z.VIDEO,an)&&En(xt,u.Z.AUDIO,an)},isProtectionCompatible:function(xt){return!xt||en(u.Z.VIDEO,xt)&&en(u.Z.AUDIO,xt)},getPreloaded:Ln,getIsEndedEventSignaled:function(){return Me},setIsEndedEventSignaled:tt,getAdapter:function(){return j},getHasFinishedBuffering:function(){return k},setPreloaded:An,startScheduleControllers:function(){for(var xt=B.length,an=0;an<xt&&B[an];an++)B[an].getScheduleController().startScheduleTimer()},prepareTrackChange:function(xt){if(Y&&ze){k=!1;var an=xt.newMediaInfo,mn=P.getValue();j.setCurrentMediaInfo(ze.id,an.type,an);var pn=Mt(an);if(pn){var Tn=ae.getTime();x.info("Stream -  Process track changed at current time "+Tn),mn.refreshManifestOnSwitchTrack?(le.push(xt),Q.getIsUpdating()||(x.debug("Stream -  Refreshing manifest for switch track"),Q.refreshManifest())):pn.selectMediaInfo(an).then((function(){an.type!==u.Z.VIDEO&&an.type!==u.Z.AUDIO||Ee.updateTopQualityIndex(an),pn.prepareTrackSwitch()}))}}},prepareQualityChange:function(xt){var an=Tt(xt.mediaType);an&&an.prepareQualityChange(xt)}},(function(){try{Le=(0,I.Z)(Re).getInstance(),x=Le.getLogger(C),Ve(),be=(0,Gs.Z)(Re).getInstance(),se=Zi(Re).create({updateEventName:E.Z.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:E.Z.SEGMENT_LOCATION_BLACKLIST_ADD}),z=kl(Re).create({streamInfo:ze,mediaPlayerModel:te,dashMetrics:J,errHandler:Ce,settings:St,boxParser:be,dashConstants:d.Z,urlUtils:xe})}catch(xt){throw xt}})(),C}Tr.__dashjs_factory_name="Stream";var ms=b.Z.getClassFactory(Tr),Va=function D(C){(function(x,B){if(!(x instanceof B))throw new TypeError("Cannot call a class as a function")})(this,D),this.url=C||null,this.type=Be.w.CONTENT_STEERING_TYPE,this.responseType="json"},Ra=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.version=null,this.ttl=300,this.reloadUri=null,this.pathwayPriority=[],this.pathwayClones=[]};function ol(){var D,C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be=this.context,Le=(0,ut.Z)(be).getInstance();function Me(Ee){P(Ee,"baseUrl")}function le(Ee){P(Ee,"location")}function Re(Ee){if(Ee&&Ee.request&&Ee.request.serviceLocation&&Ee.request.requestStartDate&&Ee.request.requestEndDate&&!isNaN(Ee.request.bytesTotal)){var ae=Ee.request.serviceLocation,Se=Ee.request.requestEndDate.getTime()-Ee.request.requestStartDate.getTime();xe(ae,parseInt(8*Ee.request.bytesTotal/Se*1e3))}}function ue(Ee){Ee&&Ee.httpRequest&&Ee.httpRequest._serviceLocation&&!isNaN(Ee.throughput)&&xe(Ee.httpRequest._serviceLocation,1e3*Ee.throughput)}function xe(Ee,ae){q[Ee]||(q[Ee]=[]),q[Ee].push(ae),q[Ee].length>4&&q[Ee].shift()}function P(Ee,ae){if(Ee&&Ee.request&&Ee.request.serviceLocation){var Se=Ee.request.serviceLocation;B[ae].all.indexOf(Se)===-1&&B[ae].all.push(Se),B[ae].current=Se}}function te(){var Ee=ie.getValue(),ae=Ne.getContentSteering(Ee);return ae||(ae=oe.getServiceDescriptionSettings().contentSteering),ae}function J(){return new Promise((function(Ee){try{var ae=te();if(!ae||!ae.serverUrl)return void Ee();var Se=(function(We){var je=We.serverUrl;x&&x.reloadUri&&(je=Le.isRelative(x.reloadUri)?Le.resolve(x.reloadUri,We.serverUrl):x.reloadUri);var Xe=[],ze=B.baseUrl.all.concat(B.location.all);if(ze.length>0){var St=ze.map((function(yt){var un=(function(Ve){if(!Ve||!q[Ve]||q[Ve].length===0)return-1;var tt=q[Ve].reduce((function(Nt,lt){return Nt+lt}))/q[Ve].length;return parseInt(tt)})(yt);return{serviceLocation:yt,throughput:un}}));St.sort((function(yt,un){return un.throughput-yt.throughput}));var At="",pt="";St.forEach((function(yt,un){un!==0&&(At="".concat(At,","),yt.throughput>-1&&(pt="".concat(pt,","))),At="".concat(At).concat(yt.serviceLocation),yt.throughput>-1&&(pt="".concat(pt).concat(yt.throughput))})),Xe.push({key:"_DASH_pathway",value:'"'.concat(At,'"')}),Xe.push({key:"_DASH_throughput",value:pt})}return je=Ht.Z.addAditionalQueryParameterToUrl(je,Xe)})(ae),Pe=new Va(Se);k.load({request:Pe,success:function(We){(function(je){je&&je[d.Z.CONTENT_STEERING_RESPONSE.VERSION]&&parseInt(je[d.Z.CONTENT_STEERING_RESPONSE.VERSION])===1&&((x=new Ra).version=je[d.Z.CONTENT_STEERING_RESPONSE.VERSION],je[d.Z.CONTENT_STEERING_RESPONSE.TTL]&&!isNaN(je[d.Z.CONTENT_STEERING_RESPONSE.TTL])&&(x.ttl=je[d.Z.CONTENT_STEERING_RESPONSE.TTL]),je[d.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]&&(x.reloadUri=je[d.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]),je[d.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]&&(x.pathwayPriority=je[d.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]),je[d.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES]&&(x.pathwayClones=je[d.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES],x.pathwayClones=x.pathwayClones.filter((function(Xe){return(function(ze){return ze[d.Z.CONTENT_STEERING_RESPONSE.BASE_ID]&&ze[d.Z.CONTENT_STEERING_RESPONSE.ID]&&ze[d.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT]&&ze[d.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][d.Z.CONTENT_STEERING_RESPONSE.HOST]})(Xe)}))),Ae())})(We),se.trigger(T.Z.CONTENT_STEERING_REQUEST_COMPLETED,{currentSteeringResponseData:x,url:Se}),Ee()},error:function(We,je,Xe,ze){(function(St,At){try{switch(C.warn("Error fetching data from content steering server",St),At.status){case 410:break;case 429:var pt=At&&At.getResponseHeader?At.getResponseHeader("retry-after"):null;pt!==null&&(x||(x={}),x.ttl=parseInt(pt)),Ae();break;default:Ae()}}catch(yt){C.error(yt)}})(We,ze),Ee(We)},complete:function(){B.baseUrl.all=Q(B.baseUrl),B.location.all=Q(B.location)}})}catch(We){Ee(We)}}))}function Q(Ee){return Ee.all&&Ee.all.length!==0&&Ee.current?Ee.all.filter((function(ae){return ae===Ee.current})):[]}function j(Ee){try{var ae=[];return Ee&&Ee.length!==0&&x&&x.pathwayClones&&x.pathwayClones.length!==0&&x.pathwayClones.forEach((function(Se){var Pe=Ee.filter((function(St){return Se[d.Z.CONTENT_STEERING_RESPONSE.BASE_ID]===St.serviceLocation})),We=null;if(Pe&&Pe.length>0&&(We=Pe[0]),We){var je=new URL(We.url),Xe=Se[d.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][d.Z.CONTENT_STEERING_RESPONSE.HOST];Xe=Ht.Z.stringHasProtocol(Xe)?Xe:"".concat(je.protocol,"//").concat(Xe);var ze={synthesizedUrl:"".concat(Xe).concat(je.pathname),serviceLocation:Se[d.Z.CONTENT_STEERING_RESPONSE.ID],queryParams:Se[d.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][d.Z.CONTENT_STEERING_RESPONSE.PARAMS],reference:We};ae.push(ze)}})),ae}catch(Se){return C.error(Se),[]}}function Ae(){x&&x.ttl&&!isNaN(x.ttl)&&(Y&&clearTimeout(Y),Y=setTimeout((function(){J()}),1e3*x.ttl))}function ve(){Y&&clearTimeout(Y),Y=null}function Ce(){x=null,q={},B={baseUrl:{current:null,all:[]},location:{current:null,all:[]}},ve()}return D={reset:function(){Ce(),se.off(T.Z.FRAGMENT_LOADING_STARTED,Me,D),se.off(T.Z.MANIFEST_LOADING_STARTED,le,D),se.off(T.Z.MANIFEST_LOADING_FINISHED,Re,D),se.off(T.Z.THROUGHPUT_MEASUREMENT_STORED,ue,D)},setConfig:function(Ee){Ee&&(Ee.adapter&&(Ne=Ee.adapter),Ee.errHandler&&(K=Ee.errHandler),Ee.dashMetrics&&(re=Ee.dashMetrics),Ee.mediaPlayerModel&&(ge=Ee.mediaPlayerModel),Ee.requestModifier&&(z=Ee.requestModifier),Ee.manifestModel&&(ie=Ee.manifestModel),Ee.serviceDescriptionController&&(oe=Ee.serviceDescriptionController),Ee.eventBus&&(se=Ee.eventBus))},loadSteeringData:J,getCurrentSteeringResponseData:function(){return x},shouldQueryBeforeStart:function(){var Ee=te();return!!Ee&&Ee.queryBeforeStart},getSteeringDataFromManifest:te,stopSteeringRequestTimer:ve,getSynthesizedBaseUrlElements:function(Ee){try{return j(Ee).map((function(ae){var Se=new zi(ae.synthesizedUrl,ae.serviceLocation);return Se.queryParams=ae.queryParams,Se.dvbPriority=ae.reference.dvbPriority,Se.dvbWeight=ae.reference.dvbWeight,Se.availabilityTimeOffset=ae.reference.availabilityTimeOffset,Se.availabilityTimeComplete=ae.reference.availabilityTimeComplete,Se}))}catch(ae){return C.error(ae),[]}},getSynthesizedLocationElements:function(Ee){try{return j(Ee).map((function(ae){var Se=new Rn(ae.synthesizedUrl,ae.serviceLocation);return Se.queryParams=ae.queryParams,Se}))}catch(ae){return C.error(ae),[]}},initialize:function(){k=vi(be).create({errHandler:K,dashMetrics:re,mediaPlayerModel:ge,requestModifier:z,errors:X}),se.on(T.Z.FRAGMENT_LOADING_STARTED,Me,D),se.on(T.Z.MANIFEST_LOADING_STARTED,le,D),se.on(T.Z.MANIFEST_LOADING_FINISHED,Re,D),se.on(T.Z.THROUGHPUT_MEASUREMENT_STORED,ue,D)}},C=(0,I.Z)(be).getInstance().getLogger(D),Ce(),D}ol.__dashjs_factory_name="ContentSteeringController";var Hr=b.Z.getSingletonFactory(ol);function Ia(){var D,C,x,B=this.context,q=(0,Ie.Z)(B).getInstance();return D={select:function(Y){if(!Y||Y.length===0)return null;var k=null;return q.get().streaming.applyContentSteering&&(k=(function(K){var re=x.getCurrentSteeringResponseData();return re&&re.pathwayPriority&&re.pathwayPriority.length>0?(function(){for(var ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],z=0,oe=null,se=function(){var Ne=ge[z],be=ie.findIndex((function(Le){return Le.serviceLocation&&Le.serviceLocation===Ne}));if(be!==-1&&!C.contains(ie[be].serviceLocation))return oe=ie[be],"break";z+=1};z<ge.length&&se()!=="break";);return oe})(re.pathwayPriority,K):null})(Y)),k||(k=(function(K){return K[0]})(Y)),k},setConfig:function(Y){Y.blacklistController&&(C=Y.blacklistController),Y.contentSteeringController&&(x=Y.contentSteeringController)},reset:function(){C.reset()}},C=Zi(B).create({updateEventName:E.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:E.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD}),x=Hr(B).getInstance(),D}Ia.__dashjs_factory_name="LocationSelector";var da=b.Z.getClassFactory(Ia);function ps(){var D,C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne=this.context,be=(0,_.Z)(Ne).getInstance(),Le=(0,ut.Z)(Ne).getInstance();function Me(){x=NaN,k=!1,q=!0,Y=!1,le()}function le(){B!==null&&(clearTimeout(B),B=null)}function Re(ve){le(),Y||(isNaN(ve)&&!isNaN(x)&&(ve=1e3*x),isNaN(ve)||(C.debug("Refresh manifest in "+ve+" milliseconds."),B=setTimeout(te,ve)))}function ue(){var ve=arguments.length>0&&arguments[0]!==void 0&&arguments[0];k=!0;var Ce=re.getValue(),Ee=Ce.url,ae=null,Se=ie.getPatchLocation(Ce),Pe=ge.select(Se),We=null;if(Pe&&!ve)Ee=Pe.url,ae=Pe.serviceLocation,We=Pe.queryParams;else{var je=xe(Ce),Xe=ge.select(je);Xe&&(Ee=Xe.url,ae=Xe.serviceLocation,We=Xe.queryParams)}Le.isRelative(Ee)&&(Ee=Le.resolve(Ee,Ce.url)),K.load(Ee,ae,We)}function xe(ve){var Ce=ie.getLocation(ve),Ee=oe.getSynthesizedLocationElements(Ce);return Ce.concat(Ee)}function P(ve){if(ve){if(ie.getIsPatch(ve)){var Ce=ve;ve=re.getValue();var Ee=ie.isPatchValid(ve,Ce),ae=Ee;if(Ee){var Se=ie.getPublishTime(ve);ae=ie.applyPatchToManifest(ve,Ce);var Pe=ie.getPublishTime(ve);ae=Se.getTime()!=Pe.getTime()}if(!ae)return C.debug("Patch provided is invalid, performing full manifest refresh"),void ue(!0);ve.loadedTime=new Date}}else(ve=re.getValue()).loadedTime=new Date;if(re.getValue()&&re.getValue().type===d.Z.DYNAMIC&&ve.type===d.Z.STATIC)return be.trigger(E.Z.DYNAMIC_TO_STATIC),k=!1,void(Y=!0);re.setValue(ve);var We=new Date,je=(We.getTime()-ve.loadedTime.getTime())/1e3;1e3*(x=ie.getManifestUpdatePeriod(ve,je))>2147483647&&(x=2147483647e-3),be.trigger(E.Z.MANIFEST_UPDATED,{manifest:ve}),C.info("Manifest has been refreshed at "+We+"["+We.getTime()/1e3+"] "),q||Re()}function te(){q||(k?Re(se.get().streaming.manifestUpdateRetryInterval):ue())}function J(ve){ve.error?ve.error.code===X.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&z.error(ve.error):P(ve.manifest)}function Q(){q=!1,Re()}function j(){(q=!se.get().streaming.scheduling.scheduleWhilePaused)&&le()}function Ae(){k=!1}return D={initialize:function(){Me(),be.on(E.Z.STREAMS_COMPOSED,Ae,this),be.on(T.Z.PLAYBACK_STARTED,Q,this),be.on(T.Z.PLAYBACK_PAUSED,j,this),be.on(E.Z.INTERNAL_MANIFEST_LOADED,J,this)},setManifest:function(ve){P(ve)},refreshManifest:ue,getIsUpdating:function(){return k},setConfig:function(ve){ve&&(ve.manifestModel&&(re=ve.manifestModel),ve.adapter&&(ie=ve.adapter),ve.manifestLoader&&(K=ve.manifestLoader),ve.errHandler&&(z=ve.errHandler),ve.locationSelector&&(ge=ve.locationSelector),ve.settings&&(se=ve.settings),ve.contentSteeringController&&(oe=ve.contentSteeringController))},reset:function(){be.off(T.Z.PLAYBACK_STARTED,Q,this),be.off(T.Z.PLAYBACK_PAUSED,j,this),be.off(E.Z.STREAMS_COMPOSED,Ae,this),be.off(E.Z.INTERNAL_MANIFEST_LOADED,J,this),Me()}},C=(0,I.Z)(Ne).getInstance().getLogger(D),ge=da(Ne).create(),D}ps.__dashjs_factory_name="ManifestUpdater";var Xc=b.Z.getClassFactory(ps);function ll(){var D,C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le=this.context,Me=(0,_.Z)(Le).getInstance(),le=(0,ut.Z)(Le).getInstance();function Re(){K=[],re=[],ge=null,ie=null,oe=null,z=NaN,x=!1,B=!1,se=q.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function ue(){q.get().streaming.utcSynchronization.enabled&&!x&&!B&&oe&&oe.value&&oe.schemeIdUri&&!isNaN(z)&&!isNaN(q.get().streaming.utcSynchronization.backgroundAttempts)&&(ie&&(Date.now()-ie)/1e3<30||(K=[],B=!0,xe(isNaN(q.get().streaming.utcSynchronization.backgroundAttempts)?2:q.get().streaming.utcSynchronization.backgroundAttempts)))}function xe(Xe){try{if(Xe<=0)return void We();var ze=Date.now();Y[oe.schemeIdUri](oe.value,(function(St){var At=Date.now(),pt=te(ze,At,St);K.push(pt),xe(Xe-1)}),(function(){We()}))}catch{We()}}function P(){var Xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,ze=Xe||0;if(!re||re.length===0||ze>=re.length)J();else{var St=re[ze];if(St)if(Y.hasOwnProperty(St.schemeIdUri)){var At=new Date().getTime();Y[St.schemeIdUri](St.value,(function(pt){var yt=new Date().getTime(),un=te(At,yt,pt);oe=St,J(un)}),(function(){P(ze+1)}))}else P(ze+1);else J()}}function te(Xe,ze,St){return St-(ze-(ze-Xe)/2)}function J(){var Xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NaN,ze=isNaN(Xe);ze&&q.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?Se():Pe(ze,Xe)}function Q(Xe){var ze=Date.parse(Xe);return isNaN(ze)&&(ze=(function(St){var At,pt,yt=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(St);return At=Date.UTC(parseInt(yt[1],10),parseInt(yt[2],10)-1,parseInt(yt[3],10),parseInt(yt[4],10),parseInt(yt[5],10),yt[6]&&(parseInt(yt[6],10)||0),yt[7]&&1e3*parseFloat(yt[7])||0),yt[9]&&yt[10]&&(pt=60*parseInt(yt[9],10)+parseInt(yt[10],10),At+=(yt[8]==="+"?-1:1)*pt*60*1e3),new Date(At).getTime()})(Xe)),ze}function j(Xe){return Date.parse(Xe)}function Ae(Xe){return Date.parse(Xe)}function ve(Xe,ze,St){St()}function Ce(Xe,ze,St){var At=Q(Xe);isNaN(At)?St():ze(At)}function Ee(Xe,ze,St,At,pt){var yt,un,Ve=!1,tt=new XMLHttpRequest,Nt=pt?Be.w.HEAD:Be.w.GET,lt=ze.match(/\S+/g);if(ze=lt.shift(),yt=function(){Ve||(Ve=!0,lt.length?Ee(Xe,lt.join(" "),St,At,pt):At())},un=function(){var Ft,Ct;tt.status===200&&(Ft=pt?tt.getResponseHeader("Date"):tt.response,Ct=Xe(Ft),isNaN(Ct)||(St(Ct),Ve=!0))},le.isRelative(ze)){var Bt=be.resolve();Bt&&(ze=le.resolve(ze,Bt.url))}tt.open(Nt,ze),tt.timeout=5e3,tt.onload=un,tt.onloadend=yt,tt.send()}function ae(Xe,ze,St){Ee(Ae,Xe,ze,St,!0)}function Se(){var Xe=k.getLatestMPDRequestHeaderValueByID("Date"),ze=Xe!==null?new Date(Xe).getTime():Number.NaN;isNaN(ze)?Pe(!0):Pe(!1,ze-Date.now())}function Pe(Xe,ze){if(isNaN(z)||isNaN(ze)||Xe||(function(At){try{var pt,yt=je(At),un=isNaN(se)?30:se,Ve=isNaN(q.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?2:q.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,tt=isNaN(q.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?600:q.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,Nt=isNaN(q.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?2:q.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts;yt?(pt=Math.min(un*Ve,tt),C.debug("Increasing timeBetweenSyncAttempts to ".concat(pt))):(pt=Math.max(un/Ve,Nt),C.debug("Decreasing timeBetweenSyncAttempts to ".concat(pt))),se=pt}catch{}})(ze),!Xe&&!isNaN(ze)){ge=Date.now(),x=!1;var St=isNaN(z);z=ze,St&&ue(),C.debug("Completed UTC sync. Setting client - server offset to ".concat(ze))}Xe&&(oe=null,x=!1,Ne.error(new fe.Z(X.TIME_SYNC_FAILED_ERROR_CODE,X.TIME_SYNC_FAILED_ERROR_MESSAGE))),Me.trigger(E.Z.UPDATE_TIME_SYNC_OFFSET,{offset:ze}),Me.trigger(E.Z.TIME_SYNCHRONIZATION_COMPLETED)}function We(){if(K&&K.length!==0){var Xe=K.reduce((function(ze,St){return ze+St}),0)/K.length;je(Xe)?C.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(C.debug("Completed background UTC sync. Setting client - server offset to ".concat(Xe)),z=Xe,Me.trigger(E.Z.UPDATE_TIME_SYNC_OFFSET,{offset:z})),B=!1,ie=Date.now()}}function je(Xe){try{if(isNaN(z))return!0;var ze=q.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(q.get().streaming.utcSynchronization.maximumAllowedDrift)?q.get().streaming.utcSynchronization.maximumAllowedDrift:100;return Xe>=z-ze&&Xe<=z+ze}catch{return!0}}return D={initialize:function(){Re(),Y={"urn:mpeg:dash:utc:http-head:2014":ae,"urn:mpeg:dash:utc:http-xsdate:2014":Ee.bind(null,Q),"urn:mpeg:dash:utc:http-iso:2014":Ee.bind(null,j),"urn:mpeg:dash:utc:direct:2014":Ce,"urn:mpeg:dash:utc:http-head:2012":ae,"urn:mpeg:dash:utc:http-xsdate:2012":Ee.bind(null,Q),"urn:mpeg:dash:utc:http-iso:2012":Ee.bind(null,j),"urn:mpeg:dash:utc:direct:2012":Ce,"urn:mpeg:dash:utc:http-ntp:2014":ve,"urn:mpeg:dash:utc:ntp:2014":ve,"urn:mpeg:dash:utc:sntp:2014":ve}},attemptSync:function(Xe,ze){re=Xe,x||((function(St){try{if(!St||!q.get().streaming.utcSynchronization.enabled)return!1;var At=isNaN(se)?30:se;return!(ge&&At&&!isNaN(At))||(Date.now()-ge)/1e3>=At}catch{return!0}})(ze)?(x=!0,P()):Me.trigger(E.Z.TIME_SYNCHRONIZATION_COMPLETED))},setConfig:function(Xe){Xe&&(Xe.dashMetrics&&(k=Xe.dashMetrics),Xe.baseURLController&&(be=Xe.baseURLController),Xe.errHandler&&(Ne=Xe.errHandler),Xe.settings&&(q=Xe.settings))},reset:function(){Re(),Me.off(E.Z.ATTEMPT_BACKGROUND_SYNC,ue,D)}},C=(0,I.Z)(Le).getInstance().getLogger(D),Me.on(E.Z.ATTEMPT_BACKGROUND_SYNC,ue,D),D}ll.__dashjs_factory_name="TimeSyncController";var ul=b.Z.getSingletonFactory(ll);ul.HTTP_TIMEOUT_MS=5e3,b.Z.updateSingletonFactory(ll.__dashjs_factory_name,ul);var cl=ul;function fl(){var D,C,x,B,q,Y=this.context,k=(0,_.Z)(Y).getInstance();return D={attachMediaSource:function(K){var re=window.URL.createObjectURL(C);return K.setSource(re),B==="managedMediaSource"&&(K.setDisableRemotePlayback(!0),C.addEventListener("startstreaming",(function(){k.trigger(T.Z.MANAGED_MEDIA_SOURCE_START_STREAMING)})),C.addEventListener("endstreaming",(function(){k.trigger(T.Z.MANAGED_MEDIA_SOURCE_END_STREAMING)}))),re},createMediaSource:function(){var K="WebKitMediaSource"in window,re="MediaSource"in window;return"ManagedMediaSource"in window?(C=new ManagedMediaSource,B="managedMediaSource",q.info("Created ManagedMediaSource")):re?(C=new MediaSource,B="mediaSource",q.info("Created MediaSource")):K&&(C=new WebKitMediaSource,q.info("Created WebkitMediaSource")),C},detachMediaSource:function(K){K.setSource(null)},setConfig:function(K){K&&K.settings&&(x=K.settings)},setDuration:function K(re){C&&C.readyState==="open"&&(re===null&&isNaN(re)||C.duration!==re&&(re!==1/0||x.get().streaming.buffer.mediaSourceDurationInfinity||(re=Math.pow(2,32)),(function(ge){for(var ie=ge.sourceBuffers,z=0;z<ie.length;z++)if(ie[z].updating)return!0;return!1})(C)?setTimeout(K.bind(null,re),50):(q.info("Set MediaSource duration:"+re),C.duration=re)))},setSeekable:function(K,re){C&&typeof C.setLiveSeekableRange=="function"&&typeof C.clearLiveSeekableRange=="function"&&C.readyState==="open"&&K>=0&&K<re&&(C.clearLiveSeekableRange(),C.setLiveSeekableRange(K,re))},signalEndOfStream:function(K){if(K&&K.readyState==="open"){for(var re=K.sourceBuffers,ge=0;ge<re.length;ge++)if(re[ge].updating||re[ge].buffered.length===0)return;q.info("call to mediaSource endOfStream"),K.endOfStream()}}},q=(0,I.Z)(Y).getInstance().getLogger(D),D}fl.__dashjs_factory_name="MediaSourceController";var Qc=b.Z.getSingletonFactory(fl);function Jc(){var D,C,x,B,q,Y,k,K,re,ge,ie,z="urn:mpeg:dash:event:2012",oe="discarded",se="updated",Ne="added",be=this.context,Le=(0,_.Z)(be).getInstance();function Me(){if(!k||!K)throw new Error("setConfig function has to be called previously")}function le(){ie=!1,x={},B={},q=null,ge=!1,Y=Date.now()/1e3}function Re(){try{if(!ge){ge=!0;var ve=K.getTime(),Ce=ve-Y;Ce=Y>0?Math.max(0,Ce):0,ue(B,Ce,ve),ue(x,Ce,ve),xe(B),xe(x),Y=ve,ge=!1}}catch(Ee){ge=!1,C.error(Ee)}}function ue(ve,Ce,Ee){try{Q(ve,(function(ae){if(ae!==void 0){var Se=isNaN(ae.duration)?0:ae.duration;ae.calculatedPresentationTime<=Ee&&ae.calculatedPresentationTime+Ce+Se>=Ee?Ae(ae,T.Z.EVENT_MODE_ON_START):(j(Ee,Se+Ce,ae.calculatedPresentationTime)||(function(Pe){try{var We=Pe.eventStream.period.start+Pe.eventStream.period.duration;return Pe.calculatedPresentationTime>We}catch(je){return C.error(je),!1}})(ae))&&(C.debug("Removing event ".concat(ae.id," from period ").concat(ae.eventStream.period.id," as it is expired or invalid")),(function(Pe,We){try{var je=We.eventStream.schemeIdUri,Xe=We.eventStream.period.id,ze=We.eventStream.value,St=We.id;Pe[Xe][je]=Pe[Xe][je].filter((function(At){return ze&&At.eventStream.value&&At.eventStream.value!==ze||At.id!==St})),Pe[Xe][je].length===0&&delete Pe[Xe][je]}catch(At){C.error(At)}})(ve,ae))}}))}catch(ae){C.error(ae)}}function xe(ve){try{for(var Ce in ve)ve.hasOwnProperty(Ce)&&Object.keys(ve[Ce]).length===0&&delete ve[Ce]}catch(Ee){C.error(Ee)}}function P(ve,Ce){var Ee=arguments.length>2&&arguments[2]!==void 0&&arguments[2],ae=ve.eventStream.schemeIdUri,Se=ve.eventStream.value,Pe=ve.id,We=oe;Ce[ae]||(Ce[ae]=[]);var je=Ce[ae].findIndex((function(ze){return(!Se||ze.eventStream.value&&ze.eventStream.value===Se)&&ze.id===Pe}));if(je===-1)Ce[ae].push(ve),ve.triggeredReceivedEvent=!1,ve.triggeredStartEvent=!1,We=Ne;else if(Ee){var Xe=Ce[ae][je];ve.triggeredReceivedEvent=Xe.triggeredReceivedEvent,ve.triggeredStartEvent=Xe.triggeredStartEvent,Ce[ae][je]=ve,We=se}return We}function te(ve){try{if(ve.eventStream.value==1){var Ce,Ee=ve.calculatedPresentationTime;Ce=ve.calculatedPresentationTime==4294967295?NaN:ve.calculatedPresentationTime+ve.duration,Le.trigger(T.Z.MANIFEST_VALIDITY_CHANGED,{id:ve.id,validUntil:Ee,newDuration:Ce,newManifestValidAfter:NaN},{mode:T.Z.EVENT_MODE_ON_START})}}catch(ae){C.error(ae)}}function J(ve){try{var Ce=K.getTime();Q(ve,(function(Ee){var ae=Ee.eventStream&&Ee.eventStream.period&&!isNaN(Ee.eventStream.period.duration)?Ee.eventStream.period.duration:NaN,Se=Ee.eventStream&&Ee.eventStream.period&&!isNaN(Ee.eventStream.period.start)?Ee.eventStream.period.start:NaN;if(!isNaN(ae)&&!isNaN(Se)){var Pe=Ee.calculatedPresentationTime;Math.abs(Pe-Ce)<300&&Ae(Ee,T.Z.EVENT_MODE_ON_START)}}))}catch(Ee){C.error(Ee)}}function Q(ve,Ce){try{if(ve)for(var Ee=Object.keys(ve),ae=0;ae<Ee.length;ae++)for(var Se=ve[Ee[ae]],Pe=Object.keys(Se),We=0;We<Pe.length;We++)Se[Pe[We]].forEach((function(je){je!==void 0&&Ce(je)}))}catch(je){C.error(je)}}function j(ve,Ce,Ee){try{return ve-Ce>Ee}catch(ae){return C.error(ae),!1}}function Ae(ve,Ce){try{var Ee=K.getTime(),ae=ve.id;if(Ce===T.Z.EVENT_MODE_ON_RECEIVE&&!ve.triggeredReceivedEvent)return C.debug("Received event ".concat(ae)),ve.triggeredReceivedEvent=!0,void Le.trigger(ve.eventStream.schemeIdUri,{event:ve},{mode:Ce});ve.triggeredStartEvent||(ve.eventStream.schemeIdUri===z&&ve.eventStream.value==1?ve.duration===0&&ve.presentationTimeDelta===0||(C.debug("Starting manifest refresh event ".concat(ae," at ").concat(Ee)),(function(){try{Me(),k.refreshManifest()}catch(Se){C.error(Se)}})()):ve.eventStream.schemeIdUri==="urn:mpeg:dash:event:callback:2015"&&ve.eventStream.value==1?(C.debug("Starting callback event ".concat(ae," at ").concat(Ee)),(function(Se){try{(0,ln.Z)(be).create({}).load({method:"get",url:Se,request:{responseType:"arraybuffer"}})}catch(Pe){C.error(Pe)}})(ve.messageData)):(C.debug("Starting event ".concat(ae," from period ").concat(ve.eventStream.period.id," at ").concat(Ee)),Le.trigger(ve.eventStream.schemeIdUri,{event:ve},{mode:Ce})),ve.triggeredStartEvent=!0)}catch(Se){C.error(Se)}}return D={addInlineEvents:function(ve,Ce){try{if(Me(),x[Ce]||(x[Ce]={}),ve)for(var Ee=0;Ee<ve.length;Ee++){var ae=ve[Ee];if(!j(K.getTime(),isNaN(ae.duration)?0:ae.duration,ae.calculatedPresentationTime)){var Se=P(ae,x[Ce],!0);Se===Ne?(C.debug("Added inline event with id ".concat(ae.id," from period ").concat(Ce)),Ae(ae,T.Z.EVENT_MODE_ON_RECEIVE)):Se===se&&C.debug("Updated inline event with id ".concat(ae.id," from period ").concat(Ce))}}}catch(Pe){throw Pe}},addInbandEvents:function(ve,Ce){try{Me(),B[Ce]||(B[Ce]={});for(var Ee=0;Ee<ve.length;Ee++){var ae=ve[Ee];j(K.getTime(),isNaN(ae.duration)?0:ae.duration,ae.calculatedPresentationTime)||(P(ae,B[Ce],!1)===Ne?(ae.eventStream.schemeIdUri===z&&te(ae),C.debug("Added inband event with id ".concat(ae.id," from period ").concat(Ce)),Ae(ae,T.Z.EVENT_MODE_ON_RECEIVE)):C.debug("Inband event with scheme_id_uri ".concat(ae.eventStream.schemeIdUri,", value ").concat(ae.eventStream.value,", period id ").concat(Ce," and event id ").concat(ae.id," was ignored because it has been added before.")))}Re()}catch(Se){throw Se}},getInbandEvents:function(){return B},getInlineEvents:function(){return x},start:function(){try{Me(),C.debug("Start Event Controller");var ve=re.get().streaming.eventControllerRefreshDelay;ie||isNaN(ve)||(ie=!0,q=setInterval(Re,ve))}catch(Ce){throw Ce}},setConfig:function(ve){try{if(!ve)return;ve.manifestUpdater&&(k=ve.manifestUpdater),ve.playbackController&&(K=ve.playbackController),ve.settings&&(re=ve.settings)}catch(Ce){throw Ce}},reset:function(){(function(){try{q!==null&&ie&&(clearInterval(q),q=null,ie=!1,(function(){try{J(B),J(x)}catch(ve){C.error(ve)}})())}catch(ve){throw ve}})(),le()}},C=(0,I.Z)(be).getInstance().getLogger(D),le(),D}Jc.__dashjs_factory_name="EventController";var Xd=b.Z.getSingletonFactory(Jc),yo={LEVELS:{WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}};function dl(D,C){(C==null||C>D.length)&&(C=D.length);for(var x=0,B=new Array(C);x<C;x++)B[x]=D[x];return B}function ef(){var D,C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le,Me,le,Re,ue,xe,P,te,J,Q,j,Ae,ve,Ce,Ee,ae,Se,Pe,We,je,Xe,ze,St,At,pt,yt,un,Ve,tt,Nt,lt,Bt,Ft=this.context,Ct=(0,_.Z)(Ft).getInstance();function vn(){if(!(Y&&Y.hasOwnProperty("load")&&ue&&ue.hasOwnProperty("initialize")&&ue.hasOwnProperty("reset")&&ue.hasOwnProperty("getClientTimeOffset")&&k&&Re&&re&&Se))throw new Error(u.Z.MISSING_CONFIG_ERROR)}function yn(){if(!q||!q.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}function Fn(){(function(){try{var dt=K.getStreamsInfo();if(!P&&dt.length===0)throw new Error("There are no periods in the MPD");P&&dt.length>0&&re.updateManifestUpdateInfo({currentTime:Se.getTime(),buffered:ae.getBufferRange(),presentationStartTime:dt[0].start,clientTimeOffset:ue.getClientTimeOffset()}),xe.length>0&&(function(Kn){Kn.length!==0?xe=xe.filter((function(qn){var Cr=Kn.filter((function(Sr){return Sr.id===qn.getId()})).length>0||qn.getId()===P.getId();return Cr||(C.debug("Removing stream ".concat(qn.getId())),qn.reset(!0)),Cr})):C.warn("No periods included in the current manifest. Skipping the filtering of outdated stream objects.")})(dt);for(var Xt=[],Dn=0,Un=dt.length;Dn<Un;Dn++){var Vn=dt[Dn];Xt.push(st(Vn)),re.addManifestUpdateStreamInfo(Vn)}Promise.all(Xt).then((function(){return new Promise((function(Kn,qn){P?Kn():Mt(dt,Kn,qn)}))})).then((function(){Ct.trigger(E.Z.STREAMS_COMPOSED),tn()})).catch((function(Kn){throw Kn}))}catch(Kn){Re.error(new fe.Z(X.MANIFEST_ERROR_ID_NOSTREAMS_CODE,Kn.message+" nostreamscomposed",k.getValue())),Ce=!0,pa()}})()}function Zn(){tt=!0}function st(dt){var Xt=ko(dt.id);return Xt?Xt.updateData(dt):(Xt=ms(Ft).create({manifestModel:k,mediaPlayerModel:We,dashMetrics:re,manifestUpdater:q,adapter:K,timelineConverter:ue,capabilities:x,capabilitiesFilter:B,errHandler:Re,baseURLController:oe,segmentBaseController:se,textController:J,abrController:be,playbackController:Se,eventController:Me,mediaController:Le,protectionController:te,videoModel:ae,streamInfo:dt,settings:Ve}),xe.push(Xt),Xt.initialize(),Promise.resolve())}function Mt(dt,Xt,Dn){try{Tn();var Un=re.getCurrentDVRInfo().range;if(Un.end<Un.start){Nt&&clearTimeout(Nt);var Vn=Math.min(1e3*(-1*(Un.end-Un.start)+2),2147483647);return C.debug("Waiting for ".concat(Vn," ms before playback can start")),Ct.trigger(E.Z.AST_IN_FUTURE,{delay:Vn}),void(Nt=setTimeout((function(){Mt(dt,Xt,Dn)}),Vn))}Ve.get().streaming.applyProducerReferenceTime&&Pe.calculateProducerReferenceTimeOffsets(dt);var Kn=dt[0].manifestInfo;if(Ve.get().streaming.applyServiceDescription&&Pe.applyServiceDescription(Kn),K.getIsDynamic()){var qn=Is(dt,Kn);Se.computeAndSetLiveDelay(qn,Kn)}(Ve.get().streaming.applyContentSteering&&z.shouldQueryBeforeStart()?z.loadSteeringData():Promise.resolve()).then((function(){var Cr=k.getValue();Cr&&oe.update(Cr),Tt(),Xt()})).catch((function(Cr){C.error(Cr),Tt(),Xt()}))}catch(Cr){Dn(Cr)}}function Tt(){var dt=(function(){var Un;if(K.getIsDynamic()){var Vn=re.getCurrentDVRInfo();Un=(Vn&&Vn.range?Vn.range.end:0)-Se.getOriginalLiveDelay();var Kn=Vn?Vn.range:null;if(Kn){if(isNaN(lt)&&lt.toString().indexOf("posix:")===-1){var qn=Ri(!0);isNaN(qn)||(C.info("Start time from URI parameters: ".concat(qn)),Un=Math.min(Un,qn))}else{C.info("Start time provided by the app: ".concat(lt));var Cr=ei(!0,lt);isNaN(Cr)||(Un=Math.min(Un,Cr))}var Sr=Ve.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0;Un=Math.max(Un,Kn.start+Sr)}}else if(Un=rs()[0].getStreamInfo().start,isNaN(lt)){var Ma=Ri(!1);isNaN(Ma)||(C.info("Start time from URI parameters: ".concat(Ma)),Un=Math.max(Un,Ma))}else{C.info("Start time provided by the app: ".concat(lt));var Pa=ei(!1,lt);isNaN(Pa)||(Un=Math.max(Un,Pa))}return Un})(),Xt=pn(dt),Dn=Xt!==null?Xt:xe[0];Ct.trigger(E.Z.INITIAL_STREAM_SWITCH,{startTime:dt}),jt(Dn,null,dt),At||(At=setInterval((function(){!Ae&&Se.getTimeToStreamEnd()<=0&&!Se.isSeeking()&&Ct.trigger(E.Z.PLAYBACK_ENDED,{isLast:pi().isLast})}),200))}function jt(dt,Xt,Dn){try{if(Ae||!dt||Xt===dt&&dt.getIsActive())return;Ae=!0,Ct.trigger(E.Z.PERIOD_SWITCH_STARTED,{fromStreamInfo:Xt?Xt.getStreamInfo():null,toStreamInfo:dt.getStreamInfo()});var Un=!1;P=dt,Xt&&(Un=an(dt,Xt),Xt.deactivate(Un)),Dn=isNaN(Dn)?!Un&&Xt?dt.getStreamInfo().start:NaN:Dn,C.info("Switch to stream ".concat(dt.getId(),". Seektime is ").concat(Dn,", current playback time is ").concat(Se.getTime(),". Seamless period switch is set to ").concat(Un)),yt=yt.filter((function(Vn){return Vn.getId()!==P.getId()})),Se.initialize(pi(),!!Xt),ae.getElement()?en(Dn,Un,!1):_n(Dn,Un)}catch{Ae=!1}}function en(dt,Xt){var Dn,Un=arguments.length>2&&arguments[2]!==void 0&&arguments[2];function Vn(){if(Ee&&Ee.readyState==="open"){C.debug("MediaSource is open!"),window.URL.revokeObjectURL(Dn),Ee.removeEventListener("sourceopen",Vn),Ee.removeEventListener("webkitsourceopen",Vn),fr();var qn=re.getCurrentDVRInfo();ge.setSeekable(qn.range.start,qn.range.end),Un?(isNaN(dt)||Se.seek(dt,!0,!0),P.setMediaSource(Ee).then((function(){P.initializeForTextWithMediaSource(Ee)}))):_n(dt,Xt)}}function Kn(){Ee.addEventListener("sourceopen",Vn,!1),Ee.addEventListener("webkitsourceopen",Vn,!1),Dn=ge.attachMediaSource(ae),C.debug("MediaSource attached to element.  Waiting on open...")}Ee?Xt?_n(dt,Xt):(ge.detachMediaSource(ae),Kn()):(Ee=ge.createMediaSource(),Kn())}function _n(dt,Xt){P.activate(Ee,Xt?pt:void 0,dt).then((function(Dn){if(Dn){var Un=Object.keys(Dn);Un.length>0&&Dn[Un[0]].getBuffer().changeType&&(un=!0),pt=Dn}isNaN(dt)||(Ct.trigger(E.Z.SEEK_TARGET,{time:dt},{streamId:P.getId()}),Se.seek(dt,!1,!0),P.startScheduleControllers()),Ae=!1,Ct.trigger(E.Z.PERIOD_SWITCH_COMPLETED,{toStreamInfo:pi()})}))}function En(dt){var Xt=pn(dt.seekTime);Xt&&Xt!==P?Xt&&Xt!==P&&(An(),(function(Dn,Un){var Vn=Dn&&!isNaN(Dn.seekTime)?Dn.seekTime:NaN,Kn=P.getProcessors().map((function(qn){return qn.prepareOuterPeriodPlaybackSeeking(Dn)}));Promise.all(Kn).then((function(){jt(Un,P,Vn)})).catch((function(qn){Re.error(qn)}))})(dt,Xt)):(An(),(function(Dn){P.getProcessors().forEach((function(Un){return Un.prepareInnerPeriodPlaybackSeeking(Dn)})),Ti(Ye.USER_REQUEST_STOP_REASON)})(dt)),ns(Qe.SEEK_START_REASON)}function An(){Ln()}function Ln(){yt&&yt.length>0&&(yt.forEach((function(dt){dt.deactivate(!0)})),yt=[])}function xt(dt){if(dt.newMediaInfo.streamInfo.id===P.getId()){if(Ln(),Ve.get().streaming.buffer.resetSourceBuffersForTrackSwitch&&dt.oldMediaInfo&&dt.oldMediaInfo.codec!==dt.newMediaInfo.codec){var Xt=Se.getTime();return P.deactivate(!1),void en(Xt,!1,!1)}P.prepareTrackChange(dt)}}function an(dt,Xt){try{return Ve.get().streaming.buffer.reuseExistingSourceBuffers&&(Xt.isProtectionCompatible(dt)||tt)&&(un&&Ve.get().streaming.buffer.useChangeTypeForTrackSwitch||Xt.isMediaCodecCompatible(dt,Xt))}catch{return!1}}function mn(dt){var Xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(Ee&&!dt.getPreloaded()){var Dn=an(dt,Xt);Dn&&dt.startPreloading(Ee,pt).then((function(){yt.push(dt)}))}}function pn(dt){if(isNaN(dt))return null;for(var Xt=xe.length,Dn=0;Dn<Xt;Dn++){var Un=xe[Dn];if(dt<parseFloat((Un.getStartTime()+Un.getDuration()).toFixed(5)))return Un}return null}function Tn(){try{var dt=K.getIsDynamic(),Xt=K.getStreamsInfo()[0].manifestInfo,Dn=Se.getTime(),Un=ue.calcTimeShiftBufferWindow(xe,dt),Vn=cr();if(Un.start===void 0||Un.end===void 0)return;Vn&&Vn.length!==0?Vn.forEach((function(Kn){re.addDVRInfo(Kn.getType(),Dn,Xt,Un)})):re.addDVRInfo(u.Z.VIDEO,Dn,Xt,Un)}catch{}}function ot(dt){if(ze&&j){var Xt=We.getInitialBufferLevel(),Dn=[u.Z.TEXT];(isNaN(Xt)||Xt<=Se.getBufferLevel(Dn)||K.getIsDynamic()&&Xt>Se.getLiveDelay())&&(ze=!1,ns(Qe.INITIAL_PLAYOUT_START_REASON),Se.play())}dt&&dt.mediaType&&re.addBufferLevel(dt.mediaType,new Date,1e3*dt.bufferLevel)}function $e(dt){dt.streamInfo.id===P.getId()&&dt.reason&&dt.reason.forceReplace&&Ln(),ko(dt.streamInfo.id).prepareQualityChange(dt)}function bt(){if(K.getIsDynamic()&&Se.getOriginalLiveDelay()!==0&&P){var dt=K.getStreamsInfo();if(dt.length>0){var Xt=dt[0].manifestInfo,Dn=Is(dt,Xt);Se.computeAndSetLiveDelay(Dn,Xt)}}}function we(){if(ta()){var dt=ae.getPlaybackQuality();dt&&re.addDroppedFrames(dt)}}function Ue(){C.debug("[onPlaybackStarted]"),!ze&&Xe&&ns(Qe.RESUME_FROM_PAUSE_START_REASON),ze&&(ze=!1),St&&(St=!1,Ve.get().streaming.applyContentSteering&&!z.shouldQueryBeforeStart()&&z.loadSteeringData()),Xe=!1}function ft(dt){C.debug("[onPlaybackPaused]"),dt.ended||(Xe=!0,Ti(Ye.USER_REQUEST_STOP_REASON))}function zt(dt){C.debug("Stream with id ".concat(dt.streamInfo.id," finished buffering"));var Xt=dt.streamInfo.isLast;Ee&&Xt?(C.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),ge.signalEndOfStream(Ee)):tn()}function tn(){if(P&&P.getHasFinishedBuffering())for(var dt=(function(){var Vn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;try{var Kn=Vn||P||null;if(Kn){var qn=Kn.getStreamInfo();return xe.filter((function(Cr){var Sr=Cr.getStreamInfo();return Sr.start>qn.start&&qn.id!==Sr.id}))}}catch{return[]}})(P),Xt=0;Xt<dt.length;){var Dn=dt[Xt],Un=Xt===0?P:dt[Xt-1];!Dn.getPreloaded()&&Un.getHasFinishedBuffering()&&Ee&&mn(Dn,Un),Xt+=1}}function Hn(){At&&(clearInterval(At),At=null)}function cr(){return P?P.getProcessors():[]}function $r(dt){if(P&&!P.getIsEndedEventSignaled()){P.setIsEndedEventSignaled(!0);var Xt=(function(){var Dn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,Un=Dn||P||null;if(!Un)return null;for(var Vn=Un.getStreamInfo(),Kn=Vn.start,qn=0,Cr=-1,Sr=NaN;qn<xe.length;){var Ma=xe[qn].getStreamInfo(),Pa=Ma.start-Kn;Pa>0&&(isNaN(Sr)||Pa<Sr)&&Vn.id!==Ma.id&&(Sr=Pa,Cr=qn),qn+=1}return Cr>=0?xe[Cr]:null})();Xt?(C.debug("StreamController onEnded, found next stream with id ".concat(Xt.getStreamInfo().id,". Switching from ").concat(P.getStreamInfo().id," to ").concat(Xt.getStreamInfo().id)),jt(Xt,P,NaN)):(C.debug("StreamController no next stream found"),P.setIsEndedEventSignaled(!1)),Ti(Xt?Ye.END_OF_PERIOD_STOP_REASON:Ye.END_OF_CONTENT_STOP_REASON)}dt&&dt.isLast&&(Hn(),z.stopSteeringRequestTimer())}function fr(dt){var Xt=dt||pi().manifestInfo.duration;ge.setDuration(Xt)}function Ri(dt){var Xt=Ne.getURIFragmentData();if(!Xt||!Xt.t)return NaN;var Dn=rs()[0].getStreamInfo().start;return Xt.t=Xt.t.split(",")[0],ea(dt,Xt.t,Dn)}function ei(dt,Xt){var Dn=0;return dt||(Dn=rs()[0].getStreamInfo().start),ea(dt,Xt,Dn)}function ea(dt,Xt,Dn){var Un=K.getRegularPeriods()[0],Vn=Xt.toString(),Kn=Vn.indexOf("posix:")!==-1?Vn.substring(6)==="now"?Date.now()/1e3:parseFloat(Vn.substring(6)):NaN;return dt&&!isNaN(Kn)?ue.calcPresentationTimeFromWallTime(new Date(1e3*Kn),Un):parseFloat(Vn)+Dn}function Is(dt,Xt){try{var Dn=NaN;if(Xt&&!isNaN(Xt.maxFragmentDuration)&&isFinite(Xt.maxFragmentDuration))return Xt.maxFragmentDuration;if(dt&&dt.length===1){var Un=dt[0],Vn=[u.Z.VIDEO,u.Z.AUDIO,u.Z.TEXT].reduce((function(qn,Cr){var Sr=K.getMediaInfoForType(Un,Cr);return Sr&&Sr.isFragmented!==!1&&qn.push(Sr),qn}),[]).reduce((function(qn,Cr){var Sr=K.getVoRepresentations(Cr);return Sr&&Sr.length>0&&Sr.forEach((function(Ma){Ma&&qn.push(Ma)})),qn}),[]).reduce((function(qn,Cr){var Sr=K.convertRepresentationToRepresentationInfo(Cr);return Sr&&Sr.fragmentDuration&&!isNaN(Sr.fragmentDuration)&&qn.push(Sr.fragmentDuration),qn}),[]);Dn=Math.max.apply(Math,(function(qn){if(Array.isArray(qn))return dl(qn)})(Kn=Vn)||(function(qn){if(typeof Symbol<"u"&&Symbol.iterator in Object(qn))return Array.from(qn)})(Kn)||(function(qn,Cr){if(qn){if(typeof qn=="string")return dl(qn,Cr);var Sr=Object.prototype.toString.call(qn).slice(8,-1);return Sr==="Object"&&qn.constructor&&(Sr=qn.constructor.name),Sr==="Map"||Sr==="Set"?Array.from(qn):Sr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Sr)?dl(qn,Cr):void 0}})(Kn)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})())}return isFinite(Dn)?Dn:NaN}catch{return NaN}var Kn}function ts(dt){if(dt.error)Ce=!0,pa();else{C.info("Manifest updated... updating data system wide.");var Xt=dt.manifest;K.updatePeriods(Xt);var Dn=K.getUTCTimingSources();!K.getIsDynamic()||Dn&&Dn.length!==0||Ct.trigger(T.Z.CONFORMANCE_VIOLATION,{level:yo.LEVELS.WARNING,event:yo.EVENTS.NO_UTC_TIMING_ELEMENT});var Un=K.getIsDynamic()?Dn.concat(je.getUTCTimingSources()):Dn;B.filterUnsupportedFeatures(Xt).then((function(){oe.initialize(Xt),ie.attemptSync(Un,K.getIsDynamic())}))}}function ta(){return!!P&&P.getHasVideoTrack()}function ma(){return!!P&&P.getHasAudioTrack()}function Ti(dt,Xt){Xt=Xt||new Date,cr().forEach((function(Dn){Dn.finalisePlayList(Xt,dt)})),re.addPlayList()}function ns(dt){re.createPlaylistMetrics(1e3*Se.getTime(),dt)}function Cs(dt){if(dt.error){var Xt="";switch(dt.error.code){case 1:Xt="MEDIA_ERR_ABORTED";break;case 2:Xt="MEDIA_ERR_NETWORK";break;case 3:Xt="MEDIA_ERR_DECODE",Bt.counts.mediaErrorDecode+=1;break;case 4:Xt="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:Xt="MEDIA_ERR_ENCRYPTED";break;default:Xt="UNKNOWN"}Xt==="MEDIA_ERR_DECODE"&&Ve.get().errors.recoverAttempts.mediaErrorDecode>=Bt.counts.mediaErrorDecode?(function(){C.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var Dn=Se.getTime();P.deactivate(!1),C.warn("MediaSource has been resetted. Resuming playback from time ".concat(Dn)),en(Dn,!1,!1)})():(ve=!0,dt.error.message&&(Xt+=" ("+dt.error.message+")"),dt.error.msExtendedCode&&(Xt+=" (0x"+(dt.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),C.fatal("Video Element Error: "+Xt),dt.error&&C.fatal(dt.error),Re.error(new fe.Z(dt.error.code,Xt)),pa())}}function pi(){return P?P.getStreamInfo():null}function ko(dt){for(var Xt=0,Dn=xe.length;Xt<Dn;Xt++)if(xe[Xt].getId()===dt)return xe[Xt];return null}function Rl(dt){isNaN(dt.newDuration)||fr(dt.newDuration)}function Il(){xe=[],lt=NaN,te=null,Ae=!1,P=null,ve=!1,Ce=!1,ze=!0,St=!0,Xe=!1,j=!0,At=null,tt=!1,un=!1,yt=[],Nt=null,Bt={counts:{mediaErrorDecode:0}}}function pa(){vn(),ie.reset(),Ti(ve||Ce?Ye.FAILURE_STOP_REASON:Ye.USER_REQUEST_STOP_REASON);for(var dt=0,Xt=xe?xe.length:0;dt<Xt;dt++)xe[dt].reset(ve);Ct.off(T.Z.PLAYBACK_TIME_UPDATED,we,D),Ct.off(T.Z.PLAYBACK_SEEKING,En,D),Ct.off(T.Z.PLAYBACK_ERROR,Cs,D),Ct.off(T.Z.PLAYBACK_STARTED,Ue,D),Ct.off(T.Z.PLAYBACK_PAUSED,ft,D),Ct.off(T.Z.PLAYBACK_ENDED,$r,D),Ct.off(T.Z.METRIC_ADDED,Cl,D),Ct.off(T.Z.MANIFEST_VALIDITY_CHANGED,Rl,D),Ct.off(T.Z.BUFFER_LEVEL_UPDATED,ot,D),Ct.off(T.Z.QUALITY_CHANGE_REQUESTED,$e,D),E.Z.KEY_SESSION_UPDATED&&Ct.off(E.Z.KEY_SESSION_UPDATED,Zn,D),Ct.off(E.Z.MANIFEST_UPDATED,ts,D),Ct.off(E.Z.STREAM_BUFFERING_COMPLETED,zt,D),Ct.off(E.Z.TIME_SYNCHRONIZATION_COMPLETED,Fn,D),Ct.off(E.Z.CURRENT_TRACK_CHANGED,xt,D),Ct.off(E.Z.SETTING_UPDATED_LIVE_DELAY,bt,D),Ct.off(E.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,bt,D),oe.reset(),q.reset(),Me.reset(),re.clearAllCurrentMetrics(),k.setValue(null),Y.reset(),ue.reset(),le.reset(),Ee&&(ge.detachMediaSource(ae),Ee=null),ae=null,te&&(te=null,Q=null,k.getValue()&&Ct.trigger(E.Z.PROTECTION_DESTROYED,{data:k.getValue().url})),Hn(),Ct.trigger(E.Z.STREAM_TEARDOWN_COMPLETE),Il()}function Cl(dt){if(dt.metric===S.Z.DVR_INFO){var Xt=ma()?u.Z.AUDIO:u.Z.VIDEO;dt.mediaType===Xt&&ge.setSeekable(dt.value.range.start,dt.value.range.end)}}function rs(){return xe}return D={initialize:function(dt,Xt){vn(),j=dt,Q=Xt,ue.initialize(),(q=Xc(Ft).create()).setConfig({manifestModel:k,adapter:K,manifestLoader:Y,errHandler:Re,settings:Ve,contentSteeringController:z}),q.initialize(),(Me=Xd(Ft).getInstance()).setConfig({manifestUpdater:q,playbackController:Se,settings:Ve}),Me.start(),ie.setConfig({dashMetrics:re,baseURLController:oe,errHandler:Re,settings:Ve}),ie.initialize(),ge.setConfig({settings:Ve}),te&&(Ct.trigger(E.Z.PROTECTION_CREATED,{controller:te}),te.setMediaElement(ae.getElement()),Q&&te.setProtectionData(Q)),Ct.on(T.Z.PLAYBACK_TIME_UPDATED,we,D),Ct.on(T.Z.PLAYBACK_SEEKING,En,D),Ct.on(T.Z.PLAYBACK_ERROR,Cs,D),Ct.on(T.Z.PLAYBACK_STARTED,Ue,D),Ct.on(T.Z.PLAYBACK_PAUSED,ft,D),Ct.on(T.Z.PLAYBACK_ENDED,$r,D),Ct.on(T.Z.METRIC_ADDED,Cl,D),Ct.on(T.Z.MANIFEST_VALIDITY_CHANGED,Rl,D),Ct.on(T.Z.BUFFER_LEVEL_UPDATED,ot,D),Ct.on(T.Z.QUALITY_CHANGE_REQUESTED,$e,D),E.Z.KEY_SESSION_UPDATED&&Ct.on(E.Z.KEY_SESSION_UPDATED,Zn,D),Ct.on(E.Z.MANIFEST_UPDATED,ts,D),Ct.on(E.Z.STREAM_BUFFERING_COMPLETED,zt,D),Ct.on(E.Z.TIME_SYNCHRONIZATION_COMPLETED,Fn,D),Ct.on(E.Z.CURRENT_TRACK_CHANGED,xt,D),Ct.on(E.Z.SETTING_UPDATED_LIVE_DELAY,bt,D),Ct.on(E.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,bt,D)},getActiveStreamInfo:pi,addDVRMetric:Tn,hasVideoTrack:ta,hasAudioTrack:ma,getStreamById:ko,getStreamForTime:pn,getTimeRelativeToStreamId:function(dt,Xt){for(var Dn=null,Un=0,Vn=0,Kn=null,qn=0;qn<xe.length;qn++){if(Vn=(Dn=xe[qn]).getStartTime(),Kn=Dn.getDuration(),Number.isFinite(Vn)&&(Un=Vn),Dn.getId()===Xt)return dt-Un;Number.isFinite(Kn)&&(Un+=Kn)}return null},load:function(dt){var Xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;vn(),lt=Xt,Y.load(dt)},loadWithManifest:function(dt){var Xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;yn(),lt=Xt,q.setManifest(dt)},getActiveStreamProcessors:cr,setConfig:function(dt){dt&&(dt.capabilities&&(x=dt.capabilities),dt.capabilitiesFilter&&(B=dt.capabilitiesFilter),dt.manifestLoader&&(Y=dt.manifestLoader),dt.manifestModel&&(k=dt.manifestModel),dt.mediaPlayerModel&&(We=dt.mediaPlayerModel),dt.customParametersModel&&(je=dt.customParametersModel),dt.protectionController&&(te=dt.protectionController),dt.adapter&&(K=dt.adapter),dt.dashMetrics&&(re=dt.dashMetrics),dt.errHandler&&(Re=dt.errHandler),dt.timelineConverter&&(ue=dt.timelineConverter),dt.videoModel&&(ae=dt.videoModel),dt.playbackController&&(Se=dt.playbackController),dt.serviceDescriptionController&&(Pe=dt.serviceDescriptionController),dt.contentSteeringController&&(z=dt.contentSteeringController),dt.textController&&(J=dt.textController),dt.abrController&&(be=dt.abrController),dt.mediaController&&(Le=dt.mediaController),dt.settings&&(Ve=dt.settings),dt.baseURLController&&(oe=dt.baseURLController),dt.uriFragmentModel&&(Ne=dt.uriFragmentModel),dt.segmentBaseController&&(se=dt.segmentBaseController),dt.manifestUpdater&&(q=dt.manifestUpdater))},setProtectionData:function(dt){Q=dt,te&&te.setProtectionData(Q)},getIsStreamSwitchInProgress:function(){return Ae},switchToVideoElement:function(dt){P&&(Se.initialize(pi()),en(dt,!1,!0))},getHasMediaOrInitialisationError:function(){return ve||Ce},getStreams:rs,getActiveStream:function(){return P},getInitialPlayback:function(){return ze},getAutoPlay:function(){return j},refreshManifest:function(){q.getIsUpdating()||q.refreshManifest()},reset:pa},C=(0,I.Z)(Ft).getInstance().getLogger(D),ie=cl(Ft).getInstance(),ge=Qc(Ft).getInstance(),le=De(Ft).getInstance(),Il(),D}ef.__dashjs_factory_name="StreamController";var tf=b.Z.getSingletonFactory(ef);function nf(){var D,C,x,B,q,Y,k,K,re,ge,ie,z,oe=this.context,se=(0,_.Z)(oe).getInstance();function Ne(){z.debug("Stopping the gap controller"),q&&(clearInterval(q),q=null),(function(){se.off(E.Z.WALLCLOCK_TIME_UPDATED,Re,this),se.off(E.Z.INITIAL_STREAM_SWITCH,le,this),se.off(E.Z.PLAYBACK_SEEKING,be,this),se.off(E.Z.BUFFER_REPLACEMENT_STARTED,Le,D),se.off(E.Z.TRACK_CHANGE_RENDERED,Me,D)})(),q=null,Y=NaN,B=0,ge=null,ie={}}function be(){ge&&(clearTimeout(ge),ge=null)}function Le(Q){try{if(Q.streamId!==K.getActiveStreamInfo().id||Q.mediaType!==u.Z.VIDEO&&Q.mediaType!==u.Z.AUDIO)return;Q.streamId===K.getActiveStreamInfo().id&&(ie[Q.mediaType]=!0)}catch(j){z.error(j)}}function Me(Q){Q&&Q.mediaType&&(ie[Q.mediaType]=!1)}function le(){q||(function(){try{q||(z.debug("Starting the gap controller"),q=setInterval((function(){ue()&&J(k.getTime())}),100))}catch{}})()}function Re(){if(ue(x.get().streaming.gaps.enableSeekFix)&&++B>=10){var Q=k.getTime();C===Q?J(Q,!0):(C=Q,Y=NaN),B=0}}function ue(){var Q=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(!K.getActiveStream())return!1;var j=Object.keys(ie).some((function(ve){return ie[ve]})),Ae=!!Q&&xe();return!j&&x.get().streaming.gaps.jumpGaps&&K.getActiveStreamProcessors().length>0&&(!k.isSeeking()||Ae)&&!k.isPaused()&&!K.getIsStreamSwitchInProgress()&&!K.getHasMediaOrInitialisationError()}function xe(){var Q=K.getActiveStream(),j=parseFloat((Q.getStartTime()+Q.getDuration()).toFixed(5));return k.getTime()+x.get().streaming.gaps.threshold>=j}function P(Q,j){try{if(!Q||Q.length<=1&&j>0)return NaN;for(var Ae=NaN,ve=0;isNaN(Ae)&&ve<Q.length;){var Ce=ve>0?Q.end(ve-1):0;j<Q.start(ve)&&Ce-j<x.get().streaming.gaps.threshold&&(Ae=ve),ve+=1}return Ae}catch{return null}}function te(Q,j){for(var Ae=0,ve=Q.length;Ae<ve;Ae++)if(j>=Q.start(Ae)&&j<=Q.end(Ae))return!0;return!1}function J(Q){var j,Ae=arguments.length>1&&arguments[1]!==void 0&&arguments[1],ve=x.get().streaming.gaps.enableStallFix,Ce=x.get().streaming.gaps.stallSeek,Ee=x.get().streaming.gaps.smallGapLimit,ae=x.get().streaming.gaps.jumpLargeGaps,Se=re.getBufferRange(),Pe=NaN,We=!1;if(j=P(Se,Q),!isNaN(j)){var je=Se.start(j),Xe=je-Q;Xe>0&&(Xe<=Ee||ae)&&(Pe=je)}var ze=k.getTimeToStreamEnd();if(isNaN(Pe)&&Ae&&isFinite(ze)&&!isNaN(ze)&&ze<Ee&&(Pe=parseFloat(k.getStreamEndTime().toFixed(5)),We=!0),ve&&isNaN(Pe)&&Ae&&isNaN(j)&&te(Se,Q)&&(Ce===0?(z.warn("Toggle play pause to break stall"),re.pause(),re.play()):(z.warn("Jumping ".concat(Ce,"s to break stall")),Pe=Q+Ce)),Pe>0&&Y!==Pe&&Pe>Q&&!ge){var St=Pe-Q;if(We){var At=K.getStreamForTime(Pe),pt=At&&!!At.getPreloaded();z.warn("Jumping to end of stream because of gap from ".concat(Q," to ").concat(Pe,". Gap duration: ").concat(St)),k.seek(Pe,!0,pt)}else{var yt=k.getIsDynamic(),un=j>0?Se.end(j-1):Q,Ve=yt?1e3*Math.max(0,St-.1):0;ge=window.setTimeout((function(){k.seek(Pe,!0,!0),z.warn("Jumping gap occuring in period ".concat(K.getActiveStream().getStreamId()," starting at ").concat(un," and ending at ").concat(Pe,". Jumping by: ").concat(Pe-un)),ge=null}),Ve)}Y=Pe}}return D={reset:Ne,setConfig:function(Q){Q&&(Q.settings&&(x=Q.settings),Q.playbackController&&(k=Q.playbackController),Q.streamController&&(K=Q.streamController),Q.videoModel&&(re=Q.videoModel))},initialize:function(){(function(){se.on(E.Z.WALLCLOCK_TIME_UPDATED,Re,this),se.on(E.Z.INITIAL_STREAM_SWITCH,le,this),se.on(E.Z.PLAYBACK_SEEKING,be,this),se.on(E.Z.BUFFER_REPLACEMENT_STARTED,Le,D),se.on(E.Z.TRACK_CHANGE_RENDERED,Me,D)})()}},z=(0,I.Z)(oe).getInstance().getLogger(D),Ne(),D}nf.__dashjs_factory_name="GapController";var Qd=b.Z.getSingletonFactory(nf);function rf(){var D,C,x,B,q,Y,k,K,re,ge,ie=this.context,z=(0,_.Z)(ie).getInstance();function oe(){C=!1;var xe=Ht.Z.parseUserAgent();x=xe&&xe.browser&&xe.browser.name&&xe.browser.name.toLowerCase()==="safari"}function se(){C=!1}function Ne(xe){if(xe.streamId===Y.getActiveStreamInfo().id&&re){var P=k.getLiveDelay();k.getBufferLevel()>P/2&&(re=!1)}}function be(xe){xe.streamId===Y.getActiveStreamInfo().id&&(re=xe.state===S.Z.BUFFER_EMPTY)}function Le(){K.getCatchupModeEnabled()||B.setPlaybackRate(1)}function Me(){k.getIsDynamic()&&K.getCatchupModeEnabled()&&(K.getCatchupPlaybackRates().max>0||K.getCatchupPlaybackRates().min<0)&&!k.isPaused()&&!k.isSeeking()&&(function(){try{return!(!k.getTime()>0||C)&&(Re()===u.Z.LIVE_CATCHUP_MODE_LOLP?(function(xe,P){try{return Math.abs(le())>0||xe<P}catch{return!1}})(k.getBufferLevel(),q.get().streaming.liveCatchup.playbackBufferMin):(function(){try{return Math.abs(le())>0}catch{return!1}})())}catch{return!1}})()&&(function(){if(!C&&B){var xe,P=B.getPlaybackRate(),te=K.getCatchupPlaybackRates(),J=k.getBufferLevel(),Q=le(),j=K.getCatchupMaxDrift();if(!isNaN(j)&&j>0&&Q>j)ge.info("[CatchupController]: Low Latency catchup mechanism. Latency too high, doing a seek to live point"),C=!0,k.seekToCurrentLive(!0,!1);else{var Ae=k.getCurrentLiveLatency(),ve=k.getLiveDelay();xe=Re()===u.Z.LIVE_CATCHUP_MODE_LOLP?(function(Ee,ae,Se,Pe,We){var je;if(We<Pe){var Xe=Math.abs(Ee.min),ze=5*(We-Pe);je=1-Xe+2*Xe/(1+Math.pow(Math.E,-ze)),ge.debug("[LoL+ playback control_buffer-based] bufferLevel: "+We+", newRate: "+je)}else{if(Math.abs(ae-Se)<=.02*Se)je=1;else{var St=ae-Se,At=St<0?Math.abs(Ee.min):Ee.max,pt=5*St;je=1-At+2*At/(1+Math.pow(Math.E,-pt))}ge.debug("[LoL+ playback control_latency-based] latency: "+ae+", newRate: "+je)}return je})(te,Ae,ve,q.get().streaming.liveCatchup.playbackBufferMin,J):(function(Ee,ae,Se,Pe){if(re)return 1;var We=ae-Se,je=We<0?Math.abs(Ee.min):Ee.max,Xe=5*We,ze=1-je+2*je/(1+Math.pow(Math.E,-Xe));return k.getPlaybackStalled()&&Pe<=Se/2&&We>0&&(ze=1),ze})(te,Ae,ve,J);var Ce=x?.25:.02/(.5/te.max);xe&&Math.abs(P-xe)>=Ce&&(ge.debug("[CatchupController]: Setting playback rate to ".concat(xe)),B.setPlaybackRate(xe))}}})()}function le(){return k.getCurrentLiveLatency()-k.getLiveDelay()}function Re(){var xe=q.get().streaming.liveCatchup.playbackBufferMin;return q.get().streaming.liveCatchup.mode!==u.Z.LIVE_CATCHUP_MODE_LOLP||xe===null||isNaN(xe)?u.Z.LIVE_CATCHUP_MODE_DEFAULT:u.Z.LIVE_CATCHUP_MODE_LOLP}function ue(){K.getCatchupPlaybackRates(!0)}return D={reset:function(){z.off(T.Z.BUFFER_LEVEL_UPDATED,Ne,D),z.off(T.Z.BUFFER_LEVEL_STATE_CHANGED,be,D),z.off(T.Z.PLAYBACK_PROGRESS,Me,D),z.off(T.Z.PLAYBACK_TIME_UPDATED,Me,D),z.off(T.Z.PLAYBACK_SEEKED,se,D),z.off(E.Z.SETTING_UPDATED_CATCHUP_ENABLED,Le,D),z.off(E.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,ue,D),z.off(E.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,ue,D),z.off(T.Z.STREAM_INITIALIZED,ue,D),oe(),B.setPlaybackRate(1,!0)},setConfig:function(xe){xe&&(xe.settings&&(q=xe.settings),xe.videoModel&&(B=xe.videoModel),xe.streamController&&(Y=xe.streamController),xe.playbackController&&(k=xe.playbackController),xe.mediaPlayerModel&&(K=xe.mediaPlayerModel))},initialize:function(){z.on(T.Z.BUFFER_LEVEL_UPDATED,Ne,D),z.on(T.Z.BUFFER_LEVEL_STATE_CHANGED,be,D),z.on(T.Z.PLAYBACK_PROGRESS,Me,D),z.on(T.Z.PLAYBACK_TIME_UPDATED,Me,D),z.on(T.Z.PLAYBACK_SEEKED,se,D),z.on(E.Z.SETTING_UPDATED_CATCHUP_ENABLED,Le,D),z.on(E.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,ue,D),z.on(E.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,ue,D),z.on(T.Z.STREAM_INITIALIZED,ue,D),ue()}},ge=(0,I.Z)(ie).getInstance().getLogger(D),oe(),D}rf.__dashjs_factory_name="CatchupController";var af=b.Z.getSingletonFactory(rf),Jd=[u.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME],sf="video",of="audio";function lf(){var D,C,x,B,q,Y=this.context;function k(){C={liveDelay:NaN,liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN}},minBitrate:{},maxBitrate:{},initialBitrate:{},contentSteering:null},x=[]}function K(re,ge,ie){try{C[re][ge]=ie/1e3}catch(z){B.error(z)}}return D={getServiceDescriptionSettings:function(){return C},getProducerReferenceTimeOffsets:function(){return x},calculateProducerReferenceTimeOffsets:function(re){try{var ge=[];if(re&&re.length>0){var ie=[u.Z.VIDEO,u.Z.AUDIO,u.Z.TEXT],z=q.getAvailabilityStartTime()/1e3;re.forEach((function(oe){var se=ie.reduce((function(Ne,be){return Ne.concat(q.getAllMediaInfoForType(oe,be))}),[]).reduce((function(Ne,be){return q.getProducerReferenceTimes(oe,be).forEach((function(Le){var Me=q.getVoRepresentations(be);if(Me&&Me.length>0&&Me[0].adaptation&&Me[0].segmentInfoType===d.Z.SEGMENT_TEMPLATE){var le=Me[0],Re=new Date(Le[d.Z.WALL_CLOCK_TIME]).getTime()/1e3-(Le[d.Z.PRESENTATION_TIME]/le[d.Z.TIMESCALE]-le[d.Z.PRESENTATION_TIME_OFFSET]+oe.start),ue=z-Re;Ne.push({id:Le[d.Z.ID],to:ue})}})),Ne}),[]);ge=ge.concat(se)}))}x=ge}catch(oe){B.error(oe),x=[]}},applyServiceDescription:function(re){if(re&&re.serviceDescriptions){var ge=re.serviceDescriptions.filter((function(oe){return Jd.includes(oe.schemeIdUri)})),ie=re.serviceDescriptions.filter((function(oe){return oe.schemeIdUri==null})),z=ge.length>0?ge[ge.length-1]:ie[ie.length-1];z&&(z.latency&&z.latency.target>0&&(function(oe){var se;if(oe.schemeIdUri,u.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME,se=(function(Me){return{liveDelay:Me.latency.target/1e3,maxDrift:!isNaN(Me.latency.max)&&Me.latency.max>Me.latency.target?(Me.latency.max-Me.latency.target+500)/1e3:NaN,referenceId:Me.latency.referenceId||NaN}})(oe),x.length>0){var Ne=(function(Me){var le,Re=0,ue=x.filter((function(xe){return xe.id===Me.referenceId}));return ue.length===0?(Re=x.length>0?x[0].to:0,le=x[0].id||NaN):(Re=ue[0].to||0,le=ue[0].id||NaN),{to:Re,id:le}})(se),be=Ne.to,Le=Ne.id;C.liveDelay=se.liveDelay-be,C.liveCatchup.maxDrift=se.maxDrift,B.debug(`
                Found latency properties coming from service description. Applied time offset of `.concat(be," from ProducerReferenceTime element with id ").concat(Le,`.
                Live Delay: `).concat(se.liveDelay-be,", Live catchup max drift: ").concat(se.maxDrift,`
            `))}else C.liveDelay=se.liveDelay,C.liveCatchup.maxDrift=se.maxDrift,B.debug("Found latency properties coming from service description: Live Delay: ".concat(se.liveDelay,", Live catchup max drift: ").concat(se.maxDrift))})(z),z.playbackRate&&(function(oe){var se=oe.playbackRate.min?Math.round(1e3*(oe.playbackRate.min-1))/1e3:NaN,Ne=oe.playbackRate.max?Math.round(1e3*(oe.playbackRate.max-1))/1e3:NaN;C.liveCatchup.playbackRate.min=se,C.liveCatchup.playbackRate.max=Ne,B.debug("Found latency properties coming from service description: Live catchup min playback rate: ".concat(se)),B.debug("Found latency properties coming from service description: Live catchup max playback rate: ".concat(Ne))})(z),z.operatingQuality,z.operatingBandwidth&&(function(oe){if(oe&&oe.operatingBandwidth&&oe.operatingBandwidth.mediaType&&oe.operatingBandwidth.mediaType!=="all"){var se={};se.minBandwidth=oe.operatingBandwidth.min,se.maxBandwidth=oe.operatingBandwidth.max,se.targetBandwidth=oe.operatingBandwidth.target;var Ne=[];oe.operatingBandwidth.mediaType===sf||oe.operatingBandwidth.mediaType===of?Ne.push(oe.operatingBandwidth.mediaType):oe.operatingBandwidth.mediaType==="any"&&(Ne.push(of),Ne.push(sf)),Ne.forEach((function(be){isNaN(se.minBandwidth)||K("minBitrate",be,se.minBandwidth),isNaN(se.maxBandwidth)||K("maxBitrate",be,se.maxBandwidth),isNaN(se.targetBandwidth)||K("initialBitrate",be,se.targetBandwidth)}))}})(z),z.contentSteering&&(function(oe){C.contentSteering=oe.contentSteering})(z))}},reset:function(){k()},setConfig:function(re){re&&re.adapter&&(q=re.adapter)}},B=(0,I.Z)(Y).getInstance().getLogger(D),k(),D}lf.__dashjs_factory_name="ServiceDescriptionController";var Uu=b.Z.getSingletonFactory(lf),eh=g(3973),Fl=g.n(eh),uf=g(3039);function Ul(){var D,C,x,B,q,Y,k,K,re=this.context,ge=(0,_.Z)(re).getInstance();function ie(ae,Se){return ae&&x[Se]&&x[Se][ae]?x[Se][ae].list:[]}function z(ae,Se){return ae&&x[Se]&&x[Se][ae]?x[Se][ae].current:null}function oe(ae){var Se=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(ae&&ae.streamInfo){var Pe=ae.type,We=ae.streamInfo,je=We.id,Xe=z(Pe,je);if(x[je]&&x[je][Pe]&&(x[je][Pe].current=ae,x[je][Pe].current&&(Pe!==u.Z.TEXT&&!be(ae,Xe)||Pe===u.Z.TEXT&&ae.isFragmented)&&ge.trigger(E.Z.CURRENT_TRACK_CHANGED,{oldMediaInfo:Xe,newMediaInfo:ae,switchMode:B.get().streaming.trackSwitchMode[Pe]},{streamId:je}),!Se)){var ze=Me(ae);if(!ze||!x[je][Pe].storeLastSettings)return;ze.roles&&(ze.role=ze.roles[0],delete ze.roles),ze.accessibility&&(ze.accessibility=ze.accessibility[0]),ze.audioChannelConfiguration&&(ze.audioChannelConfiguration=ze.audioChannelConfiguration[0]),Y[Pe]=ze,K.setSavedMediaSettings(Pe,ze)}}}function se(ae,Se){ae&&Se&&(q[ae]=Se)}function Ne(ae){return ae?q[ae]:null}function be(ae,Se){if(!ae&&!Se)return!0;if(!ae||!Se)return!1;var Pe=ae.id===Se.id,We=ae.viewpoint===Se.viewpoint,je=JSON.stringify(ae.viewpointsWithSchemeIdUri)===JSON.stringify(Se.viewpointsWithSchemeIdUri),Xe=ae.lang===Se.lang,ze=ae.codec===Se.codec,St=ae.roles.toString()===Se.roles.toString(),At=JSON.stringify(ae.rolesWithSchemeIdUri)===JSON.stringify(Se.rolesWithSchemeIdUri),pt=ae.accessibility.toString()===Se.accessibility.toString(),yt=JSON.stringify(ae.accessibilitiesWithSchemeIdUri)===JSON.stringify(Se.accessibilitiesWithSchemeIdUri),un=ae.audioChannelConfiguration.toString()===Se.audioChannelConfiguration.toString(),Ve=JSON.stringify(ae.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(Se.audioChannelConfigurationsWithSchemeIdUri);return Pe&&ze&&We&&je&&Xe&&St&&At&&pt&&yt&&un&&Ve}function Le(){x={},Y={},q={audio:null,video:null,text:null}}function Me(ae){var Se={lang:ae.lang,viewpoint:ae.viewpoint,roles:ae.roles,accessibility:ae.accessibility,audioChannelConfiguration:ae.audioChannelConfiguration,codec:ae.codec};return Se.lang||Se.viewpoint||Se.role&&Se.role.length>0||Se.accessibility&&Se.accessibility.length>0||Se.audioChannelConfiguration&&Se.audioChannelConfiguration.length>0?Se:null}function le(ae,Se,Pe){var We=[];return ae.forEach((function(je){Se(Pe,je)&&We.push(je)})),We.length!==0?We:ae}function Re(ae,Se){try{return!ae.lang||ae.lang instanceof RegExp?Se.lang.match(ae.lang):Se.lang!==""&&(0,uf.extendedFilter)(Se.lang,Fl()(ae.lang)).length>0}catch{return!1}}function ue(ae,Se){return ae.index===void 0||ae.index===null||Se.index===ae.index}function xe(ae,Se){return!ae.viewpoint||ae.viewpoint===Se.viewpoint}function P(ae,Se){var Pe=arguments.length>2&&arguments[2]!==void 0&&arguments[2],We=!ae.role||!!Se.roles.filter((function(je){return je===ae.role}))[0];return We||Se.type===u.Z.AUDIO&&Pe}function te(ae,Se){return ae.accessibility?!!Se.accessibility.filter((function(Pe){return Pe===ae.accessibility}))[0]:!Se.accessibility.length}function J(ae,Se){return!ae.audioChannelConfiguration||!!Se.audioChannelConfiguration.filter((function(Pe){return Pe===ae.audioChannelConfiguration}))[0]}function Q(ae,Se){return!ae.codec||ae.codec===Se.codec}function j(ae){var Se,Pe=0,We=[];return ae.forEach((function(je){(Se=Math.max.apply(Math,je.bitrateList.map((function(Xe){return Xe.bandwidth}))))>Pe?(Pe=Se,We=[je]):Se===Pe&&We.push(je)})),We}function Ae(ae){var Se,Pe=1/0,We=[];return ae.forEach((function(je){var Xe=je.bitrateList.reduce((function(ze,St){var At=Math.max(1,St.width*St.height);return ze+St.bandwidth/At}),0);(Se=Xe/je.bitrateList.length)<Pe?(Pe=Se,We=[je]):Se===Pe&&We.push(je)})),We}function ve(ae){var Se,Pe=0,We=[];return ae.forEach((function(je){(Se=je.representationCount)>Pe?(Pe=Se,We=[je]):Se===Pe&&We.push(je)})),We}function Ce(ae,Se){if(ae===u.Z.TEXT)return Se[0];var Pe,We=B.get().streaming.selectionModeForInitialTrack,je=k.getCustomInitialTrackSelectionFunction();if(je&&typeof je=="function")Pe=je(Se);else switch(We){case u.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:Pe=(function(Xe){var ze,St,At=(ze=0,St=[],Xe.forEach((function(pt){isNaN(pt.selectionPriority)||(pt.selectionPriority>ze?(ze=pt.selectionPriority,St=[pt]):pt.selectionPriority===ze&&St.push(pt))})),St);return At.length>1&&(At=j(At)),At.length>1&&(At=ve(At)),At})(Se);break;case u.Z.TRACK_SELECTION_MODE_HIGHEST_BITRATE:Pe=(function(Xe){var ze=j(Xe);return ze.length>1&&(ze=ve(ze)),ze})(Se);break;case u.Z.TRACK_SELECTION_MODE_FIRST_TRACK:Pe=Ee(Se);break;case u.Z.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:Pe=(function(Xe){var ze=Ae(Xe);return ze.length>1&&(ze=j(ze)),ze})(Se);break;case u.Z.TRACK_SELECTION_MODE_WIDEST_RANGE:Pe=(function(Xe){var ze=ve(Xe);return ze.length>1&&(ze=j(Xe)),ze})(Se);break;default:C.warn("Track selection mode ".concat(We," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),Pe=Ee(Se)}return Pe.length>0?Pe[0]:Se[0]}function Ee(ae){return ae[0]}return D={setInitialMediaSettingsForType:function(ae,Se){var Pe=Y[ae]||Ne(ae),We=ie(ae,Se.id),je=[];Pe||((Pe=K.getSavedMediaSettings(ae))&&delete Pe.codec,se(ae,Pe)),We&&We.length!==0&&(Pe&&(je=le(je=Array.from(We),Re,Pe),je=le(je,ue,Pe),je=le(je,xe,Pe),ae===u.Z.AUDIO&&Y[ae]||(je=le(je,P,Pe)),je=le(je,te,Pe),je=le(je,J,Pe),je=le(je,Q,Pe)),je.length===0?oe(Ce(ae,We),!0):je.length>1?oe(Ce(ae,je)):oe(je[0]))},addTrack:function(ae){if(ae){var Se=ae.type;if((Pe=Se)===u.Z.AUDIO||Pe===u.Z.VIDEO||Pe===u.Z.TEXT||Pe===u.Z.IMAGE){var Pe,We,je=ae.streamInfo.id;x[je]||(x[je]={audio:{list:[],storeLastSettings:We=B.get().streaming.saveLastMediaSettingsForCurrentStreamingSession,current:null},video:{list:[],storeLastSettings:We,current:null},text:{list:[],storeLastSettings:We,current:null},image:{list:[],storeLastSettings:We,current:null}});for(var Xe=x[je][Se].list,ze=0,St=Xe.length;ze<St;++ze)if(be(Xe[ze],ae))return;Xe.push(ae)}}},getTracksFor:ie,getCurrentTrackFor:z,isCurrentTrack:function(ae){if(!ae)return!1;var Se=ae.type,Pe=ae.streamInfo.id;return x[Pe]&&x[Pe][Se]&&be(x[Pe][Se].current,ae)},setTrack:oe,selectInitialTrack:Ce,setInitialSettings:se,getInitialSettings:Ne,getTracksWithHighestBitrate:j,getTracksWithHighestEfficiency:Ae,getTracksWithWidestRange:ve,isTracksEqual:be,matchSettings:function(ae,Se){var Pe=arguments.length>2&&arguments[2]!==void 0&&arguments[2];try{var We=!1;if(ae.lang){if(ae.lang instanceof RegExp)We=Se.lang.match(ae.lang);else if(Se.lang!==""){var je=Fl()(ae.lang);je&&(We=(0,uf.extendedFilter)(Se.lang,je).length>0)}}else We=!0;var Xe=ae.index===void 0||ae.index===null||Se.index===ae.index,ze=!ae.viewpoint||ae.viewpoint===Se.viewpoint,St=!ae.role||!!Se.roles.filter((function(yt){return yt===ae.role}))[0],At=!ae.accessibility||!!Se.accessibility.filter((function(yt){return yt===ae.accessibility}))[0],pt=!ae.audioChannelConfiguration||!!Se.audioChannelConfiguration.filter((function(yt){return yt===ae.audioChannelConfiguration}))[0];return We&&Xe&&ze&&(St||Se.type===u.Z.AUDIO&&Pe)&&At&&pt}catch{return!1}},matchSettingsLang:Re,matchSettingsIndex:ue,matchSettingsViewPoint:xe,matchSettingsRole:P,matchSettingsAccessibility:te,matchSettingsAudioChannelConfig:J,saveTextSettingsDisabled:function(){K.setSavedMediaSettings(u.Z.TEXT,null)},setConfig:function(ae){ae&&(ae.domStorage&&(K=ae.domStorage),ae.settings&&(B=ae.settings),ae.customParametersModel&&(k=ae.customParametersModel))},reset:Le},C=(0,I.Z)(re).getInstance().getLogger(D),Le(),D}Ul.__dashjs_factory_name="MediaController";var cf=b.Z.getSingletonFactory(Ul);b.Z.updateSingletonFactory(Ul.__dashjs_factory_name,cf);var th=cf,Bl=NaN,ff=function D(C,x){(function(B,q){if(!(B instanceof q))throw new TypeError("Cannot call a class as a function")})(this,D),this.data={baseUrls:C||null,selectedIdx:x||Bl},this.children=[]};function df(){var D,C,x,B,q=this.context,Y=sn(q).getInstance();function k(ie,z,oe){var se=K(oe);ie[z]?Y.areEqual(se,ie[z].data.baseUrls)||(ie[z].data.baseUrls=se,ie[z].data.selectedIdx=Bl):ie[z]=new ff(se)}function K(ie){var z=x.getBaseURLsFromElement(ie),oe=B.getSynthesizedBaseUrlElements(z);return oe&&oe.length>0&&(z=z.concat(oe)),z}function re(ie,z){var oe=z||C;ie(oe.data),oe.children&&oe.children.forEach((function(se){return re(ie,se)}))}function ge(){C=new ff}return D={reset:ge,update:function(ie){(function(z){(function(){if(!x||!x.hasOwnProperty("getBaseURLsFromElement")||!x.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")})();var oe=K(z);Y.areEqual(oe,C.data.baseUrls)||(C.data.baseUrls=oe,C.data.selectedIdx=Bl),z&&z.Period_asArray&&z.Period_asArray.forEach((function(se,Ne){k(C.children,Ne,se),se.AdaptationSet_asArray&&se.AdaptationSet_asArray.forEach((function(be,Le){k(C.children[Ne].children,Le,be),be.Representation_asArray&&be.Representation_asArray.sort(x.getRepresentationSortFunction()).forEach((function(Me,le){k(C.children[Ne].children[Le].children,le,Me)}))}))}))})(ie)},getForPath:function(ie){var z=C,oe=[z.data];return ie&&ie.forEach((function(se){(z=z.children[se])&&oe.push(z.data)})),oe.filter((function(se){return se.baseUrls.length}))},invalidateSelectedIndexes:function(ie){re((function(z){isNaN(z.selectedIdx)||ie===z.baseUrls[z.selectedIdx].serviceLocation&&(z.selectedIdx=Bl)}))},setConfig:function(ie){ie.adapter&&(x=ie.adapter),ie.contentSteeringController&&(B=ie.contentSteeringController)},getBaseUrls:function(ie){return K(ie)}},ge(),D}df.__dashjs_factory_name="BaseURLTreeModel";var nh=b.Z.getClassFactory(df);function hf(D){var C=(D=D||{}).blacklistController;return{select:function(x){return x&&(function(q){var Y,k,K=0,re=[],ge=0;if((k=q.sort((function(ie,z){var oe=ie.dvbPriority-z.dvbPriority;return isNaN(oe)?0:oe})).filter((function(ie,z,oe){return!z||oe[0].dvbPriority&&ie.dvbPriority&&oe[0].dvbPriority===ie.dvbPriority}))).length)return k.length>1&&(k.forEach((function(ie){K+=ie.dvbWeight,re.push(K)})),Y=Math.floor(Math.random()*(K-1)),re.every((function(ie,z){return ge=z,!(Y<ie)}))),k[ge]})((B=[],x.filter((function(q){return!C.contains(q.serviceLocation)||(q.dvbPriority&&B.push(q.dvbPriority),!1)})).filter((function(q){return!B.length||!q.dvbPriority||B.indexOf(q.dvbPriority)===-1}))));var B}}}hf.__dashjs_factory_name="DVBSelector";var rh=b.Z.getClassFactory(hf);function gf(D){var C=(D=D||{}).blacklistController;return{select:function(x){var B,q=0;return x&&x.some((function(Y,k){return q=k,!C.contains(Y.serviceLocation)}))&&(B=x[q]),B}}}gf.__dashjs_factory_name="BasicSelector";var Bu=b.Z.getClassFactory(gf);function vo(){var D,C,x,B=this.context;function q(){for(var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],K=0,re=NaN,ge=function(){var z=Y[K],oe=k.findIndex((function(se){return se.serviceLocation&&se.serviceLocation===z}));if(oe!==-1&&!x.contains(k[oe].serviceLocation))return re=oe,"break";K+=1};K<Y.length;){var ie=ge();if(ie==="break")break}return re}return D={selectBaseUrlIndex:function(Y){var k=NaN;if(isNaN(Y.selectedIdx)){var K=C.getSteeringDataFromManifest();K&&K.defaultServiceLocationArray.length>0&&(k=q(K.defaultServiceLocationArray,Y.baseUrls))}var re=C.getCurrentSteeringResponseData();return Y.baseUrls&&Y.baseUrls.length&&re&&re.pathwayPriority&&re.pathwayPriority.length&&(k=q(re.pathwayPriority,Y.baseUrls)),k},setConfig:function(Y){Y.blacklistController&&(x=Y.blacklistController),Y.contentSteeringController&&(C=Y.contentSteeringController)}},C=Hr(B).getInstance(),D}vo.__dashjs_factory_name="ContentSteeringSelector";var ih=b.Z.getClassFactory(vo);function Gu(){var D,C,x,B,q,Y,k=this.context,K=(0,_.Z)(k).getInstance(),re=(0,Ie.Z)(k).getInstance();function ge(){C.reset()}return D={chooseSelector:function(ie){(0,ye.PS)(ie,"boolean"),Y=ie?B:x},select:function(ie){if(ie){if(re.get().streaming.applyContentSteering){var z=q.selectBaseUrlIndex(ie);isNaN(z)||z===-1||(ie.selectedIdx=z)}if(!isNaN(ie.selectedIdx))return ie.baseUrls[ie.selectedIdx];var oe=Y.select(ie.baseUrls);return oe?(ie.selectedIdx=ie.baseUrls.indexOf(oe),oe):(K.trigger(E.Z.URL_RESOLUTION_FAILED,{error:new fe.Z(X.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,X.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(Y===x&&ge()))}},reset:ge,setConfig:function(ie){ie.selector&&(Y=ie.selector),ie.contentSteeringSelector&&(q=ie.contentSteeringSelector)}},C=Zi(k).create({updateEventName:E.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,addBlacklistEventName:E.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD}),x=Bu(k).create({blacklistController:C}),B=rh(k).create({blacklistController:C}),(q=ih(k).create()).setConfig({blacklistController:C}),Y=x,D}Gu.__dashjs_factory_name="BaseURLSelector";var mf=b.Z.getClassFactory(Gu);function Zu(){var D,C,x,B,q,Y=this.context,k=(0,_.Z)(Y).getInstance(),K=(0,ut.Z)(Y).getInstance();function re(ie){x.update(ie),B.chooseSelector(C.getIsDVB(ie)),k.trigger(T.Z.BASE_URLS_UPDATED,{baseUrls:ge(ie)})}function ge(ie){return x.getBaseUrls(ie)}return D={reset:function(){x.reset(),B.reset()},initialize:function(ie){x.setConfig({adapter:C,contentSteeringController:q}),re(ie)},resolve:function(ie){var z=x.getForPath(ie).reduce((function(oe,se){var Ne=B.select(se);return Ne?(K.isRelative(Ne.url)?oe.url=K.resolve(Ne.url,oe.url):(oe.url=Ne.url,oe.serviceLocation=Ne.serviceLocation),oe.availabilityTimeOffset=Ne.availabilityTimeOffset,oe.availabilityTimeComplete=Ne.availabilityTimeComplete,oe.queryParams=Ne.queryParams,oe):new zi}),new zi);if(!K.isRelative(z.url))return z},setConfig:function(ie){ie.baseURLTreeModel&&(x=ie.baseURLTreeModel),ie.baseURLSelector&&(B=ie.baseURLSelector),ie.adapter&&(C=ie.adapter),ie.contentSteeringController&&(q=ie.contentSteeringController)},getBaseUrls:ge,update:re},x=nh(Y).create(),B=mf(Y).create(),k.on(E.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,(function(ie){x.invalidateSelectedIndexes(ie.entry)}),D),D}Zu.__dashjs_factory_name="BaseURLController";var pf=b.Z.getClassFactory(Zu);function Gl(D){return Gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},Gl(D)}function ys(D,C){return ys=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},ys(D,C)}function ah(D,C){return!C||Gl(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function Zl(D){return Zl=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},Zl(D)}var yf=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&ys(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=Zl(C);if(x){var K=Zl(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return ah(this,Y)});function q(Y,k){var K;return(function(re,ge){if(!(re instanceof ge))throw new TypeError("Cannot call a class as a function")})(this,q),(K=B.call(this)).url=Y||null,K.type=k||null,K.mediaType=u.Z.STREAM,K.responseType="",K}return q})(O.Z);function Hu(D){D=D||{};var C=this.context,x=(0,_.Z)(C).getInstance(),B=vi(C).create({errHandler:D.errHandler,dashMetrics:D.dashMetrics,mediaPlayerModel:D.mediaPlayerModel,requestModifier:D.requestModifier,errors:X});return{load:function(q,Y,k){var K=function(ge,ie){Y.resolved=!0,Y.resolvedContent=ge||null,x.trigger(E.Z.XLINK_ELEMENT_LOADED,{element:Y,resolveObject:k,error:ge||ie?null:new fe.Z(X.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,X.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+q)})};if(q==="urn:mpeg:dash:resolve-to-zero:2013")K(null,!0);else{var re=new yf(q,Be.w.XLINK_EXPANSION_TYPE);B.load({request:re,success:function(ge){K(ge)},error:function(){K(null)}})}},reset:function(){B&&(B.abort(),B=null)}}}Hu.__dashjs_factory_name="XlinkLoader";var vf=b.Z.getClassFactory(Hu),Eo=function(D){(D=D||{}).escapeMode===void 0&&(D.escapeMode=!0),D.attributePrefix===void 0&&(D.attributePrefix="_"),D.arrayAccessForm=D.arrayAccessForm||"none",D.emptyNodeForm=D.emptyNodeForm||"text",D.enableToStringFunc===void 0&&(D.enableToStringFunc=!0),D.arrayAccessFormPaths=D.arrayAccessFormPaths||[],D.skipEmptyTextNodesForObj===void 0&&(D.skipEmptyTextNodesForObj=!0),D.stripWhitespaces===void 0&&(D.stripWhitespaces=!0),D.datetimeAccessFormPaths=D.datetimeAccessFormPaths||[],D.useDoubleQuotes===void 0&&(D.useDoubleQuotes=!1),D.xmlElementsFilter=D.xmlElementsFilter||[],D.jsonPropertiesFilter=D.jsonPropertiesFilter||[],D.keepCData===void 0&&(D.keepCData=!1),D.ignoreRoot===void 0&&(D.ignoreRoot=!1);function C(le){var Re=le.localName;return Re==null&&(Re=le.baseName),Re!=null&&Re!=""||(Re=le.nodeName),Re}function x(le){return typeof le=="string"?le.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):le}function B(le,Re,ue,xe){for(var P=0;P<le.length;P++){var te=le[P];if(typeof te=="string"){if(te==xe)break}else if(te instanceof RegExp){if(te.test(xe))break}else if(typeof te=="function"&&te(Re,ue,xe))break}return P!=le.length}function q(le,Re,ue){D.arrayAccessForm==="property"&&(le[Re]instanceof Array?le[Re+"_asArray"]=le[Re]:le[Re+"_asArray"]=[le[Re]]),!(le[Re]instanceof Array)&&D.arrayAccessFormPaths.length>0&&B(D.arrayAccessFormPaths,le,Re,ue)&&(le[Re]=[le[Re]])}function Y(le){var Re=le.split(/[-T:+Z]/g),ue=new Date(Re[0],Re[1]-1,Re[2]),xe=Re[5].split(".");if(ue.setHours(Re[3],Re[4],xe[0]),xe.length>1&&ue.setMilliseconds(xe[1]),Re[6]&&Re[7]){var P=60*Re[6]+Number(Re[7]);P=0+((/\d\d-\d\d:\d\d$/.test(le)?"-":"+")=="-"?-1*P:P),ue.setMinutes(ue.getMinutes()-P-ue.getTimezoneOffset())}else le.indexOf("Z",le.length-1)!==-1&&(ue=new Date(Date.UTC(ue.getFullYear(),ue.getMonth(),ue.getDate(),ue.getHours(),ue.getMinutes(),ue.getSeconds(),ue.getMilliseconds())));return ue}function k(le,Re,ue,xe){return!(Re==1&&D.xmlElementsFilter.length>0)||B(D.xmlElementsFilter,le,ue,xe)}function K(le,Re){if(le.nodeType==9){for(var ue=new Object,xe=le.childNodes,P=0;P<xe.length;P++)(J=xe[P]).nodeType==1&&(D.ignoreRoot?ue=K(J):(ue={})[Q=C(J)]=K(J));return ue}if(le.nodeType==1){(ue=new Object).__cnt=0;var te=[];for(xe=le.childNodes,P=0;P<xe.length;P++){var J,Q=C(J=xe[P]);if(J.nodeType!=8){var j=Re+"."+Q;if(k(ue,J.nodeType,Q,j))if(ue.__cnt++,ue[Q]==null){var Ae=K(J,j);(Q!="#text"||/[^\s]/.test(Ae))&&((ve={})[Q]=Ae,te.push(ve)),ue[Q]=Ae,q(ue,Q,j)}else{var ve;ue[Q]!=null&&(ue[Q]instanceof Array||(ue[Q]=[ue[Q]],q(ue,Q,j))),Ae=K(J,j),(Q!="#text"||/[^\s]/.test(Ae))&&((ve={})[Q]=Ae,te.push(ve)),ue[Q][ue[Q].length]=Ae}}}ue.__children=te;for(var Ce=C(le),Ee=0;Ee<le.attributes.length;Ee++){var ae=le.attributes[Ee];ue.__cnt++;for(var Se=ae.value,Pe=0,We=D.matchers.length;Pe<We;Pe++){var je=D.matchers[Pe];je.test(ae,Ce)&&(Se=je.converter(ae.value))}ue[D.attributePrefix+ae.name]=Se}var Xe=(function(ze){return ze.prefix})(le);return Xe!=null&&Xe!=""&&(ue.__cnt++,ue.__prefix=Xe),ue["#text"]!=null&&(ue.__text=ue["#text"],ue.__text instanceof Array&&(ue.__text=ue.__text.join(`
`)),D.stripWhitespaces&&(ue.__text=ue.__text.trim()),delete ue["#text"],D.arrayAccessForm=="property"&&delete ue["#text_asArray"],ue.__text=(function(ze,St,At){if(D.datetimeAccessFormPaths.length>0){var pt=At.split(".#")[0];return B(D.datetimeAccessFormPaths,ze,St,pt)?Y(ze):ze}return ze})(ue.__text,Q,Re+"."+Q)),ue["#cdata-section"]!=null&&(ue.__cdata=ue["#cdata-section"],delete ue["#cdata-section"],D.arrayAccessForm=="property"&&delete ue["#cdata-section_asArray"]),ue.__cnt==0&&D.emptyNodeForm=="text"?ue="":ue.__cnt==1&&ue.__text!=null?ue=ue.__text:ue.__cnt!=1||ue.__cdata==null||D.keepCData?ue.__cnt>1&&ue.__text!=null&&D.skipEmptyTextNodesForObj&&(D.stripWhitespaces&&ue.__text==""||ue.__text.trim()=="")&&delete ue.__text:ue=ue.__cdata,delete ue.__cnt,!D.enableToStringFunc||ue.__text==null&&ue.__cdata==null||(ue.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}),ue}if(le.nodeType==3||le.nodeType==4)return le.nodeValue}function re(le,Re,ue,xe){var P="<"+(le!=null&&le.__prefix!=null?le.__prefix+":":"")+Re;if(ue!=null)for(var te=0;te<ue.length;te++){var J=ue[te],Q=le[J];D.escapeMode&&(Q=x(Q)),P+=" "+J.substr(D.attributePrefix.length)+"=",D.useDoubleQuotes?P+='"'+Q+'"':P+="'"+Q+"'"}return P+(xe?"/>":">")}function ge(le,Re){return"</"+(le.__prefix!=null?le.__prefix+":":"")+Re+">"}function ie(le,Re){return D.arrayAccessForm=="property"&&(xe="_asArray",(ue=Re.toString()).indexOf(xe,ue.length-xe.length)!==-1)||Re.toString().indexOf(D.attributePrefix)==0||Re.toString().indexOf("__")==0||le[Re]instanceof Function;var ue,xe}function z(le){var Re=0;if(le instanceof Object)for(var ue in le)ie(le,ue)||Re++;return Re}function oe(le,Re,ue){return D.jsonPropertiesFilter.length==0||ue==""||B(D.jsonPropertiesFilter,le,Re,ue)}function se(le){var Re=[];if(le instanceof Object)for(var ue in le)ue.toString().indexOf("__")==-1&&ue.toString().indexOf(D.attributePrefix)==0&&Re.push(ue);return Re}function Ne(le){var Re="";return le instanceof Object?Re+=(function(ue){var xe="";return ue.__cdata!=null&&(xe+="<![CDATA["+ue.__cdata+"]]>"),ue.__text!=null&&(D.escapeMode?xe+=x(ue.__text):xe+=ue.__text),xe})(le):le!=null&&(D.escapeMode?Re+=x(le):Re+=le),Re}function be(le,Re){return le===""?Re:le+"."+Re}function Le(le,Re,ue,xe){var P="";if(le.length==0)P+=re(le,Re,ue,!0);else for(var te=0;te<le.length;te++)P+=re(le[te],Re,se(le[te]),!1),P+=Me(le[te],be(xe,Re)),P+=ge(le[te],Re);return P}function Me(le,Re){var ue="";if(z(le)>0){for(var xe in le)if(!ie(le,xe)&&(Re==""||oe(le,xe,be(Re,xe)))){var P=le[xe],te=se(P);P==null||P==null?ue+=re(P,xe,te,!0):P instanceof Object?P instanceof Array?ue+=Le(P,xe,te,Re):P instanceof Date?(ue+=re(P,xe,te,!1),ue+=P.toISOString(),ue+=ge(P,xe)):z(P)>0||P.__text!=null||P.__cdata!=null?(ue+=re(P,xe,te,!1),ue+=Me(P,be(Re,xe)),ue+=ge(P,xe)):ue+=re(P,xe,te,!0):(ue+=re(P,xe,te,!1),ue+=Ne(P),ue+=ge(P,xe))}}return ue+Ne(le)}this.parseXmlString=function(le){var Re;if(le===void 0)return null;if(window.DOMParser){var ue=new window.DOMParser;try{(Re=ue.parseFromString(le,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(Re=null)}catch{Re=null}}else le.indexOf("<?")==0&&(le=le.substr(le.indexOf("?>")+2)),(Re=new ActiveXObject("Microsoft.XMLDOM")).async="false",Re.loadXML(le);return Re},this.asArray=function(le){return le===void 0||le==null?[]:le instanceof Array?le:[le]},this.toXmlDateTime=function(le){return le instanceof Date?le.toISOString():typeof le=="number"?new Date(le).toISOString():null},this.asDateTime=function(le){return typeof le=="string"?Y(le):le},this.xml2json=function(le){return K(le)},this.xml_str2json=function(le){var Re=this.parseXmlString(le);return Re!=null?this.xml2json(Re):null},this.json2xml_str=function(le){return Me(le,"")},this.json2xml=function(le){var Re=this.json2xml_str(le);return this.parseXmlString(Re)},this.getVersion=function(){return"1.2.0"}},Ca="onLoad";function Ef(D){D=D||{};var C,x,B,q,Y,k,K=this.context,re=(0,_.Z)(K).getInstance(),ge=(0,ut.Z)(K).getInstance();function ie(be,Le,Me){var le,Re,ue={};ue.elements=be,ue.type=Le,ue.resolveType=Me,ue.elements.length===0&&oe(ue);for(var xe=0;xe<ue.elements.length;xe++)le=ue.elements[xe],Re=ge.isHTTPURL(le.url)?le.url:le.originalContent.BaseURL+le.url,k.load(Re,le,ue)}function z(be){var Le,Me,le="";if(Le=be.element,Me=be.resolveObject,Le.resolvedContent){var Re=0;Le.resolvedContent.indexOf("<?xml")===0&&(Re=Le.resolvedContent.indexOf("?>")+2),le=Le.resolvedContent.substr(0,Re)+"<response>"+Le.resolvedContent.substr(Re)+"</response>",Le.resolvedContent=Y.xml_str2json(le)}(function(ue){var xe;for(xe=0;xe<ue.elements.length;xe++)if(ue.elements[xe].resolved===!1)return!1;return!0})(Me)&&oe(Me)}function oe(be){var Le,Me,le=[];if((function(Re){var ue,xe,P,te,J,Q,j=[];for(te=Re.elements.length-1;te>=0;te--){if(xe=(ue=Re.elements[te]).type+"_asArray",ue.resolvedContent){if(ue.resolvedContent)for(J=0;J<ue.resolvedContent[xe].length;J++)P=ue.resolvedContent[xe][J],j.push(P)}else delete ue.originalContent["xlink:actuate"],delete ue.originalContent["xlink:href"],j.push(ue.originalContent);for(ue.parentElement[xe].splice(ue.index,1),Q=0;Q<j.length;Q++)ue.parentElement[xe].splice(ue.index+Q,0,j[Q]);j=[]}Re.elements.length>0&&B.run(q)})(be),be.resolveType==="onActuate"&&re.trigger(E.Z.XLINK_READY,{manifest:q}),be.resolveType===Ca)switch(be.type){case d.Z.PERIOD:for(Le=0;Le<q[d.Z.PERIOD+"_asArray"].length;Le++)(Me=q[d.Z.PERIOD+"_asArray"][Le]).hasOwnProperty(d.Z.ADAPTATION_SET+"_asArray")&&(le=le.concat(se(Me[d.Z.ADAPTATION_SET+"_asArray"],Me,d.Z.ADAPTATION_SET,Ca))),Me.hasOwnProperty(d.Z.EVENT_STREAM+"_asArray")&&(le=le.concat(se(Me[d.Z.EVENT_STREAM+"_asArray"],Me,d.Z.EVENT_STREAM,Ca)));ie(le,d.Z.ADAPTATION_SET,Ca);break;case d.Z.ADAPTATION_SET:re.trigger(E.Z.XLINK_READY,{manifest:q})}}function se(be,Le,Me,le){var Re,ue,xe,P=[];for(ue=be.length-1;ue>=0;ue--)(Re=be[ue]).hasOwnProperty("xlink:href")&&Re["xlink:href"]==="urn:mpeg:dash:resolve-to-zero:2013"&&be.splice(ue,1);for(ue=0;ue<be.length;ue++)(Re=be[ue]).hasOwnProperty("xlink:href")&&Re.hasOwnProperty("xlink:actuate")&&Re["xlink:actuate"]===le&&(xe=Ne(Re["xlink:href"],Le,Me,ue,le,Re),P.push(xe));return P}function Ne(be,Le,Me,le,Re,ue){return{url:be,parentElement:Le,type:Me,index:le,resolveType:Re,originalContent:ue,resolvedContent:null,resolved:!1}}return C={resolveManifestOnLoad:function(be){Y=new Eo({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:x}),(q=be).Period_asArray?ie(se(q.Period_asArray,q,d.Z.PERIOD,Ca),d.Z.PERIOD,Ca):re.trigger(E.Z.XLINK_READY,{manifest:q})},setMatchers:function(be){be&&(x=be)},setIron:function(be){be&&(B=be)},reset:function(){re.off(E.Z.XLINK_ELEMENT_LOADED,z,C),k&&(k.reset(),k=null)}},re.on(E.Z.XLINK_ELEMENT_LOADED,z,C),k=vf(K).create({errHandler:D.errHandler,dashMetrics:D.dashMetrics,mediaPlayerModel:D.mediaPlayerModel,requestModifier:D.requestModifier,settings:D.settings}),C}Ef.__dashjs_factory_name="XlinkController";var Hl=b.Z.getClassFactory(Ef);function To(D){return To=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},To(D)}function Vu(D){function C(q,Y){for(var k in q)Y.hasOwnProperty(k)||(Y[k]=q[k])}function x(q,Y,k){for(var K=0,re=q.length;K<re;++K){var ge=q[K];if(Y[ge.name])if(k[ge.name]){if(ge.merge){var ie=Y[ge.name],z=k[ge.name];To(ie)==="object"&&To(z)==="object"?C(ie,z):k[ge.name]=ie+z}}else k[ge.name]=Y[ge.name]}}function B(q,Y){for(var k=0,K=q.children.length;k<K;++k){var re=q.children[k],ge=Y[re.name+"_asArray"];if(ge)for(var ie=0,z=ge.length;ie<z;++ie){var oe=ge[ie];x(q.properties,Y,oe),B(re,oe)}}}return{run:function(q){if(q===null||To(q)!=="object")return q;if(q.Period_asArray&&"period"in D)for(var Y=D.period,k=q.Period_asArray,K=0,re=k.length;K<re;++K){var ge=k[K];if(B(Y,ge),"adaptationset"in D){var ie=ge.AdaptationSet_asArray;if(ie)for(var z=D.adaptationset,oe=0,se=ie.length;oe<se;++oe)B(z,ie[oe])}}return q}}}Vu.__dashjs_factory_name="ObjectIron";var Yu=b.Z.getClassFactory(Vu);function ju(D,C){for(var x=0;x<C.length;x++){var B=C[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}var So=(function(){function D(B,q){(function(Y,k){if(!(Y instanceof k))throw new TypeError("Cannot call a class as a function")})(this,D),this._test=B,this._converter=q}var C,x;return C=D,(x=[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}])&&ju(C.prototype,x),D})();function Vl(D){return Vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},Vl(D)}function Ir(D,C,x){return C in D?Object.defineProperty(D,C,{value:x,enumerable:!0,configurable:!0,writable:!0}):D[C]=x,D}function qu(D,C){return qu=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},qu(D,C)}function sh(D,C){return!C||Vl(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function Yl(D){return Yl=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},Yl(D)}var oh=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&qu(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=Yl(C);if(x){var K=Yl(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return sh(this,Y)});function q(){return(function(Y,k){if(!(Y instanceof k))throw new TypeError("Cannot call a class as a function")})(this,q),B.call(this,(function(Y,k){var K,re=(Ir(K={},d.Z.MPD,[d.Z.ID,d.Z.PROFILES]),Ir(K,d.Z.PERIOD,[d.Z.ID]),Ir(K,d.Z.BASE_URL,[d.Z.SERVICE_LOCATION,d.Z.BYTE_RANGE]),Ir(K,d.Z.SEGMENT_BASE,[d.Z.INDEX_RANGE]),Ir(K,d.Z.INITIALIZATION,[d.Z.RANGE]),Ir(K,d.Z.REPRESENTATION_INDEX,[d.Z.RANGE]),Ir(K,d.Z.SEGMENT_LIST,[d.Z.INDEX_RANGE]),Ir(K,d.Z.BITSTREAM_SWITCHING,[d.Z.RANGE]),Ir(K,d.Z.SEGMENT_URL,[d.Z.MEDIA_RANGE,d.Z.INDEX_RANGE]),Ir(K,d.Z.SEGMENT_TEMPLATE,[d.Z.INDEX_RANGE,d.Z.MEDIA,d.Z.INDEX,d.Z.INITIALIZATION_MINUS,d.Z.BITSTREAM_SWITCHING_MINUS]),Ir(K,d.Z.ASSET_IDENTIFIER,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.EVENT_STREAM,[d.Z.VALUE]),Ir(K,d.Z.ADAPTATION_SET,[d.Z.PROFILES,d.Z.MIME_TYPE,d.Z.SEGMENT_PROFILES,d.Z.CODECS,d.Z.CONTENT_TYPE]),Ir(K,d.Z.FRAME_PACKING,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.AUDIO_CHANNEL_CONFIGURATION,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.CONTENT_PROTECTION,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.ESSENTIAL_PROPERTY,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.SUPPLEMENTAL_PROPERTY,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.INBAND_EVENT_STREAM,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.ACCESSIBILITY,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.ROLE,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.RATING,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.VIEWPOINT,[d.Z.VALUE,d.Z.ID]),Ir(K,d.Z.CONTENT_COMPONENT,[d.Z.CONTENT_TYPE]),Ir(K,d.Z.REPRESENTATION,[d.Z.ID,d.Z.DEPENDENCY_ID,d.Z.MEDIA_STREAM_STRUCTURE_ID]),Ir(K,d.Z.SUBSET,[d.Z.ID]),Ir(K,d.Z.METRICS,[d.Z.METRICS_MINUS]),Ir(K,d.Z.REPORTING,[d.Z.VALUE,d.Z.ID]),K);if(re.hasOwnProperty(k)){var ge=re[k];return ge!==void 0&&ge.indexOf(Y.name)>=0}return!1}),(function(Y){return String(Y)}))}return q})(So);function Ku(D){return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},Ku(D)}function xi(D,C){return xi=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},xi(D,C)}function hl(D,C){return!C||Ku(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function gl(D){return gl=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},gl(D)}var zu=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,Tf=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&xi(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=gl(C);if(x){var K=gl(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return hl(this,Y)});function q(){return(function(Y,k){if(!(Y instanceof k))throw new TypeError("Cannot call a class as a function")})(this,q),B.call(this,(function(Y){for(var k=[d.Z.MIN_BUFFER_TIME,d.Z.MEDIA_PRESENTATION_DURATION,d.Z.MINIMUM_UPDATE_PERIOD,d.Z.TIMESHIFT_BUFFER_DEPTH,d.Z.MAX_SEGMENT_DURATION,d.Z.MAX_SUBSEGMENT_DURATION,d.Z.SUGGESTED_PRESENTATION_DELAY,d.Z.START,u.Z.START_TIME,d.Z.DURATION],K=k.length,re=0;re<K;re++)if(Y.nodeName===k[re])return zu.test(Y.value);return!1}),(function(Y){var k=zu.exec(Y),K=31536e3*parseFloat(k[3]||0)+2592e3*parseFloat(k[5]||0)+86400*parseFloat(k[7]||0)+3600*parseFloat(k[9]||0)+60*parseFloat(k[11]||0)+parseFloat(k[13]||0);return k[1]!==void 0&&(K=-K),K}))}return q})(So);function jl(D){return jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},jl(D)}function ml(D,C){return ml=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},ml(D,C)}function lh(D,C){return!C||jl(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function Ya(D){return Ya=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},Ya(D)}var ql=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,pl=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&ml(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=Ya(C);if(x){var K=Ya(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return lh(this,Y)});function q(){return(function(Y,k){if(!(Y instanceof k))throw new TypeError("Cannot call a class as a function")})(this,q),B.call(this,(function(Y){return ql.test(Y.value)}),(function(Y){var k,K=ql.exec(Y);if(k=Date.UTC(parseInt(K[1],10),parseInt(K[2],10)-1,parseInt(K[3],10),parseInt(K[4],10),parseInt(K[5],10),K[6]&&parseInt(K[6],10)||0,K[7]&&1e3*parseFloat(K[7])||0),K[9]&&K[10]){var re=60*parseInt(K[9],10)+parseInt(K[10],10);k+=(K[8]==="+"?-1:1)*re*60*1e3}return new Date(k)}))}return q})(So);function yl(D){return yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},yl(D)}function Kl(D,C){return Kl=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},Kl(D,C)}function Zs(D,C){return!C||yl(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function ja(D){return ja=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},ja(D)}var $u=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,Sf=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&Kl(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=ja(C);if(x){var K=ja(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return Zs(this,Y)});function q(){return(function(Y,k){if(!(Y instanceof k))throw new TypeError("Cannot call a class as a function")})(this,q),B.call(this,(function(Y){return $u.test(Y.value)}),(function(Y){return parseFloat(Y)}))}return q})(So);function qa(D){return qa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},qa(D)}function _o(D,C,x){return C in D?Object.defineProperty(D,C,{value:x,enumerable:!0,configurable:!0,writable:!0}):D[C]=x,D}function zl(D,C){return zl=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},zl(D,C)}function _f(D,C){return!C||qa(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function $l(D){return $l=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},$l(D)}var uh=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&zl(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=$l(C);if(x){var K=$l(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return _f(this,Y)});function q(){return(function(Y,k){if(!(Y instanceof k))throw new TypeError("Cannot call a class as a function")})(this,q),B.call(this,(function(Y,k){var K,re=(_o(K={},d.Z.ADAPTATION_SET,[d.Z.LANG]),_o(K,d.Z.REPRESENTATION,[d.Z.LANG]),_o(K,d.Z.CONTENT_COMPONENT,[d.Z.LANG]),_o(K,d.Z.LABEL,[d.Z.LANG]),_o(K,d.Z.GROUP_LABEL,[d.Z.LANG]),K);if(re.hasOwnProperty(k)){var ge=re[k];return ge!==void 0&&ge.indexOf(Y.name)>=0}return!1}),(function(Y){return Fl()(Y)||String(Y)}))}return q})(So);function ch(D,C){for(var x=0;x<C.length;x++){var B=C[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}var Af=(function(){function D(B){var q;(function(Y,k){if(!(Y instanceof k))throw new TypeError("Cannot call a class as a function")})(this,D),this._name=B,this._merge=(q=B)&&q.length&&q.charAt(0)===q.charAt(0).toUpperCase()}var C,x;return C=D,(x=[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}])&&ch(C.prototype,x),D})();function bf(D,C){for(var x=0;x<C.length;x++){var B=C[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}var vs=(function(){function D(B,q,Y){var k=this;(function(K,re){if(!(K instanceof re))throw new TypeError("Cannot call a class as a function")})(this,D),this._name=B||"",this._properties=[],this._children=Y||[],Array.isArray(q)&&q.forEach((function(K){k._properties.push(new Af(K))}))}var C,x;return C=D,(x=[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}])&&bf(C.prototype,x),D})();function Hi(D){return Hi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},Hi(D)}function Ao(D,C){return Ao=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},Ao(D,C)}function Wi(D,C){return!C||Hi(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function Ka(D){return Ka=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},Ka(D)}var Wu=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&Ao(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=Ka(C);if(x){var K=Ka(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return Wi(this,Y)});function q(){(function(k,K){if(!(k instanceof K))throw new TypeError("Cannot call a class as a function")})(this,q);var Y=[d.Z.PROFILES,d.Z.WIDTH,d.Z.HEIGHT,d.Z.SAR,d.Z.FRAMERATE,d.Z.AUDIO_SAMPLING_RATE,d.Z.MIME_TYPE,d.Z.SEGMENT_PROFILES,d.Z.CODECS,d.Z.MAXIMUM_SAP_PERIOD,d.Z.START_WITH_SAP,d.Z.MAX_PLAYOUT_RATE,d.Z.CODING_DEPENDENCY,d.Z.SCAN_TYPE,d.Z.FRAME_PACKING,d.Z.AUDIO_CHANNEL_CONFIGURATION,d.Z.CONTENT_PROTECTION,d.Z.ESSENTIAL_PROPERTY,d.Z.ESSENTIAL_PROPERTY+"_asArray",d.Z.SUPPLEMENTAL_PROPERTY,d.Z.INBAND_EVENT_STREAM];return B.call(this,d.Z.ADAPTATION_SET,Y,[new vs(d.Z.REPRESENTATION,Y,[new vs(d.Z.SUB_REPRESENTATION,Y)])])}return q})(vs);function bo(D){return bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},bo(D)}function Ro(D,C){return Ro=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},Ro(D,C)}function Xu(D,C){return!C||bo(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function Da(D){return Da=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},Da(D)}var Rf=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&Ro(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=Da(C);if(x){var K=Da(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return Xu(this,Y)});function q(){(function(k,K){if(!(k instanceof K))throw new TypeError("Cannot call a class as a function")})(this,q);var Y=[d.Z.SEGMENT_BASE,d.Z.SEGMENT_TEMPLATE,d.Z.SEGMENT_LIST];return B.call(this,d.Z.PERIOD,Y,[new vs(d.Z.ADAPTATION_SET,Y,[new vs(d.Z.REPRESENTATION,Y)])])}return q})(vs);function vl(D){D=D||{};var C,x,B,q,Y,k=this.context,K=D.debug;return C={parse:function(re){var ge,ie=window.performance.now();if(!(ge=q.xml_str2json(re)))throw new Error("parsing the manifest failed");var z=window.performance.now();ge.Patch?((ge=ge.Patch).add_asArray&&ge.add_asArray.forEach((function(se){return Y.run(se)})),ge.replace_asArray&&ge.replace_asArray.forEach((function(se){return Y.run(se)}))):(ge=ge.MPD,Y.run(ge));var oe=window.performance.now();return x.info("Parsing complete: ( xml2json: "+(z-ie).toPrecision(3)+"ms, objectiron: "+(oe-z).toPrecision(3)+"ms, total: "+((oe-ie)/1e3).toPrecision(3)+"s)"),ge.protocol="DASH",ge},getMatchers:function(){return B},getIron:function(){return Y}},x=K.getLogger(C),B=[new Tf,new pl,new Sf,new uh,new oh],q=new Eo({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:B}),Y=Yu(k).create({adaptationset:new Wu,period:new Rf}),C}vl.__dashjs_factory_name="DashParser";var Io=b.Z.getClassFactory(vl);function If(D){D=D||{};var C,x,B,q,Y,k=this.context,K=D.debug,re=D.settings,ge=(0,_.Z)(k).getInstance(),ie=(0,ut.Z)(k).getInstance(),z=D.mssHandler,oe=D.errHandler;function se(be){ge.trigger(E.Z.INTERNAL_MANIFEST_LOADED,{manifest:be.manifest})}function Ne(be){var Le=null;return be.indexOf("SmoothStreamingMedia")>-1?(z&&(Le=z.createMssParser(),z.createMssFragmentProcessor(),z.registerEvents()),Le):be.indexOf("MPD")>-1||be.indexOf("Patch")>-1?Io(k).create({debug:K}):Le}return C={load:function(be){var Le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,le=new Date,Re=new yf(be,Be.w.MPD_TYPE);Le&&(Re.serviceLocation=Le),Me&&(Re.queryParams=Me),Re.requestStartDate||(Re.requestStartDate=le),ge.trigger(E.Z.MANIFEST_LOADING_STARTED,{request:Re}),B.load({request:Re,success:function(ue,xe,P){var te,J,Q;if(q)if(P&&P!==be?(J=ie.parseBaseUrl(P),te=P):(ie.isRelative(be)&&(be=ie.resolve(be,window.location.href)),J=ie.parseBaseUrl(be)),xe!="No Content")if(Y===null&&(Y=Ne(ue)),Y!==null){q.setMatchers(Y.getMatchers()),q.setIron(Y.getIron());try{Q=Y.parse(ue)}catch{return void ge.trigger(E.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new fe.Z(X.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,X.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(be))})}if(Q){if(Q.url=te||be,Q.originalUrl||(Q.originalUrl=Q.url),re&&re.get().streaming.enableManifestDurationMismatchFix&&Q.mediaPresentationDuration&&Q.Period_asArray.length>1){var j=Q.Period_asArray.reduce((function(Ae,ve){return Ae+ve.duration}),0);!isNaN(j)&&Q.mediaPresentationDuration>j&&(x.warn("Media presentation duration greater than duration of all periods. Setting duration to total period duration"),Q.mediaPresentationDuration=j)}Q.baseUri=J,Q.loadedTime=new Date,q.resolveManifestOnLoad(Q),ge.trigger(E.Z.ORIGINAL_MANIFEST_LOADED,{originalManifest:ue})}else ge.trigger(E.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new fe.Z(X.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,X.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(be))})}else ge.trigger(E.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new fe.Z(X.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,X.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(be))});else ge.trigger(E.Z.INTERNAL_MANIFEST_LOADED,{manifest:null})},error:function(ue,xe,P){ge.trigger(E.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new fe.Z(X.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,X.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(be,", ").concat(P))})}})},reset:function(){ge.off(E.Z.XLINK_READY,se,C),z&&z.reset(),q&&(q.reset(),q=null),B&&(B.abort(),B=null)}},x=K.getLogger(C),ge.on(E.Z.XLINK_READY,se,C),B=vi(k).create({errHandler:D.errHandler,dashMetrics:D.dashMetrics,mediaPlayerModel:D.mediaPlayerModel,requestModifier:D.requestModifier,urlUtils:ie,constants:u.Z,dashConstants:d.Z,errors:X,requestTimeout:D.settings.get().streaming.manifestRequestTimeout}),q=Hl(k).create({errHandler:oe,dashMetrics:D.dashMetrics,mediaPlayerModel:D.mediaPlayerModel,requestModifier:D.requestModifier,settings:D.settings}),Y=null,C}If.__dashjs_factory_name="ManifestLoader";var Vi=b.Z.getClassFactory(If);function Wl(){var D=this.context,C=(0,_.Z)(D).getInstance();return{error:function(x){C.trigger(E.Z.ERROR,{error:x})}}}Wl.__dashjs_factory_name="ErrorHandler";var za=b.Z.getSingletonFactory(Wl),Qu=g(1715);function El(){var D,C,x,B,q,Y,k=this.context,K=(0,_.Z)(k).getInstance();function re(ge,ie){if(!ie||!ie.Period_asArray||ie.Period_asArray.length===0)return Promise.resolve();var z=[];return ie.Period_asArray.forEach((function(oe){z.push((function(se,Ne){return new Promise((function(be){if(se&&se.AdaptationSet_asArray&&se.AdaptationSet_asArray.length!==0){var Le=[];se.AdaptationSet_asArray.forEach((function(Me){C.getIsTypeOf(Me,Ne)&&Le.push((function(le,Re){return new Promise((function(ue){if(le.Representation_asArray&&le.Representation_asArray.length!==0){var xe=[],P=[];le.Representation_asArray.forEach((function(te,J){var Q=C.getCodec(le,J,!1),j=(function(Ae,ve,Ce){switch(Ae){case u.Z.VIDEO:return(function(Ee,ae){return{codec:ae,width:Ee.width||null,height:Ee.height||null,framerate:Ee.frameRate||null,bitrate:Ee.bandwidth||null}})(ve,Ce);case u.Z.AUDIO:return(function(Ee,ae){var Se=Ee.audioSamplingRate||null;return{codec:ae,bitrate:Ee.bandwidth||null,samplerate:Se}})(ve,Ce);default:return null}})(Re,te,Q);P.push(j),xe.push(x.supportsCodec(j,Re))})),Promise.all(xe).then((function(te){le.Representation_asArray=le.Representation_asArray.filter((function(J,Q){return te[Q]||Y.debug("[Stream] Codec ".concat(P[Q].codec," not supported ")),te[Q]})),ue()})).catch((function(){ue()}))}else ue()}))})(Me,Ne))})),Promise.all(Le).then((function(){se.AdaptationSet_asArray=se.AdaptationSet_asArray.filter((function(Me){var le=Me.Representation_asArray&&Me.Representation_asArray.length>0;return le||(K.trigger(E.Z.ADAPTATION_SET_REMOVED_NO_CAPABILITIES,{adaptationSet:Me}),Y.warn("AdaptationSet has been removed because of no supported Representation")),le})),be()})).catch((function(){be()}))}else be()}))})(oe,ge))})),Promise.all(z)}return D={setConfig:function(ge){ge&&(ge.adapter&&(C=ge.adapter),ge.capabilities&&(x=ge.capabilities),ge.settings&&(B=ge.settings),ge.customParametersModel&&(q=ge.customParametersModel))},filterUnsupportedFeatures:function(ge){return new Promise((function(ie){var z=[];z.push(re(u.Z.VIDEO,ge)),z.push(re(u.Z.AUDIO,ge)),Promise.all(z).then((function(){B.get().streaming.capabilities.filterUnsupportedEssentialProperties&&(function(oe){oe&&oe.Period_asArray&&oe.Period_asArray.length!==0&&oe.Period_asArray.forEach((function(se){se.AdaptationSet_asArray=se.AdaptationSet_asArray.filter((function(Ne){return!Ne.Representation_asArray||Ne.Representation_asArray.length===0||(Ne.Representation_asArray=Ne.Representation_asArray.filter((function(be){var Le=C.getEssentialPropertiesForRepresentation(be);if(Le&&Le.length>0)for(var Me=0;Me<Le.length;){if(!x.supportsEssentialProperty(Le[Me]))return Y.debug("[Stream] EssentialProperty not supported: "+Le[Me].schemeIdUri),!1;Me+=1}return!0})),Ne.Representation_asArray&&Ne.Representation_asArray.length>0)}))}))})(ge),(function(oe){var se=q.getCustomCapabilitiesFilters();se&&se.length!==0&&oe&&oe.Period_asArray&&oe.Period_asArray.length!==0&&oe.Period_asArray.forEach((function(Ne){Ne.AdaptationSet_asArray=Ne.AdaptationSet_asArray.filter((function(be){return!be.Representation_asArray||be.Representation_asArray.length===0||(be.Representation_asArray=be.Representation_asArray.filter((function(Le){return!se.some((function(Me){return!Me(Le)}))})),be.Representation_asArray&&be.Representation_asArray.length>0)}))}))})(ge),ie()})).catch((function(){ie()}))}))}},Y=(0,I.Z)(k).getInstance().getLogger(D),D}El.__dashjs_factory_name="CapabilitiesFilter";var Hs=b.Z.getSingletonFactory(El),Ju=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};function ec(){var D;return{initialize:function(C){if(D=new Ju,!C)return null;var x=C.indexOf("#");if(x!==-1)for(var B=C.substr(x+1).split("&"),q=0,Y=B.length;q<Y;++q){var k=B[q],K=k.indexOf("=");if(K!==-1){var re=k.substring(0,K);D.hasOwnProperty(re)&&(D[re]=k.substr(K+1))}}},getURIFragmentData:function(){return D}}}ec.__dashjs_factory_name="URIFragmentModel";var tc=b.Z.getSingletonFactory(ec);function nc(){var D,C=this.context,x=(0,_.Z)(C).getInstance();return{getValue:function(){return D},setValue:function(B){D=B,B&&x.trigger(E.Z.MANIFEST_LOADED,{data:B})}}}nc.__dashjs_factory_name="ManifestModel";var Xi=b.Z.getSingletonFactory(nc),Es=-.5;function Vs(){var D,C,x,B,q=this.context,Y=(0,Ie.Z)(q).getInstance();function k(ge,ie){return isNaN(ge)?0:ge>0?(ie&&C.warn("Supplied minimum playback rate is a positive value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):ge<Es?(ie&&C.warn("Supplied minimum playback rate is out of range and will be limited to ".concat(Es,": ").concat(-50,"% playback speed.")),Es):ge}function K(ge,ie){return isNaN(ge)?0:ge<0?(ie&&C.warn("Supplied maximum playback rate is a negative value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):ge>1?(ie&&C.warn("Supplied maximum playback rate is out of range and will be limited to ".concat(1,": ").concat(200,"% playback speed.")),1):ge}function re(){var ge=Y.get().streaming.buffer.stableBufferTime>0?Y.get().streaming.buffer.stableBufferTime:Y.get().streaming.buffer.fastSwitchEnabled?20:12,ie=x.getLiveDelay();return!isNaN(ie)&&ie>0?Math.min(ge,ie):ge}return D={getCatchupMaxDrift:function(){if(!isNaN(Y.get().streaming.liveCatchup.maxDrift)&&Y.get().streaming.liveCatchup.maxDrift>0)return Y.get().streaming.liveCatchup.maxDrift;var ge=B.getServiceDescriptionSettings();return ge&&ge.liveCatchup&&!isNaN(ge.liveCatchup.maxDrift)&&ge.liveCatchup.maxDrift>0?ge.liveCatchup.maxDrift:12},getCatchupModeEnabled:function(){return Y.get().streaming.liveCatchup.enabled!==null?Y.get().streaming.liveCatchup.enabled:x.getInitialCatchupModeActivated()},getStableBufferTime:re,getInitialBufferLevel:function(){var ge=Y.get().streaming.buffer.initialBufferLevel;return isNaN(ge)||ge<0?0:Math.min(re(),ge)},getRetryAttemptsForType:function(ge){var ie=isNaN(Y.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:Y.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return x.getLowLatencyModeEnabled()?Y.get().streaming.retryAttempts[ge]*ie:Y.get().streaming.retryAttempts[ge]},getRetryIntervalsForType:function(ge){var ie=isNaN(Y.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:Y.get().streaming.retryIntervals.lowLatencyReductionFactor;return x.getLowLatencyModeEnabled()?Y.get().streaming.retryIntervals[ge]/ie:Y.get().streaming.retryIntervals[ge]},getCatchupPlaybackRates:function(ge){var ie=Y.get().streaming.liveCatchup.playbackRate;if(!isNaN(ie.min)||!isNaN(ie.max))return{min:k(ie.min,ge),max:K(ie.max,ge)};var z=B.getServiceDescriptionSettings();if(z&&z.liveCatchup&&(!isNaN(z.liveCatchup.playbackRate.min)||!isNaN(z.liveCatchup.playbackRate.max))){var oe=z.liveCatchup.playbackRate;return{min:k(oe.min,ge),max:K(oe.max,ge)}}return{min:-.5,max:.5}},getAbrBitrateParameter:function(ge,ie){try{var z=Y.get().streaming.abr[ge][ie];if(!isNaN(z)&&z!==-1)return z;var oe=B.getServiceDescriptionSettings();return oe&&oe[ge]&&!isNaN(oe[ge][ie])?oe[ge][ie]:-1}catch{return-1}},setConfig:function(ge){ge.playbackController&&(x=ge.playbackController),ge.serviceDescriptionController&&(B=ge.serviceDescriptionController)},reset:function(){}},C=(0,I.Z)(q).getInstance().getLogger(D),D}Vs.__dashjs_factory_name="MediaPlayerModel";var Xl=b.Z.getSingletonFactory(Vs),Tl=g(1767);function Yi(D){var C=(D=D||{}).abrController,x=D.switchHistory,B=D.droppedFramesHistory,q=D.currentRequest,Y=D.useBufferOccupancyABR,k=D.useL2AABR,K=D.useLoLPABR,re=D.streamProcessor?D.streamProcessor.getScheduleController():null,ge=D.streamProcessor?D.streamProcessor.getRepresentationInfo():null,ie=D.videoModel?D.videoModel:null;function z(){return ge?ge.mediaInfo:null}return{getMediaType:function(){var oe=z();return oe?oe.type:null},getMediaInfo:z,getDroppedFramesHistory:function(){return B},getCurrentRequest:function(){return q},getSwitchHistory:function(){return x},getStreamInfo:function(){var oe=z();return oe?oe.streamInfo:null},getScheduleController:function(){return re},getAbrController:function(){return C},getRepresentationInfo:function(){return ge},useBufferOccupancyABR:function(){return Y},useL2AABR:function(){return k},useLoLPABR:function(){return K},getVideoModel:function(){return ie}}}Yi.__dashjs_factory_name="RulesContext";var ji=b.Z.getClassFactory(Yi),ha=g(2068);function ga(){var D=[],C=[];return{push:function(x){x.newValue===ha.Z.NO_CHANGE&&(x.newValue=x.oldValue),D[x.oldValue]||(D[x.oldValue]={noDrops:0,drops:0,dropSize:0});var B=x.newValue-x.oldValue,q=B<0?1:0,Y=q?-B:0,k=q?0:1;if(D[x.oldValue].drops+=q,D[x.oldValue].dropSize+=Y,D[x.oldValue].noDrops+=k,C.push({idx:x.oldValue,noDrop:k,drop:q,dropSize:Y}),C.length>8){var K=C.shift();D[K.idx].drops-=K.drop,D[K.idx].dropSize-=K.dropSize,D[K.idx].noDrops-=K.noDrop}},getSwitchRequests:function(){return D},reset:function(){D=[],C=[]}}}ga.__dashjs_factory_name="SwitchRequestHistory";var La=b.Z.getClassFactory(ga);function xa(){var D={},C={},x={};return{push:function(B,q,Y){if(q){D[B]||(D[B]=[],C[B]=0,x[B]=0);var k=Y&&Y.droppedVideoFrames?Y.droppedVideoFrames:0,K=Y&&Y.totalVideoFrames?Y.totalVideoFrames:0,re=k-C[B];C[B]=k;var ge=K-x[B];x[B]=K;var ie=D[B];isNaN(q)||(ie[q]?(ie[q].droppedVideoFrames+=re,ie[q].totalVideoFrames+=ge):ie[q]={droppedVideoFrames:re,totalVideoFrames:ge})}},getFrameHistory:function(B){return D[B]},clearForStream:function(B){try{delete D[B],delete C[B],delete x[B]}catch{}},reset:function(){D={},C={},x={}}}}xa.__dashjs_factory_name="DroppedFramesHistory";var Cf=b.Z.getClassFactory(xa);function Ql(D){var C,x,B,q,Y,k=this.context,K=(D=D||{}).settings,re=(0,_.Z)(k).getInstance();function ge(be,Le,Me,le){var Re=Math.pow(.5,Me/le.fast);be.fastEstimate=(1-Re)*Le+Re*be.fastEstimate;var ue=Math.pow(.5,Me/le.slow);be.slowEstimate=(1-ue)*Le+ue*be.slowEstimate,be.totalWeight+=Me}function ie(be,Le,Me){return K.get().streaming.abr.movingAverageMethod!==u.Z.MOVING_AVERAGE_SLIDING_WINDOW?(function(le,Re){var ue=le?Y.throughputHalfLife:Y.latencyHalfLife,xe=le?B[Re]:q[Re];if(!xe||xe.totalWeight<=0)return NaN;var P=xe.fastEstimate/(1-Math.pow(.5,xe.totalWeight/ue.fast)),te=xe.slowEstimate/(1-Math.pow(.5,xe.totalWeight/ue.slow));return le?Math.min(P,te):Math.max(P,te)})(be,Le):(function(le,Re,ue){var xe=(function(te,J,Q){var j,Ae;if(te?(j=C[J],Ae=Q?3:4):(j=x[J],Ae=4),j){if(Ae>=j.length)Ae=j.length;else if(te)for(var ve=1;ve<Ae;++ve){var Ce=j[j.length-ve]/j[j.length-ve-1];if((Ce>=1.3||Ce<=.7692307692307692)&&(Ae+=1)===j.length)break}}else Ae=0;return Ae})(le,Re,ue),P=(le?C:x)[Re];return xe!==0&&P&&P.length!==0?(P=P.slice(-xe)).reduce((function(te,J){return te+J}))/P.length:NaN})(be,Le,Me)}function z(be,Le){return ie(!0,be,Le)}function oe(be){C[be]=C[be]||[],x[be]=x[be]||[],B[be]=B[be]||{fastEstimate:0,slowEstimate:0,totalWeight:0},q[be]=q[be]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function se(){C={},x={},B={},q={}}var Ne={push:function(be,Le,Me){if(Le.trace&&Le.trace.length){var le,Re=Le.tresponse.getTime()-Le.trequest.getTime()||1,ue=Le._tfinish.getTime()-Le.tresponse.getTime()||1,xe=Le.trace.reduce((function(Q,j){return Q+j.b[0]}),0),P=0;if((le=Le._fileLoaderType&&Le._fileLoaderType===u.Z.FILE_LOADER_TYPES.FETCH?Le.trace.reduce((function(Q,j){return Q+j.d}),0):Me?ue:Re+ue)!==0&&(P=Math.round(8*xe/le)),Le.cmsd){var te=Le.cmsd.dynamic&&Le.cmsd.dynamic.etp?Le.cmsd.dynamic.etp:null;if(te){var J=K.get().streaming.cmsd.abr.etpWeightRatio;J>0&&J<=1&&(P=P*(1-J)+te*J)}}if(oe(be),(function(Q,j,Ae){return Q===u.Z.VIDEO?Ae<K.get().streaming.cacheLoadThresholds[u.Z.VIDEO]:Q===u.Z.AUDIO?Ae<K.get().streaming.cacheLoadThresholds[u.Z.AUDIO]:void 0})(be,0,ue)){if(C[be].length>0&&!C[be].hasCachedEntries)return;C[be].hasCachedEntries=!0}else C[be]&&C[be].hasCachedEntries&&(function(Q){delete C[Q],delete x[Q],delete B[Q],delete q[Q],oe(Q)})(be);C[be].push(P),re.trigger(T.Z.THROUGHPUT_MEASUREMENT_STORED,{throughput:P,mediaType:be,httpRequest:Le}),C[be].length>20&&C[be].shift(),x[be].push(Re),x[be].length>20&&x[be].shift(),ge(B[be],P,.001*ue,Y.throughputHalfLife),ge(q[be],Re,1,Y.latencyHalfLife)}},getAverageThroughput:z,getSafeAverageThroughput:function(be,Le){var Me=z(be,Le);return isNaN(Me)||(Me*=K.get().streaming.abr.bandwidthSafetyFactor),Me},getAverageLatency:function(be){return ie(!1,be)},reset:se};return Y={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},se(),Ne}Ql.__dashjs_factory_name="ThroughputHistory";var rc=b.Z.getClassFactory(Ql);function Jl(){var D,C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le,Me,le,Re,ue,xe,P,te,J,Q,j,Ae=this.context,ve=(0,I.Z)(Ae).getInstance(),Ce=(0,_.Z)(Ae).getInstance();function Ee(){q={},Y={},K={},k={},Re={},P={},te={},J={},ge===void 0&&(ge=!1),ue&&ue.reset(),le=void 0,ue=void 0,xe=void 0,clearTimeout(re),re=null}function ae(Ve){var tt=Ve.request.mediaType,Nt=Ve.streamId;if(tt&&Nt&&k[Nt]&&j.get().streaming.abr.autoSwitchBitrate[tt]){var lt=k[Nt][tt];if(lt){var Bt=ji(Ae).create({abrController:D,streamProcessor:lt,currentRequest:Ve.request,useBufferOccupancyABR:P[tt],useL2AABR:te[tt],useLoLPABR:J[tt],videoModel:se}),Ft=x.shouldAbandonFragment(Bt,Nt);Ft.quality>ha.Z.NO_CHANGE&&lt.getFragmentModel().getRequests({state:W.FRAGMENT_MODEL_LOADING,index:Ve.request.index})[0]&&(K[Nt][tt].state=S.Z.ABANDON_LOAD,Re[Nt][tt].reset(),Re[Nt][tt].push({oldValue:Xe(tt,Nt),newValue:Ft.quality,confidence:1,reason:Ft.reason}),ze(tt,B.getActiveStreamInfo(),Ft.quality,Ft.reason),clearTimeout(re),re=setTimeout((function(){K[Nt][tt].state=S.Z.ALLOW_LOAD,re=null}),j.get().streaming.abandonLoadTimeout))}}}function Se(Ve){Ve.mediaType===u.Z.VIDEO&&(le!==void 0&&ue.push(Ve.streamId,le,se.getPlaybackQuality()),le=Ve.newQuality)}function Pe(Ve){var tt,Nt;Ve.metric!==S.Z.HTTP_REQUEST||!Ve.value||Ve.value.type!==Be.w.MEDIA_SEGMENT_TYPE||Ve.mediaType!==u.Z.AUDIO&&Ve.mediaType!==u.Z.VIDEO||xe.push(Ve.mediaType,Ve.value,j.get().streaming.abr.useDeadTimeLatency),Ve.metric!==S.Z.BUFFER_LEVEL||Ve.mediaType!==u.Z.AUDIO&&Ve.mediaType!==u.Z.VIDEO||(tt=Ve.mediaType,Nt=.001*Ve.value.level,j.get().streaming.abr.ABRStrategy===u.Z.ABR_STRATEGY_DYNAMIC&&(function(lt,Bt){try{var Ft=Ne.getStableBufferTime(),Ct=Ft,vn=.5*Ft,yn=P[lt],Fn=Bt>(yn?vn:Ct);P[lt]=Fn,Fn!==yn&&(Fn?C.info("["+lt+"] switching from throughput to buffer occupancy ABR rule (buffer: "+Bt.toFixed(3)+")."):C.info("["+lt+"] switching from buffer occupancy to throughput ABR rule (buffer: "+Bt.toFixed(3)+")."))}catch(Zn){C.error(Zn)}})(tt,Nt))}function We(Ve,tt){try{var Nt;return q[tt]=q[tt]||{},q[tt].hasOwnProperty(Ve)||(q[tt][Ve]=0),Nt=(function(lt,Bt){var Ft=q[Bt][lt],Ct=Ft;if(!k[Bt]||!k[Bt][lt])return Ct;var vn=je(lt,Bt);vn!==void 0&&(Ct=Math.max(Ft,vn));var yn=(function(Fn,Zn){try{var st=Ne.getAbrBitrateParameter("maxBitrate",Fn);return st>-1?pt(k[Zn][Fn].getMediaInfo(),st,Zn):void 0}catch{return}})(lt,Bt);return yn!==void 0&&(Ct=Math.min(Ct,yn)),Ct})(Ve,tt),Nt=(function(lt,Bt,Ft){var Ct=q[Ft][Bt],vn=j.get().streaming.abr.maxRepresentationRatio[Bt];return isNaN(vn)||vn>=1||vn<0?lt:Math.min(lt,Math.round(Ct*vn))})(Nt,Ve,tt),Nt=(function(lt,Bt,Ft){if(Bt!==u.Z.VIDEO||!j.get().streaming.abr.limitBitrateByPortal||!k[Ft]||!k[Ft][Bt])return lt;ge||un();var Ct=k[Ft][Bt].getStreamInfo(),vn=oe.getAdaptationForType(Ct.index,Bt,Ct).Representation_asArray,yn=lt;if(ie>0&&z>0){for(;yn>0&&vn[yn]&&ie<vn[yn].width&&ie-vn[yn-1].width<vn[yn].width-ie;)yn-=1;for(;yn<vn.length-1&&vn[yn].width===vn[yn+1].width;)yn+=1}return yn})(Nt,Ve,tt),j.get().streaming.cmsd.enabled&&j.get().streaming.cmsd.abr.applyMb&&(Nt=(function(lt,Bt,Ft){if(Bt!=="video")return lt;var Ct=Le.getMaxBitrate(Bt);if(Ct<0)return lt;var vn=At(Ft,"audio",Xe("audio",Ft));Ct-=vn?vn.bitrate/1e3:0;var yn=pt(k[Ft][Bt].getMediaInfo(),Ct,Ft);return C.debug("Stream ID: "+Ft+" ["+Bt+"] Apply max bit rate from CMSD: "+Ct),Math.min(lt,yn)})(Nt,Ve,tt)),Nt}catch{return}}function je(Ve,tt){try{return(function(Nt,lt){try{var Bt=Ne.getAbrBitrateParameter("minBitrate",Nt);if(Bt>-1){var Ft=k[lt][Nt].getMediaInfo(),Ct=yt(Ft),vn=pt(Ft,Bt,lt);return Ct[vn]&&vn<Ct.length-1&&Ct[vn].bitrate<1e3*Bt&&vn++,vn}return}catch{return}})(Ve,tt)}catch{return}}function Xe(Ve){var tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;try{return tt||(tt=B.getActiveStreamInfo().id),Ve&&k[tt]&&k[tt][Ve]&&tt?(Y[tt]=Y[tt]||{},Y[tt].hasOwnProperty(Ve)||(Y[tt][Ve]=0),Y[tt][Ve]):0}catch{return 0}}function ze(Ve,tt,Nt){var lt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(tt&&tt.id&&Ve){var Bt=tt.id,Ft=Xe(Ve,Bt);(0,ye.SE)(Nt);var Ct=We(Ve,Bt);Nt!==Ft&&Nt>=0&&Nt<=Ct&&St(Ve,Ft,Nt,Ct,lt,Bt)}}function St(Ve,tt,Nt,lt,Bt,Ft){if(Ve&&k[Ft]&&k[Ft][Ve]){var Ct=k[Ft][Ve].getStreamInfo(),vn=Ct&&Ct.manifestInfo&&Ct.manifestInfo.isDynamic,yn=Q.getCurrentBufferLevel(Ve);C.info("Stream ID: "+Ft+" ["+Ve+"] switch from "+tt+" to "+Nt+"/"+lt+" (buffer: "+yn+") "+(Bt?JSON.stringify(Bt):".")),Y[Ft]=Y[Ft]||{},Y[Ft][Ve]=Nt;var Fn=At(Ft,Ve,Nt);Ce.trigger(E.Z.QUALITY_CHANGE_REQUESTED,{oldQuality:tt,newQuality:Nt,reason:Bt,streamInfo:Ct,bitrateInfo:Fn,maxIdx:lt,mediaType:Ve},{streamId:Ct.id,mediaType:Ve});var Zn=xe.getAverageThroughput(Ve,vn);isNaN(Zn)||Me.setSavedBitrateSettings(Ve,Zn)}}function At(Ve,tt,Nt){if(tt&&k&&k[Ve]&&k[Ve][tt]){var lt=yt(k[Ve][tt].getMediaInfo());return lt[Nt]?lt[Nt]:null}return null}function pt(Ve,tt,Nt){var lt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,Bt=Ve&&Ve.type?k[Nt][Ve.type].getRepresentationInfo():null;if(j.get().streaming.abr.useDeadTimeLatency&&lt&&Bt&&Bt.fragmentDuration){lt/=1e3;var Ft=Bt.fragmentDuration;if(lt>Ft)return 0;var Ct=lt/Ft;tt*=1-Ct}for(var vn=yt(Ve),yn=vn.length-1;yn>=0;yn--){var Fn=vn[yn];if(1e3*tt>=Fn.bitrate)return yn}return 0}function yt(Ve){var tt=[];if(!Ve||!Ve.bitrateList)return tt;for(var Nt,lt=Ve.bitrateList,Bt=Ve.type,Ft=0,Ct=lt.length;Ft<Ct;Ft++)(Nt=new al).mediaType=Bt,Nt.qualityIndex=Ft,Nt.bitrate=lt[Ft].bandwidth,Nt.width=lt[Ft].width,Nt.height=lt[Ft].height,Nt.scanType=lt[Ft].scanType,tt.push(Nt);return tt}function un(){if(se){var Ve=j.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;ie=se.getClientWidth()*Ve,z=se.getClientHeight()*Ve}}return D={initialize:function(){ue=Cf(Ae).create(),xe=rc(Ae).create({settings:j}),(x=(0,Tl.Z)(Ae).create({dashMetrics:Q,customParametersModel:be,mediaPlayerModel:Ne,settings:j})).initialize(),Ce.on(T.Z.QUALITY_CHANGE_RENDERED,Se,D),Ce.on(T.Z.METRIC_ADDED,Pe,D),Ce.on(E.Z.LOADING_PROGRESS,ae,D)},isPlayingAtTopQuality:function(Ve){var tt=Ve?Ve.id:null,Nt=Xe(u.Z.AUDIO,tt),lt=Xe(u.Z.VIDEO,tt);return Nt===We(u.Z.AUDIO,tt)&&lt===We(u.Z.VIDEO,tt)},updateTopQualityIndex:function(Ve){var tt=Ve.type,Nt=Ve.streamInfo.id,lt=Ve.representationCount-1;return q[Nt]=q[Nt]||{},q[Nt][tt]=lt,lt},clearDataForStream:function(Ve){ue&&ue.clearForStream(Ve),k[Ve]&&delete k[Ve],Re[Ve]&&delete Re[Ve],K[Ve]&&delete K[Ve]},getThroughputHistory:function(){return xe},getBitrateList:yt,getQualityForBitrate:pt,getTopBitrateInfoFor:function(Ve){var tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(tt||(tt=B.getActiveStreamInfo().id),Ve&&k&&k[tt]&&k[tt][Ve]){var Nt=We(Ve,tt),lt=yt(k[tt][Ve].getMediaInfo());return lt[Nt]?lt[Nt]:null}return null},getMinAllowedIndexFor:je,getMaxAllowedIndexFor:We,getInitialBitrateFor:function(Ve,tt){if((function(){if(!Me||!Me.hasOwnProperty("getSavedBitrateSettings"))throw new Error(u.Z.MISSING_CONFIG_ERROR)})(),Ve===u.Z.TEXT)return NaN;var Nt=Me.getSavedBitrateSettings(Ve),lt=Ne.getAbrBitrateParameter("initialBitrate",Ve),Bt=j.get().streaming.abr.initialRepresentationRatio[Ve];if(lt===-1)if(Bt>-1){var Ft=k[tt][Ve].getStreamInfo(),Ct=oe.getAdaptationForType(Ft.index,Ve,Ft).Representation_asArray;lt=Array.isArray(Ct)?Ct[Math.max(Math.round(Ct.length*Bt)-1,0)].bandwidth/1e3:0}else lt=isNaN(Nt)?Ve===u.Z.VIDEO?1e3:100:Nt;return lt},getQualityFor:Xe,getAbandonmentStateFor:function(Ve,tt){return K[Ve]&&K[Ve][tt]?K[Ve][tt].state:null},setPlaybackQuality:ze,checkPlaybackQuality:function(Ve,tt){try{if(!(Ve&&k&&k[tt]&&k[tt][Ve]))return!1;if(ue){var Nt=se.getPlaybackQuality();Nt&&ue.push(tt,le,Nt)}if(!j.get().streaming.abr.autoSwitchBitrate[Ve])return!1;var lt=Xe(Ve,tt),Bt=ji(Ae).create({abrController:D,switchHistory:Re[tt][Ve],droppedFramesHistory:ue,streamProcessor:k[tt][Ve],currentValue:lt,useBufferOccupancyABR:P[Ve],useL2AABR:te[Ve],useLoLPABR:J[Ve],videoModel:se}),Ft=je(Ve,tt),Ct=We(Ve,tt),vn=x.getMaxQuality(Bt),yn=vn.quality;return Ft!==void 0&&(yn>ha.Z.NO_CHANGE?yn:lt)<Ft&&(yn=Ft),yn>Ct&&(yn=Ct),Re[tt][Ve].push({oldValue:lt,newValue:yn}),yn>ha.Z.NO_CHANGE&&yn!==lt&&(K[tt][Ve].state===S.Z.ALLOW_LOAD||yn<lt)&&(St(Ve,lt,yn,Ct,vn.reason,tt),!0)}catch{return!1}},setElementSize:un,setWindowResizeEventCalled:function(Ve){ge=Ve},registerStreamType:function(Ve,tt){var Nt=tt.getStreamInfo().id;k[Nt]||(k[Nt]={}),Re[Nt]||(Re[Nt]={}),K[Nt]||(K[Nt]={}),Re[Nt][Ve]=La(Ae).create(),k[Nt][Ve]=tt,K[Nt][Ve]={},K[Nt][Ve].state=S.Z.ALLOW_LOAD,(function(lt){var Bt=j.get().streaming.abr.ABRStrategy;Bt===u.Z.ABR_STRATEGY_L2A?(P[lt]=!1,J[lt]=!1,te[lt]=!0):Bt===u.Z.ABR_STRATEGY_LoLP?(P[lt]=!1,J[lt]=!0,te[lt]=!1):Bt===u.Z.ABR_STRATEGY_BOLA?(P[lt]=!0,J[lt]=!1,te[lt]=!1):Bt===u.Z.ABR_STRATEGY_THROUGHPUT?(P[lt]=!1,J[lt]=!1,te[lt]=!1):Bt===u.Z.ABR_STRATEGY_DYNAMIC&&(P[lt]=!(!P||!P[lt])&&P[lt],J[lt]=!1,te[lt]=!1)})(Ve),Ve===u.Z.VIDEO&&un()},unRegisterStreamType:function(Ve,tt){try{k[Ve]&&k[Ve][tt]&&delete k[Ve][tt],Re[Ve]&&Re[Ve][tt]&&delete Re[Ve][tt],K[Ve]&&K[Ve][tt]&&delete K[Ve][tt]}catch{}},setConfig:function(Ve){Ve&&(Ve.streamController&&(B=Ve.streamController),Ve.domStorage&&(Me=Ve.domStorage),Ve.mediaPlayerModel&&(Ne=Ve.mediaPlayerModel),Ve.customParametersModel&&(be=Ve.customParametersModel),Ve.cmsdModel&&(Le=Ve.cmsdModel),Ve.dashMetrics&&(Q=Ve.dashMetrics),Ve.adapter&&(oe=Ve.adapter),Ve.videoModel&&(se=Ve.videoModel),Ve.settings&&(j=Ve.settings))},reset:function(){Ee(),Ce.off(E.Z.LOADING_PROGRESS,ae,D),Ce.off(T.Z.QUALITY_CHANGE_RENDERED,Se,D),Ce.off(T.Z.METRIC_ADDED,Pe,D),x&&x.reset()}},C=ve.getLogger(D),Ee(),D}Jl.__dashjs_factory_name="AbrController";var di=b.Z.getSingletonFactory(Jl);di.QUALITY_DEFAULT=0,b.Z.updateSingletonFactory(Jl.__dashjs_factory_name,di);var Vr=di,ur=new Map([[u.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[u.Z.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[u.Z.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[u.Z.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function $a(){var D,C,x,B,q,Y,k,K,re=this.context,ge=(0,_.Z)(re).getInstance(),ie=[];function z(){x&&(x.playbackRate=1,x.removeEventListener("canplay",z))}function oe(){return ie.length>0}function se(){if(x&&oe()&&x.playbackRate===0){var ue=document.createEvent("Event");ue.initEvent("waiting",!0,!1),x.dispatchEvent(ue)}}function Ne(ue,xe){x&&x.addEventListener(ue,xe)}function be(ue,xe){x&&x.removeEventListener(ue,xe)}function Le(){return x?x.readyState:NaN}function Me(){return x?x.buffered:null}function le(ue,xe,P,te,J){if(x){for(var Q=0;Q<x.textTracks.length;Q++)if(x.textTracks[Q].kind===ue&&(!xe||x.textTracks[Q].label==xe)&&x.textTracks[Q].language===P&&x.textTracks[Q].isTTML===te&&x.textTracks[Q].isEmbedded===J)return x.textTracks[Q]}return null}function Re(ue,xe){return ue===u.Z.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||Le()>=ue?(xe(),null):(function(P,te){var J=function Q(){be(P,Q),te(P)};return Ne(P,J),{func:J,event:P}})(ur.get(ue),xe)}return D={addEventListener:Ne,addTextTrack:function(ue,xe,P,te,J){if(!x)return null;var Q=le(ue,xe,P,te,J);return Q||((Q=x.addTextTrack(ue,xe,P)).isEmbedded=J,Q.isTTML=te),Q},appendChild:function(ue){x&&(x.appendChild(ue),ue.isTTML!==void 0&&(x.textTracks[x.textTracks.length-1].isTTML=ue.isTTML,x.textTracks[x.textTracks.length-1].isEmbedded=ue.isEmbedded))},getBufferRange:Me,getClientHeight:function(){return x?x.clientHeight:NaN},getClientWidth:function(){return x?x.clientWidth:NaN},getElement:function(){return x},getEnded:function(){return x?x.ended:null},getPlaybackQuality:function(){if(!x)return null;var ue="webkitDroppedFrameCount"in x&&"webkitDecodedFrameCount"in x,xe=null;return"getVideoPlaybackQuality"in x?xe=x.getVideoPlaybackQuality():ue&&(xe={droppedVideoFrames:x.webkitDroppedFrameCount,totalVideoFrames:x.webkitDroppedFrameCount+x.webkitDecodedFrameCount,creationTime:new Date}),xe},getPlaybackRate:function(){return x?x.playbackRate:null},getPlayedRanges:function(){return x?x.played:null},getReadyState:Le,getSource:function(){return x?x.src:null},getTTMLRenderingDiv:function(){return Y},getTextTrack:le,getTextTracks:function(){return x?x.textTracks:[]},getTime:function(){return x?isNaN(B)?x.currentTime:B:null},getVideoHeight:function(){return x?x.videoHeight:NaN},getVideoRelativeOffsetLeft:function(){if(x){var ue=x.parentNode.host||x.parentNode;return ue?x.getBoundingClientRect().left-ue.getBoundingClientRect().left:NaN}return NaN},getVideoRelativeOffsetTop:function(){if(x){var ue=x.parentNode.host||x.parentNode;return ue?x.getBoundingClientRect().top-ue.getBoundingClientRect().top:NaN}return NaN},getVideoWidth:function(){return x?x.videoWidth:NaN},getVttRenderingDiv:function(){return k},initialize:function(){ge.on(E.Z.PLAYBACK_PLAYING,se,this)},isPaused:function(){return x?x.paused:null},isSeeking:function(){return x?x.seeking||!isNaN(B):null},isStalled:oe,pause:function(){x&&(x.pause(),x.autoplay=!1)},play:function(){if(x){x.autoplay=!0;var ue=x.play();ue&&ue.catch&&typeof Promise<"u"&&ue.catch((function(xe){xe.name==="NotAllowedError"&&ge.trigger(E.Z.PLAYBACK_NOT_ALLOWED),C.warn("Caught pending play exception - continuing (".concat(xe,")"))}))}},removeChild:function(ue){x&&x.removeChild(ue)},removeEventListener:be,reset:function(){clearTimeout(K),ge.off(E.Z.PLAYBACK_PLAYING,se,this)},setCurrentTime:function(ue,xe){x&&(q&&q.func&&q.event&&be(q.event,q.func),B=ue,q=Re(u.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,(function(){if(x)if(x.currentTime!==B)try{B=xe?(function(P){var te=Me(),J=P,Q=9999999999;if(te)for(var j=0;j<te.length;j++){var Ae=te.start(j),ve=te.end(j),Ce=Math.abs(Ae-P),Ee=Math.abs(ve-P);if(P>=Ae&&P<=ve)return P;Ce<Q&&(Q=Ce,J=Ae),Ee<Q&&(Q=Ee,J=ve)}return J})(B):B,isNaN(B)||(x.currentTime=B),B=NaN}catch(P){x.readyState===0&&P.code===P.INVALID_STATE_ERR&&(K=setTimeout((function(){x.currentTime=B,B=NaN}),400))}else B=NaN})))},setElement:function(ue){if(!(ue==null||ue&&/^(VIDEO|AUDIO)$/i.test(ue.nodeName)))throw"element is not video or audio DOM type!";(x=ue)&&(x.preload="auto")},setPlaybackRate:function(ue){var xe=arguments.length>1&&arguments[1]!==void 0&&arguments[1];x&&(!xe&&x.readyState<=2&&ue>0?x.addEventListener("canplay",z):x.playbackRate=ue)},setSource:function(ue){x&&(ue?x.src=ue:(x.removeAttribute("src"),x.load()))},setStallState:function(ue,xe){(function(P,te){te?(function(J){J!==null&&x&&!x.seeking&&ie.indexOf(J)===-1&&ie.push(J)})(P):(function(J){var Q=ie.indexOf(J);J!==null&&Q!==-1&&ie.splice(Q,1)})(P)})(ue,xe)},setTTMLRenderingDiv:function(ue){(Y=ue).style.position="absolute",Y.style.display="flex",Y.style.overflow="hidden",Y.style.pointerEvents="none",Y.style.top=0,Y.style.left=0},setVttRenderingDiv:function(ue){k=ue},waitForReadyState:Re,setDisableRemotePlayback:function(ue){x&&(x.disableRemotePlayback=ue)}},C=(0,I.Z)(re).getInstance().getLogger(D),B=NaN,D}$a.__dashjs_factory_name="VideoModel";var Qi=b.Z.getSingletonFactory($a),ic=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],Wa="dashjs_?_bitrate",ac="dashjs_?_settings",Ys="localStorage",js="lastBitrate",Ts="lastMediaSettings";function eu(D){D=D||{};var C,x,B,q=this.context,Y=D.settings;function k(ie){if(B!==void 0)return B;var z;B=!1;try{typeof window<"u"&&(z=window[ie])}catch(oe){return x.warn("DOMStorage access denied: "+oe.message),B}if(!z||ie!==Ys)return B;try{z.setItem("1","1"),z.removeItem("1"),B=!0}catch(oe){x.warn("DOMStorage is supported, but cannot be used: "+oe.message)}return B}function K(){var ie=6e5;return Math.round(new Date().getTime()/ie)*ie}function re(ie,z){return k(ie)&&Y.get().streaming[z+"CachingInfo"].enabled}function ge(){if(!Y)throw new Error(u.Z.MISSING_CONFIG_ERROR)}return C={getSavedBitrateSettings:function(ie){if(ge(),!Y.get().streaming.lastBitrateCachingInfo.enabled)return NaN;var z=NaN;if(re(Ys,js)){var oe=Wa.replace(/\?/,ie);try{var se=JSON.parse(localStorage.getItem(oe))||{},Ne=new Date().getTime()-parseInt(se.timestamp,10)>=Y.get().streaming.lastBitrateCachingInfo.ttl||!1,be=parseFloat(se.bitrate);isNaN(be)||Ne?Ne&&localStorage.removeItem(oe):(z=be,x.debug("Last saved bitrate for "+ie+" was "+be))}catch{return null}}return z},setSavedBitrateSettings:function(ie,z){if(re(Ys,js)&&z){var oe=Wa.replace(/\?/,ie);try{localStorage.setItem(oe,JSON.stringify({bitrate:z.toFixed(3),timestamp:K()}))}catch(se){x.error(se.message)}}},getSavedMediaSettings:function(ie){if(ge(),!Y.get().streaming.lastMediaSettingsCachingInfo.enabled)return null;var z=null;if(re(Ys,Ts)){var oe=ac.replace(/\?/,ie);try{var se=JSON.parse(localStorage.getItem(oe))||{},Ne=new Date().getTime()-parseInt(se.timestamp,10)>=Y.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;z=se.settings,Ne&&(localStorage.removeItem(oe),z=null)}catch{return null}}return z},setSavedMediaSettings:function(ie,z){if(re(Ys,Ts)){var oe=ac.replace(/\?/,ie);try{localStorage.setItem(oe,JSON.stringify({settings:z,timestamp:K()}))}catch(se){x.error(se.message)}}}},x=(0,I.Z)(q).getInstance().getLogger(C),k(Ys)&&ic.forEach((function(ie){var z=localStorage.getItem(ie.oldKey);if(z){localStorage.removeItem(ie.oldKey);try{localStorage.setItem(ie.newKey,z)}catch(oe){x.error(oe.message)}}})),C}eu.__dashjs_factory_name="DOMStorage";var Sl=b.Z.getSingletonFactory(eu),sc=g(2032),Ss=g(2011);function Na(){var D,C,x,B,q,Y,k,K,re,ge,ie,z,oe,se=this.context;function Ne(le,Re,ue,xe){var P=null,te=le?oe.resolve(le.path):null,J=xe||{init:!0,url:te?te.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:Re};C.debug("Start searching for initialization.");var Q=Me(J);K.load({request:Q,success:function(j){if(J.bytesLoaded=J.range.end,!(P=B.findInitRange(j)))return J.range.end=J.bytesLoaded+J.bytesToLoad,Ne(le,Re,ue,J);le.range=P,ue(le)},error:function(){ue(le)}}),C.debug("Perform init search: "+J.url)}function be(le,Re,ue,xe,P,te){if(ue&&(ue.start===void 0||ue.end===void 0)){var J=ue?ue.toString().split("-"):null;ue=J?{start:parseFloat(J[0]),end:parseFloat(J[1])}:null}P=P||Le;var Q=null,j=null,Ae=!!ue,ve=le?oe.resolve(le.path):null,Ce={init:!1,url:ve?ve.url:void 0,range:Ae?ue:{start:0,end:1500},searching:!Ae,bytesLoaded:te?te.bytesLoaded:0,bytesToLoad:1500,mediaType:Re},Ee=Me(Ce);K.load({request:Ee,success:function(ae){var Se=Ce.bytesToLoad,Pe=ae.byteLength;if(Ce.bytesLoaded=Ce.range.end-Ce.range.start,Q=B.parse(ae),(j=Q.getBox("sidx"))&&j.isComplete){var We,je,Xe=j.references;if(Xe!=null&&Xe.length>0&&(We=Xe[0].reference_type===1),We){var ze,St,At,pt;C.debug("Initiate multiple SIDX load."),Ce.range.end=Ce.range.start+j.size;var yt=[],un=0,Ve=(j.offset||Ce.range.start)+j.size,tt=function(lt){lt?(yt=yt.concat(lt),++un>=St&&(yt.sort((function(Bt,Ft){return Bt.startTime-Ft.startTime<0?-1:0})),P(yt,le,xe))):P(null,le,xe)};for(ze=0,St=Xe.length;ze<St;ze++)At=Ve,pt=Ve+Xe[ze].referenced_size-1,Ve+=Xe[ze].referenced_size,be(le,Re,{start:At,end:pt},xe,tt,Ce)}else C.debug("Parsing segments from SIDX. representation "+Re+" - id: "+le.id+" for range : "+Ce.range.start+" - "+Ce.range.end),je=(function(lt,Bt){for(var Ft,Ct,vn,yn,Fn=lt.references,Zn=Fn.length,st=lt.timescale,Mt=lt.earliest_presentation_time,Tt=Bt.range.start+lt.offset+lt.first_offset+lt.size,jt=[],en=0;en<Zn;en++)vn=Fn[en].subsegment_duration,yn=Fn[en].referenced_size,(Ft=new Ss.Z).duration=vn,Ft.startTime=Mt,Ft.timescale=st,Ct=Tt+yn-1,Ft.mediaRange=Tt+"-"+Ct,jt.push(Ft),Mt+=vn,Tt+=yn;return jt})(j,Ce),P(je,le,xe)}else{if(j)Ce.range.start=j.offset||Ce.range.start,Ce.range.end=Ce.range.start+(j.size||Se);else{if(Pe<Ce.bytesLoaded)return void P(null,le,xe);var Nt=Q.getLastBox();Nt&&Nt.size?(Ce.range.start=Nt.offset+Nt.size,Ce.range.end=Ce.range.start+Se):Ce.range.end+=Se}be(le,Re,Ce.range,xe,null,Ce)}},error:function(){P(null,le,xe)}}),C.debug("Perform SIDX load for type ".concat(Re," : ").concat(Ce.url," with range ").concat(Ce.range.start," - ").concat(Ce.range.end))}function Le(le,Re,ue){ue({segments:le,representation:Re,error:le?void 0:new fe.Z(re.SEGMENT_BASE_LOADER_ERROR_CODE,re.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function Me(le){if(le.url){var Re=new O.Z;return Re.setInfo(le),Re}}return D={setConfig:function(le){le.baseURLController&&(oe=le.baseURLController),le.dashMetrics&&(Y=le.dashMetrics),le.mediaPlayerModel&&(k=le.mediaPlayerModel),le.errHandler&&(x=le.errHandler),le.boxParser&&(B=le.boxParser),le.debug&&(C=le.debug.getLogger(D)),le.requestModifier&&(q=le.requestModifier),le.errors&&(re=le.errors),le.urlUtils&&(z=le.urlUtils),le.constants&&(ge=le.constants),le.dashConstants&&(ie=le.dashConstants)},initialize:function(){K=vi(se).create({errHandler:x,dashMetrics:Y,mediaPlayerModel:k,requestModifier:q,boxParser:B,errors:re,urlUtils:z,constants:ge,dashConstants:ie})},loadInitialization:function(le,Re){return new Promise((function(ue){Ne(le,Re,ue)}))},loadSegments:function(le,Re,ue){return new Promise((function(xe){be(le,Re,ue,xe)}))},reset:function(){K&&(K.abort(),K=null)}}}Na.__dashjs_factory_name="SegmentBaseLoader";var _s=b.Z.getSingletonFactory(Na);function wa(D){var C;D=D||{};var x=new DataView(D.data),B=0;function q(k,K){var re=!0,ge=0;if(K===void 0&&(K=!1),k.tag>16777215?(x.getUint32(B)!==k.tag&&(re=!1),ge=4):k.tag>65535?(256*x.getUint16(B)+x.getUint8(B+2)!==k.tag&&(re=!1),ge=3):k.tag>255?(x.getUint16(B)!==k.tag&&(re=!1),ge=2):(x.getUint8(B)!==k.tag&&(re=!1),ge=1),!re&&k.required&&!K)throw new Error("required tag not found");return re&&(B+=ge),re}function Y(k){var K=1,re=128,ge=-1,ie=0,z=x.getUint8(B),oe=0;for(oe=0;oe<8;oe+=1){if((z&re)===re){ie=k===void 0?z&~re:z,ge=oe;break}re>>=1}for(oe=0;oe<ge;oe+=1,K+=1)ie=ie<<8|255&x.getUint8(B+K);return B+=K,ie}return C={getPos:function(){return B},setPos:function(k){B=k},consumeTag:q,consumeTagAndSize:function(k,K){var re=q(k,K);return re&&Y(),re},parseTag:function(k){var K;return q(k),K=Y(),C[k.parse](K)},skipOverElement:function(k,K){var re,ge=q(k,K);return ge&&(re=Y(),B+=re),ge},getMatroskaCodedNum:Y,getMatroskaFloat:function(k){var K;switch(k){case 4:K=x.getFloat32(B),B+=4;break;case 8:K=x.getFloat64(B),B+=8}return K},getMatroskaUint:function(k){if(k>4)return(function(ge){for(var ie=Math.floor(Number.MAX_SAFE_INTEGER/256),z=0,oe=0;oe<ge;oe+=1){if(z>ie)throw new Error("Value exceeds safe integer limit");z*=256;var se=x.getUint8(B+oe);if(z>Number.MAX_SAFE_INTEGER-se)throw new Error("Value exceeds safe integer limit");z+=se}return B+=ge,z})(k);for(var K=0,re=0;re<k;re+=1)K<<=8,K|=255&x.getUint8(B+re);return B+=k,K>>>0},moreData:function(){return B<x.byteLength}}}wa.__dashjs_factory_name="EBMLParser";var tu=b.Z.getClassFactory(wa);function nu(){var D,C,x,B,q,Y,k,K,re,ge,ie=this.context;function z(oe){var se=new O.Z;return se.setInfo(oe),se}return D={setConfig:function(oe){if(!(oe.baseURLController&&oe.dashMetrics&&oe.mediaPlayerModel&&oe.errHandler))throw new Error(u.Z.MISSING_CONFIG_ERROR);ge=oe.baseURLController,Y=oe.dashMetrics,k=oe.mediaPlayerModel,B=oe.errHandler,re=oe.errors,C=oe.debug.getLogger(D),q=oe.requestModifier},initialize:function(){K=vi(ie).create({errHandler:B,dashMetrics:Y,mediaPlayerModel:k,requestModifier:q,errors:re})},loadInitialization:function(oe,se){return new Promise((function(Ne){var be=null,Le=oe?ge.resolve(oe.path):null,Me=oe?oe.range.split("-"):null,le={range:{start:Me?parseFloat(Me[0]):null,end:Me?parseFloat(Me[1]):null},request:be,url:Le?Le.url:void 0,init:!0,mediaType:se};C.info("Start loading initialization."),be=z(le),K.load({request:be,success:function(){Ne(oe)},error:function(){Ne(oe)}}),C.debug("Perform init load: "+le.url)}))},loadSegments:function(oe,se,Ne){return new Promise((function(be){var Le=null,Me=oe?ge.resolve(oe.path):null,le=Me?Me.url:void 0;Le=z({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:Le,url:le,init:!1,mediaType:se}),C.debug("Parsing ebml header"),K.load({request:Le,success:function(Re){(function(ue,xe,P,te){if(ue&&ue.byteLength!==0){var J,Q,j,Ae,ve=tu(ie).create({data:ue}),Ce=P?P.split("-"):null,Ee=null,ae={url:xe,range:{start:Ce?parseFloat(Ce[0]):null,end:Ce?parseFloat(Ce[1]):null},request:Ee};for(C.debug("Parse EBML header: "+ae.url),ve.skipOverElement(x.EBML),ve.consumeTag(x.Segment),j=ve.getMatroskaCodedNum(),j+=ve.getPos(),Ae=ve.getPos();ve.moreData()&&!ve.consumeTagAndSize(x.Segment.Info,!0);)if(!(ve.skipOverElement(x.Segment.SeekHead,!0)||ve.skipOverElement(x.Segment.Tracks,!0)||ve.skipOverElement(x.Segment.Cues,!0)||ve.skipOverElement(x.Void,!0)))throw new Error("no valid top level element found");for(;J===void 0;){var Se=ve.getMatroskaCodedNum(!0),Pe=ve.getMatroskaCodedNum();Se===x.Segment.Info.Duration.tag?J=ve[x.Segment.Info.Duration.parse](Pe):ve.setPos(ve.getPos()+Pe)}Ee=z(ae),K.load({request:Ee,success:function(We){Q=(function(je,Xe,ze,St){var At,pt,yt,un,Ve,tt,Nt,lt;for(yt=[],Ve=0,tt=(pt=(function(Bt){var Ft,Ct,vn=[],yn=tu(ie).create({data:Bt});for(yn.consumeTagAndSize(x.Segment.Cues);yn.moreData()&&yn.consumeTagAndSize(x.Segment.Cues.CuePoint,!0);){for((Ft={}).CueTime=yn.parseTag(x.Segment.Cues.CuePoint.CueTime),Ft.CueTracks=[];yn.moreData()&&yn.consumeTag(x.Segment.Cues.CuePoint.CueTrackPositions,!0);){var Fn=yn.getMatroskaCodedNum(),Zn=yn.getPos();if((Ct={}).Track=yn.parseTag(x.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),Ct.Track===0)throw new Error("Cue track cannot be 0");Ct.ClusterPosition=yn.parseTag(x.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),Ft.CueTracks.push(Ct),yn.setPos(Zn+Fn)}if(Ft.CueTracks.length===0)throw new Error("Mandatory cuetrack not found");vn.push(Ft)}if(vn.length===0)throw new Error("mandatory cuepoint not found");return vn})(je)).length;Ve<tt;Ve+=1)un=new Ss.Z,At=Ve<pt.length-1?pt[Ve+1].CueTime-pt[Ve].CueTime:St-pt[Ve].CueTime,un.duration=At,un.startTime=pt[Ve].CueTime,un.timescale=1e3,Nt=pt[Ve].CueTracks[0].ClusterPosition+Xe,lt=Ve<pt.length-1?pt[Ve+1].CueTracks[0].ClusterPosition+Xe-1:ze-1,un.mediaRange=Nt+"-"+lt,yt.push(un);return C.debug("Parsed cues: "+yt.length+" cues."),yt})(We,Ae,j,J),te(Q)},error:function(){C.error("Download Error: Cues "+ae.url),te(null)}}),C.debug("Perform cues load: "+ae.url+" bytes="+ae.range.start+"-"+ae.range.end)}else te(null)})(Re,le,Ne,(function(ue){be({segments:ue,representation:oe,error:ue?void 0:new fe.Z(re.SEGMENT_BASE_LOADER_ERROR_CODE,re.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}))},error:function(){be({representation:oe,error:new fe.Z(re.SEGMENT_BASE_LOADER_ERROR_CODE,re.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}})}))},reset:function(){K&&(K.abort(),K=null)}},x={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},D}nu.__dashjs_factory_name="WebmSegmentBaseLoader";var Co=b.Z.getSingletonFactory(nu);function _l(D){D=D||{};var C,x,B,q=this.context,Y=D.eventBus,k=D.events,K=D.dashMetrics,re=D.mediaPlayerModel,ge=D.errHandler,ie=D.baseURLController,z=D.debug,oe=D.boxParser,se=D.requestModifier,Ne=D.errors;function be(Le){return(Le?Le.split("/")[1]:"").toLowerCase()==="webm"}return C={initialize:function(){x.initialize(),B.initialize()},getSegmentBaseInitSegment:function(Le){return be(Le.representation.mimeType)?B.loadInitialization(Le.representation,Le.mediaType):x.loadInitialization(Le.representation,Le.mediaType)},getSegmentList:function(Le){return be(Le.mimeType)?B.loadSegments(Le.representation,Le.mediaType,Le.representation?Le.representation.indexRange:null):x.loadSegments(Le.representation,Le.mediaType,Le.representation?Le.representation.indexRange:null)},reset:function(){x.reset(),B.reset()}},x=_s(q).getInstance(),B=Co(q).getInstance(),x.setConfig({baseURLController:ie,dashMetrics:K,mediaPlayerModel:re,errHandler:ge,eventBus:Y,events:k,errors:Ne,debug:z,boxParser:oe,requestModifier:se}),B.setConfig({baseURLController:ie,dashMetrics:K,mediaPlayerModel:re,errHandler:ge,eventBus:Y,events:k,errors:Ne,debug:z,requestModifier:se}),C}_l.__dashjs_factory_name="SegmentBaseController";var qs=b.Z.getSingletonFactory(_l),mi=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null},Do=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.viewpointsWithSchemeIdUri=null,this.accessibility=null,this.accessibilitiesWithSchemeIdUri=null,this.audioChannelConfiguration=null,this.audioChannelConfigurationsWithSchemeIdUri=null,this.roles=null,this.rolesWithSchemeIdUri=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1,this.supplementalProperties={},this.supplementalPropertiesAsArray=[],this.essentialProperties={},this.essentialPropertiesAsArray=[],this.segmentAlignment=!1,this.subSegmentAlignment=!1},oc=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0},fh=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null,this.serviceDescriptions=[],this.protocol=null};function dh(D,C){for(var x=0;x<C.length;x++){var B=C[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}var hh=(function(){function D(B){var q=this;(function(Y,k){if(!(Y instanceof k))throw new TypeError("Cannot call a class as a function")})(this,D),this.valid=B[0]=="/",this.path=B.split("/").filter((function(Y){return Y.length!==0})).map((function(Y){var k={name:Y},K=Y.indexOf("[");if(K!=-1){k.name=Y.substring(0,K);var re=Y.substring(K+1,Y.length-1);q.valid=q.valid&&re.indexOf("[")==-1;var ge=re.indexOf("=");ge!=-1?(k.attribute={name:re.substring(1,ge),value:re.substring(ge+1)},["'",'"'].indexOf(k.attribute.value[0])!=-1&&(k.attribute.value=k.attribute.value.substring(1,k.attribute.value.length-1))):k.position=parseInt(re,10)-1}return k}))}var C,x;return C=D,(x=[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"findsTextReplace",value:function(){return this.path[this.path.length-1].name==="text()"}},{key:"getMpdTarget",value:function(B,q){for(var Y=null,k=B,K=1,re="MPD";K<this.path.length&&k!==null;){Y=k;var ge=this.path[K];if(re=ge.name,K!==this.path.length-1||!re.startsWith("@")&&re!=="text()"){var ie=Y[re+"_asArray"]||[];ie.length===0&&Y[re]&&ie.push(Y[re]),ge.position?k=ie[ge.position]||null:ge.attribute?(function(){var z=ge.attribute;k=ie.filter((function(oe){return oe[z.name]==z.value}))[0]||null})():k=ie[0]||null}K++}return k===null?null:re.startsWith("@")?{name:re.substring(1),leaf:k,target:k}:re==="text()"?{name:"__text",leaf:k,target:k}:{name:re,leaf:k,target:q?Y:k}}}])&&dh(C.prototype,x),D})();function ai(D,C){for(var x=0;x<C.length;x++){var B=C[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}var lc=(function(){function D(B,q,Y){(function(k,K){if(!(k instanceof K))throw new TypeError("Cannot call a class as a function")})(this,D),this.action=B,this.xpath=q,this.value=Y,this.position=null}var C,x;return C=D,(x=[{key:"getMpdTarget",value:function(B){var q=this.action==="remove"||this.action==="replace"||this.position==="before"||this.position==="after";return this.xpath.getMpdTarget(B,q)}}])&&ai(C.prototype,x),D})();function Lo(){var D,C,x=this.context;return D={getIsPatch:function(B){return B&&B.hasOwnProperty(d.Z.ORIGINAL_MPD_ID)||!1},getPublishTime:function(B){return B&&B.hasOwnProperty(d.Z.PUBLISH_TIME)?new Date(B[d.Z.PUBLISH_TIME]):null},getOriginalPublishTime:function(B){return B&&B.hasOwnProperty(d.Z.ORIGINAL_PUBLISH_TIME)?new Date(B[d.Z.ORIGINAL_PUBLISH_TIME]):null},getMpdId:function(B){return B&&B[d.Z.ORIGINAL_MPD_ID]||null},getPatchOperations:function(B){return B?(B.__children||[]).map((function(q){var Y=Object.keys(q)[0];if(Y!=="add"&&Y!=="remove"&&Y!=="replace")return C.warn("Ignoring node of invalid action: ".concat(Y)),null;var k=q[Y],K=k.sel;if(Y==="add"&&k.type){if(!k.type.startsWith("@"))return C.warn("Ignoring add action for prefixed namespace declaration: ".concat(k.type,"=").concat(k.__text)),null;K="".concat(K,"/").concat(k.type)}var re=new hh(K);if(!re.isValid())return C.warn("Ignoring action with invalid selector: ".concat(Y," - ").concat(K)),null;var ge=null;re.findsAttribute()||re.findsTextReplace()?ge=k.__text||"":Y!=="remove"&&(ge=k.__children.reduce((function(z,oe){var se=Object.keys(oe)[0];return se!=="#text"&&(z[se]=z[se]||[],z[se].push(oe[se])),z}),{}));var ie=new lc(Y,re,ge);return Y==="add"&&(ie.position=k.pos),ie})).filter((function(q){return!!q})):[]}},C=(0,I.Z)(x).getInstance().getLogger(D),D}Lo.__dashjs_factory_name="PatchManifestModel";var Al=b.Z.getSingletonFactory(Lo);function ru(){var D,C,x,B,q,Y,k,K=this.context;function re(J,Q,j){var Ae,ve=C.getAdaptationsForType(B[0].mpd.manifest,J,Q);if(!ve||ve.length===0)return null;if(ve.length>1&&j){var Ce=z(j,Q);if(q[j.id]&&q[j.id][Q]){for(var Ee=0,ae=ve.length;Ee<ae;Ee++)if(ge(q[j.id][Q],Ce[Ee]))return ve[Ee]}for(var Se=0,Pe=ve.length;Se<Pe;Se++)if(Ae=ve[Se],C.getRolesForAdaptation(Ae).filter((function(We){return We.value===d.Z.MAIN}))[0])return ve[Se]}return ve[0]}function ge(J,Q){if(!J||!Q)return!1;var j=J.id===Q.id,Ae=J.codec===Q.codec,ve=J.viewpoint===Q.viewpoint,Ce=JSON.stringify(J.viewpointsWithSchemeIdUri)===JSON.stringify(Q.viewpointsWithSchemeIdUri),Ee=J.lang===Q.lang,ae=J.roles.toString()===Q.roles.toString(),Se=JSON.stringify(J.rolesWithSchemeIdUri)===JSON.stringify(Q.rolesWithSchemeIdUri),Pe=J.accessibility.toString()===Q.accessibility.toString(),We=JSON.stringify(J.accessibilitiesWithSchemeIdUri)===JSON.stringify(Q.accessibilitiesWithSchemeIdUri),je=J.audioChannelConfiguration.toString()===Q.audioChannelConfiguration.toString(),Xe=JSON.stringify(J.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(Q.audioChannelConfigurationsWithSchemeIdUri);return j&&Ae&&ve&&Ce&&Ee&&ae&&Se&&Pe&&We&&je&&Xe}function ie(J,Q,j,Ae,ve,Ce){var Ee,ae,Se,Pe,We,je,Xe=[];if(!Ae||Ae.length===0)return[];var ze=C.getAdaptationsForPeriod(Q);for(Pe=0,je=Ae.length;Pe<je;Pe++)if(Ee=Ae[Pe],ae=le(ze[Se=C.getIndexForAdaptation(Ee,J,j.index)]),Ce){var St=ae.accessibility.length;for(We=0;We<St;We++)if(ae){var At=ae.accessibility[We];if(At.indexOf("cea-608:")===0){var pt=At.substring(8).split(";");if(pt[0].substring(0,2)==="CC")for(We=0;We<pt.length;We++)ae||(ae=le.call(this,ze[Se])),Re(ae,pt[We].substring(0,3),pt[We].substring(4)),Xe.push(ae),ae=null;else for(We=0;We<pt.length;We++)ae||(ae=le.call(this,ze[Se])),Re(ae,"CC"+(We+1),pt[We]),Xe.push(ae),ae=null}else At.indexOf("cea-608")===0&&(Re(ae,Y.CC1,"eng"),Xe.push(ae),ae=null)}}else ve===Y.IMAGE?(ae.type=Y.IMAGE,Xe.push(ae),ae=null):ae&&Xe.push(ae);return Xe}function z(J,Q,j){var Ae=B,ve=j,Ce=[];if(ve)xe(),Ae=oe(ve);else{if(!(B.length>0))return Ce;ve=B[0].mpd.manifest}var Ee=Me(J,Ae),ae=C.getAdaptationsForType(ve,J?J.index:null,Q);return Ce=ie(ve,Ee,J,ae,Q),Q===Y.TEXT&&(ae=C.getAdaptationsForType(ve,J?J.index:null,Y.VIDEO),Ce=Ce.concat(ie(ve,Ee,J,ae,Q,!0))),Ce}function oe(J){var Q=se(J);return C.getRegularPeriods(Q)}function se(J){var Q=be(J);return C.getMpd(Q)}function Ne(){B=[],q={}}function be(J){return J||(B.length>0?B[0].mpd.manifest:null)}function Le(J){try{var Q=Me(J.streamInfo,B),j=C.getAdaptationsForPeriod(Q);return J&&J.streamInfo&&J.streamInfo.id!==void 0&&j?j[J.index]:null}catch{return null}}function Me(J,Q){for(var j=Q.length,Ae=0;Ae<j;Ae++){var ve=Q[Ae];if(J&&J.id===ve.id)return ve}return null}function le(J){if(!J)return null;var Q,j,Ae,ve,Ce,Ee=new Do,ae=J.period.mpd.manifest.Period_asArray[J.period.index].AdaptationSet_asArray[J.index];if(Ee.id=J.id,Ee.index=J.index,Ee.type=J.type,Ee.streamInfo=ue(J.period),Ee.representationCount=C.getRepresentationCount(ae),Ee.labels=C.getLabelsForAdaptation(ae),Ee.lang=C.getLanguageForAdaptation(ae),Ee.segmentAlignment=C.getSegmentAlignment(ae),Ee.subSegmentAlignment=C.getSubSegmentAlignment(ae),Q=C.getViewpointForAdaptation(ae),Ee.viewpoint=Q.length?Q[0].value:void 0,Ee.viewpointsWithSchemeIdUri=Q,Ce=C.getAccessibilityForAdaptation(ae),Ee.accessibility=Ce.map((function(Xe){var ze=Xe.value,St=ze;return Xe.schemeIdUri&&Xe.schemeIdUri.search("cea-608")>=0&&k!==void 0&&(St=ze?"cea-608:"+ze:"cea-608",Ee.embeddedCaptions=!0),St})),Ee.accessibilitiesWithSchemeIdUri=Ce,j=C.getAudioChannelConfigurationForAdaptation(ae),Ee.audioChannelConfiguration=j.map((function(Xe){return Xe.value})),Ee.audioChannelConfigurationsWithSchemeIdUri=j,Ee.audioChannelConfiguration.length===0&&Array.isArray(ae.Representation_asArray)&&ae.Representation_asArray.length>0&&(Ae=C.getAudioChannelConfigurationForRepresentation(ae.Representation_asArray[0]),Ee.audioChannelConfiguration=Ae.map((function(Xe){return Xe.value})),Ee.audioChannelConfigurationsWithSchemeIdUri=Ae),ve=C.getRolesForAdaptation(ae),Ee.roles=ve.map((function(Xe){return Xe.value})),Ee.rolesWithSchemeIdUri=ve,Ee.codec=C.getCodec(ae),Ee.mimeType=C.getMimeType(ae),Ee.contentProtection=C.getContentProtectionData(ae),Ee.bitrateList=C.getBitrateListForAdaptation(ae),Ee.selectionPriority=C.getSelectionPriority(ae),Ee.contentProtection){var Se=Ee.contentProtection.map((function(Xe){return C.getKID(Xe)})).filter((function(Xe){return Xe!==null}));if(Se.length){var Pe=Se[0];Ee.contentProtection.forEach((function(Xe){Xe.keyId=Pe}))}}if(Ee.isText=C.getIsText(ae),Ee.supplementalProperties=C.getSupplementalPropertiesForAdaptation(ae),(!Ee.supplementalProperties||Object.keys(Ee.supplementalProperties).length===0)&&Array.isArray(ae.Representation_asArray)&&ae.Representation_asArray.length>0){var We=ae.Representation_asArray.map((function(Xe){return C.getSupplementalPropertiesForRepresentation(Xe)}));We.every((function(Xe){return JSON.stringify(Xe)===JSON.stringify(We[0])}))&&(Ee.supplementalProperties=We[0])}if(Ee.supplementalPropertiesAsArray=C.getSupplementalPropertiesAsArrayForAdaptation(ae),(!Ee.supplementalPropertiesAsArray||Ee.supplementalPropertiesAsArray.length===0)&&Array.isArray(ae.Representation_asArray)&&ae.Representation_asArray.length>0){var je=ae.Representation_asArray.map((function(Xe){return C.getSupplementalPropertiesAsArrayForRepresentation(Xe)}));je.every((function(Xe){return JSON.stringify(Xe)===JSON.stringify(je[0])}))&&(Ee.supplementalPropertiesAsArray=je[0])}return Ee.essentialProperties=C.getEssentialPropertiesForAdaptation(ae),Ee.essentialPropertiesAsArray=C.getEssentialPropertiesAsArrayForAdaptation(ae),Ee.isFragmented=C.getIsFragmented(ae),Ee.isEmbedded=!1,Ee}function Re(J,Q,j){J.id=Q,J.index=100+parseInt(Q.substring(2,3)),J.type=Y.TEXT,J.codec="cea-608-in-SEI",J.isEmbedded=!0,J.isFragmented=!1;var Ae=Fl()(j);J.lang=Ae||j,J.roles=["caption"],J.rolesWithSchemeIdUri=[{schemeIdUri:"urn:mpeg:dash:role:2011",value:"caption"}]}function ue(J){var Q,j,Ae=new oc;return Ae.id=J.id,Ae.index=J.index,Ae.start=J.start,Ae.duration=J.duration,Ae.manifestInfo=(Q=J.mpd,(j=new fh).dvrWindowSize=Q.timeShiftBufferDepth,j.loadedTime=Q.manifest.loadedTime,j.availableFrom=Q.availabilityStartTime,j.minBufferTime=Q.manifest.minBufferTime,j.maxFragmentDuration=Q.maxSegmentDuration,j.duration=C.getDuration(Q.manifest),j.isDynamic=C.getIsDynamic(Q.manifest),j.serviceDescriptions=C.getServiceDescriptions(Q.manifest),j.protocol=Q.manifest.protocol,j),Ae.isLast=J.mpd.manifest.Period_asArray.length===1||Math.abs(Ae.start+Ae.duration-Ae.manifestInfo.duration)<1,Ae}function xe(){if(!Y)throw new Error("setConfig function has to be called previously")}function P(J){return B.length>0?B[0].mpd.manifest.Period_asArray[J]:null}function te(J,Q,j){var Ae,ve,Ce,Ee,ae;if(J){for(Ae=J.AdaptationSet_asArray,Ee=0;Ee<Ae.length;Ee+=1)for(Ce=Ae[Ee].Representation_asArray,ae=0;ae<Ce.length;ae+=1)if(Q===(ve=Ce[ae]).id)return j?ae:ve}return null}return D={getBandwidthForRepresentation:function(J,Q){var j;return(j=te(P(Q),J))?j.bandwidth:null},getIndexForRepresentation:function(J,Q){return(function(j,Ae){var ve=te(j,Ae,!0);return ve!==null?ve:-1})(P(Q),J)},getMaxIndexForBufferType:function(J,Q){return(function(j,Ae){var ve,Ce,Ee,ae;if(!j||!Ae)return-1;for(Ce=j.AdaptationSet_asArray,ae=0;ae<Ce.length;ae+=1)if(Ee=(ve=Ce[ae]).Representation_asArray,C.getIsTypeOf(ve,Ae))return Ee.length;return-1})(P(Q),J)},convertRepresentationToRepresentationInfo:function(J){if(J){var Q=new mi,j=J.adaptation.period.mpd.manifest.Period_asArray[J.adaptation.period.index].AdaptationSet_asArray[J.adaptation.index],Ae=C.getRepresentationFor(J.index,j);return Q.id=J.id,Q.quality=J.index,Q.bandwidth=C.getBandwidth(Ae),Q.fragmentDuration=J.segmentDuration||(J.segments&&J.segments.length>0?J.segments[0].duration:NaN),Q.MSETimeOffset=J.MSETimeOffset,Q.mediaInfo=le(J.adaptation),Q}return null},getStreamsInfo:function(J,Q){var j=[],Ae=B;if(J&&(xe(),Ae=oe(J)),Ae.length>0){(!Q||Q>Ae.length)&&(Q=Ae.length);for(var ve=0;ve<Q;ve++)j.push(ue(Ae[ve]))}return j},getMediaInfoForType:function(J,Q){if(B.length===0||!J)return null;var j=Me(J,B);if(!j)return null;var Ae=C.getAdaptationsForPeriod(j),ve=re(J.index,Q,J);return ve?le(Ae[C.getIndexForAdaptation(ve,B[0].mpd.manifest,J.index)]):null},getAllMediaInfoForType:z,getAdaptationForType:re,getRealAdaptation:function(J,Q){var j,Ae,ve=Me(J,B);return j=Q?Q.id:null,B.length>0&&ve&&(Ae=j?C.getAdaptationForId(j,B[0].mpd.manifest,ve.index):C.getAdaptationForIndex(Q?Q.index:null,B[0].mpd.manifest,ve.index)),Ae},getProducerReferenceTimes:function(J,Q){var j,Ae,ve=Me(J,B);return j=Q?Q.id:null,B.length>0&&ve&&(Ae=j?C.getAdaptationForId(j,B[0].mpd.manifest,ve.index):C.getAdaptationForIndex(Q?Q.index:null,B[0].mpd.manifest,ve.index)),Ae?C.getProducerReferenceTimesForAdaptation(Ae):[]},getRealPeriodByIndex:function(J){return C.getRealPeriodForIndex(J,B[0].mpd.manifest)},getEssentialPropertiesForRepresentation:function(J){try{return C.getEssentialPropertiesForRepresentation(J)}catch{return[]}},getVoRepresentations:function(J){var Q=Le(J);return C.getRepresentationsForAdaptation(Q)},getEventsFor:function(J,Q,j){var Ae=[];if(B.length>0){var ve=B[0].mpd.manifest;if(J instanceof oc){var Ce=Me(J,B);Ae=C.getEventsForPeriod(Ce)}else if(J instanceof Do){var Ee=Me(j,B);Ae=C.getEventStreamForAdaptationSet(ve,Le(J),Ee)}else if(J instanceof mi){var ae=Me(j,B);Ae=C.getEventStreamForRepresentation(ve,Q,ae)}}return Ae},getEvent:function(J,Q,j,Ae){try{if(!J||!Q||isNaN(j)||!Ae)return null;var ve=J.scheme_id_uri,Ce=J.value;if(!Q[ve+"/"+Ce])return null;var Ee,ae=new ii,Se=J.timescale||1,Pe=Ae.adaptation.period.start,We=Q[ve+"/"+Ce],je=isNaN(Ae.presentationTimeOffset)?isNaN(We.presentationTimeOffset)?0:We.presentationTimeOffset:Ae.presentationTimeOffset,Xe=J.presentation_time_delta/Se;Ee=J.version===0?Pe+j-je+Xe:Pe-je+Xe;var ze=J.event_duration/Se,St=J.id,At=J.message_data;return ae.eventStream=We,ae.eventStream.value=Ce,ae.eventStream.timescale=Se,ae.duration=ze,ae.id=St,ae.calculatedPresentationTime=Ee,ae.messageData=At,ae.presentationTimeDelta=Xe,ae}catch{return null}},getMpd:se,setConfig:function(J){J&&(J.constants&&(Y=J.constants),J.cea608parser&&(k=J.cea608parser),J.errHandler&&C.setConfig({errHandler:J.errHandler}),J.BASE64&&C.setConfig({BASE64:J.BASE64}))},updatePeriods:function(J){if(!J)return null;xe(),B=oe(J)},getIsTextTrack:function(J){return C.getIsText(J)},getUTCTimingSources:function(){var J=be();return C.getUTCTimingSources(J)},getSuggestedPresentationDelay:function(){var J=B.length>0?B[0].mpd:null;return C.getSuggestedPresentationDelay(J)},getAvailabilityStartTime:function(J){var Q=se(J);return C.getAvailabilityStartTime(Q)},getIsTypeOf:function(J,Q){return C.getIsTypeOf(J,Q)},getIsDynamic:function(J){var Q=be(J);return C.getIsDynamic(Q)},getDuration:function(J){var Q=be(J);return C.getDuration(Q)},getRegularPeriods:oe,getContentSteering:function(J){return C.getContentSteering(J)},getLocation:function(J){return C.getLocation(J)},getPatchLocation:function(J){var Q=C.getPatchLocation(J),j=C.getPublishTime(J);return Q&&Q.length!==0&&j?Q.filter((function(Ae){return isNaN(Ae.ttl)||j.getTime()+Ae.ttl>new Date().getTime()})):[]},getManifestUpdatePeriod:function(J){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return C.getManifestUpdatePeriod(J,Q)},getPublishTime:function(J){return C.getPublishTime(J)},getIsDVB:function(J){return C.hasProfile(J,"urn:dvb:dash:profile:dvb-dash:2014")},getIsPatch:function(J){return x.getIsPatch(J)},getBaseURLsFromElement:function(J){return C.getBaseURLsFromElement(J)},getRepresentationSortFunction:function(){return C.getRepresentationSortFunction()},getCodec:function(J,Q,j){return C.getCodec(J,Q,j)},getPeriodById:function(J){if(!J||B.length===0)return null;var Q=B.filter((function(j){return j.id===J}));return Q&&Q.length>0?Q[0]:null},setCurrentMediaInfo:function(J,Q,j){q[J]=q[J]||{},q[J][Q]=q[J][Q]||{},q[J][Q]=j},isPatchValid:function(J,Q){var j=C.getId(J),Ae=x.getMpdId(Q),ve=C.getPublishTime(J),Ce=x.getPublishTime(Q),Ee=x.getOriginalPublishTime(Q);return!!(j&&Ae&&j==Ae&&ve&&Ee&&ve.getTime()==Ee.getTime()&&Ce&&ve.getTime()<Ce.getTime())},applyPatchToManifest:function(J,Q){x.getPatchOperations(Q).forEach((function(j){var Ae=j.getMpdTarget(J);if(Ae!==null){var ve=Ae.name,Ce=Ae.target,Ee=Ae.leaf;if(j.xpath.findsAttribute()||ve==="__text")switch(j.action){case"add":case"replace":Ce[ve]=j.value;break;case"remove":delete Ce[ve]}else{var ae=(Ce[ve+"_asArray"]||[]).indexOf(Ee),Se=j.position==="prepend"||j.position==="before";if((j.action==="remove"||j.action==="replace")&&(delete Ce[ve],ae!=-1)){var Pe=Ce[ve+"_asArray"];Pe.splice(ae,1),Pe.length>1?Ce[ve]=Pe:Pe.length==1?Ce[ve]=Pe[0]:delete Ce[ve+"_asArray"]}j.action!=="add"&&j.action!=="replace"||Object.keys(j.value).forEach((function(We){var je=j.value[We],Xe=Ce[We+"_asArray"]||[];if(Xe.length===0&&Ce[We]&&Xe.push(Ce[We]),Xe.length===0)Xe=je;else{var ze=Xe.length;ze=We==ve&&ae!=-1?ae+(Se?0:1)+(j.action=="replace"?-1:0):Se?0:Xe.length,Xe.splice.apply(Xe,[ze,0].concat(je))}Ce[We+"_asArray"]=Xe,Ce[We]=Xe.length==1?Xe[0]:Xe}))}}}))},areMediaInfosEqual:ge,reset:Ne},C=xn(K).getInstance(),x=Al(K).getInstance(),Ne(),D}ru.__dashjs_factory_name="DashAdapter";var xo=b.Z.getSingletonFactory(ru);function No(D,C){for(var x=0;x<C.length;x++){var B=C[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}var gh=(function(){function D(){(function(B,q){if(!(B instanceof q))throw new TypeError("Cannot call a class as a function")})(this,D)}var C,x;return C=D,x=[{key:"round10",value:function(B,q){return(function(Y,k,K){return K===void 0||+K==0?Math[Y](k):(K=+K,(k=+k)===null||isNaN(k)||typeof K!="number"||K%1!=0?NaN:(k=k.toString().split("e"),+((k=(k=Math[Y](+(k[0]+"e"+(k[1]?+k[1]-K:-K)))).toString().split("e"))[0]+"e"+(k[1]?+k[1]+K:K))))})("round",B,q)}}],x&&No(C,x),D})(),Df=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]},mh=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.t=null,this.mt=null,this.to=null,this.lto=null},Lf=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.t=null,this.level=null},Ks=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.target=null,this.state=S.Z.BUFFER_EMPTY},uc=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.time=null,this.range=null,this.manifestInfo=null},iu=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.time=null,this.droppedFrames=null};function au(D,C){if(!(D instanceof C))throw new TypeError("Cannot call a class as a function")}var wo=function D(){au(this,D),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},cc=function D(){au(this,D),this.id=null,this.index=null,this.start=null,this.duration=null},su=function D(){au(this,D),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null},ou=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null},xf=function D(){(function(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")})(this,D),this.loadingRequests=[],this.executedRequests=[]};function fc(D){var C,x,B=(D=D||{}).settings,q=this.context,Y=(0,_.Z)(q).getInstance();function k(){Y.trigger(E.Z.METRICS_CHANGED)}function K(se){Y.trigger(E.Z.METRIC_CHANGED,{mediaType:se}),k()}function re(se,Ne,be){Y.trigger(E.Z.METRIC_UPDATED,{mediaType:se,metric:Ne,value:be}),K(se)}function ge(se,Ne,be){Y.trigger(E.Z.METRIC_ADDED,{mediaType:se,metric:Ne,value:be}),K(se)}function ie(se,Ne){var be=null;return se&&(x.hasOwnProperty(se)?be=x[se]:Ne||(be=new Df,x[se]=be)),be}function z(se,Ne,be){var Le=ie(se);Le!==null&&(Le[Ne].push(be),Le[Ne].length>B.get().streaming.metrics.maxListDepth&&Le[Ne].shift())}function oe(se,Ne,be){z(se,Ne,be),ge(se,Ne,be)}return C={clearCurrentMetricsForType:function(se){delete x[se],K(se)},clearAllCurrentMetrics:function(){x={},k()},getMetricsFor:ie,addHttpRequest:function se(Ne,be,Le,Me,le,Re,ue,xe,P,te,J,Q,j,Ae,ve,Ce,Ee){var ae=new Be.w;Re!=null&&Re!==Me&&(se(Ne,null,Le,Me,le,null,null,xe,P,null,null,null,j,null,null,Ce,Ee),ae.actualurl=Re),ae.tcpid=be,ae.type=Le,ae.url=Me,ae.range=xe,ae.trequest=P,ae.tresponse=te,ae.responsecode=Q,ae.cmsd=Ee,ae._tfinish=J,ae._stream=Ne,ae._mediaduration=j,ae._quality=le,ae._responseHeaders=Ae,ae._serviceLocation=ue,ae._fileLoaderType=Ce,ve?ve.forEach((function(Se){(function(Pe,We,je,Xe){var ze=new Be.O;ze.s=We,ze.d=je,ze.b=Xe,Pe.trace.push(ze),Pe.interval||(Pe.interval=0),Pe.interval+=je})(ae,Se.s,Se.d,Se.b)})):(delete ae.interval,delete ae.trace),oe(Ne,S.Z.HTTP_REQUEST,ae)},addRepresentationSwitch:function(se,Ne,be,Le,Me){var le=new mh;le.t=Ne,le.mt=be,le.to=Le,Me?le.lto=Me:delete le.lto,oe(se,S.Z.TRACK_SWITCH,le)},addBufferLevel:function(se,Ne,be){var Le=new Lf;Le.t=Ne,Le.level=be,oe(se,S.Z.BUFFER_LEVEL,Le)},addBufferState:function(se,Ne,be){var Le=new Ks;Le.target=be,Le.state=Ne,oe(se,S.Z.BUFFER_STATE,Le)},addDVRInfo:function(se,Ne,be,Le){var Me=new uc;Me.time=Ne,Me.range=Le,Me.manifestInfo=be,oe(se,S.Z.DVR_INFO,Me)},addDroppedFrames:function(se,Ne){var be=new iu,Le=ie(se).DroppedFrames;Ne&&(be.time=Ne.creationTime,be.droppedFrames=Ne.droppedVideoFrames,Le.length>0&&Le[Le.length-1]==be||oe(se,S.Z.DROPPED_FRAMES,be))},addSchedulingInfo:function(se,Ne,be,Le,Me,le,Re,ue,xe){var P=new ou;P.mediaType=se,P.t=Ne,P.type=be,P.startTime=Le,P.availabilityStartTime=Me,P.duration=le,P.quality=Re,P.range=ue,P.state=xe,oe(se,S.Z.SCHEDULING_INFO,P)},addRequestsQueue:function(se,Ne,be){var Le=new xf;Le.loadingRequests=Ne,Le.executedRequests=be,ie(se).RequestsQueue=Le,ge(se,S.Z.REQUESTS_QUEUE,Le)},addManifestUpdate:function(se,Ne,be,Le,Me,le,Re,ue,xe,P){var te=new wo;te.mediaType=se,te.type=Ne,te.requestTime=be,te.fetchTime=Le,te.availabilityStartTime=Me,te.presentationStartTime=le,te.clientTimeOffset=Re,te.currentTime=ue,te.buffered=xe,te.latency=P,z(u.Z.STREAM,S.Z.MANIFEST_UPDATE,te),ge(se,S.Z.MANIFEST_UPDATE,te)},updateManifestUpdateInfo:function(se,Ne){if(se){for(var be in Ne)se[be]=Ne[be];re(se.mediaType,S.Z.MANIFEST_UPDATE,se)}},addManifestUpdateStreamInfo:function(se,Ne,be,Le,Me){if(se){var le=new cc;le.id=Ne,le.index=be,le.start=Le,le.duration=Me,se.streamInfo.push(le),re(se.mediaType,S.Z.MANIFEST_UPDATE_STREAM_INFO,se)}},addManifestUpdateRepresentationInfo:function(se,Ne,be,Le,Me,le,Re,ue){if(se&&se.representationInfo){var xe=new su;xe.id=Ne,xe.index=be,xe.streamIndex=Le,xe.mediaType=Me,xe.startNumber=Re,xe.fragmentInfoType=ue,xe.presentationTimeOffset=le,se.representationInfo.push(xe),re(se.mediaType,S.Z.MANIFEST_UPDATE_TRACK_INFO,se)}},addPlayList:function(se){se.trace&&Array.isArray(se.trace)?se.trace.forEach((function(Ne){Ne.hasOwnProperty("subreplevel")&&!Ne.subreplevel&&delete Ne.subreplevel})):delete se.trace,oe(u.Z.STREAM,S.Z.PLAY_LIST,se)},addDVBErrors:function(se){oe(u.Z.STREAM,S.Z.DVB_ERRORS,se)}},x={},C}fc.__dashjs_factory_name="MetricsModel";var zs=b.Z.getSingletonFactory(fc);function As(D){D=D||{};var C,x,B,q,Y=this.context,k=D.metricsModel;function K(ie){var z=k.getMetricsFor(ie,!0);if(!z)return null;var oe,se=z.HttpList,Ne=null;if(!se||se.length<=0)return null;for(oe=se.length-1;oe>=0;){if(se[oe].responsecode){Ne=se[oe];break}oe--}return Ne}function re(ie){var z=k.getMetricsFor(ie,!0);return z&&z.HttpList?z.HttpList:[]}function ge(ie,z){if(!ie)return null;var oe=ie[z];return oe&&oe.length!==0?oe[oe.length-1]:null}return C={getCurrentRepresentationSwitch:function(ie){return ge(k.getMetricsFor(ie,!0),S.Z.TRACK_SWITCH)},getCurrentBufferState:function(ie){return ge(k.getMetricsFor(ie,!0),S.Z.BUFFER_STATE)},getCurrentBufferLevel:function(ie){var z=ge(k.getMetricsFor(ie,!0),S.Z.BUFFER_LEVEL);return z?gh.round10(z.level/1e3,-3):0},getCurrentHttpRequest:K,getHttpRequests:re,getCurrentDroppedFrames:function(){return ge(k.getMetricsFor(u.Z.VIDEO,!0),S.Z.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(ie){return ge(k.getMetricsFor(ie,!0),S.Z.SCHEDULING_INFO)},getCurrentDVRInfo:function(ie){return ge(ie?k.getMetricsFor(ie,!0):k.getMetricsFor(u.Z.VIDEO,!0)||k.getMetricsFor(u.Z.AUDIO,!0),S.Z.DVR_INFO)},getCurrentManifestUpdate:function(){return ge(k.getMetricsFor(u.Z.STREAM),S.Z.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(ie,z){if(!z)return null;var oe={},se=K(ie);se&&(oe=Ht.Z.parseHttpHeaders(se._responseHeaders));var Ne=oe[z.toLowerCase()];return Ne===void 0?null:Ne},getLatestMPDRequestHeaderValueByID:function(ie){if(!ie)return null;var z,oe,se,Ne={};for(se=(z=re(u.Z.STREAM)).length-1;se>=0;se--)if((oe=z[se]).type===Be.w.MPD_TYPE){Ne=Ht.Z.parseHttpHeaders(oe._responseHeaders);break}var be=Ne[ie.toLowerCase()];return be===void 0?null:be},addRepresentationSwitch:function(ie,z,oe,se,Ne){k.addRepresentationSwitch(ie,z,oe,se,Ne)},addDVRInfo:function(ie,z,oe,se){k.addDVRInfo(ie,z,oe,se)},updateManifestUpdateInfo:function(ie){var z=this.getCurrentManifestUpdate();k.updateManifestUpdateInfo(z,ie)},addManifestUpdateStreamInfo:function(ie){if(ie){var z=this.getCurrentManifestUpdate();k.addManifestUpdateStreamInfo(z,ie.id,ie.index,ie.start,ie.duration)}},addManifestUpdateRepresentationInfo:function(ie,z){if(ie){var oe=this.getCurrentManifestUpdate();k.addManifestUpdateRepresentationInfo(oe,ie.id,ie.index,ie.streamIndex,z,ie.presentationTimeOffset,ie.startNumber,ie.fragmentInfoType)}},addManifestUpdate:function(ie){k.addManifestUpdate(u.Z.STREAM,ie.type,ie.requestStartDate,ie.requestEndDate)},addHttpRequest:function(ie,z,oe,se,Ne,be){k.addHttpRequest(ie.mediaType,null,ie.type,ie.url,ie.quality,z,ie.serviceLocation||null,ie.range||null,ie.requestStartDate,ie.firstByteDate,ie.requestEndDate,oe,ie.duration,se,Ne,ie.fileLoaderType,be)},addSchedulingInfo:function(ie,z){k.addSchedulingInfo(ie.mediaType,new Date,ie.type,ie.startTime,ie.availabilityStartTime,ie.duration,ie.quality,ie.range,z)},addRequestsQueue:function(ie,z,oe){k.addRequestsQueue(ie,z,oe)},addBufferLevel:function(ie,z,oe){k.addBufferLevel(ie,z,oe)},addBufferState:function(ie,z,oe){k.addBufferState(ie,z,oe)},addDroppedFrames:function(ie){k.addDroppedFrames(u.Z.VIDEO,ie)},addPlayList:function(){q&&(k.addPlayList(q),q=null)},addDVBErrors:function(ie){k.addDVBErrors(ie)},createPlaylistMetrics:function(ie,z){(q=new Qe).start=new Date,q.mstart=ie,q.starttype=z},createPlaylistTraceMetrics:function(ie,z,oe){x===!0&&(x=!1,(B=new Ye).representationid=ie,B.start=new Date,B.mstart=z,B.playbackspeed=oe!==null?oe.toString():null)},updatePlayListTraceMetrics:function(ie){if(B)for(var z in B)B[z]=ie[z]},pushPlayListTraceMetrics:function(ie,z){if(x===!1&&q&&B&&B.start){var oe=B.start,se=ie.getTime()-oe.getTime();B.duration=se,B.stopreason=z,q.trace.push(B),x=!0}},clearAllCurrentMetrics:function(){k.clearAllCurrentMetrics()}},k=k||zs(Y).getInstance({settings:D.settings}),x=!0,B=null,q=null,C}As.__dashjs_factory_name="DashMetrics";var Nf=b.Z.getSingletonFactory(As);function dc(){var D,C,x,B,q=this.context,Y=(0,_.Z)(q).getInstance(),k=(0,Ie.Z)(q).getInstance();function K(Me){B=Me}function re(Me,le,Re,ue){var xe,P=le.adaptation.period.mpd,te=P.availabilityStartTime;if(ue)xe=Re&&P.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(te.getTime()+1e3*(Me+P.timeShiftBufferDepth)):P.availabilityEndTime;else if(Re){var J=le.availabilityTimeOffset;xe=new Date(te.getTime()+1e3*(Me-J))}else xe=te;return xe}function ge(Me,le){return(Me.getTime()-le.mpd.availabilityStartTime.getTime()+1e3*B)/1e3}function ie(Me,le){return Me+(le.adaptation.period.start-le.presentationTimeOffset)}function z(Me){var le={start:NaN,end:NaN},Re=Me[0].getAdapter().getRegularPeriods()[0],ue=ge(new Date,Re);if(!Me||Me.length===0)return{range:le,now:ue};Me.forEach((function(P){var te=P.getAdapter(),J=te.getMediaInfoForType(P.getStreamInfo(),u.Z.VIDEO)||te.getMediaInfoForType(P.getStreamInfo(),u.Z.AUDIO),Q=te.getVoRepresentations(J)[0],j={start:NaN,end:NaN};if(Q)if(Q.segmentInfoType===d.Z.SEGMENT_TIMELINE)j=(function(ve){var Ce,Ee,ae,Se,Pe=ve.adaptation.period.mpd.manifest.Period_asArray[ve.adaptation.period.index].AdaptationSet_asArray[ve.adaptation.index],We=C.getRepresentationFor(ve.index,Pe),je=We.SegmentTemplate||We.SegmentList,Xe=je.SegmentTimeline,ze=je.timescale,St=Xe.S_asArray,At={start:0,end:0},pt=St[0].t,yt=!isNaN(pt),un=yt?pt:0,Ve=0;for(yt&&(At.start=ie(un/ze,ve)),ae=0,Se=St.length;ae<Se;ae++)Ee=0,(Ce=St[ae]).hasOwnProperty("r")&&(Ee=Ce.r),Ve+=Ce.d*(1+Ee);return At.end=ie((un+Ve)/ze,ve),At})(Q);else{var Ae=Q.adaptation.period;j.start=Ae.start,j.end=Math.max(ue,Ae.start+Ae.duration)}!isNaN(j.start)&&(isNaN(le.start)||le.start>j.start)&&(le.start=j.start),!isNaN(j.end)&&(isNaN(le.end)||le.end<j.end)&&(le.end=j.end)})),le.end=Math.min(ue,le.end);var xe=se(Me,le.end,!0);return le.end=isNaN(xe)?le.end:xe,le.start=Re&&Re.mpd&&Re.mpd.timeShiftBufferDepth&&!isNaN(Re.mpd.timeShiftBufferDepth)&&!isNaN(le.end)?Math.max(le.end-Re.mpd.timeShiftBufferDepth,le.start):le.start,le.start=se(Me,le.start),{range:le,now:ue}}function oe(Me,le){x=Me-le.end}function se(Me,le){var Re=arguments.length>2&&arguments[2]!==void 0&&arguments[2];try{for(var ue=0,xe=!1,P=NaN;!xe&&ue<Me.length;){var te=Me[ue].getStreamInfo();te.start<=le&&(!isFinite(te.duration)||te.start+te.duration>=le)?(P=le,xe=!0):!Re&&te.start>le&&(isNaN(P)||te.start<P)?P=te.start:Re&&te.start+te.duration<le&&(isNaN(P)||te.start+te.duration>P)&&(P=te.start+te.duration),ue+=1}return P}catch{return le}}function Ne(Me){Me.offset===void 0||isNaN(Me.offset)||K(Me.offset/1e3)}function be(){B=0,x=0}function Le(){Y.off(E.Z.UPDATE_TIME_SYNC_OFFSET,Ne,this),be()}return D={initialize:function(){be(),Y.on(E.Z.UPDATE_TIME_SYNC_OFFSET,Ne,this)},getClientTimeOffset:function(){return B},setClientTimeOffset:K,getClientReferenceTime:function(){return Date.now()-1e3*x+1e3*B},calcAvailabilityStartTimeFromPresentationTime:function(Me,le,Re){return re(Me,le,Re)},calcAvailabilityEndTimeFromPresentationTime:function(Me,le,Re){return re(Me,le,Re,!0)},calcPresentationTimeFromWallTime:ge,calcPresentationTimeFromMediaTime:ie,calcPeriodRelativeTimeFromMpdRelativeTime:function(Me,le){return le-Me.adaptation.period.start},calcMediaTimeFromPresentationTime:function(Me,le){return Me-le.adaptation.period.start+le.presentationTimeOffset},calcWallTimeForSegment:function(Me,le){var Re,ue,xe;return le&&(Re=Me.representation.adaptation.period.mpd.suggestedPresentationDelay,ue=Me.presentationStartTime+Re,xe=new Date(Me.availabilityStartTime.getTime()+1e3*ue)),xe},calcTimeShiftBufferWindow:function(Me,le){if(!le)return(function(ue){var xe={start:NaN,end:NaN},P=0,te=NaN;return ue.forEach((function(J){var Q=J.getStreamInfo();P+=Q.duration,(isNaN(te)||Q.start<te)&&(te=Q.start)})),xe.start=te,xe.end=te+P,xe})(Me);if(k.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var Re=z(Me);return oe(Re.now,Re.range),Re.range}return(function(ue){var xe={start:NaN,end:NaN};if(!ue||ue.length===0)return xe;var P=ue[0].getAdapter().getRegularPeriods()[0],te=ge(new Date,P),J=P.mpd.timeShiftBufferDepth,Q=isNaN(J)?0:te-J;if(xe.start=se(ue,Q),xe.end=!isNaN(xe.start)&&te<xe.start?te:se(ue,te,!0),!isNaN(J)&&xe.end<te-J&&(xe.end=NaN),k.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var j=z(ue);if(j.range.end<xe.start)return Y.trigger(T.Z.CONFORMANCE_VIOLATION,{level:yo.LEVELS.WARNING,event:yo.EVENTS.INVALID_DVR_WINDOW}),oe(j.now,j.range),j.range}return xe})(Me)},reset:Le},C=xn(q).getInstance(),Le(),D}dc.__dashjs_factory_name="TimelineConverter";var Oo=b.Z.getSingletonFactory(dc),$s=g(4593),Ws=g(6934);function Xs(D){return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},Xs(D)}function Mo(D,C){return Mo=Object.setPrototypeOf||function(x,B){return x.__proto__=B,x},Mo(D,C)}function wf(D,C){return!C||Xs(C)!=="object"&&typeof C!="function"?(function(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x})(D):C}function Oa(D){return Oa=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)},Oa(D)}var Of=(function(D){(function(Y,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(k&&k.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),k&&Mo(Y,k)})(q,D);var C,x,B=(C=q,x=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Y,k=Oa(C);if(x){var K=Oa(this).constructor;Y=Reflect.construct(k,arguments,K)}else Y=k.apply(this,arguments);return wf(this,Y)});function q(){var Y;return(function(k,K){if(!(k instanceof K))throw new TypeError("Cannot call a class as a function")})(this,q),(Y=B.call(this)).captionData=null,Y.label=null,Y.defaultTrack=!1,Y.kind=null,Y.isFragmented=!1,Y.isEmbedded=!1,Y.isTTML=null,Y}return q})(Do),bs=g(2295);function lu(){var D=0;function C(K){for(var re="",ge=0;ge<K.length;++ge)re+=K[ge].uchar;return re.length-re.replace(/^\s+/,"").length}function x(K){return"left: "+3.125*K.x+"%; top: "+6.66*K.y1+"%; width: "+(100-3.125*K.x)+"%; height: "+6.66*Math.max(K.y2-1-K.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function B(K){return K==="red"?"rgb(255, 0, 0)":K==="green"?"rgb(0, 255, 0)":K==="blue"?"rgb(0, 0, 255)":K==="cyan"?"rgb(0, 255, 255)":K==="magenta"?"rgb(255, 0, 255)":K==="yellow"?"rgb(255, 255, 0)":K==="white"?"rgb(255, 255, 255)":K==="black"?"rgb(0, 0, 0)":K}function q(K,re){var ge=K.videoHeight/15;return re?"font-size: "+ge+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(re.foreground?B(re.foreground):"rgb(255, 255, 255)")+"; font-style: "+(re.italics?"italic":"normal")+"; text-decoration: "+(re.underline?"underline":"none")+"; white-space: pre; background-color: "+(re.background?B(re.background):"transparent")+";":"font-size: "+ge+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function Y(K){return K.replace(/^\s+/g,"")}function k(K){return K.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(K,re,ge,ie){var z,oe,se=null,Ne=!1,be=-1,Le={start:re,end:ge,spans:[]},Me="style_cea608_white_black",le={},Re={},ue=[];for(z=0;z<15;++z){var xe=ie.rows[z],P="",te=null;if(xe.isEmpty()===!1){var J=C(xe.chars);se===null&&(se={x:J,y1:z,y2:z+1,p:[]}),J!==be&&Ne&&(se.p.push(Le),Le={start:re,end:ge,spans:[]},se.y2=z,se.name="region_"+se.x+"_"+se.y1+"_"+se.y2,le.hasOwnProperty(se.name)===!1?(ue.push(se),le[se.name]=se):le[se.name].p.contat(se.p),se={x:J,y1:z,y2:z+1,p:[]});for(var Q=0;Q<xe.chars.length;++Q){var j=xe.chars[Q],Ae=j.penState;if(te===null||!Ae.equals(te)){P.trim().length>0&&(Le.spans.push({name:Me,line:P,row:z}),P="");var ve="style_cea608_"+Ae.foreground+"_"+Ae.background;Ae.underline&&(ve+="_underline"),Ae.italics&&(ve+="_italics"),Re.hasOwnProperty(ve)||(Re[ve]=JSON.parse(JSON.stringify(Ae))),te=Ae,Me=ve}P+=j.uchar}P.trim().length>0&&Le.spans.push({name:Me,line:P,row:z}),Ne=!0,be=J}else Ne=!1,be=-1,se&&(se.p.push(Le),Le={start:re,end:ge,spans:[]},se.y2=z,se.name="region_"+se.x+"_"+se.y1+"_"+se.y2,le.hasOwnProperty(se.name)===!1?(ue.push(se),le[se.name]=se):le[se.name].p.contat(se.p),se=null)}se&&(se.p.push(Le),se.y2=z+1,se.name="region_"+se.x+"_"+se.y1+"_"+se.y2,le.hasOwnProperty(se.name)===!1?(ue.push(se),le[se.name]=se):le[se.name].p.contat(se.p),se=null);var Ce=[];for(z=0;z<ue.length;++z){var Ee=ue[z],ae="sub_cea608_"+D++,Se=document.createElement("div");Se.id=ae;var Pe=x(Ee);Se.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+Pe;var We=document.createElement("div");We.className="paragraph bodyStyle",We.style.cssText=q(K);var je=document.createElement("div");je.className="cueUniWrapper",je.style.cssText="unicode-bidi: normal; direction: ltr;";for(var Xe=0;Xe<Ee.p.length;++Xe){var ze=Ee.p[Xe],St=0;for(oe=0;oe<ze.spans.length;++oe){var At=ze.spans[oe];if(At.line.length>0){if(oe!==0&&St!=At.row){var pt=document.createElement("br");pt.className="lineBreak",je.appendChild(pt)}var yt=!1;St===At.row&&(yt=!0),St=At.row;var un=Re[At.name],Ve=document.createElement("span");Ve.className="spanPadding "+At.name+" customSpanColor",Ve.style.cssText=q(K,un),oe!==0&&yt?oe===ze.spans.length-1?Ve.textContent=k(At.line):Ve.textContent=At.line:ze.spans.length>1&&oe<ze.spans.length-1&&At.row===ze.spans[oe+1].row?Ve.textContent=Y(At.line):Ve.textContent=At.line.trim(),je.appendChild(Ve)}}}We.appendChild(je),Se.appendChild(We);var tt={bodyStyle:["%",90]};for(var Nt in Re)Re.hasOwnProperty(Nt)&&(tt[Nt]=["%",90]);Ce.push({type:"html",start:re,end:ge,cueHTMLElement:Se,cueID:ae,cellResolution:[32,15],isFromCEA608:!0,fontSize:tt,lineHeight:{},linePadding:{}})}return Ce}}}lu.__dashjs_factory_name="EmbeddedTextHtmlRender";var hc=b.Z.getSingletonFactory(lu);function Xa(D){var C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le,Me,le=D.errHandler,Re=D.manifestModel,ue=D.mediaController,xe=D.videoModel,P=D.textTracks,te=D.vttParser,J=D.vttCustomRenderingParser,Q=D.ttmlParser,j=D.streamInfo,Ae=D.settings,ve=this.context,Ce=(0,_.Z)(ve).getInstance(),Ee=!1;function ae(){k=null,re=NaN,ge=[],ie=null,K=!1,Y=[],q=null}function Se(pt){var yt=new Of;for(var un in pt)yt[un]=pt[un];yt.labels=pt.labels,yt.defaultTrack=(function(Ve){var tt=!1;return oe.length>1&&Ve.isEmbedded?tt=Ve.id&&Ve.id===u.Z.CC1:oe.length===1?Ve.id&&typeof Ve.id=="string"&&Ve.id.substring(0,2)==="CC"&&(tt=!0):oe.length===0&&(tt=Ve.index===Y[0].index),tt})(pt),yt.isFragmented=pt.isFragmented,yt.isEmbedded=!!pt.isEmbedded,yt.isTTML=(function(Ve){return Ve.codec&&Ve.codec.search(u.Z.STPP)>=0||Ve.mimeType&&Ve.mimeType.search(u.Z.TTML)>=0})(pt),yt.kind=(function(Ve,tt){var Nt=Ve.roles&&Ve.roles.length>0?tt[Ve.roles[0]]:tt.caption;return Nt=Nt===tt.caption||Nt===tt.subtitle?Nt:tt.caption})(pt,{subtitle:"subtitles",caption:"captions"}),P.addTextTrack(yt)}function Pe(pt){var yt=pt.chunk;yt.mediaInfo.embeddedCaptions&&je(yt.bytes,yt)}function We(pt){z=pt}function je(pt,yt){var un=yt.mediaInfo,Ve=un.type,tt=un.mimeType,Nt=un.codec||tt;Nt?un.codec.indexOf("application/mp4")!==-1?(function(lt,Bt,Ft){var Ct;if(Bt.segmentType==="InitializationSegment")K=!0,re=B.getMediaTimescaleFromMoov(lt);else{if(!K)return;(Ct=B.getSamplesInfo(lt).sampleList).length>0&&(ie=Ct[0].cts-Bt.start*re),Ft.search(u.Z.STPP)>=0?(function(vn,yn,Fn){var Zn,st;for(q=q!==null?q:St(Fn),Zn=0;Zn<yn.length;Zn++){var Mt=yn[Zn],Tt=Mt.cts,jt=ze(),en=jt+Tt/re,_n=en+Mt.duration/re;C.buffered.add(en,_n);var En=new DataView(vn,Mt.offset,Mt.subSizes[0]),An=Ws.Utils.dataViewToString(En,u.Z.UTF8),Ln=[],xt=Mt.offset+Mt.subSizes[0];for(st=1;st<Mt.subSizes.length;st++){var an=new Uint8Array(vn,xt,Mt.subSizes[st]),mn=String.fromCharCode.apply(null,an);Ln.push(mn),xt+=Mt.subSizes[st]}try{var pn=Re.getValue().ttmlTimeIsRelative?Tt/re:0,Tn=q.parse(An,pn,Tt/re,(Tt+Mt.duration)/re,Ln);P.addCaptions(z,jt,Tn)}catch(ot){k.removeExecutedRequestsBeforeTime(),this.remove(),x.error("TTML parser error: "+ot.message)}}})(lt,Ct,Ft):(function(vn,yn){var Fn,Zn,st,Mt=[];for(Fn=0;Fn<yn.length;Fn++){var Tt=yn[Fn];Tt.cts-=ie;var jt=ze()+Tt.cts/re,en=jt+Tt.duration/re;C.buffered.add(jt,en);var _n=vn.slice(Tt.offset,Tt.offset+Tt.size),En=Ws.parseBuffer(_n);for(Zn=0;Zn<En.boxes.length;Zn++){var An=En.boxes[Zn];if(x.debug("VTT box1: "+An.type),An.type!=="vtte"&&An.type==="vttc"){x.debug("VTT vttc boxes.length = "+An.boxes.length);var Ln={styles:{}};for(st=0;st<An.boxes.length;st++){var xt=An.boxes[st];if(x.debug("VTT box2: "+xt.type),xt.type==="payl")Ln.start=Tt.cts/re,Ln.end=(Tt.cts+Tt.duration)/re,Ln.data=xt.cue_text;else if(xt.type==="sttg"&&xt.settings&&xt.settings!=="")try{var an=xt.settings.split(" ");Ln.styles=te.getCaptionStyles(an)}catch{}}Ln&&Ln.data&&(Mt.push(Ln),x.debug("VTT  ".concat(Ln.start," - ").concat(Ln.end," :  ").concat(Ln.data)))}}}Mt.length>0&&P.addCaptions(z,0,Mt)})(lt,Ct)}})(pt,yt,Nt):Ve===u.Z.VIDEO?(function(lt,Bt){var Ft,Ct;if(Bt.segmentType===Be.w.INIT_SEGMENT_TYPE)se===0&&(se=B.getMediaTimescaleFromMoov(lt));else if(Bt.segmentType===Be.w.MEDIA_SEGMENT_TYPE){if(se===0)return void x.warn("CEA-608: No timescale for embeddedTextTrack yet");var vn=(Ct=B.getSamplesInfo(lt)).lastSequenceNumber,yn=Math.trunc(Bt.start),Fn=Math.trunc(Bt.end);if(Le[0]||Le[1]||(function(){for(var jt,en=0;en<oe.length;en++){if((jt=P.getTrackIdxForId(oe[en].id))===-1)return void x.warn("CEA-608: data before track is ready.");var _n=Xe(jt);Le[en]=new(m()).Cea608Parser(en+1,{newCue:_n},null)}})(),se){if((function(jt,en,_n,En,An){return jt!==null&&en!==null&&En!==null&&An!==null&&(en===jt?En!==An:en!==jt+_n)})(Ne,vn,Ct.numSequences,be,yn))for(Ft=0;Ft<Le.length;Ft++)Le[Ft]&&Le[Ft].reset();for(var Zn=(function(jt,en){if(en.length===0)return null;for(var _n={splits:[],fields:[[],[]]},En=new DataView(jt),An=0;An<en.length;An++)for(var Ln=en[An],xt=m().findCea608Nalus(En,Ln.offset,Ln.size),an=null,mn=0,pn=0;pn<xt.length;pn++)for(var Tn=m().extractCea608DataFromRange(En,xt[pn]),ot=0;ot<2;ot++)if(Tn[ot].length>0){Ln.cts!==an?mn=0:mn+=1;var $e=ze();_n.fields[ot].push([Ln.cts+$e*se,Tn[ot],mn]),an=Ln.cts}return _n.fields.forEach((function(bt){bt.sort((function(we,Ue){return we[0]===Ue[0]?we[2]-Ue[2]:we[0]-Ue[0]}))})),_n})(lt,Ct.sampleList),st=0;st<Le.length;st++){var Mt=Zn.fields[st],Tt=Le[st];if(Tt)for(Ft=0;Ft<Mt.length;Ft++)Tt.addData(Mt[Ft][0]/se,Mt[Ft][1])}Ne=vn,be=Fn}}})(pt,yt):(function(lt,Bt,Ft){var Ct,vn,yn=new DataView(lt,0,lt.byteLength);vn=Ws.Utils.dataViewToString(yn,u.Z.UTF8);try{Ct=St(Ft).parse(vn,0),P.addCaptions(P.getCurrentTrackIdx(),0,Ct),C.buffered&&C.buffered.add(Bt.start,Bt.end)}catch(Fn){le.error(new fe.Z(X.TIMED_TEXT_ERROR_ID_PARSE_CODE,X.TIMED_TEXT_ERROR_MESSAGE_PARSE+Fn.message,vn))}})(pt,yt,Nt):x.error("No text type defined")}function Xe(pt){return function(yt,un,Ve){var tt;(tt=xe.getTTMLRenderingDiv()?Me.createHTMLCaptionsFromScreen(xe.getElement(),yt,un,Ve):[{start:yt,end:un,data:Ve.getDisplayText(),styles:{}}])&&P.addCaptions(pt,0,tt)}}function ze(){return isNaN(C.timestampOffset)?0:C.timestampOffset}function St(pt){var yt;return pt.search(u.Z.VTT)>=0?yt=Ae.get().streaming.text.webvtt.customRenderingEnabled&&J?J:te:(pt.search(u.Z.TTML)>=0||pt.search(u.Z.STPP)>=0)&&(yt=Q),yt}function At(pt){oe.forEach((function(yt){var un=P.getTrackIdxForId(yt.id);un>=0&&P.deleteCuesFromTrackIdx(un,pt.from,pt.to)}))}return C={initialize:function(){Ee||(oe=[],z=null,se=0,Le=[],Ne=null,be=null,Ee=!0,Me=hc(ve).getInstance(),Ce.on(E.Z.VIDEO_CHUNK_RECEIVED,Pe,C),Ce.on(E.Z.BUFFER_CLEARED,At,C))},addMediaInfos:function(pt,yt,un){if(Y=Y.concat(yt),pt===u.Z.TEXT&&yt[0].isFragmented&&!yt[0].isEmbedded){k=un,C.buffered=(0,bs.Z)(ve).create(),ge=ue.getTracksFor(u.Z.TEXT,j.id).filter((function(lt){return lt.isFragmented}));for(var Ve=ue.getCurrentTrackFor(u.Z.TEXT,j.id),tt=0;tt<ge.length;tt++)if(ge[tt]===Ve){We(tt);break}}for(var Nt=0;Nt<yt.length;Nt++)Se(yt[Nt])},resetMediaInfos:function(){Y=[]},getStreamId:function(){return j.id},append:je,abort:function(){},addEmbeddedTrack:function(pt){if(Ee&&pt)if(pt.id===u.Z.CC1||pt.id===u.Z.CC3){for(var yt=0;yt<oe.length;yt++)if(oe[yt].id===pt.id)return;oe.push(pt)}else x.warn("Embedded track "+pt.id+" not supported!")},resetEmbedded:function(){Ce.off(E.Z.VIDEO_CHUNK_RECEIVED,Pe,C),Ce.off(E.Z.BUFFER_CLEARED,At,C),P&&P.deleteAllTextTracks(),Ee=!1,oe=[],Le=[null,null],Ne=null,be=null},getConfig:function(){return{fragmentModel:k,fragmentedTracks:ge,videoModel:xe}},setCurrentFragmentedTrackIdx:We,remove:function(pt,yt){pt===void 0&&pt===yt&&(pt=C.buffered.start(0),yt=C.buffered.end(C.buffered.length-1)),C.buffered.remove(pt,yt),P.deleteCuesFromTrackIdx(z,pt,yt)},reset:function(){ae(),Y=[],B=null}},x=(0,I.Z)(ve).getInstance().getLogger(C),B=(0,Gs.Z)(ve).getInstance(),ae(),C}Xa.__dashjs_factory_name="TextSourceBuffer";var Rs=b.Z.getClassFactory(Xa),Qs=g(4403);function uu(D,C){(C==null||C>D.length)&&(C=D.length);for(var x=0,B=new Array(C);x<C;x++)B[x]=D[x];return B}var gc=["text","align","fontSize","id","isd","line","lineAlign","lineHeight","linePadding","position","positionAlign","region","size","snapToLines","vertical"];function Po(D){var C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le,Me,le,Re,ue,xe=this.context,P=(0,_.Z)(xe).getInstance(),te=D.videoModel,J=D.streamInfo,Q=D.settings;function j(st,Mt,Tt,jt,en,_n){var En=0,An=0;st/Mt>Tt/jt?En=(An=Mt)/jt*Tt:An=(En=st)/Tt*jt;var Ln,xt,an=0,mn=0;return En/An>en?(mn=An,an=An*en):(an=En,mn=En/en),Ln=(st-an)/2,xt=(Mt-mn)/2,_n?{x:Ln+.1*an,y:xt+.1*mn,w:.8*an,h:.8*mn}:{x:Ln,y:xt,w:an,h:mn}}function Ae(st,Mt){var Tt=te.getClientWidth(),jt=te.getClientHeight(),en=te.getVideoWidth(),_n=te.getVideoHeight(),En=te.getVideoRelativeOffsetTop(),An=te.getVideoRelativeOffsetLeft();if(en!==0&&_n!==0){var Ln=en/_n,xt=!1;st.isFromCEA608&&(Ln=1.1666666666666667,xt=!0);var an=j.call(this,Tt,jt,en,_n,Ln,xt),mn=an.w,pn=an.h,Tn=an.x,ot=an.y;if(mn!=ge||pn!=ie||Tn!=K||ot!=re||Mt){if(K=Tn+An,re=ot+En,ge=mn,ie=pn,z){var $e=z.style;$e&&($e.left=K+"px",$e.top=re+"px",$e.width=ge+"px",$e.height=ie+"px",$e.zIndex=Ne&&document[Ne]||be?Me:null,P.trigger(T.Z.CAPTION_CONTAINER_RESIZE))}var bt=st.activeCues;if(bt)for(var we=bt.length,Ue=0;Ue<we;++Ue){var ft=bt[Ue];ft.scaleCue(ft)}}}}function ve(st){var Mt,Tt,jt,en,_n,En=ge,An=ie;if(st.cellResolution){var Ln=[En/st.cellResolution[0],An/st.cellResolution[1]];if(st.linePadding){for(Mt in st.linePadding)if(st.linePadding.hasOwnProperty(Mt)){Tt=(st.linePadding[Mt]*Ln[0]).toString();for(var xt=document.getElementsByClassName("spanPadding"),an=0;an<xt.length;an++)xt[an].style.cssText=xt[an].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Tt),xt[an].style.cssText=xt[an].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Tt)}}if(st.fontSize){for(Mt in st.fontSize)if(st.fontSize.hasOwnProperty(Mt)){st.fontSize[Mt][0]==="%"?jt=st.fontSize[Mt][1]/100:st.fontSize[Mt][0]==="c"&&(jt=st.fontSize[Mt][1]),Tt=(jt*Ln[1]).toString(),_n=Mt!=="defaultFontSize"?document.getElementsByClassName(Mt):document.getElementsByClassName("paragraph");for(var mn=0;mn<_n.length;mn++)_n[mn].style.cssText=_n[mn].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Tt)}if(st.lineHeight){for(Mt in st.lineHeight)if(st.lineHeight.hasOwnProperty(Mt)){st.lineHeight[Mt][0]==="%"?en=st.lineHeight[Mt][1]/100:st.fontSize[Mt][0]==="c"&&(en=st.lineHeight[Mt][1]),Tt=(en*Ln[1]).toString(),_n=document.getElementsByClassName(Mt);for(var pn=0;pn<_n.length;pn++)_n[pn].style.cssText=_n[pn].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Tt)}}}}if(st.isd){var Tn=document.getElementById(st.cueID);Tn&&z.removeChild(Tn),Ee(st)}}function Ce(st,Mt){var Tt=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,jt=/^#(.*)$/;if(Tt.test(Mt)){var en=Tt.exec(Mt),_n=parseInt(en[4],10)-1;return"data:image/png;base64,"+btoa(st.images[_n])}if(jt.test(Mt)){var En=jt.exec(Mt)[1];return"data:image/png;base64,"+st.embeddedImages[En]}return Mt}function Ee(st){if(z){Zn.call(this);var Mt=document.createElement("div");z.appendChild(Mt),Le=(0,Qs.renderHTML)(st.isd,Mt,(function(Tt){return Ce(st,Tt)}),z.clientHeight,z.clientWidth,Q.get().streaming.text.imsc.displayForcedOnlyMode,(function(Tt){x.info("renderCaption :",Tt)}),Le,Q.get().streaming.text.imsc.enableRollUp),Mt.id=st.cueID,P.trigger(T.Z.CAPTION_RENDERED,{captionDiv:Mt,currentTrackIdx:k})}}function ae(st,Mt){return!!Mt&&Mt.endTime>=st.startTime}function Se(st,Mt){return!!Q.get().streaming.text.extendSegmentedCues&&!!(function(Tt,jt,en){for(var _n=0;_n<en.length;_n++){var En=en[_n];if(JSON.stringify(Tt[En])!==JSON.stringify(jt[En]))return!1}return!0})(Mt,st,gc)&&(Mt.endTime=Math.max(Mt.endTime,st.endTime),!0)}function Pe(st,Mt){Mt&&Mt.forEach((function(Tt){Tt.kind&&Tt.kind==="image"&&(Tt.src=Ce(st,Tt.src)),Pe(st,Tt.contents)}))}function We(st,Mt,Tt){var jt=tt(st),en=Q.get().streaming.text.dispatchForManualRendering;if(jt&&Array.isArray(Tt)&&Tt.length!==0)for(var _n=0;_n<Tt.length;_n++){var En=null,An=Tt[_n];jt.cellResolution=An.cellResolution,jt.isFromCEA608=An.isFromCEA608,isNaN(An.start)||isNaN(An.end)||(en?En=je(An,Mt):pt(An)&&z?En=St(An,Mt,jt):An.data&&(En=At(An,Mt,jt)));try{if(En){if(!Bt(jt,En))if(Q.get().streaming.text.webvtt.customRenderingEnabled)jt.manualCueList||(jt.manualCueList=[]),jt.manualCueList.push(En);else{var Ln=void 0;jt.cues&&jt.cues.length!==0&&(Ln=jt.cues[jt.cues.length-1]),ae(En,Ln)?Se(En,Ln)||(Ln.isd&&(Ln.onexit=function(){}),jt.mode!==u.Z.TEXT_DISABLED&&jt.addCue(En)):jt.mode!==u.Z.TEXT_DISABLED&&jt.addCue(En)}var xt=Q.get().streaming.buffer.bufferToKeep;Ct(jt,0,te.getTime()-xt)}else x.error("Impossible to display subtitles. You might have missed setting a TTML rendering div via player.attachTTMLRenderingDiv(TTMLRenderingDiv)")}catch(an){throw vn(jt),jt.addCue(En),an}}}function je(st,Mt){var Tt=yt(st,Mt);return Tt.onenter=function(){pt(st)&&ue&&ue.cueID!==Tt.cueID&&ze(ue),delete Tt.type,ue=Tt,Xe(Tt)},Tt.onexit=function(){ze(Tt),ue=null},Tt}function Xe(st){P.trigger(T.Z.CUE_ENTER,st)}function ze(st){P.trigger(T.Z.CUE_EXIT,{cueID:st.cueID})}function St(st,Mt,Tt){var jt=this,en=yt(st,Mt);return z.style.left=K+"px",z.style.top=re+"px",z.style.width=ge+"px",z.style.height=ie+"px",en.onenter=function(){var _n=this;Tt.mode===u.Z.TEXT_SHOWING&&(this.isd?(Re?requestAnimationFrame((function(){return Ee(_n)})):Ee(this),x.debug("Cue enter id:"+this.cueID)):(z.appendChild(this.cueHTMLElement),ve.call(jt,this),P.trigger(T.Z.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:k})))},en.onexit=function(){if(z)for(var _n=z.childNodes,En=0;En<_n.length;++En)_n[En].id===this.cueID&&(x.debug("Cue exit id:"+_n[En].id),z.removeChild(_n[En]),--En)},en}function At(st,Mt,Tt){var jt=yt(st,Mt);if(jt.isActive=!1,st.styles)try{st.styles.align!==void 0&&"align"in jt&&(jt.align=st.styles.align),st.styles.line!==void 0&&"line"in jt&&(jt.line=st.styles.line),st.styles.snapToLines!==void 0&&"snapToLines"in jt&&(jt.snapToLines=st.styles.snapToLines),st.styles.position!==void 0&&"position"in jt&&(jt.position=st.styles.position),st.styles.size!==void 0&&"size"in jt&&(jt.size=st.styles.size)}catch(en){x.error(en)}return jt.onenter=function(){Tt.mode===u.Z.TEXT_SHOWING&&P.trigger(T.Z.CAPTION_RENDERED,{currentTrackIdx:k})},jt}function pt(st){return st.type==="html"}function yt(st,Mt){return pt(st)?(function(Tt,jt){var en=new B(Tt.start+jt,Tt.end+jt,"");return en.cueHTMLElement=Tt.cueHTMLElement,en.isd=Tt.isd,en.images=Tt.images,en.embeddedImages=Tt.embeddedImages,en.cueID=Tt.cueID,en.scaleCue=ve.bind(self),en.cellResolution=Tt.cellResolution,en.lineHeight=Tt.lineHeight,en.linePadding=Tt.linePadding,en.fontSize=Tt.fontSize,en.isd&&Pe(en,en.isd.contents),en})(st,Mt):(function(Tt,jt){var en=new B(Tt.start-jt,Tt.end-jt,Tt.data);return en.cueID="".concat(en.startTime,"_").concat(en.endTime),en})(st,Mt)}function un(st){if(oe)for(var Mt=oe.childNodes,Tt=0;Tt<Mt.length;++Tt)Mt[Tt].id===st.cueID&&(oe.removeChild(Mt[Tt]),--Tt)}function Ve(){var st,Mt=[],Tt=(function(en,_n){var En;if(typeof Symbol>"u"||en[Symbol.iterator]==null){if(Array.isArray(en)||(En=(function(pn,Tn){if(pn){if(typeof pn=="string")return uu(pn,Tn);var ot=Object.prototype.toString.call(pn).slice(8,-1);return ot==="Object"&&pn.constructor&&(ot=pn.constructor.name),ot==="Map"||ot==="Set"?Array.from(pn):ot==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ot)?uu(pn,Tn):void 0}})(en))||_n){En&&(en=En);var An=0,Ln=function(){};return{s:Ln,n:function(){return An>=en.length?{done:!0}:{done:!1,value:en[An++]}},e:function(pn){throw pn},f:Ln}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xt,an=!0,mn=!1;return{s:function(){En=en[Symbol.iterator]()},n:function(){var pn=En.next();return an=pn.done,pn},e:function(pn){mn=!0,xt=pn},f:function(){try{an||En.return==null||En.return()}finally{if(mn)throw xt}}}})(te.getTextTracks());try{for(Tt.s();!(st=Tt.n()).done;){var jt=st.value;jt.manualMode===u.Z.TEXT_SHOWING&&Mt.push(jt)}}catch(en){Tt.e(en)}finally{Tt.f()}return Mt}function tt(st){return st>=0&&q[st]?te.getTextTrack(q[st].kind,q[st].id,q[st].lang,q[st].isTTML,q[st].isEmbedded):null}function Nt(st){var Mt=this;if(st!==k){var Tt=tt(k=st);lt.call(this,Tt),se&&(clearInterval(se),se=null),Tt&&Tt.renderingType==="html"&&(Ae.call(this,Tt,!0),window.ResizeObserver?(le=new window.ResizeObserver((function(){Ae.call(Mt,Tt,!0)}))).observe(te.getElement()):se=setInterval(Ae.bind(this,Tt),500))}}function lt(st){Zn.call(this),st&&st.renderingType==="html"?yn.call(this):Fn.call(this)}function Bt(st,Mt){if(!st.cues)return!1;for(var Tt=0;Tt<st.cues.length;Tt++)if(st.cues[Tt].startTime===Mt.startTime&&st.cues[Tt].endTime===Mt.endTime)return!0;return!1}function Ft(st,Mt,Tt){var jt=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return!!st&&(isNaN(Mt)||(jt?st.startTime:st.endTime)>=Mt)&&(isNaN(Tt)||(jt?st.endTime:st.startTime)<=Tt)}function Ct(st,Mt,Tt){var jt,en;if(!(Tt<Mt)&&st&&(st.cues||st.manualCueList)){var _n=st.cues&&st.cues.length>0?"native":"custom",En=_n==="native"?st.cues:st.manualCueList;if(!En||En.length===0)return;for(var An=En.length-1;An>=0;An--)!Ft(En[An],Mt,Tt,!0)||(jt=En[An],en=te.getTime(),jt.startTime>=en&&jt.endTime<=en)||(_n==="native"?st.removeCue(En[An]):(un(En[An]),delete st.manualCueList[An]))}}function vn(st,Mt,Tt){var jt=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];if(st&&(st.cues||st.manualCueList)){var en=st.cues&&st.cues.length>0?"native":"custom",_n=en==="native"?st.cues:st.manualCueList;if(!_n||_n.length===0)return;for(var En=_n.length-1,An=En;An>=0;An--)Ft(_n[An],Mt,Tt,jt)&&(en==="native"?(_n[An].onexit&&_n[An].onexit(),st.removeCue(_n[An])):(un(_n[An]),delete st.manualCueList[An]))}}function yn(){var st=document.getElementById("native-cue-style");if(!st){(st=document.createElement("style")).id="native-cue-style",document.head.appendChild(st);var Mt=st.sheet,Tt=te.getElement();try{Tt&&(Tt.id?Mt.insertRule("#"+Tt.id+"::cue {background: transparent}",0):Tt.classList.length!==0?Mt.insertRule("."+Tt.className+"::cue {background: transparent}",0):Mt.insertRule("video::cue {background: transparent}",0))}catch(jt){x.info(""+jt.message)}}}function Fn(){var st=document.getElementById("native-cue-style");st&&document.head.removeChild(st)}function Zn(){if(z)for(;z.firstChild;)z.removeChild(z.firstChild)}return C={initialize:function(){typeof window<"u"&&typeof navigator<"u"&&(B=window.VTTCue||window.TextTrackCue,q=[],Y=[],k=-1,K=0,re=0,ge=0,ie=0,z=null,oe=null,se=null,be=!1,Me=2147483647,Le=null,Re="requestAnimationFrame"in window,document.fullscreenElement!==void 0?Ne="fullscreenElement":document.webkitIsFullScreen!==void 0?Ne="webkitIsFullScreen":document.msFullscreenElement?Ne="msFullscreenElement":document.mozFullScreen&&(Ne="mozFullScreen"))},getStreamId:function(){return J.id},addTextTrack:function(st){q.push(st)},addCaptions:We,createTracks:function(){var st=Q.get().streaming.text.dispatchForManualRendering;q.sort((function(Tn,ot){return Tn.index-ot.index})),z=te.getTTMLRenderingDiv(),oe=te.getVttRenderingDiv();for(var Mt,Tt,jt,en,_n,En,An=-1,Ln=0;Ln<q.length;Ln++){var xt=(Tt=(Mt=q[Ln]).kind,jt=Mt.id!==void 0?Mt.id:Mt.lang,en=Mt.lang,_n=Mt.isTTML,En=Mt.isEmbedded,te.addTextTrack(Tt,jt,en,_n,En));Y.push(xt),q[Ln].defaultTrack&&(xt.default=!0,An=Ln);var an=tt(Ln);an&&(an.mode=u.Z.TEXT_SHOWING,z&&(q[Ln].isTTML||q[Ln].isEmbedded)?an.renderingType="html":an.renderingType="default"),We(Ln,0,q[Ln].captionData),P.trigger(T.Z.TEXT_TRACK_ADDED)}if(Nt.call(this,An),An>=0){P.on(T.Z.PLAYBACK_METADATA_LOADED,(function Tn(){var ot=tt(An);ot&&ot.renderingType==="html"&&Ae.call(this,ot,!0),P.off(T.Z.PLAYBACK_METADATA_LOADED,Tn,this)}),this);for(var mn=0;mn<q.length;mn++){var pn=tt(mn);pn&&(pn.mode=mn!==An||st?u.Z.TEXT_HIDDEN:u.Z.TEXT_SHOWING,pn.manualMode=mn===An?u.Z.TEXT_SHOWING:u.Z.TEXT_HIDDEN)}}P.trigger(E.Z.TEXT_TRACKS_QUEUE_INITIALIZED,{index:k,tracks:q,streamId:J.id})},getCurrentTrackIdx:function(){return k},setCurrentTrackIdx:Nt,getTrackIdxForId:function(st){for(var Mt=-1,Tt=0;Tt<q.length;Tt++)if(q[Tt].id===st){Mt=Tt;break}return Mt},getCurrentTrackInfo:function(){return q[k]},setModeForTrackIdx:function(st,Mt){var Tt=tt(st);Tt&&Tt.mode!==Mt&&(Tt.mode=Mt),Tt&&Tt.manualMode!==Mt&&(Tt.manualMode=Mt)},deleteCuesFromTrackIdx:function(st,Mt,Tt){var jt=tt(st);jt&&vn(jt,Mt,Tt)},deleteAllTextTracks:function(){for(var st=Y?Y.length:0,Mt=0;Mt<st;Mt++){var Tt=tt(Mt);Tt&&vn.call(this,Tt,J.start,J.start+J.duration,!1)}Y=[],q=[],se&&(clearInterval(se),se=null),le&&te&&(le.unobserve(te.getElement()),le=null),k=-1,Zn.call(this)},manualCueProcessing:function(st){var Mt=Ve();if(Mt&&Mt.length>0){var Tt=Mt[0].manualCueList;Tt&&Tt.length>0&&Tt.forEach((function(jt){jt.startTime<=st&&jt.endTime>=st&&!jt.isActive?(jt.isActive=!0,Q.get().streaming.text.dispatchForManualRendering?Xe(jt):WebVTT.processCues(window,[jt],oe,jt.cueID)):jt.isActive&&(jt.startTime>st||jt.endTime<st)&&(jt.isActive=!1,Q.get().streaming.text.dispatchForManualRendering?ze(jt):un(jt))}))}},disableManualTracks:function(){var st=Ve();if(st&&st.length>0){var Mt=st[0].manualCueList;Mt&&Mt.length>0&&Mt.forEach((function(Tt){if(Tt.isActive){if(Tt.isActive=!1,Q.get().streaming.text.dispatchForManualRendering)ze(Tt);else if(oe)for(var jt=oe.childNodes,en=0;en<jt.length;++en)jt[en].id===Tt.cueID&&(oe.removeChild(jt[en]),--en)}}))}}},x=(0,I.Z)(xe).getInstance().getLogger(C),C}Po.__dashjs_factory_name="TextTracks";var bl=b.Z.getClassFactory(Po);function mc(){var D,C,x,B,q,Y,k=this.context;function K(z){var oe=z.split(":"),se=oe.length-1;return z=60*parseInt(oe[se-1],10)+parseFloat(oe[se]),se===2&&(z+=3600*parseInt(oe[0],10)),z}function re(z){var oe=z.split(B),se=oe[1].split(Y);return se.shift(),oe[1]=se[0],se.shift(),{cuePoints:oe,styles:ge(se)}}function ge(z){var oe={};return z.forEach((function(se){if(se.split(/:/).length>1){var Ne=se.split(/:/)[1],be=!1;Ne&&Ne.search(/%/)!=-1&&(be=!0,Ne=parseInt(Ne.replace(/%/,""),10)),(se.match(/align/)||se.match(/A/))&&(oe.align=Ne),(se.match(/line/)||se.match(/L/))&&(oe.line=Ne==="auto"?Ne:parseInt(Ne,10),be&&(oe.snapToLines=!1)),(se.match(/position/)||se.match(/P/))&&(oe.position=Ne),(se.match(/size/)||se.match(/S/))&&(oe.size=Ne)}})),oe}function ie(z,oe){for(var se,Ne=oe,be="",Le="";z[Ne]!==""&&Ne<z.length;)Ne++;if((se=Ne-oe)>1)for(var Me=0;Me<se;Me++){if((Le=z[oe+Me]).match(B)){be="";break}be+=Le,Me!==se-1&&(be+=`
`)}else(Le=z[oe]).match(B)||(be=Le);return be}return D={parse:function(z){var oe,se,Ne=[];if(!z)return Ne;oe=(z=z.split(x)).length,se=-1;for(var be=0;be<oe;be++){var Le=z[be];if(Le.length>0&&Le!=="WEBVTT"&&Le.match(B)){var Me=re(Le),le=Me.cuePoints,Re=Me.styles,ue=ie(z,be+1),xe=K(le[0].replace(q,"")),P=K(le[1].replace(q,""));!isNaN(xe)&&!isNaN(P)&&xe>=se&&P>xe?ue!==""?(se=xe,Ne.push({start:xe,end:P,data:ue,styles:Re})):C.error("Skipping cue due to empty/malformed cue text"):C.error("Skipping cue due to incorrect cue timing")}}return Ne},getCaptionStyles:ge},C=(0,I.Z)(k).getInstance().getLogger(D),x=/(?:\r\n|\r|\n)/gm,B=/-->/,q=/(^[\s]+|[\s]+$)/g,Y=/\s\b/g,D}mc.__dashjs_factory_name="VTTParser";var Mf=b.Z.getSingletonFactory(mc);function Js(){var D,C;return D={parse:function(x){var B=[];return C.oncue=function(q){q.start=q.startTime,q.end=q.endTime,q.data=q.text,q.styles={align:q.align,line:q.line,position:q.position,size:q.size},B.push(q)},C.parse(x),B}},(function(){try{window&&window.WebVTT&&window.WebVTT.Parser&&(C=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()))}catch{}})(),D}Js.__dashjs_factory_name="VttCustomRenderingParser";var cu=b.Z.getSingletonFactory(Js);function pc(){var D,C,x=this.context,B=(0,_.Z)(x).getInstance(),q=0;return D={parse:function(Y,k,K,re,ge){var ie,z,oe,se="",Ne=[],be={},Le={},Me="",le="",Re={onOpenTag:function(J,Q,j){if(j[" imagetype"]&&!j[" imageType"]&&(B.trigger(T.Z.CONFORMANCE_VIOLATION,{level:yo.LEVELS.ERROR,event:yo.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),j[" imageType"]=j[" imagetype"]),Q==="image"&&(J==="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"||J==="http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt")){if(!j[" imageType"]||j[" imageType"].value!=="PNG")return void C.warn("smpte-tt imageType != PNG. Discarded");Me=j["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){Me&&(Le[Me]=le.trim()),le="",Me=""},onText:function(J){Me&&(le+=J)}};if(!Y)throw se="no ttml data to parse",new Error(se);be.data=Y,B.trigger(E.Z.TTML_TO_PARSE,be);var ue=(0,Qs.fromXML)(be.data,(function(J){se=J}),Re);B.trigger(E.Z.TTML_PARSED,{ttmlString:be.data,ttmlDoc:ue});var xe,P=ue.getMediaTimeEvents();for(oe=0;oe<P.length;oe++){var te=(0,Qs.generateISD)(ue,P[oe],(function(J){se=J}));te.contents.some((function(J){return J.contents.length}))&&(ie=P[oe]+k)<(z=P[oe+1]+k)&&Ne.push({start:ie,end:z,type:"html",cueID:(xe="cue_TTML_"+q,q++,xe),isd:te,images:ge,embeddedImages:Le})}if(se!=="")throw C.error(se),new Error(se);return Ne}},C=(0,I.Z)(x).getInstance().getLogger(D),D}pc.__dashjs_factory_name="TTMLParser";var yc=b.Z.getSingletonFactory(pc);function fu(D,C){var x=Object.keys(D);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(D);C&&(B=B.filter((function(q){return Object.getOwnPropertyDescriptor(D,q).enumerable}))),x.push.apply(x,B)}return x}function Fi(D){for(var C=1;C<arguments.length;C++){var x=arguments[C]!=null?arguments[C]:{};C%2?fu(Object(x),!0).forEach((function(B){Ji(D,B,x[B])})):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(x)):fu(Object(x)).forEach((function(B){Object.defineProperty(D,B,Object.getOwnPropertyDescriptor(x,B))}))}return D}function Ji(D,C,x){return C in D?Object.defineProperty(D,C,{value:x,enumerable:!0,configurable:!0,writable:!0}):D[C]=x,D}function Qa(D,C){(C==null||C>D.length)&&(C=D.length);for(var x=0,B=new Array(C);x<C;x++)B[x]=D[x];return B}function du(D){var C,x,B,q=this.context,Y=(0,_.Z)(q).getInstance(),k=(0,ut.Z)(q).getInstance(),K=D.adapter,re=D.baseURLController;function ge(oe,se){var Ne,be,Le=!1;if(re.resolve()){var Me=K.getVoRepresentations(oe);Me&&Me.length>0&&(Ne=re.resolve(Me[0].path).url)}var le=oe.essentialPropertiesAsArray.filter((function(ue){return ue.schemeIdUri&&ue.schemeIdUri===u.Z.FONT_DOWNLOAD_DVB_SCHEME})),Re=oe.supplementalPropertiesAsArray.filter((function(ue){return ue.schemeIdUri&&ue.schemeIdUri===u.Z.FONT_DOWNLOAD_DVB_SCHEME}));le.length>0?(Le=!0,be=le):be=Re,be.forEach((function(ue){if((function(J){return!(!(J.value&&J.value==="1"&&J.dvbUrl&&J.dvbUrl.length>0&&J.dvbFontFamily&&J.dvbFontFamily.length>0&&J.dvbMimeType)||J.dvbMimeType!==u.Z.OFF_MIMETYPE&&J.dvbMimeType!==u.Z.WOFF_MIMETYPE)})(ue)){var xe=(P=ue.dvbUrl,te=Ne,k.isPathAbsolute(P)?P:k.isRelative(P)?te?k.resolve(P,te):k.resolve(P):P);B.push({fontFamily:ue.dvbFontFamily,url:xe,mimeType:ue.dvbMimeType,trackId:oe.id,streamId:se,isEssential:Le,status:"unloaded",fontFace:new FontFace(ue.dvbFontFamily,"url(".concat(xe,")"),{display:"swap"})})}var P,te}))}function ie(oe,se){var Ne=B[oe];B[oe]=Fi(Fi({},Ne),{},{status:se})}function z(){B=[]}return C={addFontsFromTracks:function(oe,se){if(oe&&Array.isArray(oe)&&se)for(var Ne=0;Ne<oe.length;Ne++)ge(oe[Ne],se)},downloadFonts:function(){for(var oe=function(Ne){var be=B[Ne];document.fonts.add(be.fontFace),Y.trigger(T.Z.DVB_FONT_DOWNLOAD_ADDED,be),be.fontFace.load().then((function(){ie(Ne,"loaded"),Y.trigger(T.Z.DVB_FONT_DOWNLOAD_COMPLETE,be)}),(function(Le){ie(Ne,"error"),x.debug("Font download error: ",Le),Y.trigger(T.Z.DVB_FONT_DOWNLOAD_FAILED,be)}))},se=0;se<B.length;se++)oe(se)},getFonts:function(){return B},getFontsForTrackId:function(oe){return B.filter((function(se){return se.trackId&&se.trackId===oe}))},reset:function(){(function(){var oe,se=(function(Le,Me){var le;if(typeof Symbol>"u"||Le[Symbol.iterator]==null){if(Array.isArray(Le)||(le=(function(J,Q){if(J){if(typeof J=="string")return Qa(J,Q);var j=Object.prototype.toString.call(J).slice(8,-1);return j==="Object"&&J.constructor&&(j=J.constructor.name),j==="Map"||j==="Set"?Array.from(J):j==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(j)?Qa(J,Q):void 0}})(Le))||Me){le&&(Le=le);var Re=0,ue=function(){};return{s:ue,n:function(){return Re>=Le.length?{done:!0}:{done:!1,value:Le[Re++]}},e:function(J){throw J},f:ue}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xe,P=!0,te=!1;return{s:function(){le=Le[Symbol.iterator]()},n:function(){var J=le.next();return P=J.done,J},e:function(J){te=!0,xe=J},f:function(){try{P||le.return==null||le.return()}finally{if(te)throw xe}}}})(B);try{for(se.s();!(oe=se.n()).done;){var Ne=oe.value,be=document.fonts.delete(Ne.fontFace);x.debug("Removal of fontFamily: ".concat(Ne.fontFamily," was ").concat(be?"successful":"unsuccessful"))}}catch(Le){se.e(Le)}finally{se.f()}})(),z()}},x=(0,I.Z)(q).getInstance().getLogger(C),z(),C}du.__dashjs_factory_name="DVBFonts";var Pf=b.Z.getClassFactory(du);function Ja(D){var C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be=this.context,Le=D.adapter,Me=D.errHandler,le=D.manifestModel,Re=D.mediaController,ue=D.baseURLController,xe=D.videoModel,P=D.settings;function te(Se){if(Ne.error("Could not download ".concat(Se.isEssential?"an essential":"a"," font - fontFamily: ").concat(Se.fontFamily,", url: ").concat(Se.url)),Se.isEssential){var Pe=q[Se.streamId].getTrackIdxForId(Se.trackId);q[Se.streamId].setModeForTrackIdx(Pe,u.Z.TEXT_DISABLED)}}function J(Se){if(Ne.debug("Successfully downloaded ".concat(Se.isEssential?"an essential":"a"," font - fontFamily: ").concat(Se.fontFamily,", url: ").concat(Se.url)),Se.isEssential){var Pe=q[Se.streamId].getTrackIdxForId(Se.trackId);Pe===q[Se.streamId].getCurrentTrackIdx()?q[Se.streamId].setModeForTrackIdx(Pe,u.Z.TEXT_SHOWING):q[Se.streamId].setModeForTrackIdx(Pe,u.Z.TEXT_HIDDEN)}}function Q(Se){var Pe=Se.tracks,We=Se.index,je=Se.streamId;if(P.get().streaming.text.defaultEnabled===!1&&!ve()||oe)Ce(je,-1);else{var Xe=Re.getCurrentTrackFor(u.Z.TEXT,je);if(Xe){var ze={lang:Xe.lang,role:Xe.roles[0],index:Xe.index,codec:Xe.codec,accessibility:Xe.accessibility[0]};Pe.some((function(St,At){if(Re.matchSettings(ze,St))return Ce(je,At),We=At,!0}))}ge=!1}x[je].lastEnabledIndex=We,re.trigger(T.Z.TEXT_TRACKS_ADDED,{enabled:ve(),index:We,tracks:Pe,streamId:je}),z=!0,se.addFontsFromTracks(Pe,je),se.getFonts().forEach((function(St){if(St.isEssential){var At=q[St.streamId].getTrackIdxForId(St.trackId);q[St.streamId].setModeForTrackIdx(At,u.Z.TEXT_DISABLED)}})),se.downloadFonts()}function j(Se){try{var Pe=Se.streamId;if(!q[Pe]||isNaN(Se.time))return;q[Pe].manualCueProcessing(Se.time)}catch{}}function Ae(Se){try{var Pe=Se.streamId;if(!q[Pe])return;q[Pe].disableManualTracks()}catch{}}function ve(){var Se=!0;return ge&&!ie&&(Se=!1),Se}function Ce(Se,Pe){(ge=Pe===-1)&&Re&&Re.saveTextSettingsDisabled();var We=Ee(Se);if(We!==Pe&&q[Se]){q[Se].disableManualTracks();var je=q[Se].getCurrentTrackInfo(),Xe=je?xe.getTextTrack(je.kind,je.id,je.lang,je.isTTML,je.isEmbedded):null;Xe&&Xe.mode!==u.Z.TEXT_DISABLED&&q[Se].setModeForTrackIdx(We,u.Z.TEXT_HIDDEN),q[Se].setCurrentTrackIdx(Pe),je=q[Se].getCurrentTrackInfo();var ze=P.get().streaming.text.dispatchForManualRendering;je&&!ze&&je.mode!==u.Z.TEXT_DISABLED&&q[Se].setModeForTrackIdx(Pe,u.Z.TEXT_SHOWING),je&&je.isFragmented&&!je.isEmbedded?(function(St,At,pt){if(B[St])for(var yt=B[St].getConfig().fragmentedTracks,un=0;un<yt.length;un++){var Ve=yt[un];if(At.lang===Ve.lang&&(Ve.id?At.id===Ve.id:At.index===Ve.index)){var tt=Re.getCurrentTrackFor(u.Z.TEXT,St);(Ve.id?tt.id!==Ve.id:tt.index!==Ve.index)?(q[St].deleteCuesFromTrackIdx(pt),B[St].setCurrentFragmentedTrackIdx(un)):pt===-1&&re.trigger(E.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:St,mediaType:u.Z.TEXT})}}})(Se,je,We):je&&!je.isFragmented&&(function(St,At){re.trigger(E.Z.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:At},{streamId:St,mediaType:u.Z.TEXT})})(Se,je),Re.setTrack(je)}}function Ee(Se){return q[Se].getCurrentTrackIdx()}function ae(){B={},q={},x={},ge=!0,z=!1,oe=!1}return C={deactivateStream:function(Se){if(Se){var Pe=Se.id;B[Pe]&&B[Pe].resetMediaInfos(),q[Pe]&&q[Pe].deleteAllTextTracks()}},initialize:function(){se=Pf(be).create({adapter:Le,baseURLController:ue}),re.on(E.Z.TEXT_TRACKS_QUEUE_INITIALIZED,Q,C),re.on(E.Z.DVB_FONT_DOWNLOAD_FAILED,te,C),re.on(E.Z.DVB_FONT_DOWNLOAD_COMPLETE,J,C),P.get().streaming.text.webvtt.customRenderingEnabled&&(re.on(E.Z.PLAYBACK_TIME_UPDATED,j,C),re.on(E.Z.PLAYBACK_SEEKING,Ae,C))},initializeForStream:function(Se){var Pe=Se.id,We=bl(be).create({videoModel:xe,settings:P,streamInfo:Se});We.initialize(),q[Pe]=We;var je=Rs(be).create({errHandler:Me,adapter:Le,dvbFonts:se,manifestModel:le,mediaController:Re,videoModel:xe,textTracks:We,vttParser:Y,vttCustomRenderingParser:k,ttmlParser:K,streamInfo:Se,settings:P});je.initialize(),B[Pe]=je,x[Pe]={},x[Pe].lastEnabledIndex=-1},createTracks:function(Se){var Pe=Se.id;q[Pe]&&q[Pe].createTracks()},getTextSourceBuffer:function(Se){var Pe=Se.id;if(B&&B[Pe])return B[Pe]},getAllTracksAreDisabled:function(){return ge},addEmbeddedTrack:function(Se,Pe){var We=Se.id;B[We]&&B[We].addEmbeddedTrack(Pe)},enableText:function(Se,Pe){return(0,ye.PS)(Pe,"boolean"),ve()!==Pe&&(Pe&&Ce(Se,x[Se].lastEnabledIndex),Pe||(x[Se].lastEnabledIndex=Ee(Se),z?Ce(Se,-1):oe=!0)),!0},isTextEnabled:ve,setTextTrack:Ce,getCurrentTrackIdx:Ee,enableForcedTextStreaming:function(Se){return(0,ye.PS)(Se,"boolean"),ie=Se,!0},addMediaInfosToBuffer:function(Se,Pe,We){var je=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,Xe=Se.id;B[Xe]&&B[Xe].addMediaInfos(Pe,We,je)},reset:function(){se.reset(),ae(),re.off(E.Z.TEXT_TRACKS_QUEUE_INITIALIZED,Q,C),re.off(E.Z.DVB_FONT_DOWNLOAD_FAILED,te,C),re.off(E.Z.DVB_FONT_DOWNLOAD_COMPLETE,J,C),P.get().streaming.text.webvtt.customRenderingEnabled&&(re.off(E.Z.PLAYBACK_TIME_UPDATED,j,C),re.off(E.Z.PLAYBACK_SEEKING,Ae,C)),Object.keys(B).forEach((function(Se){B[Se].resetEmbedded(),B[Se].reset()}))}},ie=!1,z=!1,oe=!1,Y=Mf(be).getInstance(),k=cu(be).getInstance(),K=yc(be).getInstance(),re=(0,_.Z)(be).getInstance(),Ne=(0,I.Z)(be).getInstance().getLogger(C),ae(),C}Ja.__dashjs_factory_name="TextController";var qi=b.Z.getClassFactory(Ja);function Wr(){var D,C,x,B,q,Y,k,K,re,ge,ie,z,oe,se,Ne,be,Le,Me,le,Re,ue,xe,P,te,J,Q,j,Ae,ve,Ce,Ee,ae,Se,Pe,We,je,Xe,ze,St,At="You must first call initialize() and set a source before calling this method",pt="You must first call initialize() and set a valid source and view before calling this method",yt="You must first call attachView() to set the video element before calling this method",un="You must first call attachSource() with a valid source before calling this method",Ve="MediaPlayer not initialized!",tt=this.context,Nt=(0,_.Z)(tt).getInstance(),lt=(0,Ie.Z)(tt).getInstance(),Bt=(0,I.Z)(tt).getInstance({settings:lt});function Ft(){Ln(null),En(null),B=null,se&&(se.reset(),se=null),Ne&&(Ne.reset(),Ne=null),Re&&Re.reset(),lt.reset(),Le&&(Le.reset(),Le=null)}function Ct(){return!!x&&!!je.getElement()}function vn(){return(0,sc.e)()}function yn(){if(!k)throw pt;return Ae.isPaused()}function Fn(){if(!k)throw pt;return Ae.getIsDynamic()}function Zn(we){var Ue=J&&J.hasVideoTrack()?u.Z.VIDEO:u.Z.AUDIO,ft=ae.getCurrentDVRInfo(Ue);if(!ft)return 0;var zt=Ae.getOriginalLiveDelay(),tn=ft.range.start+we;return tn>ft.range.end-zt&&(tn=ft.range.end-zt),tn}function st(we){if(!k)throw pt;var Ue=_n().currentTime;if(we!==void 0)Ue=J.getTimeRelativeToStreamId(Ue,we);else if(Ae.getIsDynamic()){var ft=J&&J.hasVideoTrack()?u.Z.VIDEO:u.Z.AUDIO,zt=ae.getCurrentDVRInfo(ft);Ue=zt===null||Ue===0?0:Math.max(0,Ue-zt.range.start)}return Ue}function Mt(){if(!k)throw pt;var we=_n().duration;if(Ae.getIsDynamic()){var Ue=J&&J.hasVideoTrack()?u.Z.VIDEO:u.Z.AUDIO,ft=ae.getCurrentDVRInfo(Ue);we=ft?ft.range.end-ft.range.start:0}return we}function Tt(we){(0,ye.PS)(we,"boolean"),K=we}function jt(){Re.restoreDefaultUTCTimingSources()}function en(){return ae}function _n(){if(!je.getElement())throw yt;return je.getElement()}function En(we){if(!q)throw Ve;je.setElement(we),we&&(Tn(),(function(){if(!Ne){var Ue=dashjs.MetricsReporting;if(typeof Ue=="function"){var ft=Ue(tt).create();Ne=ft.createMetricsReporting({debug:Bt,eventBus:Nt,mediaElement:_n(),adapter:Me,dashMetrics:ae,mediaPlayerModel:le,events:E.Z,constants:u.Z,metricsConstants:S.Z})}}})(),(function(){if(!be){var Ue=dashjs.MssHandler;typeof Ue=="function"&&(X.extend(Ue.errors),be=Ue(tt).create({eventBus:Nt,mediaPlayerModel:le,dashMetrics:ae,manifestModel:Se,playbackController:Ae,streamController:J,protectionController:se,baseURLController:xe,errHandler:ue,events:E.Z,constants:u.Z,debug:Bt,initSegmentType:Be.w.INIT_SEGMENT_TYPE,BASE64:$s,ISOBoxer:Ws,settings:lt}))}})(),J&&J.switchToVideoElement(re)),k&&an(),bt(re)}function An(we){if(!Y)throw At;var Ue=J.getActiveStreamInfo();return Ue?oe.getTracksFor(we,Ue.id):[]}function Ln(we){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;if(!q)throw Ve;typeof we=="string"&&Xe.initialize(we),Ue==null&&(Ue=NaN),isNaN(Ue)||(Ue=Math.max(0,Ue)),re=Ue,x=we,(Y||k)&&an(),Ct()&&bt(re)}function xt(){if(!Y)throw At;var we=J.getActiveStreamInfo();return we?J.getStreamById(we.id):null}function an(){k=!1,Y=!1,Me.reset(),J.reset(),j.reset(),Ee.reset(),Ae.reset(),ve.reset(),Ce.reset(),ge.reset(),oe.reset(),St.reset(),se&&(lt.get().streaming.protection.keepProtectionMediaKeys?se.stop():(se.reset(),se=null,Tn())),Q.reset(),Pe.reset(),We.reset()}function mn(){var we=pn();J||(J=tf(tt).getInstance()),Q||(Q=qi(tt).create({errHandler:ue,manifestModel:Se,adapter:Me,mediaController:oe,baseURLController:xe,videoModel:je,settings:lt})),te.setConfig({capabilities:P,customParametersModel:Re,adapter:Me,settings:lt,manifestModel:Se,errHandler:ue}),J.setConfig({capabilities:P,capabilitiesFilter:te,manifestLoader:we,manifestModel:Se,mediaPlayerModel:le,customParametersModel:Re,protectionController:se,textController:Q,adapter:Me,dashMetrics:ae,errHandler:ue,timelineConverter:z,videoModel:je,playbackController:Ae,serviceDescriptionController:ve,contentSteeringController:Ce,abrController:ge,mediaController:oe,settings:lt,baseURLController:xe,uriFragmentModel:Xe,segmentBaseController:St}),j.setConfig({settings:lt,playbackController:Ae,streamController:J,videoModel:je,timelineConverter:z,adapter:Me}),Ae.setConfig({streamController:J,serviceDescriptionController:ve,dashMetrics:ae,adapter:Me,videoModel:je,timelineConverter:z,settings:lt}),Ee.setConfig({streamController:J,playbackController:Ae,mediaPlayerModel:le,videoModel:je,settings:lt}),ge.setConfig({streamController:J,domStorage:ze,mediaPlayerModel:le,customParametersModel:Re,cmsdModel:We,dashMetrics:ae,adapter:Me,videoModel:je,settings:lt}),Pe.setConfig({abrController:ge,dashMetrics:ae,playbackController:Ae}),We.setConfig({}),ge.initialize(),J.initialize(K,B),Q.initialize(),j.initialize(),Ee.initialize(),Pe.initialize(),We.initialize(),Ce.initialize(),St.initialize()}function pn(){return Vi(tt).create({debug:Bt,errHandler:ue,dashMetrics:ae,mediaPlayerModel:le,requestModifier:(0,He.Z)(tt).getInstance(),mssHandler:be,settings:lt})}function Tn(){if(se)return se;var we=dashjs.Protection;if(typeof we=="function"){var Ue=we(tt).create();return E.Z.extend(we.events),T.Z.extend(we.events,{publicOnly:!0}),X.extend(we.errors),P||(P=(0,Qu.Z)(tt).getInstance()),se=Ue.createProtectionSystem({debug:Bt,errHandler:ue,videoModel:je,customParametersModel:Re,capabilities:P,eventBus:Nt,events:E.Z,BASE64:$s,constants:u.Z,cmcdModel:Pe,settings:lt})}return null}function ot(){if(!q)throw Ve;if(Le)return Le;var we=dashjs.OfflineController;if(typeof we=="function"){E.Z.extend(we.events),T.Z.extend(we.events,{publicOnly:!0}),X.extend(we.errors);var Ue=pn(),ft=Xc(tt).create();return ft.setConfig({manifestModel:Se,adapter:Me,manifestLoader:Ue,errHandler:ue,contentSteeringController:Ce}),Le=we(tt).create({debug:Bt,manifestUpdater:ft,baseURLController:xe,manifestLoader:Ue,manifestModel:Se,mediaPlayerModel:le,abrController:ge,playbackController:Ae,adapter:Me,errHandler:ue,dashMetrics:ae,timelineConverter:z,segmentBaseController:St,schemeLoaderFactory:ie,eventBus:Nt,events:E.Z,errors:X,constants:u.Z,settings:lt,dashConstants:d.Z,urlUtils:(0,ut.Z)(tt).getInstance()})}return null}function $e(we){var Ue=J&&J.hasVideoTrack()?u.Z.VIDEO:u.Z.AUDIO,ft=ae.getCurrentDVRInfo(Ue);return ft?we+(ft.manifestInfo.availableFrom.getTime()/1e3+ft.range.start):0}function bt(){var we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NaN;Le&&Le.resetRecords(),!Y&&x&&(Y=!0,C.info("Streaming Initialized"),mn(),typeof x=="string"?J.load(x,we):J.loadWithManifest(x,we)),!k&&Ct()&&(k=!0,C.info("Playback Initialized"))}return D={initialize:function(we,Ue,ft){var zt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:NaN;P||(P=(0,Qu.Z)(tt).getInstance()).setConfig({settings:lt}),ue||(ue=za(tt).getInstance()),P.supportsMediaSource()?(q||(q=!0,z=Oo(tt).getInstance(),ge||(ge=Vr(tt).getInstance()).setConfig({settings:lt}),ie||(ie=xr(tt).getInstance()),Ae||(Ae=R(tt).getInstance()),oe||(oe=th(tt).getInstance()),J||(J=tf(tt).getInstance()),j||(j=Qd(tt).getInstance()),Ee||(Ee=af(tt).getInstance()),ve||(ve=Uu(tt).getInstance()),Ce||(Ce=Hr(tt).getInstance()),te||(te=Hs(tt).getInstance()),Me=xo(tt).getInstance(),Se=Xi(tt).getInstance(),Pe=kn(tt).getInstance(),We=rn(tt).getInstance(),ae=Nf(tt).getInstance({settings:lt}),ze=Sl(tt).getInstance({settings:lt}),Me.setConfig({constants:u.Z,cea608parser:m(),errHandler:ue,BASE64:$s}),xe||(xe=pf(tt).create()),xe.setConfig({adapter:Me,contentSteeringController:Ce}),ve.setConfig({adapter:Me}),St||(St=qs(tt).getInstance({dashMetrics:ae,mediaPlayerModel:le,errHandler:ue,baseURLController:xe,events:E.Z,eventBus:Nt,debug:Bt,boxParser:(0,Gs.Z)(tt).getInstance(),requestModifier:(0,He.Z)(tt).getInstance(),errors:X})),oe.setConfig({domStorage:ze,settings:lt,customParametersModel:Re}),le.setConfig({playbackController:Ae,serviceDescriptionController:ve}),Ce.setConfig({adapter:Me,errHandler:ue,dashMetrics:ae,mediaPlayerModel:le,manifestModel:Se,serviceDescriptionController:ve,eventBus:Nt,requestModifier:(0,He.Z)(tt).getInstance()}),jt(),Tt(ft===void 0||ft),ot()),we&&En(we),Ue&&Ln(Ue,zt),C.info("[dash.js "+vn()+"] MediaPlayer has been initialized")):ue.error(new fe.Z(X.CAPABILITY_MEDIASOURCE_ERROR_CODE,X.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(we){we&&(we.capabilities&&(P=we.capabilities),we.capabilitiesFilter&&(te=we.capabilitiesFilter),we.streamController&&(J=we.streamController),we.textController&&(Q=we.textController),we.gapController&&(j=we.gapController),we.playbackController&&(Ae=we.playbackController),we.serviceDescriptionController&&(ve=we.serviceDescriptionController),we.contentSteeringController&&(Ce=we.contentSteeringController),we.catchupController&&(Ee=we.catchupController),we.mediaPlayerModel&&(le=we.mediaPlayerModel),we.customParametersModel&&(Re=we.customParametersModel),we.abrController&&(ge=we.abrController),we.schemeLoaderFactory&&(ie=we.schemeLoaderFactory),we.mediaController&&(oe=we.mediaController),we.settings&&(lt=we.settings))},on:function(we,Ue,ft,zt){Nt.on(we,Ue,ft,zt)},off:function(we,Ue,ft){Nt.off(we,Ue,ft)},extend:function(we,Ue,ft){b.Z.extend(we,Ue,ft,tt)},attachView:En,attachSource:Ln,refreshManifest:function(we){if(!q)throw Ve;if(!Ct())return we(null,un);var Ue=this;typeof we=="function"&&Nt.on(E.Z.INTERNAL_MANIFEST_LOADED,(function ft(zt){Nt.off(E.Z.INTERNAL_MANIFEST_LOADED,ft,Ue),zt.error?we(null,zt.error):we(zt.manifest)}),Ue),J.refreshManifest()},isReady:Ct,preload:function(){if(!je.getElement()&&!Y){if(!x)throw un;bt(re)}},play:function(){if(!k)throw pt;(!K||yn()&&k)&&Ae.play(!0)},isPaused:yn,pause:function(){if(!k)throw pt;Ae.pause()},isSeeking:function(){if(!k)throw pt;return Ae.isSeeking()},isDynamic:Fn,getLowLatencyModeEnabled:function(){if(!k)throw pt;return Ae.getLowLatencyModeEnabled()},seek:function(we){if(!k)throw pt;if((0,ye.PS)(we,"number"),isNaN(we))throw u.Z.BAD_ARGUMENT_ERROR;we<0&&(we=0);var Ue=Ae.getIsDynamic()?Zn(we):we,ft=_n();!Ae.getIsDynamic()&&ft.duration&&(Ue=Math.min(ft.duration,Ue)),Ae.seek(Ue,!1,!1,!0)},seekToOriginalLive:function(){k&&Fn()&&Ae.seekToOriginalLive()},setPlaybackRate:function(we){_n().playbackRate=we},getPlaybackRate:function(){return _n().playbackRate},setMute:function(we){(0,ye.PS)(we,"boolean"),_n().muted=we},isMuted:function(){return _n().muted},setVolume:function(we){if(typeof we!="number"||isNaN(we)||we<0||we>1)throw u.Z.BAD_ARGUMENT_ERROR;_n().volume=we},getVolume:function(){return _n().volume},time:st,duration:Mt,timeAsUTC:function(){if(!k)throw pt;return st()<0?NaN:$e(st())},durationAsUTC:function(){if(!k)throw pt;return $e(Mt())},getActiveStream:xt,getDVRWindowSize:function(){var we=J&&J.hasVideoTrack()?u.Z.VIDEO:u.Z.AUDIO,Ue=ae.getCurrentDVRInfo(we);return Ue?Ue.manifestInfo.dvrWindowSize:0},getDVRSeekOffset:Zn,getAvailableBaseUrls:function(){var we=Se.getValue();return we?xe.getBaseUrls(we):[]},getAvailableLocations:function(){var we=Se.getValue();if(!we)return[];var Ue=Me.getLocation(we),ft=Ce.getSynthesizedLocationElements(Ue);return Ue.concat(ft)},getTargetLiveDelay:function(){if(!k)throw pt;return Ae.getOriginalLiveDelay()},convertToTimeCode:function(we){we=Math.max(we,0);var Ue=Math.floor(we/3600),ft=Math.floor(we%3600/60),zt=Math.floor(we%3600%60);return(Ue===0?"":Ue<10?"0"+Ue.toString()+":":Ue.toString()+":")+(ft<10?"0"+ft.toString():ft.toString())+":"+(zt<10?"0"+zt.toString():zt.toString())},formatUTC:function(we,Ue,ft){var zt=arguments.length>3&&arguments[3]!==void 0&&arguments[3],tn=new Date(1e3*we),Hn=tn.toLocaleDateString(Ue),cr=tn.toLocaleTimeString(Ue,{hour12:ft});return zt?cr+" "+Hn:cr},getVersion:vn,getDebug:function(){return Bt},getBufferLength:function(we){var Ue=[u.Z.VIDEO,u.Z.AUDIO,u.Z.TEXT];if(we)return Ue.indexOf(we)!==-1?en().getCurrentBufferLevel(we)||NaN:(C.warn("getBufferLength requested for invalid type"),NaN);var ft=Ue.map((function(zt){return An(zt).length>0?en().getCurrentBufferLevel(zt):Number.MAX_VALUE})).reduce((function(zt,tn){return Math.min(zt,tn)}));return ft===Number.MAX_VALUE?NaN:ft},getTTMLRenderingDiv:function(){return je?je.getTTMLRenderingDiv():null},getVideoElement:_n,getSource:function(){if(!x)throw un;return x},updateSource:function(we){x=we,J.load(x)},getCurrentLiveLatency:function(){if(!q)throw Ve;return k?Ae.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(we){if(!Y)throw At;return ge.getTopBitrateInfoFor(we)},setAutoPlay:Tt,getAutoPlay:function(){return K},getDashMetrics:en,getQualityFor:function(we){if(!Y)throw At;if(we===u.Z.IMAGE){var Ue=xt();if(!Ue)return-1;var ft=Ue.getThumbnailController();return ft?ft.getCurrentTrackIndex():-1}return ge.getQualityFor(we)},setQualityFor:function(we,Ue){var ft=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!Y)throw At;if(we===u.Z.IMAGE){var zt=xt();if(!zt)return;var tn=zt.getThumbnailController();tn&&tn.setTrackByIndex(Ue)}ge.setPlaybackQuality(we,J.getActiveStreamInfo(),Ue,{forceReplace:ft})},updatePortalSize:function(){ge.setElementSize(),ge.setWindowResizeEventCalled(!0)},enableText:function(we){var Ue=J.getActiveStreamInfo();return!(!Ue||!Q)&&Q.enableText(Ue.id,we)},enableForcedTextStreaming:function(we){return!(!J.getActiveStreamInfo()||!Q)&&Q.enableForcedTextStreaming(we)},isTextEnabled:function(){var we=J.getActiveStreamInfo();return!(!we||!Q)&&Q.isTextEnabled(we)},setTextTrack:function(we){if(!k)throw pt;var Ue=J.getActiveStreamInfo();Ue&&Q&&Q.setTextTrack(Ue.id,we)},getBitrateInfoListFor:function(we){if(!Y)throw At;var Ue=xt();return Ue?Ue.getBitrateListFor(we):[]},getStreamsFromManifest:function(we){if(!Y)throw At;return Me.getStreamsInfo(we)},getTracksFor:An,getTracksForTypeFromManifest:function(we,Ue,ft){if(!Y)throw At;return(ft=ft||Me.getStreamsInfo(Ue,1)[0])?Me.getAllMediaInfoForType(ft,we,Ue):[]},getCurrentTrackFor:function(we){if(!Y)throw At;var Ue=J.getActiveStreamInfo();return oe.getCurrentTrackFor(we,Ue.id)},setInitialMediaSettingsFor:function(we,Ue){if(!q)throw Ve;oe.setInitialSettings(we,Ue)},getInitialMediaSettingsFor:function(we){if(!q)throw Ve;return oe.getInitialSettings(we)},setCurrentTrack:function(we){var Ue=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!Y)throw At;oe.setTrack(we,Ue)},addABRCustomRule:function(we,Ue,ft){Re.addAbrCustomRule(we,Ue,ft)},removeABRCustomRule:function(we){Re.removeAbrCustomRule(we)},removeAllABRCustomRule:function(){Re.removeAllAbrCustomRule()},getABRCustomRules:function(){return Re.getAbrCustomRules()},getAverageThroughput:function(we){var Ue=ge.getThroughputHistory(),ft=Ae.getIsDynamic();return Ue?Ue.getAverageThroughput(we,ft):0},retrieveManifest:function(we,Ue){var ft=pn(),zt=this;Nt.on(E.Z.INTERNAL_MANIFEST_LOADED,(function tn(Hn){Hn.error?Ue(null,Hn.error):Ue(Hn.manifest),Nt.off(E.Z.INTERNAL_MANIFEST_LOADED,tn,zt),ft.reset()}),zt),Xe.initialize(we),ft.load(we)},addUTCTimingSource:function(we,Ue){Re.addUTCTimingSource(we,Ue)},removeUTCTimingSource:function(we,Ue){Re.removeUTCTimingSource(we,Ue)},clearDefaultUTCTimingSources:function(){Re.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:jt,setXHRWithCredentialsForType:function(we,Ue){Re.setXHRWithCredentialsForType(we,Ue)},getXHRWithCredentialsForType:function(we){return Re.getXHRWithCredentialsForType(we)},getProtectionController:function(){return Tn()},attachProtectionController:function(we){se=we},setProtectionData:function(we){B=we,J&&J.setProtectionData(B)},registerLicenseRequestFilter:function(we){Re.registerLicenseRequestFilter(we)},registerLicenseResponseFilter:function(we){Re.registerLicenseResponseFilter(we)},unregisterLicenseRequestFilter:function(we){Re.unregisterLicenseRequestFilter(we)},unregisterLicenseResponseFilter:function(we){Re.unregisterLicenseResponseFilter(we)},registerCustomCapabilitiesFilter:function(we){Re.registerCustomCapabilitiesFilter(we)},unregisterCustomCapabilitiesFilter:function(we){Re.unregisterCustomCapabilitiesFilter(we)},setCustomInitialTrackSelectionFunction:function(we){Re.setCustomInitialTrackSelectionFunction(we)},resetCustomInitialTrackSelectionFunction:function(){Re.resetCustomInitialTrackSelectionFunction(null)},attachTTMLRenderingDiv:function(we){if(!je.getElement())throw yt;je.setTTMLRenderingDiv(we)},attachVttRenderingDiv:function(we){if(!je.getElement())throw yt;je.setVttRenderingDiv(we)},getCurrentTextTrackIndex:function(){var we=J.getActiveStreamInfo();if(we&&Q)return Q.getCurrentTrackIdx(we.id)},provideThumbnail:function(we,Ue){if(typeof Ue=="function")if(we<0)Ue(null);else{var ft=Ae.getIsDynamic()?Zn(we):we,zt=J.getStreamForTime(ft);if(zt!==null){var tn=zt.getThumbnailController();if(tn)return tn.provide(ft,Ue);Ue(null)}else Ue(null)}},getDashAdapter:function(){return Me},getOfflineController:function(){return ot()},triggerSteeringRequest:function(){if(Ce)return Ce.loadSteeringData()},getCurrentSteeringResponseData:function(){if(Ce)return Ce.getCurrentSteeringResponseData()},getSettings:function(){return lt.get()},updateSettings:function(we){lt.update(we)},resetSettings:function(){lt.reset()},reset:Ft,destroy:function(){Ft(),b.Z.deleteSingletonInstances(tt)}},C=Bt.getLogger(D),q=!1,k=!1,Y=!1,K=!0,re=NaN,se=null,Le=null,B=null,Me=null,St=null,E.Z.extend(T.Z),le=Xl(tt).getInstance(),Re=(0,kr.Z)(tt).getInstance(),je=Qi(tt).getInstance(),Xe=tc(tt).getInstance(),D}Wr.__dashjs_factory_name="MediaPlayer";var eo=b.Z.getClassFactory(Wr);eo.events=T.Z,eo.errors=X,b.Z.updateClassFactory(Wr.__dashjs_factory_name,eo);var es=eo},8825:function(f,y,g){function p(_){return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},p(_)}function m(_,E){return m=Object.setPrototypeOf||function(b,I){return b.__proto__=I,b},m(_,E)}function u(_,E){return!E||p(E)!=="object"&&typeof E!="function"?(function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b})(_):E}function d(_){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)},d(_)}var S=new((function(_){(function(A,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(R&&R.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),R&&m(A,R)})(T,_);var E,b,I=(E=T,b=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var A,R=d(E);if(b){var O=d(this).constructor;A=Reflect.construct(R,arguments,O)}else A=R.apply(this,arguments);return u(this,A)});function T(){var A;return(function(R,O){if(!(R instanceof O))throw new TypeError("Cannot call a class as a function")})(this,T),(A=I.call(this)).AST_IN_FUTURE="astInFuture",A.BASE_URLS_UPDATED="baseUrlsUpdated",A.BUFFER_EMPTY="bufferStalled",A.BUFFER_LOADED="bufferLoaded",A.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",A.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",A.DVB_FONT_DOWNLOAD_ADDED="dvbFontDownloadAdded",A.DVB_FONT_DOWNLOAD_COMPLETE="dvbFontDownloadComplete",A.DVB_FONT_DOWNLOAD_FAILED="dvbFontDownloadFailed",A.DYNAMIC_TO_STATIC="dynamicToStatic",A.ERROR="error",A.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",A.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",A.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",A.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",A.LOG="log",A.MANIFEST_LOADING_STARTED="manifestLoadingStarted",A.MANIFEST_LOADING_FINISHED="manifestLoadingFinished",A.MANIFEST_LOADED="manifestLoaded",A.METRICS_CHANGED="metricsChanged",A.METRIC_CHANGED="metricChanged",A.METRIC_ADDED="metricAdded",A.METRIC_UPDATED="metricUpdated",A.PERIOD_SWITCH_STARTED="periodSwitchStarted",A.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",A.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",A.QUALITY_CHANGE_RENDERED="qualityChangeRendered",A.TRACK_CHANGE_RENDERED="trackChangeRendered",A.STREAM_INITIALIZING="streamInitializing",A.STREAM_UPDATED="streamUpdated",A.STREAM_ACTIVATED="streamActivated",A.STREAM_DEACTIVATED="streamDeactivated",A.STREAM_INITIALIZED="streamInitialized",A.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",A.TEXT_TRACKS_ADDED="allTextTracksAdded",A.TEXT_TRACK_ADDED="textTrackAdded",A.CUE_ENTER="cueEnter",A.CUE_EXIT="cueExit",A.THROUGHPUT_MEASUREMENT_STORED="throughputMeasurementStored",A.TTML_PARSED="ttmlParsed",A.TTML_TO_PARSE="ttmlToParse",A.CAPTION_RENDERED="captionRendered",A.CAPTION_CONTAINER_RESIZE="captionContainerResize",A.CAN_PLAY="canPlay",A.CAN_PLAY_THROUGH="canPlayThrough",A.PLAYBACK_ENDED="playbackEnded",A.PLAYBACK_ERROR="playbackError",A.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",A.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",A.PLAYBACK_LOADED_DATA="playbackLoadedData",A.PLAYBACK_PAUSED="playbackPaused",A.PLAYBACK_PLAYING="playbackPlaying",A.PLAYBACK_PROGRESS="playbackProgress",A.PLAYBACK_RATE_CHANGED="playbackRateChanged",A.PLAYBACK_SEEKED="playbackSeeked",A.PLAYBACK_SEEKING="playbackSeeking",A.PLAYBACK_STALLED="playbackStalled",A.PLAYBACK_STARTED="playbackStarted",A.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",A.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",A.PLAYBACK_WAITING="playbackWaiting",A.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",A.EVENT_MODE_ON_START="eventModeOnStart",A.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",A.CONFORMANCE_VIOLATION="conformanceViolation",A.REPRESENTATION_SWITCH="representationSwitch",A.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",A.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",A.INBAND_PRFT="inbandPrft",A.MANAGED_MEDIA_SOURCE_START_STREAMING="managedMediaSourceStartStreaming",A.MANAGED_MEDIA_SOURCE_END_STREAMING="managedMediaSourceEndStreaming",A}return T})(g(8342).Z));y.Z=S},3393:function(f,y){function g(m,u){for(var d=0;d<u.length;d++){var S=u[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(m,S.key,S)}}var p=new((function(){function m(){(function(S,_){if(!(S instanceof _))throw new TypeError("Cannot call a class as a function")})(this,m),this.init()}var u,d;return u=m,(d=[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.CONTENT_STEERING="contentSteering",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.TEXT_DISABLED="disabled",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.FONT_DOWNLOAD_DVB_SCHEME="urn:dvb:dash:fontdownload:2014",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.OFF_MIMETYPE="application/font-sfnt",this.WOFF_MIMETYPE="application/font-woff",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},this.FILE_LOADER_TYPES={FETCH:"fetch_loader",XHR:"xhr_loader"}}}])&&g(u.prototype,d),m})());y.Z=p},3860:function(f,y){function g(m,u){for(var d=0;d<u.length;d++){var S=u[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(m,S.key,S)}}var p=new((function(){function m(){(function(S,_){if(!(S instanceof _))throw new TypeError("Cannot call a class as a function")})(this,m),this.init()}var u,d;return u=m,(d=[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors",this.HTTP_REQUEST_DVB_REPORTING_TYPE="DVBReporting"}}])&&g(u.prototype,d),m})());y.Z=p},8080:function(f,y,g){g.d(y,{default:function(){return G}});var p=function V(){(function(ye,he){if(!(ye instanceof he))throw new TypeError("Cannot call a class as a function")})(this,V),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};p.SSL_CONNECTION_FAILED_PREFIX="SSL",p.DNS_RESOLUTION_FAILED="C00",p.HOST_UNREACHABLE="C01",p.CONNECTION_REFUSED="C02",p.CONNECTION_ERROR="C03",p.CORRUPT_MEDIA_ISOBMFF="M00",p.CORRUPT_MEDIA_OTHER="M01",p.BASE_URL_CHANGED="F00",p.BECAME_REPORTER="S00";var m=p,u=g(1180);function d(V){var ye,he,He=(V=V||{}).eventBus,ut=V.dashMetrics,Je=V.metricsConstants,Qe=V.events;function Ye(Wt){var ln=new m;if(he){for(var cn in Wt)Wt.hasOwnProperty(cn)&&(ln[cn]=Wt[cn]);ln.mpdurl||(ln.mpdurl=he.originalUrl||he.url),ln.terror||(ln.terror=new Date),ut.addDVBErrors(ln)}}function nt(Wt){Wt.error||(he=Wt.manifest)}function mt(Wt){Ye({errorcode:m.BASE_URL_CHANGED,servicelocation:Wt.entry})}function Gt(){Ye({errorcode:m.BECAME_REPORTER})}function _t(Wt){var ln;Wt.metric===Je.HTTP_REQUEST&&((ln=Wt.value).responsecode===0||ln.responsecode==null||ln.responsecode>=400||ln.responsecode<100||ln.responsecode>=600)&&Ye({errorcode:ln.responsecode||m.CONNECTION_ERROR,url:ln.url,terror:ln.tresponse,servicelocation:ln._serviceLocation})}function gn(Wt){var ln;switch(Wt.error?Wt.error.code:0){case MediaError.MEDIA_ERR_NETWORK:ln=m.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:ln=m.CORRUPT_MEDIA_OTHER;break;default:return}Ye({errorcode:ln})}return ye={initialize:function(){He.on(Qe.MANIFEST_UPDATED,nt,ye),He.on(Qe.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,mt,ye),He.on(Qe.METRIC_ADDED,_t,ye),He.on(Qe.METRIC_UPDATED,_t,ye),He.on(Qe.PLAYBACK_ERROR,gn,ye),He.on(u.Z.BECAME_REPORTING_PLAYER,Gt,ye)},reset:function(){He.off(Qe.MANIFEST_UPDATED,nt,ye),He.off(Qe.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,mt,ye),He.off(Qe.METRIC_ADDED,_t,ye),He.off(Qe.METRIC_UPDATED,_t,ye),He.off(Qe.PLAYBACK_ERROR,gn,ye),He.off(u.Z.BECAME_REPORTING_PLAYER,Gt,ye)}}}d.__dashjs_factory_name="DVBErrorsTranslator";var S=dashjs.FactoryMaker.getSingletonFactory(d),_=g(2295);function E(V){V=V||{};var ye,he,He=!1,ut=this.context,Je=V.mediaElement;return ye={initialize:function(Qe){Qe&&Qe.length&&(Qe.forEach((function(Ye){var nt=Ye.starttime,mt=nt+Ye.duration;he.add(nt,mt)})),He=!!Qe[0]._useWallClockTime)},reset:function(){he.clear()},isEnabled:function(){var Qe,Ye=he.length;if(!Ye)return!0;Qe=He?new Date().getTime()/1e3:Je.currentTime;for(var nt=0;nt<Ye;nt+=1){var mt=he.start(nt),Gt=he.end(nt);if(mt<=Qe&&Qe<Gt)return!0}return!1}},he=(0,_.Z)(ut).create(),ye}E.__dashjs_factory_name="RangeController";var b=dashjs.FactoryMaker.getClassFactory(E);function I(){return{serialise:function V(ye){var he,He,ut=[],Je=[];for(he in ye)if(ye.hasOwnProperty(he)&&he.indexOf("_")!==0){if((He=ye[he])==null&&(He=""),Array.isArray(He)){if(!He.length)continue;Je=[],He.forEach((function(Qe){var Ye=Object.prototype.toString.call(Qe).slice(8,-1)!=="Object";Je.push(Ye?Qe:V(Qe))})),He=Je.map(encodeURIComponent).join(",")}else typeof He=="string"?He=encodeURIComponent(He):He instanceof Date?He=He.toISOString():typeof He=="number"&&(He=Math.round(He));ut.push(he+"="+He)}return ut.join("&")}}}I.__dashjs_factory_name="MetricSerialiser";var T=dashjs.FactoryMaker.getSingletonFactory(I);function A(){var V,ye,he,He=window.crypto||window.msCrypto,ut=Uint32Array,Je=Math.pow(2,8*ut.BYTES_PER_ELEMENT)-1;function Qe(){He&&(V||(V=new ut(10)),He.getRandomValues(V),ye=0)}return he={random:function(Ye,nt){var mt;return Ye||(Ye=0),nt||(nt=1),He?(ye===V.length&&Qe(),mt=V[ye]/Je,ye+=1):mt=Math.random(),mt*(nt-Ye)+Ye}},Qe(),he}A.__dashjs_factory_name="RNG";var R=dashjs.FactoryMaker.getSingletonFactory(A),O=g(5717);function H(V){var ye;V=V||{};var he,He,ut,Je,Qe,Ye,nt,mt=this.context,Gt=[],_t=V.metricsConstants;function gn(){Je=!1,Qe=!1,Ye=null,nt=null}return ye={report:function(Wt,ln){Array.isArray(ln)||(ln=[ln]),Qe&&nt.isEnabled()&&ln.forEach((function(cn){var On=he.serialise(cn);Wt!==_t.DVB_ERRORS&&(On="metricname=".concat(Wt,"&").concat(On)),(function(zn,ar,er){var Rr=new XMLHttpRequest;Rr.withCredentials=He.getXHRWithCredentialsForType(_t.HTTP_REQUEST_DVB_REPORTING_TYPE);var li=function(){var gr=Gt.indexOf(Rr);gr!==-1&&(Gt.splice(gr,1),!(Rr.status>=200&&Rr.status<300)&&er&&er())};Gt.push(Rr);try{Rr.open("GET",zn),Rr.onloadend=li,Rr.onerror=li,Rr.send()}catch{Rr.onerror()}})(On="".concat(Ye,"?").concat(On),0,(function(){Qe=!1}))}))},initialize:function(Wt,ln){var cn;if(nt=ln,!(Ye=Wt.dvbReportingUrl))throw new Error("required parameter missing (dvb:reportingUrl)");Je||((cn=Wt.dvbProbability)&&(cn===1e3||cn/1e3>=ut.random())&&(Qe=!0),Je=!0)},reset:function(){gn()}},he=T(mt).getInstance(),ut=R(mt).getInstance(),He=(0,O.Z)(mt).getInstance(),gn(),ye}H.__dashjs_factory_name="DVBReporting";var U=dashjs.FactoryMaker.getClassFactory(H);function Z(V){V=V||{};var ye,he={"urn:dvb:dash:reporting:2014":U},He=this.context,ut=V.debug?V.debug.getLogger(ye):{},Je=V.metricsConstants,Qe=V.mediaPlayerModel||{};return{create:function(Ye,nt){var mt;try{(mt=he[Ye.schemeIdUri](He).create({metricsConstants:Je,mediaPlayerModel:Qe})).initialize(Ye,nt)}catch(Gt){mt=null,ut.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(Ye.schemeIdUri," (").concat(Gt.message,")"))}return mt},register:function(Ye,nt){he[Ye]=nt},unregister:function(Ye){delete he[Ye]}}}Z.__dashjs_factory_name="ReportingFactory";var $=dashjs.FactoryMaker.getSingletonFactory(Z);function F(V){var ye=[],he=$(this.context).getInstance(V);return{initialize:function(He,ut){He.some((function(Je){var Qe=he.create(Je,ut);if(Qe)return ye.push(Qe),!0}))},reset:function(){ye.forEach((function(He){return He.reset()})),ye=[]},report:function(He,ut){ye.forEach((function(Je){return Je.report(He,ut)}))}}}F.__dashjs_factory_name="ReportingController";var W=dashjs.FactoryMaker.getClassFactory(F);function fe(){return{reconstructFullMetricName:function(V,ye,he){var He=V;return ye&&(He+="("+ye,he&&he.length&&(He+=","+he),He+=")"),He},validateN:function(V){if(!V)throw new Error("missing n");if(isNaN(V))throw new Error("n is NaN");if(V<0)throw new Error("n must be positive");return V}}}fe.__dashjs_factory_name="HandlerHelpers";var ne=dashjs.FactoryMaker.getSingletonFactory(fe);function de(V){var ye,he,He,ut,Je;V=V||{};var Qe=this.context,Ye=ne(Qe).getInstance(),nt=[],mt=V.metricsConstants;function Gt(){var _t=(function(){try{return Object.keys(nt).map((function(gn){return nt[gn]})).reduce((function(gn,Wt){return gn.level<Wt.level?gn:Wt}))}catch{return}})();_t&&Je!==_t.t&&(Je=_t.t,ye.report(He,_t))}return{initialize:function(_t,gn,Wt){gn&&(he=Ye.validateN(Wt),ye=gn,He=Ye.reconstructFullMetricName(_t,Wt),ut=setInterval(Gt,he))},reset:function(){clearInterval(ut),ut=null,he=0,ye=null,Je=null},handleNewMetric:function(_t,gn,Wt){_t===mt.BUFFER_LEVEL&&(nt[Wt]=gn)}}}de.__dashjs_factory_name="BufferLevelHandler";var Te=dashjs.FactoryMaker.getClassFactory(de),me=dashjs.FactoryMaker.getClassFactory((function(V){var ye,he=(V=V||{}).eventBus,He=V.metricsConstants;function ut(){he.off(u.Z.METRICS_INITIALISATION_COMPLETE,ut,this),he.trigger(u.Z.BECAME_REPORTING_PLAYER)}return{initialize:function(Je,Qe){Qe&&(ye=Qe,he.on(u.Z.METRICS_INITIALISATION_COMPLETE,ut,this))},reset:function(){ye=null},handleNewMetric:function(Je,Qe){Je===He.DVB_ERRORS&&ye&&ye.report(Je,Qe)}}}));function X(V){var ye,he,He,ut,Je;V=V||{};var Qe=[],Ye=ne(this.context).getInstance(),nt=V.metricsConstants;function mt(){var Gt=Qe;Gt.length&&ye&&ye.report(ut,Gt),Qe=[]}return{initialize:function(Gt,_t,gn,Wt){_t&&(he=Ye.validateN(gn),ye=_t,Wt&&Wt.length&&(He=Wt),ut=Ye.reconstructFullMetricName(Gt,gn,Wt),Je=setInterval(mt,he))},reset:function(){clearInterval(Je),Je=null,he=null,He=null,Qe=[],ye=null},handleNewMetric:function(Gt,_t){Gt===nt.HTTP_REQUEST&&(He&&He!==_t.type||Qe.push(_t))}}}X.__dashjs_factory_name="HttpListHandler";var Ie=dashjs.FactoryMaker.getClassFactory(X);function Be(){var V,ye;return{initialize:function(he,He){V=he,ye=He},reset:function(){ye=null,V=void 0},handleNewMetric:function(he,He){he===V&&ye&&ye.report(V,He)}}}Be.__dashjs_factory_name="GenericMetricHandler";var qe=dashjs.FactoryMaker.getClassFactory(Be);function ee(V){var ye,he=(V=V||{}).debug?V.debug.getLogger(ye):{},He=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,ut=this.context,Je={BufferLevel:Te,DVBErrors:me,HttpList:Ie,PlayList:qe,RepSwitchList:qe,TcpList:qe};return{create:function(Qe,Ye){var nt,mt=Qe.match(He);if(mt){try{(nt=Je[mt[1]](ut).create({eventBus:V.eventBus,metricsConstants:V.metricsConstants})).initialize(mt[1],Ye,mt[3],mt[5])}catch(Gt){nt=null,he.error("MetricsHandlerFactory: Could not create handler for type ".concat(mt[1]," with args ").concat(mt[3],", ").concat(mt[5]," (").concat(Gt.message,")"))}return nt}},register:function(Qe,Ye){Je[Qe]=Ye},unregister:function(Qe){delete Je[Qe]}}}ee.__dashjs_factory_name="MetricsHandlerFactory";var _e=dashjs.FactoryMaker.getSingletonFactory(ee);function Ze(V){V=V||{};var ye,he=[],He=this.context,ut=V.eventBus,Je=V.events,Qe=_e(He).getInstance({debug:V.debug,eventBus:V.eventBus,metricsConstants:V.metricsConstants});function Ye(nt){he.forEach((function(mt){mt.handleNewMetric(nt.metric,nt.value,nt.mediaType)}))}return ye={initialize:function(nt,mt){nt.split(",").forEach((function(Gt,_t,gn){var Wt;if(Gt.indexOf("(")!==-1&&Gt.indexOf(")")===-1){var ln=gn[_t+1];ln&&ln.indexOf("(")===-1&&ln.indexOf(")")!==-1&&(Gt+=","+ln,delete gn[_t+1])}(Wt=Qe.create(Gt,mt))&&he.push(Wt)})),ut.on(Je.METRIC_ADDED,Ye,ye),ut.on(Je.METRIC_UPDATED,Ye,ye)},reset:function(){ut.off(Je.METRIC_ADDED,Ye,ye),ut.off(Je.METRIC_UPDATED,Ye,ye),he.forEach((function(nt){return nt.reset()})),he=[]}}}Ze.__dashjs_factory_name="MetricsHandlersController";var Ke=dashjs.FactoryMaker.getClassFactory(Ze);function De(V){var ye,he,He;V=V||{};var ut=this.context;function Je(){ye&&ye.reset(),he&&he.reset(),He&&He.reset()}return{initialize:function(Qe){try{(He=b(ut).create({mediaElement:V.mediaElement})).initialize(Qe.Range),(he=W(ut).create({debug:V.debug,metricsConstants:V.metricsConstants,mediaPlayerModel:V.mediaPlayerModel})).initialize(Qe.Reporting,He),(ye=Ke(ut).create({debug:V.debug,eventBus:V.eventBus,metricsConstants:V.metricsConstants,events:V.events})).initialize(Qe.metrics,he)}catch(Ye){throw Je(),Ye}},reset:Je}}De.__dashjs_factory_name="MetricsController";var Ge=dashjs.FactoryMaker.getClassFactory(De),Et=function V(){(function(ye,he){if(!(ye instanceof he))throw new TypeError("Cannot call a class as a function")})(this,V),this.metrics="",this.Range=[],this.Reporting=[]},vt=function V(){(function(ye,he){if(!(ye instanceof he))throw new TypeError("Cannot call a class as a function")})(this,V),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1},et=function V(){(function(ye,he){if(!(ye instanceof he))throw new TypeError("Cannot call a class as a function")})(this,V),this.schemeIdUri="",this.value="",this.dvbReportingUrl="",this.dvbProbability=1e3};function gt(V){var ye=(V=V||{}).adapter,he=V.constants;return{getMetrics:function(He){var ut=[];return He&&He.Metrics_asArray&&He.Metrics_asArray.forEach((function(Je){var Qe=new Et,Ye=ye.getIsDynamic(He);Je.hasOwnProperty("metrics")&&(Qe.metrics=Je.metrics,Je.Range_asArray&&Je.Range_asArray.forEach((function(nt){var mt=new vt;mt.starttime=(function(Gt,_t,gn){var Wt,ln,cn=0;return _t?cn=ye.getAvailabilityStartTime(Gt)/1e3:(Wt=ye.getRegularPeriods(Gt)).length&&(cn=Wt[0].start),ln=cn,gn&&gn.hasOwnProperty(he.START_TIME)&&(ln+=gn.starttime),ln})(He,Ye,nt),nt.hasOwnProperty("duration")?mt.duration=nt.duration:mt.duration=ye.getDuration(He),mt._useWallClockTime=Ye,Qe.Range.push(mt)})),Je.Reporting_asArray&&(Je.Reporting_asArray.forEach((function(nt){var mt=new et;nt.hasOwnProperty(he.SCHEME_ID_URI)&&(mt.schemeIdUri=nt.schemeIdUri,nt.hasOwnProperty("value")&&(mt.value=nt.value),nt.hasOwnProperty(he.DVB_REPORTING_URL)&&(mt.dvbReportingUrl=nt[he.DVB_REPORTING_URL]),nt.hasOwnProperty(he.DVB_PROBABILITY)&&(mt.dvbProbability=nt[he.DVB_PROBABILITY]),Qe.Reporting.push(mt))})),ut.push(Qe)))})),ut}}}gt.__dashjs_factory_name="ManifestParsing";var Oe=dashjs.FactoryMaker.getSingletonFactory(gt);function Fe(V){var ye;V=V||{};var he={},He=this.context,ut=V.eventBus,Je=V.events;function Qe(nt){if(!nt.error){var mt=Object.keys(he);Oe(He).getInstance({adapter:V.adapter,constants:V.constants}).getMetrics(nt.manifest).forEach((function(Gt){var _t=JSON.stringify(Gt);if(he.hasOwnProperty(_t))mt.splice(_t,1);else try{var gn=Ge(He).create(V);gn.initialize(Gt),he[_t]=gn}catch{}})),mt.forEach((function(Gt){he[Gt].reset(),delete he[Gt]})),ut.trigger(u.Z.METRICS_INITIALISATION_COMPLETE)}}function Ye(){Object.keys(he).forEach((function(nt){he[nt].reset()})),he={}}return ye={reset:function(){ut.off(Je.MANIFEST_UPDATED,Qe,ye),ut.off(Je.STREAM_TEARDOWN_COMPLETE,Ye,ye)}},ut.on(Je.MANIFEST_UPDATED,Qe,ye),ut.on(Je.STREAM_TEARDOWN_COMPLETE,Ye,ye),ye}Fe.__dashjs_factory_name="MetricsCollectionController";var it=dashjs.FactoryMaker.getClassFactory(Fe);function w(){var V=this.context;return{createMetricsReporting:function(ye){return S(V).getInstance({eventBus:ye.eventBus,dashMetrics:ye.dashMetrics,metricsConstants:ye.metricsConstants,events:ye.events}).initialize(),it(V).create(ye)},getReportingFactory:function(){return $(V).getInstance()},getMetricsHandlerFactory:function(){return _e(V).getInstance()}}}w.__dashjs_factory_name="MetricsReporting";var N=dashjs.FactoryMaker.getClassFactory(w);N.events=u.Z,dashjs.FactoryMaker.updateClassFactory(w.__dashjs_factory_name,N);var G=N},1180:function(f,y,g){function p(_){return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},p(_)}function m(_,E){return m=Object.setPrototypeOf||function(b,I){return b.__proto__=I,b},m(_,E)}function u(_,E){return!E||p(E)!=="object"&&typeof E!="function"?(function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b})(_):E}function d(_){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)},d(_)}var S=new((function(_){(function(A,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(R&&R.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),R&&m(A,R)})(T,_);var E,b,I=(E=T,b=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var A,R=d(E);if(b){var O=d(this).constructor;A=Reflect.construct(R,arguments,O)}else A=R.apply(this,arguments);return u(this,A)});function T(){var A;return(function(R,O){if(!(R instanceof O))throw new TypeError("Cannot call a class as a function")})(this,T),(A=I.call(this)).METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",A.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",A.CMCD_DATA_GENERATED="cmcdDataGenerated",A}return T})(g(8342).Z));y.Z=S},5717:function(f,y,g){var p=g(2610),m=g(5448),u=g(1264),d=g(3106),S=g(1767),_=g(3393);function E(){var b,I,T,A,R,O,H,U,Z=this.context,$=(0,u.Z)(Z).getInstance();function F(){A=[],R=[],O=[],U=[],H=null,I=[]}function W(Te,me){var X=-1;Te.some((function(Ie,Be){if(Ie===me)return X=Be,!0})),X<0||Te.splice(X,1)}function fe(Te){var me;for(me=0;me<U.length;me++)if(U[me].rulename===Te)return me;return-1}function ne(Te,me){de(Te,me);var X=new p.Z;X.schemeIdUri=Te,X.value=me,I.push(X)}function de(Te,me){(0,d.PS)(Te,"string"),(0,d.PS)(me,"string"),I.forEach((function(X,Ie){X.schemeIdUri===Te&&X.value===me&&I.splice(Ie,1)}))}return b={getCustomInitialTrackSelectionFunction:function(){return H},setCustomInitialTrackSelectionFunction:function(Te){H=Te},resetCustomInitialTrackSelectionFunction:function(){H=null},getLicenseResponseFilters:function(){return R},getLicenseRequestFilters:function(){return A},getCustomCapabilitiesFilters:function(){return O},registerCustomCapabilitiesFilter:function(Te){O.push(Te)},registerLicenseResponseFilter:function(Te){R.push(Te)},registerLicenseRequestFilter:function(Te){A.push(Te)},unregisterCustomCapabilitiesFilter:function(Te){W(O,Te)},unregisterLicenseResponseFilter:function(Te){W(R,Te)},unregisterLicenseRequestFilter:function(Te){W(A,Te)},addAbrCustomRule:function(Te,me,X){if(typeof Te!="string"||Te!==S.Z.ABANDON_FRAGMENT_RULES&&Te!==S.Z.QUALITY_SWITCH_RULES||typeof me!="string")throw _.Z.BAD_ARGUMENT_ERROR;var Ie=fe(me);Ie===-1?U.push({type:Te,rulename:me,rule:X}):(U[Ie].type=Te,U[Ie].rule=X)},removeAllAbrCustomRule:function(){U=[]},removeAbrCustomRule:function(Te){if(Te){var me=fe(Te);me!==-1&&U.splice(me,1)}else U=[]},getAbrCustomRules:function(){return U},addUTCTimingSource:ne,removeUTCTimingSource:de,getUTCTimingSources:function(){return I},clearDefaultUTCTimingSources:function(){I=[]},restoreDefaultUTCTimingSources:function(){var Te=$.get().streaming.utcSynchronization.defaultTimingSource;ne(Te.scheme,Te.value)},setXHRWithCredentialsForType:function Te(me,X){me?T[me]=!!X:Object.keys(T).forEach((function(Ie){Te(Ie,X)}))},getXHRWithCredentialsForType:function(Te){var me=T[Te];return me===void 0?T.default:me},setConfig:function(){},reset:function(){F()}},T={default:!1},F(),b}E.__dashjs_factory_name="CustomParametersModel",y.Z=m.Z.getSingletonFactory(E)},9032:function(f,y,g){var p=g(5448),m=g(7473);function u(S){var _=(S=S||{}).requestModifier;function E(b){var I=new Date,T=b.request,A=new XMLHttpRequest;if(A.open(b.method,b.url,!0),T.responseType&&(A.responseType=T.responseType),T.range&&A.setRequestHeader("Range","bytes="+T.range),T.requestStartDate||(T.requestStartDate=I),_&&_.modifyRequestHeader&&(A=_.modifyRequestHeader(A,{url:b.url})),b.headers)for(var R in b.headers){var O=b.headers[R];O&&A.setRequestHeader(R,O)}A.withCredentials=b.withCredentials,A.onload=b.onload,A.onloadend=b.onend,A.onerror=b.onerror,A.onprogress=b.progress,A.onabort=b.onabort,A.ontimeout=b.ontimeout,A.timeout=b.timeout,A.send(),b.response=A}return{load:function(b){_&&_.modifyRequest?(0,m.k)(b,_).then((function(){return E(b)})):E(b)},abort:function(b){var I=b.response;I.onloadend=I.onerror=I.onprogress=void 0,I.abort()}}}u.__dashjs_factory_name="XHRLoader";var d=p.Z.getClassFactory(u);y.Z=d},1737:function(f,y,g){function p(qt,Vt){for(var Kt=0;Kt<Vt.length;Kt++){var at=Vt[Kt];at.enumerable=at.enumerable||!1,at.configurable=!0,"value"in at&&(at.writable=!0),Object.defineProperty(qt,at.key,at)}}g.d(y,{default:function(){return Us}});var m={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]},u=(function(){function qt(){(function(at,Ot){if(!(at instanceof Ot))throw new TypeError("Cannot call a class as a function")})(this,qt)}var Vt,Kt;return Vt=qt,Kt=[{key:"findCencContentProtection",value:function(at){for(var Ot=null,ct=0;ct<at.length;++ct){var It=at[ct];It.schemeIdUri.toLowerCase()!=="urn:mpeg:dash:mp4protection:2011"||It.value.toLowerCase()!=="cenc"&&It.value.toLowerCase()!=="cbcs"||(Ot=It)}return Ot}},{key:"getPSSHData",value:function(at){var Ot=8,ct=new DataView(at),It=ct.getUint8(Ot);return Ot+=20,It>0&&(Ot+=4+16*ct.getUint32(Ot)),Ot+=4,at.slice(Ot)}},{key:"getPSSHForKeySystem",value:function(at,Ot){var ct=qt.parsePSSHList(Ot);return at&&ct.hasOwnProperty(at.uuid.toLowerCase())?ct[at.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(at,Ot){return"pssh"in at?(at.pssh.__text=at.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),Ot.decodeArray(at.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(at){if(at==null)return[];for(var Ot=new DataView(at.buffer||at),ct={},It=0;;){var sn,fn,Rn=void 0,In=It;if(It>=Ot.buffer.byteLength)break;if(sn=It+Ot.getUint32(It),It+=4,Ot.getUint32(It)===1886614376)if(It+=4,(fn=Ot.getUint8(It))===0||fn===1){It++,It+=3,Rn="";var Jt=void 0,Pt=void 0;for(Jt=0;Jt<4;Jt++)Rn+=(Pt=Ot.getUint8(It+Jt).toString(16)).length===1?"0"+Pt:Pt;for(It+=4,Rn+="-",Jt=0;Jt<2;Jt++)Rn+=(Pt=Ot.getUint8(It+Jt).toString(16)).length===1?"0"+Pt:Pt;for(It+=2,Rn+="-",Jt=0;Jt<2;Jt++)Rn+=(Pt=Ot.getUint8(It+Jt).toString(16)).length===1?"0"+Pt:Pt;for(It+=2,Rn+="-",Jt=0;Jt<2;Jt++)Rn+=(Pt=Ot.getUint8(It+Jt).toString(16)).length===1?"0"+Pt:Pt;for(It+=2,Rn+="-",Jt=0;Jt<6;Jt++)Rn+=(Pt=Ot.getUint8(It+Jt).toString(16)).length===1?"0"+Pt:Pt;It+=6,It+=4,ct[Rn=Rn.toLowerCase()]=Ot.buffer.slice(In,sn),It=sn}else It=sn;else It=sn}return ct}},{key:"getLicenseServerUrlFromMediaInfo",value:function(at,Ot){try{if(!at||at.length===0)return null;for(var ct=0,It=null;ct<at.length&&!It;){var sn=at[ct];if(sn&&sn.contentProtection&&sn.contentProtection.length>0){var fn=sn.contentProtection.filter((function(Gn){return Gn.schemeIdUri&&Gn.schemeIdUri===Ot}));if(fn&&fn.length>0)for(var Rn=0;Rn<fn.length&&!It;){for(var In=fn[Rn],Jt=0;Jt<m.attributes.length&&!It;){for(var Pt=0,bn=m.attributes[Jt];Pt<m.prefixes.length&&!It;){var Sn=m.prefixes[Pt];In[bn]&&In[bn].__prefix&&In[bn].__prefix===Sn&&In[bn].__text&&(It=In[bn].__text),Pt+=1}Jt+=1}Rn+=1}}ct+=1}return It}catch{return null}}}],Kt&&p(Vt,Kt),qt})(),d=function qt(Vt,Kt){(function(at,Ot){if(!(at instanceof Ot))throw new TypeError("Cannot call a class as a function")})(this,qt),this.contentType=Vt,this.robustness=Kt},S=function qt(Vt,Kt,at,Ot,ct){(function(It,sn){if(!(It instanceof sn))throw new TypeError("Cannot call a class as a function")})(this,qt),this.initDataTypes=["cenc"],Vt&&Vt.length&&(this.audioCapabilities=Vt),Kt&&Kt.length&&(this.videoCapabilities=Kt),this.distinctiveIdentifier=at,this.persistentState=Ot,this.sessionTypes=ct};function _(qt){return _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Vt){return typeof Vt}:function(Vt){return Vt&&typeof Symbol=="function"&&Vt.constructor===Symbol&&Vt!==Symbol.prototype?"symbol":typeof Vt},_(qt)}function E(qt,Vt){return E=Object.setPrototypeOf||function(Kt,at){return Kt.__proto__=at,Kt},E(qt,Vt)}function b(qt,Vt){return!Vt||_(Vt)!=="object"&&typeof Vt!="function"?(function(Kt){if(Kt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Kt})(qt):Vt}function I(qt){return I=Object.setPrototypeOf?Object.getPrototypeOf:function(Vt){return Vt.__proto__||Object.getPrototypeOf(Vt)},I(qt)}var T=new((function(qt){(function(ct,It){if(typeof It!="function"&&It!==null)throw new TypeError("Super expression must either be null or a function");ct.prototype=Object.create(It&&It.prototype,{constructor:{value:ct,writable:!0,configurable:!0}}),It&&E(ct,It)})(Ot,qt);var Vt,Kt,at=(Vt=Ot,Kt=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var ct,It=I(Vt);if(Kt){var sn=I(this).constructor;ct=Reflect.construct(It,arguments,sn)}else ct=It.apply(this,arguments);return b(this,ct)});function Ot(){var ct;return(function(It,sn){if(!(It instanceof sn))throw new TypeError("Cannot call a class as a function")})(this,Ot),(ct=at.call(this)).MEDIA_KEYERR_CODE=100,ct.MEDIA_KEYERR_UNKNOWN_CODE=101,ct.MEDIA_KEYERR_CLIENT_CODE=102,ct.MEDIA_KEYERR_SERVICE_CODE=103,ct.MEDIA_KEYERR_OUTPUT_CODE=104,ct.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,ct.MEDIA_KEYERR_DOMAIN_CODE=106,ct.MEDIA_KEY_MESSAGE_ERROR_CODE=107,ct.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,ct.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,ct.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,ct.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,ct.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,ct.KEY_SESSION_CREATED_ERROR_CODE=113,ct.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,ct.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",ct.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",ct.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",ct.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",ct.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",ct.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",ct.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",ct.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",ct.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",ct.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",ct.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",ct.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",ct.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",ct.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",ct}return Ot})(g(2230).Z)),A=g(5459),R=function qt(Vt,Kt,at,Ot,ct,It,sn,fn){(function(Rn,In){if(!(Rn instanceof In))throw new TypeError("Cannot call a class as a function")})(this,qt),this.url=Vt,this.method=Kt,this.responseType=at,this.headers=Ot,this.withCredentials=ct,this.messageType=It,this.sessionId=sn,this.data=fn},O=function qt(Vt,Kt,at){(function(Ot,ct){if(!(Ot instanceof ct))throw new TypeError("Cannot call a class as a function")})(this,qt),this.url=Vt,this.headers=Kt,this.data=at},H=g(7855),U=g(703),Z=g(3393),$=g(5448);function F(qt){return F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Vt){return typeof Vt}:function(Vt){return Vt&&typeof Symbol=="function"&&Vt.constructor===Symbol&&Vt!==Symbol.prototype?"symbol":typeof Vt},F(qt)}function W(qt){var Vt,Kt,at,Ot,ct,It,sn,fn,Rn,In,Jt,Pt=(qt=qt||{}).protectionKeyController,bn=qt.protectionModel,Sn=qt.eventBus,Gn=qt.events,tr=qt.debug,mr=qt.BASE64,xn=qt.constants,Ht=[],Yt=qt.cmcdModel,hn=qt.settings,Mn=qt.customParametersModel;function kn(){if(!(Sn&&Sn.hasOwnProperty("on")&&Pt&&Pt.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function $n(rn,Cn){fn||Rn?fn&&lr():(function(Xn,kr){if(!Rn){Rn=!0;var pr,Fr=[];Xn=Xn.sort((function(xr,Lr){return(ct&&ct[xr.ks.systemString]&&ct[xr.ks.systemString].priority>=0?ct[xr.ks.systemString].priority:Xn.length)-(ct&&ct[Lr.ks.systemString]&&ct[Lr.ks.systemString].priority>=0?ct[Lr.ks.systemString].priority:Xn.length)}));for(var _r=0;_r<Xn.length;_r++){var ki=cs(Xn[_r]);Fr.push({ks:Xn[_r].ks,configs:[ki],protData:Xn[_r].protData})}bn.requestKeySystemAccess(Fr).then((function(xr){var Lr=(pr=xr.data).mksa&&pr.mksa.selectedSystemString?pr.mksa.selectedSystemString:pr.keySystem.systemString;return Kt.info("DRM: KeySystem Access Granted for system string ("+Lr+")!  Selecting key system..."),bn.selectKeySystem(pr)})).then((function(xr){if(fn=xr,Rn=!1,bn){Sn.trigger(Gn.KEY_SYSTEM_SELECTED,{data:pr});var Lr=Jr(fn);Lr&&Lr.serverCertificate&&Lr.serverCertificate.length>0&&bn.setServerCertificate(mr.decodeArray(Lr.serverCertificate).buffer),lr()}})).catch((function(xr){fn=null,Rn=!1,kr||Sn.trigger(Gn.KEY_SYSTEM_SELECTED,{data:null,error:new A.Z(T.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,T.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+xr.error)})}))}})(rn,Cn)}function lr(){for(var rn,Cn=0;Cn<at.length;Cn++)for(rn=0;rn<at[Cn].length;rn++)if(fn===at[Cn][rn].ks){ci(at[Cn][rn]);break}at=[]}function ci(rn){if(Pt.isClearKey(fn)&&rn.protData&&rn.protData.hasOwnProperty("clearkeys")&&Object.keys(rn.protData.clearkeys).length!==0){var Cn={kids:Object.keys(rn.protData.clearkeys)};rn.initData=new TextEncoder().encode(JSON.stringify(Cn))}rn.sessionId?Kr(rn):rn.initData!==null&&Er(rn)}function Kr(rn){kn(),bn.loadKeySession(rn)}function Er(rn){var Cn=u.getPSSHForKeySystem(fn,rn?rn.initData:null);if(Cn){if((function(Xn){if(!Xn)return!1;try{for(var kr=bn.getSessions(),pr=0;pr<kr.length;pr++)if(kr[pr].getKeyId()===Xn)return!0;return!1}catch{return!1}})(rn.keyId)||Pr(Cn))return;try{rn.initData=Cn,bn.createKeySession(rn)}catch(Xn){Sn.trigger(Gn.KEY_SESSION_CREATED,{data:null,error:new A.Z(T.KEY_SESSION_CREATED_ERROR_CODE,T.KEY_SESSION_CREATED_ERROR_MESSAGE+Xn.message)})}}else rn&&rn.initData?bn.createKeySession(rn):Sn.trigger(Gn.KEY_SESSION_CREATED,{data:null,error:new A.Z(T.KEY_SESSION_CREATED_ERROR_CODE,T.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(fn?fn.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function Jr(rn){if(rn){var Cn=rn.systemString;if(ct)return Cn in ct?ct[Cn]:null}return null}function Pr(rn){if(!rn)return!1;try{for(var Cn=bn.getAllInitData(),Xn=0;Xn<Cn.length;Xn++)if(Pt.initDataEquals(rn,Cn[Xn]))return Kt.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch{return!1}}function fi(rn){kn(),rn?(bn.setMediaElement(rn),Sn.on(Gn.NEED_KEY,Ga,Vt)):rn===null&&(bn.setMediaElement(rn),Sn.off(Gn.NEED_KEY,Ga,Vt))}function cs(rn){var Cn=rn.protData,Xn=[],kr=[],pr=Cn&&Cn.audioRobustness&&Cn.audioRobustness.length>0?Cn.audioRobustness:sn,Fr=Cn&&Cn.videoRobustness&&Cn.videoRobustness.length>0?Cn.videoRobustness:sn,_r=rn.sessionType,ki=Cn&&Cn.distinctiveIdentifier?Cn.distinctiveIdentifier:"optional",xr=Cn&&Cn.persistentState?Cn.persistentState:_r==="temporary"?"optional":"required";return Ot.forEach((function(Lr){Lr.type===xn.AUDIO?Xn.push(new d(Lr.codec,pr)):Lr.type===xn.VIDEO&&kr.push(new d(Lr.codec,Fr))})),new S(Xn,kr,ki,xr,[_r])}function Di(rn){rn.error?Sn.trigger(Gn.KEY_STATUSES_CHANGED,{data:null,error:rn.error}):Kt.debug("DRM: key status = "+rn.status)}function Pi(rn){Kt.debug("DRM: onKeyMessage");var Cn=rn.data;Sn.trigger(Gn.KEY_MESSAGE,{data:Cn});var Xn=Cn.messageType?Cn.messageType:"license-request",kr=Cn.message,pr=Cn.sessionToken,Fr=Jr(fn),_r=Pt.getLicenseServerModelInstance(fn,Fr,Xn),ki={sessionToken:pr,messageType:Xn};if(kr&&kr.byteLength!==0){if(!_r)return Kt.debug("DRM: License server request not required for this message (type = "+rn.data.messageType+").  Session ID = "+pr.getSessionId()),void zr(ki);if(Pt.isClearKey(fn)){var xr=Pt.processClearKeyLicenseRequest(fn,Fr,kr);if(xr&&xr.keyPairs&&xr.keyPairs.length>0)return Kt.debug("DRM: ClearKey license request handled by application!"),zr(ki),void bn.updateKeySession(pr,xr)}(function(Lr,vi,Ei){var Bi=Lr.sessionToken,$i=Lr.messageType?Lr.messageType:"license-request",ua={sessionToken:Bi,messageType:$i},ca=fn?fn.systemString:null,Gi=(function(Tr,ms,Va,Ra,ol){var Hr=null,Ia=Ra.message;if(Tr&&Tr.serverURL){var da=Tr.serverURL;typeof da=="string"&&da!==""?Hr=da:F(da)==="object"&&da.hasOwnProperty(ms)&&(Hr=da[ms])}else if(Tr&&Tr.laURL&&Tr.laURL!=="")Hr=Tr.laURL;else if(!(Hr=u.getLicenseServerUrlFromMediaInfo(Ot,fn.schemeIdURI))&&!Pt.isClearKey(fn)){var ps=u.getPSSHData(Va.initData);(Hr=fn.getLicenseServerURLFromInitData(ps))||(Hr=Ra.laURL)}return Hr=ol.getServerURLFromMessage(Hr,Ia,ms)})(Ei,$i,Bi,Lr,vi);if(Gi){var fs={},ds=!1;Ei&&Pl(fs,Ei.httpRequestHeaders);var Za=Lr.message;Pl(fs,fn.getRequestHeadersFromMessage(Za)),Object.keys(fs).forEach((function(Tr){Tr.toLowerCase()==="authorization"&&(ds=!0)})),Ei&&typeof Ei.withCredentials=="boolean"&&(ds=Ei.withCredentials);var Ha=function(Tr){if(bn)if(Tr.status>=200&&Tr.status<=299){var ms=U.Z.parseHttpHeaders(Tr.getAllResponseHeaders?Tr.getAllResponseHeaders():null),Va=new O(Tr.responseURL,ms,Tr.response);rl(Mn.getLicenseResponseFilters(),Va).then((function(){var Ra=vi.getLicenseMessage(Va.data,ca,$i);Ra!==null?(zr(ua),bn.updateKeySession(Bi,Ra)):po(Tr,ua,ca,$i,vi)}))}else po(Tr,ua,ca,$i,vi)},kl=function(Tr){zr(ua,new A.Z(T.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,T.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+ca+' update, XHR aborted. status is "'+Tr.statusText+'" ('+Tr.status+"), readyState is "+Tr.readyState))},il=function(Tr){zr(ua,new A.Z(T.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,T.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+ca+' update, XHR error. status is "'+Tr.statusText+'" ('+Tr.status+"), readyState is "+Tr.readyState))},al=fn.getLicenseRequestFromMessage(Za),hs=vi.getHTTPMethod($i),fa=vi.getResponseType(ca,$i),Gs=Ei&&!isNaN(Ei.httpTimeout)?Ei.httpTimeout:8e3,gs=Bi.getSessionId()||null,Zi=new R(Gi,hs,fa,fs,ds,$i,gs,al),sl=isNaN(hn.get().streaming.retryAttempts[H.w.LICENSE])?3:hn.get().streaming.retryAttempts[H.w.LICENSE];rl(Mn.getLicenseRequestFilters(),Zi).then((function(){Li(Zi,sl,Gs,Ha,kl,il)}))}else zr(ua,new A.Z(T.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,T.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))})(Cn,_r,Fr)}else zr(ki,new A.Z(T.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,T.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function zr(rn,Cn){Sn.trigger(Gn.LICENSE_REQUEST_COMPLETE,{data:rn,error:Cn})}function Li(rn,Cn,Xn,kr,pr,Fr){var _r=new XMLHttpRequest;if(hn.get().streaming.cmcd&&hn.get().streaming.cmcd.enabled&&hn.get().streaming.cmcd.mode===Z.Z.CMCD_MODE_QUERY){var ki=Yt.getQueryParameter({url:rn.url,type:H.w.LICENSE});ki&&(rn.url=U.Z.addAditionalQueryParameterToUrl(rn.url,[ki]))}for(var xr in _r.open(rn.method,rn.url,!0),_r.responseType=rn.responseType,_r.withCredentials=rn.withCredentials,Xn>0&&(_r.timeout=Xn),rn.headers)_r.setRequestHeader(xr,rn.headers[xr]);if(hn.get().streaming.cmcd&&hn.get().streaming.cmcd.enabled&&hn.get().streaming.cmcd.mode===Z.Z.CMCD_MODE_HEADER){var Lr=Yt.getHeaderParameters({url:rn.url,type:H.w.LICENSE});if(Lr)for(var vi in Lr){var Ei=Lr[vi];Ei&&_r.setRequestHeader(vi,Ei)}}var Bi=function(){Cn--;var $i=isNaN(hn.get().streaming.retryIntervals[H.w.LICENSE])?1e3:hn.get().streaming.retryIntervals[H.w.LICENSE];Jt=setTimeout((function(){Li(rn,Cn,Xn,kr,pr,Fr)}),$i)};_r.onload=function(){In=null,this.status>=200&&this.status<=299||Cn<=0?kr(this):(Kt.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+Cn),Bi())},_r.ontimeout=_r.onerror=function(){In=null,Cn<=0?Fr(this):(Kt.warn("License request network request failed . Retrying it... Pending retries: "+Cn),Bi())},_r.onabort=function(){pr(this)},Sn.trigger(Gn.LICENSE_REQUEST_SENDING,{url:rn.url,headers:rn.headers,payload:rn.data,sessionId:rn.sessionId}),In=_r,_r.send(rn.data)}function Bs(){In&&(In.onloadend=In.onerror=In.onprogress=void 0,In.abort(),In=null),Jt&&(clearTimeout(Jt),Jt=null)}function Pl(rn,Cn){if(Cn)for(var Xn in Cn)rn[Xn]=Cn[Xn]}function po(rn,Cn,Xn,kr,pr){var Fr="NONE",_r=null;rn.response&&(Fr=pr.getErrorResponse(rn.response,Xn,kr),_r={serverResponse:rn.response||null,responseCode:rn.status||null,responseText:rn.statusText||null}),zr(Cn,new A.Z(T.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,T.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+Xn+' update, XHR complete. status is "'+rn.statusText+'" ('+rn.status+"), readyState is "+rn.readyState+".  Response is "+Fr,_r))}function rl(rn,Cn){return rn?rn.reduce((function(Xn,kr){return Xn.then((function(){return kr(Cn)}))}),Promise.resolve()):Promise.resolve()}function Ga(rn,Cn){if(!hn.get().streaming.protection.ignoreEmeEncryptedEvent){if(Kt.debug("DRM: onNeedKey"),rn.key.initDataType!=="cenc")return void Kt.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+rn.key.initDataType);if(Ot.length===0&&(Kt.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(Cn=Cn===void 0?1:Cn+1)<5))return void Ht.push(setTimeout((function(){Ga(rn,Cn)}),500));var Xn=rn.key.initData;if(ArrayBuffer.isView(Xn)&&(Xn=Xn.buffer),fn){var kr=u.getPSSHForKeySystem(fn,Xn);if(kr&&Pr(kr))return}Kt.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(Xn)));var pr=Pt.getSupportedKeySystemsFromSegmentPssh(Xn,ct,It);if(pr.length===0)return void Kt.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");(function(Fr){at.push(Fr),$n(Fr,!1)})(pr)}}return Vt={initializeForMedia:function(rn){if(!rn)throw new Error("mediaInfo can not be null or undefined");kn(),Ot.push(rn)},clearMediaInfoArray:function(){Ot=[]},handleKeySystemFromManifest:function(){if(Ot&&Ot.length!==0){var rn=[];Ot.forEach((function(Cn){var Xn=Pt.getSupportedKeySystemsFromContentProtection(Cn.contentProtection,ct,It);Xn.length>0&&(rn.length===0&&(rn=Xn),at.push(Xn))})),rn&&rn.length>0&&$n(rn,!0)}},createKeySession:Er,loadKeySession:Kr,removeKeySession:function(rn){kn(),bn.removeKeySession(rn)},closeKeySession:function(rn){kn(),bn.closeKeySession(rn)},setServerCertificate:function(rn){kn(),bn.setServerCertificate(rn)},setMediaElement:fi,setSessionType:function(rn){It=rn},setRobustnessLevel:function(rn){sn=rn},setProtectionData:function(rn){ct=rn,Pt.setProtectionData(rn)},getSupportedKeySystemsFromContentProtection:function(rn){return kn(),Pt.getSupportedKeySystemsFromContentProtection(rn,ct,It)},getKeySystems:function(){return Pt?Pt.getKeySystems():[]},setKeySystems:function(rn){Pt&&Pt.setKeySystems(rn)},stop:function(){Bs(),bn&&bn.stop()},reset:function(){Sn.off(Gn.INTERNAL_KEY_MESSAGE,Pi,Vt),Sn.off(Gn.INTERNAL_KEY_STATUS_CHANGED,Di,Vt),kn(),Bs(),fi(null),fn=null,Rn=!1,bn&&(bn.reset(),bn=null),Ht.forEach((function(rn){return clearTimeout(rn)})),Ht=[],Ot=[],at=[]}},Kt=tr.getLogger(Vt),at=[],Ot=[],It="temporary",sn="",In=null,Jt=null,Sn.on(Gn.INTERNAL_KEY_MESSAGE,Pi,Vt),Sn.on(Gn.INTERNAL_KEY_STATUS_CHANGED,Di,Vt),Vt}W.__dashjs_factory_name="ProtectionController";var fe=$.Z.getClassFactory(W),ne=function qt(Vt,Kt){(function(at,Ot){if(!(at instanceof Ot))throw new TypeError("Cannot call a class as a function")})(this,qt),this.keyID=Vt,this.key=Kt};function de(qt,Vt){for(var Kt=0;Kt<Vt.length;Kt++){var at=Vt[Kt];at.enumerable=at.enumerable||!1,at.configurable=!0,"value"in at&&(at.writable=!0),Object.defineProperty(qt,at.key,at)}}var Te=(function(){function qt(at,Ot){if((function(ct,It){if(!(ct instanceof It))throw new TypeError("Cannot call a class as a function")})(this,qt),Ot&&Ot!=="persistent"&&Ot!=="temporary")throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=at,this.type=Ot}var Vt,Kt;return Vt=qt,(Kt=[{key:"toJWK",value:function(){var at,Ot=this.keyPairs.length,ct={keys:[]};for(at=0;at<Ot;at++){var It={kty:"oct",alg:"A128KW",kid:this.keyPairs[at].keyID,k:this.keyPairs[at].key};ct.keys.push(It)}this.type&&(ct.type=this.type);var sn=JSON.stringify(ct),fn=sn.length,Rn=new ArrayBuffer(fn),In=new Uint8Array(Rn);for(at=0;at<fn;at++)In[at]=sn.charCodeAt(at);return Rn}}])&&de(Vt.prototype,Kt),qt})();function me(qt,Vt){for(var Kt=0;Kt<Vt.length;Kt++){var at=Vt[Kt];at.enumerable=at.enumerable||!1,at.configurable=!0,"value"in at&&(at.writable=!0),Object.defineProperty(qt,at.key,at)}}var X=new((function(){function qt(){(function(at,Ot){if(!(at instanceof Ot))throw new TypeError("Cannot call a class as a function")})(this,qt),this.init()}var Vt,Kt;return Vt=qt,(Kt=[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING="com.microsoft.playready.recommendation",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}])&&me(Vt.prototype,Kt),qt})()),Ie="e2719d58-a985-b3c9-781a-b030af78d30e",Be=X.CLEARKEY_KEYSTEM_STRING,qe="urn:uuid:"+Ie;function ee(qt){var Vt=(qt=qt||{}).BASE64;return{uuid:Ie,schemeIdURI:qe,systemString:Be,getInitData:function(Kt,at){try{var Ot=u.parseInitDataFromContentProtection(Kt,Vt);if(!Ot&&at){var ct={kids:[(function(It){try{var sn=It.replace(/-/g,"");return(sn=btoa(sn.match(/\w{2}/g).map((function(fn){return String.fromCharCode(parseInt(fn,16))})).join(""))).replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}catch{return null}})(at["cenc:default_KID"])]};Ot=new TextEncoder().encode(JSON.stringify(ct))}return Ot}catch{return null}},getRequestHeadersFromMessage:function(){return{"Content-Type":"application/json"}},getLicenseRequestFromMessage:function(Kt){return JSON.stringify(JSON.parse(String.fromCharCode.apply(null,new Uint8Array(Kt))))},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(Kt,at){var Ot=null;if(Kt){for(var ct=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(at))),It=[],sn=0;sn<ct.kids.length;sn++){var fn=ct.kids[sn],Rn=Kt.clearkeys&&Kt.clearkeys.hasOwnProperty(fn)?Kt.clearkeys[fn]:null;if(!Rn)throw new Error("DRM: ClearKey keyID ("+fn+") is not known!");It.push(new ne(fn,Rn))}Ot=new Te(It)}return Ot}}}ee.__dashjs_factory_name="KeySystemClearKey";var _e=dashjs.FactoryMaker.getSingletonFactory(ee),Ze="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",Ke=X.CLEARKEY_KEYSTEM_STRING,De="urn:uuid:"+Ze;function Ge(qt){var Vt,Kt=qt.BASE64,at=qt.debug.getLogger(Vt);return{uuid:Ze,schemeIdURI:De,systemString:Ke,getInitData:function(Ot){return u.parseInitDataFromContentProtection(Ot,Kt)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(Ot){return new Uint8Array(Ot)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(Ot,ct){var It=null;if(Ot){for(var sn=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(ct))),fn=[],Rn=0;Rn<sn.kids.length;Rn++){var In=sn.kids[Rn],Jt=Ot.clearkeys&&Ot.clearkeys.hasOwnProperty(In)?Ot.clearkeys[In]:null;if(!Jt)throw new Error("DRM: ClearKey keyID ("+In+") is not known!");fn.push(new ne(In,Jt))}It=new Te(fn),at.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return It}}}Ge.__dashjs_factory_name="KeySystemW3CClearKey";var Et=dashjs.FactoryMaker.getSingletonFactory(Ge),vt="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",et=X.WIDEVINE_KEYSTEM_STRING,gt="urn:uuid:"+vt;function Oe(qt){var Vt=(qt=qt||{}).BASE64;return{uuid:vt,schemeIdURI:gt,systemString:et,getInitData:function(Kt){return u.parseInitDataFromContentProtection(Kt,Vt)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(Kt){return new Uint8Array(Kt)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null}}}Oe.__dashjs_factory_name="KeySystemWidevine";var Fe=dashjs.FactoryMaker.getSingletonFactory(Oe),it="9a04f079-9840-4286-ab92-e65be0885f95",w=X.PLAYREADY_KEYSTEM_STRING,N="urn:uuid:"+it;function G(qt){var Vt="utf-16",Kt=(qt=qt||{}).BASE64,at=qt.settings;function Ot(){if(!Kt||!Kt.hasOwnProperty("decodeArray")||!Kt.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:it,schemeIdURI:N,systemString:w,getInitData:function(ct){var It,sn,fn,Rn,In,Jt=new Uint8Array([112,115,115,104,0,0,0,0]),Pt=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),bn=0,Sn=null;if(Ot(),!ct)return null;if("pssh"in ct)return u.parseInitDataFromContentProtection(ct,Kt);if("pro"in ct)Sn=Kt.decodeArray(ct.pro.__text);else{if(!("prheader"in ct))return null;Sn=Kt.decodeArray(ct.prheader.__text)}return It=Sn.length,sn=4+Jt.length+Pt.length+4+It,fn=new ArrayBuffer(sn),Rn=new Uint8Array(fn),(In=new DataView(fn)).setUint32(bn,sn),bn+=4,Rn.set(Jt,bn),bn+=Jt.length,Rn.set(Pt,bn),bn+=Pt.length,In.setUint32(bn,It),bn+=4,Rn.set(Sn,bn),bn+=It,Rn.buffer},getRequestHeadersFromMessage:function(ct){var It,sn,fn={},Rn=new DOMParser;if(at&&at.get().streaming.protection.detectPlayreadyMessageFormat&&Vt==="utf-16"&&ct&&ct.byteLength%2==1)return fn["Content-Type"]="text/xml; charset=utf-8",fn;var In=Vt==="utf-16"?new Uint16Array(ct):new Uint8Array(ct);It=String.fromCharCode.apply(null,In);for(var Jt=(sn=Rn.parseFromString(It,"application/xml")).getElementsByTagName("name"),Pt=sn.getElementsByTagName("value"),bn=0;bn<Jt.length;bn++)fn[Jt[bn].childNodes[0].nodeValue]=Pt[bn].childNodes[0].nodeValue;return fn.hasOwnProperty("Content")&&(fn["Content-Type"]=fn.Content,delete fn.Content),fn.hasOwnProperty("Content-Type")||(fn["Content-Type"]="text/xml; charset=utf-8"),fn},getLicenseRequestFromMessage:function(ct){var It=null,sn=new DOMParser;if(at&&at.get().streaming.protection.detectPlayreadyMessageFormat&&Vt==="utf-16"&&ct&&ct.byteLength%2==1)return ct;var fn=Vt==="utf-16"?new Uint16Array(ct):new Uint8Array(ct);Ot();var Rn=String.fromCharCode.apply(null,fn),In=sn.parseFromString(Rn,"application/xml");if(!In.getElementsByTagName("PlayReadyKeyMessage")[0])return ct;var Jt=In.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return Jt&&(It=Kt.decode(Jt)),It},getLicenseServerURLFromInitData:function(ct){if(ct)for(var It=new DataView(ct),sn=It.getUint16(4,!0),fn=6,Rn=new DOMParser,In=0;In<sn;In++){var Jt=It.getUint16(fn,!0);fn+=2;var Pt=It.getUint16(fn,!0);if(fn+=2,Jt===1){var bn=ct.slice(fn,fn+Pt),Sn=String.fromCharCode.apply(null,new Uint16Array(bn)),Gn=Rn.parseFromString(Sn,"application/xml");if(Gn.getElementsByTagName("LA_URL")[0]){var tr=Gn.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(tr)return tr}if(Gn.getElementsByTagName("LUI_URL")[0]){var mr=Gn.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(mr)return mr}}else fn+=Pt}return null},getCDMData:function(ct){var It,sn,fn,Rn;if(Ot(),!ct)return null;for(It=[],Rn=0;Rn<ct.length;++Rn)It.push(ct.charCodeAt(Rn)),It.push(0);for(It=String.fromCharCode.apply(null,It),It=Kt.encode(It),sn='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",It),fn=[],Rn=0;Rn<sn.length;++Rn)fn.push(sn.charCodeAt(Rn)),fn.push(0);return new Uint8Array(fn).buffer},setPlayReadyMessageFormat:function(ct){if(ct!=="utf-8"&&ct!=="utf-16")throw new Error('Specified message format is not one of "utf-8" or "utf-16"');Vt=ct}}}G.__dashjs_factory_name="KeySystemPlayReady";var V=dashjs.FactoryMaker.getSingletonFactory(G);function ye(qt){var Vt=(qt=qt||{}).BASE64,Kt={};return Kt[X.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(at){return Vt.decodeArray(at.license)},getErrorResponse:function(at){return at}},Kt[X.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(at){return at},getErrorResponse:function(at){return String.fromCharCode.apply(null,new Uint8Array(at))}},{getServerURLFromMessage:function(at){return at},getHTTPMethod:function(){return"POST"},getResponseType:function(at){return Kt[at].responseType},getLicenseMessage:function(at,Ot){return(function(){if(!Vt||!Vt.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")})(),Kt[Ot].getLicenseMessage(at)},getErrorResponse:function(at,Ot){return Kt[Ot].getErrorResponse(at)}}}ye.__dashjs_factory_name="DRMToday";var he=dashjs.FactoryMaker.getSingletonFactory(ye);function He(){var qt="http://schemas.xmlsoap.org/soap/envelope/";function Vt(Ot){var ct=String.fromCharCode.apply(null,new Uint8Array(Ot));return decodeURIComponent(escape(ct))}function Kt(Ot){if(window.DOMParser){var ct=Vt(Ot),It=new window.DOMParser().parseFromString(ct,"text/xml"),sn=It?It.getElementsByTagNameNS(qt,"Envelope")[0]:null,fn=sn?sn.getElementsByTagNameNS(qt,"Body")[0]:null;if(fn&&fn.getElementsByTagNameNS(qt,"Fault")[0])return null}return Ot}function at(Ot){var ct="",It="",sn="",fn=-1,Rn=-1;if(window.DOMParser){var In=Vt(Ot),Jt=new window.DOMParser().parseFromString(In,"text/xml"),Pt=Jt?Jt.getElementsByTagNameNS(qt,"Envelope")[0]:null,bn=Pt?Pt.getElementsByTagNameNS(qt,"Body")[0]:null,Sn=bn?bn.getElementsByTagNameNS(qt,"Fault")[0]:null,Gn=Sn?Sn.getElementsByTagName("detail")[0]:null,tr=Gn?Gn.getElementsByTagName("Exception")[0]:null,mr=null;if(Sn===null)return In;ct=(mr=Sn.getElementsByTagName("faultstring")[0].firstChild)?mr.nodeValue:null,tr!==null&&(It=(mr=tr.getElementsByTagName("StatusCode")[0])?mr.firstChild.nodeValue:null,fn=(sn=(mr=tr.getElementsByTagName("Message")[0])?mr.firstChild.nodeValue:null)?sn.lastIndexOf("[")+1:-1,Rn=sn?sn.indexOf("]"):-1,sn=sn?sn.substring(fn,Rn):"")}var xn="code: ".concat(It,", name: ").concat(ct);return sn&&(xn+=", message: ".concat(sn)),xn}return{getServerURLFromMessage:function(Ot){return Ot},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(Ot){return Kt.call(this,Ot)},getErrorResponse:function(Ot){return at.call(this,Ot)}}}He.__dashjs_factory_name="PlayReady";var ut=$.Z.getSingletonFactory(He);function Je(){return{getServerURLFromMessage:function(qt){return qt},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(qt){return qt},getErrorResponse:function(qt){return String.fromCharCode.apply(null,new Uint8Array(qt))}}}Je.__dashjs_factory_name="Widevine";var Qe=dashjs.FactoryMaker.getSingletonFactory(Je);function Ye(){return{getServerURLFromMessage:function(qt){return qt},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"json"},getLicenseMessage:function(qt){if(!qt.hasOwnProperty("keys"))return null;for(var Vt=[],Kt=0;Kt<qt.keys.length;Kt++){var at=qt.keys[Kt],Ot=at.kid.replace(/=/g,""),ct=at.k.replace(/=/g,"");Vt.push(new ne(Ot,ct))}return new Te(Vt)},getErrorResponse:function(qt){return String.fromCharCode.apply(null,new Uint8Array(qt))}}}Ye.__dashjs_factory_name="ClearKey";var nt=dashjs.FactoryMaker.getSingletonFactory(Ye);function mt(){var qt,Vt,Kt,at,Ot,ct,It,sn,fn=this.context;function Rn(Pt,bn){return bn&&Pt in bn?bn[Pt]:null}function In(Pt,bn){return Pt&&Pt.sessionId?Pt.sessionId:bn&&bn.sessionId?bn.sessionId:null}function Jt(Pt,bn){return Pt&&Pt.sessionType?Pt.sessionType:bn}return qt={initialize:function(){var Pt;at=[],Pt=V(fn).getInstance({BASE64:Ot,settings:ct}),at.push(Pt),Pt=Fe(fn).getInstance({BASE64:Ot}),at.push(Pt),Pt=_e(fn).getInstance({BASE64:Ot}),at.push(Pt),It=Pt,Pt=Et(fn).getInstance({BASE64:Ot,debug:Vt}),at.push(Pt),sn=Pt},setProtectionData:function(Pt){for(var bn,Sn,Gn=0;Gn<at.length;Gn++){var tr=at[Gn];tr.hasOwnProperty("init")&&tr.init((bn=tr.systemString,Sn=void 0,Sn=null,Pt&&(Sn=bn in Pt?Pt[bn]:null),Sn))}},isClearKey:function(Pt){return Pt===It||Pt===sn},initDataEquals:function(Pt,bn){if(Pt.byteLength===bn.byteLength){for(var Sn=new Uint8Array(Pt),Gn=new Uint8Array(bn),tr=0;tr<Sn.length;tr++)if(Sn[tr]!==Gn[tr])return!1;return!0}return!1},getKeySystems:function(){return at},setKeySystems:function(Pt){at=Pt},getKeySystemBySystemString:function(Pt){for(var bn=0;bn<at.length;bn++)if(at[bn].systemString===Pt)return at[bn];return null},getSupportedKeySystemsFromContentProtection:function(Pt,bn,Sn){var Gn,tr,mr,xn,Ht=[];if(Pt){var Yt=u.findCencContentProtection(Pt);for(mr=0;mr<at.length;++mr){var hn=Rn((tr=at[mr]).systemString,bn);for(xn=0;xn<Pt.length;++xn)if((Gn=Pt[xn]).schemeIdUri.toLowerCase()===tr.schemeIdURI){var Mn=tr.getInitData(Gn,Yt);Ht.push({ks:at[mr],keyId:Gn.keyId,initData:Mn,protData:hn,cdmData:tr.getCDMData(hn?hn.cdmData:null),sessionId:In(hn,Gn),sessionType:Jt(hn,Sn)})}}}return Ht},getSupportedKeySystemsFromSegmentPssh:function(Pt,bn,Sn){for(var Gn,tr=[],mr=u.parsePSSHList(Pt),xn=0;xn<at.length;++xn){var Ht=Rn((Gn=at[xn]).systemString,bn);Gn.uuid in mr&&tr.push({ks:Gn,initData:mr[Gn.uuid],protData:Ht,cdmData:Gn.getCDMData(Ht?Ht.cdmData:null),sessionId:In(Ht),sessionType:Jt(Ht,Sn)})}return tr},getLicenseServerModelInstance:function(Pt,bn,Sn){if(Sn==="license-release"||Sn==="individualization-request")return null;var Gn=null;return bn&&bn.hasOwnProperty("drmtoday")?Gn=he(fn).getInstance({BASE64:Ot}):Pt.systemString===X.WIDEVINE_KEYSTEM_STRING?Gn=Qe(fn).getInstance():Pt.systemString===X.PLAYREADY_KEYSTEM_STRING?Gn=ut(fn).getInstance():Pt.systemString===X.CLEARKEY_KEYSTEM_STRING&&(Gn=nt(fn).getInstance()),Gn},processClearKeyLicenseRequest:function(Pt,bn,Sn){try{return Pt.getClearKeysFromProtectionData(bn,Sn)}catch{return Kt.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(Pt){Pt&&(Pt.debug&&(Vt=Pt.debug,Kt=Vt.getLogger(qt)),Pt.BASE64&&(Ot=Pt.BASE64),Pt.settings&&(ct=Pt.settings))}},qt}mt.__dashjs_factory_name="ProtectionKeyController";var Gt=dashjs.FactoryMaker.getSingletonFactory(mt);function _t(qt){return _t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Vt){return typeof Vt}:function(Vt){return Vt&&typeof Symbol=="function"&&Vt.constructor===Symbol&&Vt!==Symbol.prototype?"symbol":typeof Vt},_t(qt)}function gn(qt,Vt){return gn=Object.setPrototypeOf||function(Kt,at){return Kt.__proto__=at,Kt},gn(qt,Vt)}function Wt(qt,Vt){return!Vt||_t(Vt)!=="object"&&typeof Vt!="function"?(function(Kt){if(Kt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Kt})(qt):Vt}function ln(qt){return ln=Object.setPrototypeOf?Object.getPrototypeOf:function(Vt){return Vt.__proto__||Object.getPrototypeOf(Vt)},ln(qt)}var cn=new((function(qt){(function(ct,It){if(typeof It!="function"&&It!==null)throw new TypeError("Super expression must either be null or a function");ct.prototype=Object.create(It&&It.prototype,{constructor:{value:ct,writable:!0,configurable:!0}}),It&&gn(ct,It)})(Ot,qt);var Vt,Kt,at=(Vt=Ot,Kt=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var ct,It=ln(Vt);if(Kt){var sn=ln(this).constructor;ct=Reflect.construct(It,arguments,sn)}else ct=It.apply(this,arguments);return Wt(this,ct)});function Ot(){var ct;return(function(It,sn){if(!(It instanceof sn))throw new TypeError("Cannot call a class as a function")})(this,Ot),(ct=at.call(this)).INTERNAL_KEY_MESSAGE="internalKeyMessage",ct.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",ct.KEY_ADDED="public_keyAdded",ct.KEY_ERROR="public_keyError",ct.KEY_MESSAGE="public_keyMessage",ct.KEY_SESSION_CLOSED="public_keySessionClosed",ct.KEY_SESSION_CREATED="public_keySessionCreated",ct.KEY_SESSION_REMOVED="public_keySessionRemoved",ct.KEY_STATUSES_CHANGED="public_keyStatusesChanged",ct.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",ct.KEY_SYSTEM_SELECTED="public_keySystemSelected",ct.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",ct.LICENSE_REQUEST_SENDING="public_licenseRequestSending",ct.NEED_KEY="needkey",ct.PROTECTION_CREATED="public_protectioncreated",ct.PROTECTION_DESTROYED="public_protectiondestroyed",ct.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",ct.TEARDOWN_COMPLETE="protectionTeardownComplete",ct.VIDEO_ELEMENT_SELECTED="videoElementSelected",ct.KEY_SESSION_UPDATED="public_keySessionUpdated",ct}return Ot})(g(8342).Z)),On=function qt(Vt,Kt){(function(at,Ot){if(!(at instanceof Ot))throw new TypeError("Cannot call a class as a function")})(this,qt),this.initData=Vt,this.initDataType=Kt},zn=function qt(Vt,Kt,at,Ot){(function(ct,It){if(!(ct instanceof It))throw new TypeError("Cannot call a class as a function")})(this,qt),this.sessionToken=Vt,this.message=Kt,this.defaultURL=at,this.messageType=Ot||"license-request"},ar=function qt(Vt,Kt){(function(at,Ot){if(!(at instanceof Ot))throw new TypeError("Cannot call a class as a function")})(this,qt),this.keySystem=Vt,this.ksConfiguration=Kt},er={};function Rr(qt){qt=qt||{};var Vt,Kt,at,Ot,ct,It,sn,fn,Rn=this.context,In=qt.eventBus,Jt=qt.events,Pt=qt.debug;function bn(Ht,Yt,hn,Mn){if(navigator.requestMediaKeySystemAccess===void 0||typeof navigator.requestMediaKeySystemAccess!="function"){var kn="Insecure origins are not allowed";return In.trigger(Jt.KEY_SYSTEM_ACCESS_COMPLETE,{error:kn}),void Mn({error:kn})}var $n=Ht[Yt].protData&&Ht[Yt].protData.systemStringPriority?Ht[Yt].protData.systemStringPriority:null,lr=Ht[Yt].configs,ci=Ht[Yt].ks,Kr=ci.systemString;(function(Er,Jr){return new Promise((function(Pr,fi){Sn(Er,Jr,0,Pr,fi)}))})($n||(er[Kr]?er[Kr]:[Kr]),lr).then((function(Er){var Jr=typeof Er.getConfiguration=="function"?Er.getConfiguration():null,Pr=new ar(ci,Jr);Pr.mksa=Er,In.trigger(Jt.KEY_SYSTEM_ACCESS_COMPLETE,{data:Pr}),hn({data:Pr})})).catch((function(Er){if(Yt+1<Ht.length)bn(Ht,Yt+1,hn,Mn);else{var Jr="Key system access denied! ";In.trigger(Jt.KEY_SYSTEM_ACCESS_COMPLETE,{error:Jr+Er.message}),Mn({error:Jr+Er.message})}}))}function Sn(Ht,Yt,hn,Mn,kn){var $n=Ht[hn];Kt.debug("Requesting key system access for system string ".concat($n)),navigator.requestMediaKeySystemAccess($n,Yt).then((function(lr){lr.selectedSystemString=$n,Mn(lr)})).catch((function(lr){hn+1<Ht.length?Sn(Ht,Yt,hn+1,Mn,kn):kn(lr)}))}function Gn(Ht){if(!Ht||!Ht.session)return Promise.resolve;var Yt=Ht.session;return Yt.removeEventListener("keystatuseschange",Ht),Yt.removeEventListener("message",Ht),Yt.close()}function tr(Ht){for(var Yt=0;Yt<It.length;Yt++)if(It[Yt]===Ht){It.splice(Yt,1);break}}function mr(Ht){var Yt,hn;return Ht&&Ht.length>0&&(Ht[0]&&(typeof Ht[0]=="string"?Yt=Ht[0]:hn=Ht[0]),Ht[1]&&(typeof Ht[1]=="string"?Yt=Ht[1]:hn=Ht[1])),{status:Yt,keyId:hn}}function xn(Ht,Yt){var hn={session:Ht,keyId:Yt.keyId,initData:Yt.initData,sessionId:Yt.sessionId,sessionType:Yt.sessionType,handleEvent:function(Mn){switch(Mn.type){case"keystatuseschange":In.trigger(Jt.KEY_STATUSES_CHANGED,{data:this}),Mn.target.keyStatuses.forEach((function(){var $n=mr(arguments);$n.status==="expired"?In.trigger(Jt.INTERNAL_KEY_STATUS_CHANGED,{error:new A.Z(T.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,T.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)}):In.trigger(Jt.INTERNAL_KEY_STATUS_CHANGED,$n)}));break;case"message":var kn=ArrayBuffer.isView(Mn.message)?Mn.message.buffer:Mn.message;In.trigger(Jt.INTERNAL_KEY_MESSAGE,{data:new zn(this,kn,void 0,Mn.messageType)})}},getKeyId:function(){return this.keyId},getSessionId:function(){return Ht.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return Ht.expiration},getKeyStatuses:function(){return Ht.keyStatuses},getUsable:function(){var Mn=!1;return Ht.keyStatuses.forEach((function(){var kn=mr(arguments);kn.status==="usable"&&(Mn=!0)})),Mn}};return Ht.addEventListener("keystatuseschange",hn),Ht.addEventListener("message",hn),Ht.closed.then((function(){tr(hn),Kt.debug("DRM: Session closed.  SessionID = "+hn.getSessionId()),In.trigger(Jt.KEY_SESSION_CLOSED,{data:hn.getSessionId()})})),It.push(hn),hn}return Vt={getAllInitData:function(){for(var Ht=[],Yt=0;Yt<It.length;Yt++)It[Yt].initData&&Ht.push(It[Yt].initData);return Ht},getSessions:function(){return It},requestKeySystemAccess:function(Ht){return new Promise((function(Yt,hn){bn(Ht,0,Yt,hn)}))},selectKeySystem:function(Ht){return new Promise((function(Yt,hn){Ht.mksa.createMediaKeys().then((function(Mn){return at=Ht.keySystem,ct=Mn,Ot?Ot.setMediaKeys(ct):Promise.resolve()})).then((function(){Yt(at)})).catch((function(){hn({error:"Error selecting keys system ("+Ht.keySystem.systemString+")! Could not create MediaKeys -- TODO"})}))}))},setMediaElement:function(Ht){Ot!==Ht&&(Ot&&(Ot.removeEventListener("encrypted",sn),Ot.setMediaKeys&&Ot.setMediaKeys(null)),(Ot=Ht)&&(Ot.addEventListener("encrypted",sn),Ot.setMediaKeys&&ct&&Ot.setMediaKeys(ct)))},setServerCertificate:function(Ht){if(!at||!ct)throw new Error("Can not set server certificate until you have selected a key system");ct.setServerCertificate(Ht).then((function(){Kt.info("DRM: License server certificate successfully updated."),In.trigger(Jt.SERVER_CERTIFICATE_UPDATED)})).catch((function(Yt){In.trigger(Jt.SERVER_CERTIFICATE_UPDATED,{error:new A.Z(T.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,T.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+Yt.name)})}))},createKeySession:function(Ht){if(!at||!ct)throw new Error("Can not create sessions until you have selected a key system");var Yt=ct.createSession(Ht.sessionType),hn=xn(Yt,Ht),Mn=at.systemString===X.CLEARKEY_KEYSTEM_STRING&&(Ht.initData||Ht.protData&&Ht.protData.clearkeys)?X.INITIALIZATION_DATA_TYPE_KEYIDS:X.INITIALIZATION_DATA_TYPE_CENC;Yt.generateRequest(Mn,Ht.initData).then((function(){Kt.debug("DRM: Session created.  SessionID = "+hn.getSessionId()),In.trigger(Jt.KEY_SESSION_CREATED,{data:hn})})).catch((function(kn){tr(hn),In.trigger(Jt.KEY_SESSION_CREATED,{data:null,error:new A.Z(T.KEY_SESSION_CREATED_ERROR_CODE,T.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+kn.name)})}))},updateKeySession:function(Ht,Yt){var hn=Ht.session;fn.isClearKey(at)&&(Yt=Yt.toJWK()),hn.update(Yt).then((function(){In.trigger(Jt.KEY_SESSION_UPDATED)})).catch((function(Mn){In.trigger(Jt.KEY_ERROR,{error:new A.Z(T.MEDIA_KEYERR_CODE,"Error sending update() message! "+Mn.name,Ht)})}))},loadKeySession:function(Ht){if(!at||!ct)throw new Error("Can not load sessions until you have selected a key system");for(var Yt=Ht.sessionId,hn=0;hn<It.length;hn++)if(Yt===It[hn].sessionId)return void Kt.warn("DRM: Ignoring session ID because we have already seen it!");var Mn=ct.createSession(Ht.sessionType),kn=xn(Mn,Ht);Mn.load(Yt).then((function($n){$n?(Kt.debug("DRM: Session loaded.  SessionID = "+kn.getSessionId()),In.trigger(Jt.KEY_SESSION_CREATED,{data:kn})):(tr(kn),In.trigger(Jt.KEY_SESSION_CREATED,{data:null,error:new A.Z(T.KEY_SESSION_CREATED_ERROR_CODE,T.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+Yt+")")}))})).catch((function($n){tr(kn),In.trigger(Jt.KEY_SESSION_CREATED,{data:null,error:new A.Z(T.KEY_SESSION_CREATED_ERROR_CODE,T.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+Yt+")! "+$n.name)})}))},removeKeySession:function(Ht){Ht.session.remove().then((function(){Kt.debug("DRM: Session removed.  SessionID = "+Ht.getSessionId()),In.trigger(Jt.KEY_SESSION_REMOVED,{data:Ht.getSessionId()})}),(function(Yt){In.trigger(Jt.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+Ht.getSessionId()+"). "+Yt.name})}))},closeKeySession:function(Ht){Gn(Ht).catch((function(Yt){tr(Ht),In.trigger(Jt.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+Ht.getSessionId()+") "+Yt.name})}))},stop:function(){for(var Ht,Yt=0;Yt<It.length;Yt++)(Ht=It[Yt]).getUsable()||(Gn(Ht),tr(Ht))},reset:function(){var Ht,Yt=It.length;Yt!==0?(function(){for(var hn=function(kn){tr(kn),It.length===0&&(Ot?(Ot.removeEventListener("encrypted",sn),Ot.setMediaKeys(null).then((function(){In.trigger(Jt.TEARDOWN_COMPLETE)}))):In.trigger(Jt.TEARDOWN_COMPLETE))},Mn=0;Mn<Yt;Mn++)(function(kn){Gn(Ht),hn(kn)})(Ht=It[Mn])})():In.trigger(Jt.TEARDOWN_COMPLETE)}},Kt=Pt.getLogger(Vt),at=null,Ot=null,ct=null,It=[],fn=Gt(Rn).getInstance(),sn={handleEvent:function(Ht){if(Ht.type==="encrypted"&&Ht.initData){var Yt=ArrayBuffer.isView(Ht.initData)?Ht.initData.buffer:Ht.initData;In.trigger(Jt.NEED_KEY,{key:new On(Yt,Ht.initDataType)})}}},Vt}er[X.PLAYREADY_KEYSTEM_STRING]=[X.PLAYREADY_KEYSTEM_STRING,X.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING],er[X.WIDEVINE_KEYSTEM_STRING]=[X.WIDEVINE_KEYSTEM_STRING],er[X.CLEARKEY_KEYSTEM_STRING]=[X.CLEARKEY_KEYSTEM_STRING],Rr.__dashjs_factory_name="ProtectionModel_21Jan2015";var li=dashjs.FactoryMaker.getClassFactory(Rr);function gr(qt){qt=qt||{};var Vt,Kt,at,Ot,ct,It,sn,fn,Rn,In=this.context,Jt=qt.eventBus,Pt=qt.events,bn=qt.debug,Sn=qt.api;function Gn(){try{for(var xn=0;xn<sn.length;xn++)tr(sn[xn]);at&&at.removeEventListener(Sn.needkey,fn),Jt.trigger(Pt.TEARDOWN_COMPLETE)}catch(Ht){Jt.trigger(Pt.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+Ht.message})}}function tr(xn){var Ht=xn.session;Ht.removeEventListener(Sn.error,xn),Ht.removeEventListener(Sn.message,xn),Ht.removeEventListener(Sn.ready,xn),Ht.removeEventListener(Sn.close,xn);for(var Yt=0;Yt<sn.length;Yt++)if(sn[Yt]===xn){sn.splice(Yt,1);break}Ht[Sn.release]()}function mr(){var xn=null,Ht=function(){at.removeEventListener("loadedmetadata",xn),at[Sn.setMediaKeys](ct),Jt.trigger(Pt.VIDEO_ELEMENT_SELECTED)};at.readyState>=1?Ht():(xn=Ht.bind(this),at.addEventListener("loadedmetadata",xn))}return Vt={getAllInitData:function(){for(var xn=[],Ht=0;Ht<sn.length;Ht++)xn.push(sn[Ht].initData);return xn},getSessions:function(){return sn},requestKeySystemAccess:function(xn){return new Promise((function(Ht,Yt){for(var hn=!1,Mn=0;Mn<xn.length;Mn++)for(var kn=xn[Mn].ks.systemString,$n=xn[Mn].configs,lr=null,ci=null,Kr=0;Kr<$n.length;Kr++){var Er=$n[Kr].audioCapabilities,Jr=$n[Kr].videoCapabilities;if(Er&&Er.length!==0){lr=[];for(var Pr=0;Pr<Er.length;Pr++)window[Sn.MediaKeys].isTypeSupported(kn,Er[Pr].contentType)&&lr.push(Er[Pr])}if(Jr&&Jr.length!==0){ci=[];for(var fi=0;fi<Jr.length;fi++)window[Sn.MediaKeys].isTypeSupported(kn,Jr[fi].contentType)&&ci.push(Jr[fi])}if(!(!lr&&!ci||lr&&lr.length===0||ci&&ci.length===0)){hn=!0;var cs=new S(lr,ci),Di=Rn.getKeySystemBySystemString(kn),Pi=new ar(Di,cs);Jt.trigger(Pt.KEY_SYSTEM_ACCESS_COMPLETE,{data:Pi}),Ht({data:Pi});break}}if(!hn){var zr="Key system access denied! -- No valid audio/video content configurations detected!";Jt.trigger(Pt.KEY_SYSTEM_ACCESS_COMPLETE,{error:zr}),Yt({error:zr})}}))},selectKeySystem:function(xn){return new Promise((function(Ht,Yt){try{ct=xn.mediaKeys=new window[Sn.MediaKeys](xn.keySystem.systemString),Ot=xn.keySystem,It=xn,at&&mr(),Ht(Ot)}catch{Yt({error:"Error selecting keys system ("+Ot.systemString+")! Could not create MediaKeys -- TODO"})}}))},setMediaElement:function(xn){at!==xn&&(at&&at.removeEventListener(Sn.needkey,fn),(at=xn)&&(at.addEventListener(Sn.needkey,fn),ct&&mr()))},createKeySession:function(xn){if(!Ot||!ct||!It)throw new Error("Can not create sessions until you have selected a key system");var Ht=null;if(It.ksConfiguration.videoCapabilities&&It.ksConfiguration.videoCapabilities.length>0&&(Ht=It.ksConfiguration.videoCapabilities[0]),Ht===null&&It.ksConfiguration.audioCapabilities&&It.ksConfiguration.audioCapabilities.length>0&&(Ht=It.ksConfiguration.audioCapabilities[0]),Ht===null)throw new Error("Can not create sessions for unknown content types.");var Yt=Ht.contentType,hn=ct.createSession(Yt,new Uint8Array(xn.initData),xn.cdmData?new Uint8Array(xn.cdmData):null),Mn=(function(kn,$n){return{session:kn,keyId:$n.keyId,initData:$n.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(lr){switch(lr.type){case Sn.error:Jt.trigger(Pt.KEY_ERROR,{error:new A.Z(T.MEDIA_KEYERR_CODE,"KeyError",this)});break;case Sn.message:var ci=ArrayBuffer.isView(lr.message)?lr.message.buffer:lr.message;Jt.trigger(Pt.INTERNAL_KEY_MESSAGE,{data:new zn(this,ci,lr.destinationURL)});break;case Sn.ready:Kt.debug("DRM: Key added."),Jt.trigger(Pt.KEY_ADDED);break;case Sn.close:Kt.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),Jt.trigger(Pt.KEY_SESSION_CLOSED,{data:this.getSessionId()})}}}})(hn,xn);hn.addEventListener(Sn.error,Mn),hn.addEventListener(Sn.message,Mn),hn.addEventListener(Sn.ready,Mn),hn.addEventListener(Sn.close,Mn),sn.push(Mn),Kt.debug("DRM: Session created.  SessionID = "+Mn.getSessionId()),Jt.trigger(Pt.KEY_SESSION_CREATED,{data:Mn})},updateKeySession:function(xn,Ht){var Yt=xn.session;Rn.isClearKey(Ot)?Yt.update(new Uint8Array(Ht.toJWK())):Yt.update(new Uint8Array(Ht)),Jt.trigger(Pt.KEY_SESSION_UPDATED)},closeKeySession:tr,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:Gn,reset:Gn},Kt=bn.getLogger(Vt),at=null,Ot=null,ct=null,It=null,sn=[],Rn=Gt(In).getInstance(),fn={handleEvent:function(xn){if(xn.type===Sn.needkey&&xn.initData){var Ht=ArrayBuffer.isView(xn.initData)?xn.initData.buffer:xn.initData;Jt.trigger(Pt.NEED_KEY,{key:new On(Ht,"cenc")})}}},Vt}gr.__dashjs_factory_name="ProtectionModel_3Feb2014";var gi=dashjs.FactoryMaker.getClassFactory(gr);function Zr(qt){qt=qt||{};var Vt,Kt,at,Ot,ct,It,sn,fn,Rn,In=this.context,Jt=qt.eventBus,Pt=qt.events,bn=qt.debug,Sn=qt.api,Gn=qt.errHandler;function tr(){at&&Ht();for(var Yt=0;Yt<sn.length;Yt++)mr(sn[Yt]);Jt.trigger(Pt.TEARDOWN_COMPLETE)}function mr(Yt){try{at[Sn.cancelKeyRequest](Ot.systemString,Yt.sessionId)}catch(hn){Jt.trigger(Pt.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+Yt.sessionId+") "+hn.message})}}function xn(Yt,hn){if(hn&&Yt){for(var Mn=Yt.length,kn=0;kn<Mn;kn++)if(Yt[kn].sessionId==hn)return Yt[kn];return null}return null}function Ht(){at.removeEventListener(Sn.keyerror,Rn),at.removeEventListener(Sn.needkey,Rn),at.removeEventListener(Sn.keymessage,Rn),at.removeEventListener(Sn.keyadded,Rn)}return Vt={getAllInitData:function(){for(var Yt=[],hn=0;hn<It.length;hn++)Yt.push(It[hn].initData);for(var Mn=0;Mn<sn.length;Mn++)Yt.push(sn[Mn].initData);return Yt},getSessions:function(){return sn.concat(It)},requestKeySystemAccess:function(Yt){return new Promise((function(hn,Mn){var kn=at;kn||(kn=document.createElement("video"));for(var $n=!1,lr=0;lr<Yt.length;lr++)for(var ci=Yt[lr].ks.systemString,Kr=Yt[lr].configs,Er=null,Jr=0;Jr<Kr.length;Jr++){var Pr=Kr[Jr].videoCapabilities;if(Pr&&Pr.length!==0){Er=[];for(var fi=0;fi<Pr.length;fi++)kn.canPlayType(Pr[fi].contentType,ci)!==""&&Er.push(Pr[fi])}if(Er&&(!Er||Er.length!==0)){$n=!0;var cs=new S(null,Er),Di=ct.getKeySystemBySystemString(ci),Pi=new ar(Di,cs);Jt.trigger(Pt.KEY_SYSTEM_ACCESS_COMPLETE,{data:Pi}),hn({data:Pi});break}}if(!$n){var zr="Key system access denied! -- No valid audio/video content configurations detected!";Jt.trigger(Pt.KEY_SYSTEM_ACCESS_COMPLETE,{error:zr}),Mn({error:zr})}}))},selectKeySystem:function(Yt){return Ot=Yt.keySystem,Promise.resolve(Ot)},setMediaElement:function(Yt){if(at!==Yt){if(at){Ht();for(var hn=0;hn<sn.length;hn++)mr(sn[hn]);sn=[]}(at=Yt)&&(at.addEventListener(Sn.keyerror,Rn),at.addEventListener(Sn.needkey,Rn),at.addEventListener(Sn.keymessage,Rn),at.addEventListener(Sn.keyadded,Rn),Jt.trigger(Pt.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(Yt){if(!Ot)throw new Error("Can not create sessions until you have selected a key system");if(fn||sn.length===0){var hn={sessionId:null,keyId:Yt.keyId,initData:Yt.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return It.push(hn),at[Sn.generateKeyRequest](Ot.systemString,new Uint8Array(Yt.initData)),hn}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(Yt,hn){var Mn=Yt.sessionId;if(ct.isClearKey(Ot))for(var kn=0;kn<hn.keyPairs.length;kn++)at[Sn.addKey](Ot.systemString,hn.keyPairs[kn].key,hn.keyPairs[kn].keyID,Mn);else at[Sn.addKey](Ot.systemString,new Uint8Array(hn),new Uint8Array(Yt.initData),Mn);Jt.trigger(Pt.KEY_SESSION_UPDATED)},closeKeySession:mr,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:tr,reset:tr},Kt=bn.getLogger(Vt),at=null,Ot=null,It=[],sn=[],ct=Gt(In).getInstance(),Rn={handleEvent:function(Yt){var hn=null;switch(Yt.type){case Sn.needkey:var Mn=ArrayBuffer.isView(Yt.initData)?Yt.initData.buffer:Yt.initData;Jt.trigger(Pt.NEED_KEY,{key:new On(Mn,"cenc")});break;case Sn.keyerror:if((hn=xn(sn,Yt.sessionId))||(hn=xn(It,Yt.sessionId)),hn){var kn=T.MEDIA_KEYERR_CODE,$n="";switch(Yt.errorCode.code){case 1:kn=T.MEDIA_KEYERR_UNKNOWN_CODE,$n+="MEDIA_KEYERR_UNKNOWN - "+T.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:kn=T.MEDIA_KEYERR_CLIENT_CODE,$n+="MEDIA_KEYERR_CLIENT - "+T.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:kn=T.MEDIA_KEYERR_SERVICE_CODE,$n+="MEDIA_KEYERR_SERVICE - "+T.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:kn=T.MEDIA_KEYERR_OUTPUT_CODE,$n+="MEDIA_KEYERR_OUTPUT - "+T.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:kn=T.MEDIA_KEYERR_HARDWARECHANGE_CODE,$n+="MEDIA_KEYERR_HARDWARECHANGE - "+T.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:kn=T.MEDIA_KEYERR_DOMAIN_CODE,$n+="MEDIA_KEYERR_DOMAIN - "+T.MEDIA_KEYERR_DOMAIN_MESSAGE}$n+="  System Code = "+Yt.systemCode,Jt.trigger(Pt.KEY_ERROR,{error:new A.Z(kn,$n,hn)})}else Kt.error("No session token found for key error");break;case Sn.keyadded:(hn=xn(sn,Yt.sessionId))||(hn=xn(It,Yt.sessionId)),hn?(Kt.debug("DRM: Key added."),Jt.trigger(Pt.KEY_ADDED,{data:hn})):Kt.debug("No session token found for key added");break;case Sn.keymessage:if((fn=Yt.sessionId!==null&&Yt.sessionId!==void 0)?!(hn=xn(sn,Yt.sessionId))&&It.length>0&&(hn=It.shift(),sn.push(hn),hn.sessionId=Yt.sessionId,Jt.trigger(Pt.KEY_SESSION_CREATED,{data:hn})):It.length>0&&(hn=It.shift(),sn.push(hn),It.length!==0&&Gn.error(new A.Z(T.MEDIA_KEY_MESSAGE_ERROR_CODE,T.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),hn){var lr=ArrayBuffer.isView(Yt.message)?Yt.message.buffer:Yt.message;hn.keyMessage=lr,Jt.trigger(Pt.INTERNAL_KEY_MESSAGE,{data:new zn(hn,lr,Yt.defaultURL)})}else Kt.warn("No session token found for key message")}}},Vt}Zr.__dashjs_factory_name="ProtectionModel_01b";var ri=dashjs.FactoryMaker.getClassFactory(Zr),ui=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],ii=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function bi(){var qt,Vt=this.context;function Kt(at,Ot){for(var ct=0;ct<Ot.length;ct++){var It=Ot[ct];if(typeof at[It[Object.keys(It)[0]]]=="function")return It}return null}return qt={createProtectionSystem:function(at){var Ot=null,ct=Gt(Vt).getInstance();ct.setConfig({debug:at.debug,BASE64:at.BASE64,settings:at.settings}),ct.initialize();var It=(function(sn){var fn=sn.debug,Rn=fn.getLogger(qt),In=sn.eventBus,Jt=sn.errHandler,Pt=sn.videoModel?sn.videoModel.getElement():null;return Pt&&Pt.onencrypted===void 0||Pt&&Pt.mediaKeys===void 0?Kt(Pt,ii)?(Rn.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),gi(Vt).create({debug:fn,eventBus:In,events:sn.events,api:Kt(Pt,ii)})):Kt(Pt,ui)?(Rn.info("EME detected on this user agent! (ProtectionModel_01b)"),ri(Vt).create({debug:fn,eventBus:In,errHandler:Jt,events:sn.events,api:Kt(Pt,ui)})):(Rn.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(Rn.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),li(Vt).create({debug:fn,eventBus:In,events:sn.events}))})(at);return!Ot&&It&&(Ot=fe(Vt).create({protectionModel:It,protectionKeyController:ct,eventBus:at.eventBus,debug:at.debug,events:at.events,BASE64:at.BASE64,constants:at.constants,cmcdModel:at.cmcdModel,customParametersModel:at.customParametersModel,settings:at.settings}),at.capabilities.setEncryptedMediaSupported(!0)),Ot}}}bi.__dashjs_factory_name="Protection";var zi=dashjs.FactoryMaker.getClassFactory(bi);zi.events=cn,zi.errors=T,dashjs.FactoryMaker.updateClassFactory(bi.__dashjs_factory_name,zi);var Us=zi},2068:function(f,y,g){var p=g(5448),m={DEFAULT:.5,STRONG:1,WEAK:0};function u(S,_,E){var b,I;return b=S===void 0?-1:S,I=(function(T){var A=m.DEFAULT;return T!==m.DEFAULT&&T!==m.STRONG&&T!==m.WEAK||(A=T),A})(E),{quality:b,reason:_===void 0?null:_,priority:I}}u.__dashjs_factory_name="SwitchRequest";var d=p.Z.getClassFactory(u);d.NO_CHANGE=-1,d.PRIORITY=m,p.Z.updateClassFactory(u.__dashjs_factory_name,d),y.Z=d},1767:function(f,y,g){var p=g(5628),m=g(6535),u=g(7423),d=g(895),S=g(6070),_=g(3112),E=g(1914),b=g(5435),I=g(5448),T=g(2068),A=g(3393),R="qualitySwitchRules",O="abandonFragmentRules";function H(Z){Z=Z||{};var $,F,W=this.context,fe=Z.mediaPlayerModel,ne=Z.customParametersModel,de=Z.dashMetrics,Te=Z.settings;function me(Ie){return Ie.filter((function(Be){return Be.quality>T.Z.NO_CHANGE}))}function X(Ie){var Be,qe,ee,_e,Ze,Ke={},De=null;if(Ie.length!==0){for(Ke[T.Z.PRIORITY.STRONG]={quality:T.Z.NO_CHANGE,reason:null},Ke[T.Z.PRIORITY.WEAK]={quality:T.Z.NO_CHANGE,reason:null},Ke[T.Z.PRIORITY.DEFAULT]={quality:T.Z.NO_CHANGE,reason:null},Be=0,qe=Ie.length;Be<qe;Be+=1)(ee=Ie[Be]).quality!==T.Z.NO_CHANGE&&(Ke[ee.priority].quality===T.Z.NO_CHANGE||Ke[ee.priority].quality>ee.quality)&&(Ke[ee.priority].quality=ee.quality,Ke[ee.priority].reason=ee.reason||null);return Ke[T.Z.PRIORITY.WEAK].quality!==T.Z.NO_CHANGE&&(De=Ke[T.Z.PRIORITY.WEAK]),Ke[T.Z.PRIORITY.DEFAULT].quality!==T.Z.NO_CHANGE&&(De=Ke[T.Z.PRIORITY.DEFAULT]),Ke[T.Z.PRIORITY.STRONG].quality!==T.Z.NO_CHANGE&&(De=Ke[T.Z.PRIORITY.STRONG]),De&&(_e=De.quality,Ze=De.reason),(0,T.Z)(W).create(_e,Ze)}}return{initialize:function(){$=[],F=[],Te.get().streaming.abr.useDefaultABRRules&&(Te.get().streaming.abr.ABRStrategy===A.Z.ABR_STRATEGY_L2A?$.push((0,E.Z)(W).create({dashMetrics:de,settings:Te})):Te.get().streaming.abr.ABRStrategy===A.Z.ABR_STRATEGY_LoLP?$.push((0,b.Z)(W).create({dashMetrics:de})):($.push((0,_.Z)(W).create({dashMetrics:de,mediaPlayerModel:fe,settings:Te})),$.push((0,p.Z)(W).create({dashMetrics:de})),Te.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&$.push((0,m.Z)(W).create({dashMetrics:de,settings:Te})),Te.get().streaming.abr.additionalAbrRules.switchHistoryRule&&$.push((0,S.Z)(W).create()),Te.get().streaming.abr.additionalAbrRules.droppedFramesRule&&$.push((0,d.Z)(W).create()),Te.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&F.push((0,u.Z)(W).create({dashMetrics:de,mediaPlayerModel:fe,settings:Te})))),ne.getAbrCustomRules().forEach((function(Ie){Ie.type===R&&$.push(Ie.rule(W).create()),Ie.type===O&&F.push(Ie.rule(W).create())}))},reset:function(){[$,F].forEach((function(Ie){Ie&&Ie.length&&Ie.forEach((function(Be){return Be.reset&&Be.reset()}))})),$=[],F=[]},getMaxQuality:function(Ie){return X(me($.map((function(Be){return Be.getMaxIndex(Ie)}))))||(0,T.Z)(W).create()},getMinSwitchRequest:X,shouldAbandonFragment:function(Ie,Be){var qe=X(me(F.map((function(ee){return ee.shouldAbandon(Ie,Be)}))));return qe&&(qe.reason.forceAbandon=!0),qe||(0,T.Z)(W).create()},getQualitySwitchRules:function(){return $}}}H.__dashjs_factory_name="ABRRulesCollection";var U=I.Z.getClassFactory(H);U.QUALITY_SWITCH_RULES=R,U.ABANDON_FRAGMENT_RULES=O,I.Z.updateSingletonFactory(H.__dashjs_factory_name,U),y.Z=U},7423:function(f,y,g){var p=g(2068),m=g(5448),u=g(6398);function d(S){S=S||{};var _,E,b,I,T,A=this.context,R=S.mediaPlayerModel,O=S.dashMetrics,H=S.settings;function U(){b={},I={},T=[]}return _={shouldAbandon:function(Z){var $=(0,p.Z)(A).create(p.Z.NO_CHANGE,{name:d.__dashjs_factory_name});if(!(Z&&Z.hasOwnProperty("getMediaInfo")&&Z.hasOwnProperty("getMediaType")&&Z.hasOwnProperty("getCurrentRequest")&&Z.hasOwnProperty("getRepresentationInfo")&&Z.hasOwnProperty("getAbrController")))return $;var F,W,fe=Z.getMediaInfo(),ne=Z.getMediaType(),de=Z.getStreamInfo(),Te=de?de.id:null,me=Z.getCurrentRequest();if(!isNaN(me.index)){F=ne,W=me.index,b[F]=b[F]||{},b[F][W]=b[F][W]||{};var X=R.getStableBufferTime();if(O.getCurrentBufferLevel(ne)>X)return $;var Ie=b[ne][me.index];if(Ie===null||me.firstByteDate===null||I.hasOwnProperty(Ie.id))return $;if(Ie.firstByteTime===void 0&&(T[ne]=[],Ie.firstByteTime=me.firstByteDate.getTime(),Ie.segmentDuration=me.duration,Ie.bytesTotal=me.bytesTotal,Ie.id=me.index),Ie.bytesLoaded=me.bytesLoaded,Ie.elapsedTime=new Date().getTime()-Ie.firstByteTime,Ie.bytesLoaded>0&&Ie.elapsedTime>0&&(function(Ge,Et){T[Ge]=T[Ge]||[],T[Ge].push(Et)})(ne,Math.round(8*Ie.bytesLoaded/Ie.elapsedTime)),T[ne].length>=H.get().streaming.abr.abrRulesParameters.abandonRequestsRule.minLengthToAverage&&Ie.elapsedTime>H.get().streaming.abr.abrRulesParameters.abandonRequestsRule.graceTimeThreshold&&Ie.bytesLoaded<Ie.bytesTotal){var Be=T[ne].reduce((function(Ge,Et){return Ge+Et}),0);if(Ie.measuredBandwidthInKbps=Math.round(Be/T[ne].length),Ie.estimatedTimeOfDownload=+(8*Ie.bytesTotal/Ie.measuredBandwidthInKbps/1e3).toFixed(2),Ie.estimatedTimeOfDownload<Ie.segmentDuration*H.get().streaming.abr.abrRulesParameters.abandonRequestsRule.abandonMultiplier||Z.getRepresentationInfo().quality===0)return $;if(!I.hasOwnProperty(Ie.id)){var qe=Z.getAbrController(),ee=Ie.bytesTotal-Ie.bytesLoaded,_e=qe.getBitrateList(fe),Ze=qe.getQualityForBitrate(fe,Ie.measuredBandwidthInKbps*H.get().streaming.abr.bandwidthSafetyFactor,Te),Ke=qe.getMinAllowedIndexFor(ne,Te),De=Ke!==void 0?Math.max(Ke,Ze):Ze;ee>Ie.bytesTotal*_e[De].bitrate/_e[qe.getQualityFor(ne,Te)].bitrate&&($.quality=De,$.reason.throughput=Ie.measuredBandwidthInKbps,$.reason.fragmentID=Ie.id,$.reason.rule=this.getClassName(),I[Ie.id]=Ie,E.debug("["+ne+"] frag id",Ie.id," is asking to abandon and switch to quality to ",De," measured bandwidth was",Ie.measuredBandwidthInKbps),delete b[ne][Ie.id])}}else Ie.bytesLoaded===Ie.bytesTotal&&delete b[ne][Ie.id]}return $},reset:U},E=(0,u.Z)(A).getInstance().getLogger(_),U(),_}d.__dashjs_factory_name="AbandonRequestsRule",y.Z=m.Z.getClassFactory(d)},3112:function(f,y,g){var p=g(3860),m=g(2068),u=g(5448),d=g(7855),S=g(5595),_=g(8512),E=g(6398),b=g(8825),I=g(3393),T=10;function A(R){R=R||{};var O,H,U,Z=this.context,$=R.dashMetrics,F=R.mediaPlayerModel,W=(0,S.Z)(Z).getInstance();function fe(De,Ge,Et){var vt=Et.reduce((function(Oe,Fe,it){return Fe>Et[Oe]?it:Oe}),0);if(vt===0)return null;var et=Math.max(De,T+2*Ge.length),gt=(Et[vt]-1)/(et/T-1);return{gp:gt,Vp:T/gt}}function ne(De){De.placeholderBuffer=0,De.mostAdvancedSegmentStart=NaN,De.lastSegmentWasReplacement=!1,De.lastSegmentStart=NaN,De.lastSegmentDurationS=NaN,De.lastSegmentRequestTimeMs=NaN,De.lastSegmentFinishTimeMs=NaN}function de(De,Ge){var Et=F.getStableBufferTime();if(De.stableBufferTime!==Et){var vt=fe(Et,De.bitrates,De.utilities);if(vt.Vp!==De.Vp||vt.gp!==De.gp){var et=$.getCurrentBufferLevel(Ge),gt=et+De.placeholderBuffer;gt-=T,gt*=vt.Vp/De.Vp,gt+=T,De.stableBufferTime=Et,De.Vp=vt.Vp,De.gp=vt.gp,De.placeholderBuffer=Math.max(0,gt-et)}}}function Te(De,Ge){return De.Vp*(De.utilities[Ge]+De.gp)}function me(De,Ge){for(var Et=De.bitrates[Ge],vt=De.utilities[Ge],et=0,gt=Ge-1;gt>=0;--gt)if(De.utilities[gt]<De.utilities[Ge]){var Oe=De.bitrates[gt],Fe=De.utilities[gt],it=De.Vp*(De.gp+(Et*Fe-Oe*vt)/(Et-Oe));et=Math.max(et,it)}return et}function X(De){var Ge=De.mediaType===I.Z.AUDIO?[I.Z.AUDIO]:U;for(var Et in Ge)U.hasOwnProperty(Et)&&U[Et].state===2&&(U[Et].placeholderBuffer=0)}function Ie(){for(var De in U)if(U.hasOwnProperty(De)){var Ge=U[De];Ge.state!==0&&(Ge.state=1,ne(Ge))}}function Be(De){if(De&&De.chunk&&De.chunk.mediaInfo){var Ge=U[De.chunk.mediaInfo.type];if(Ge&&Ge.state!==0){var Et=De.chunk.start;isNaN(Ge.mostAdvancedSegmentStart)||Et>Ge.mostAdvancedSegmentStart?(Ge.mostAdvancedSegmentStart=Et,Ge.lastSegmentWasReplacement=!1):Ge.lastSegmentWasReplacement=!0,Ge.lastSegmentStart=Et,Ge.lastSegmentDurationS=De.chunk.duration,Ge.lastQuality=De.chunk.quality,ee(Ge,De.chunk.mediaInfo.type)}}}function qe(De){if(De&&De.metric===p.Z.HTTP_REQUEST&&De.value&&De.value.type===d.w.MEDIA_SEGMENT_TYPE&&De.value.trace&&De.value.trace.length){var Ge=U[De.mediaType];Ge&&Ge.state!==0&&(Ge.lastSegmentRequestTimeMs=De.value.trequest.getTime(),Ge.lastSegmentFinishTimeMs=De.value._tfinish.getTime(),ee(Ge,De.mediaType))}}function ee(De,Ge){if(!isNaN(De.lastSegmentStart)&&!isNaN(De.lastSegmentRequestTimeMs)&&!isNaN(De.placeholderBuffer)){if(De.placeholderBuffer*=.99,!isNaN(De.lastSegmentFinishTimeMs)){var Et=$.getCurrentBufferLevel(Ge)+.001*(De.lastSegmentFinishTimeMs-De.lastSegmentRequestTimeMs),vt=Te(De,De.lastQuality),et=Math.max(0,vt-Et);De.placeholderBuffer=Math.min(et,De.placeholderBuffer)}De.lastSegmentWasReplacement&&!isNaN(De.lastSegmentDurationS)&&(De.placeholderBuffer+=De.lastSegmentDurationS),De.lastSegmentStart=NaN,De.lastSegmentRequestTimeMs=NaN}}function _e(De){if(De){var Ge=U[De.mediaType];Ge&&Ge.state!==0&&(Ge.abrQuality=De.newQuality)}}function Ze(De){if(De){var Ge=U[De.mediaType];if(Ge&&Ge.state!==0){var Et,vt=$.getCurrentBufferLevel(De.mediaType);Et=Ge.abrQuality>0?me(Ge,Ge.abrQuality):T;var et=Math.max(0,Et-vt);Ge.placeholderBuffer=Math.min(Ge.placeholderBuffer,et)}}}function Ke(){U={}}return O={getMaxIndex:function(De){var Ge=(0,m.Z)(Z).create();if(!(De&&De.hasOwnProperty("getMediaInfo")&&De.hasOwnProperty("getMediaType")&&De.hasOwnProperty("getScheduleController")&&De.hasOwnProperty("getStreamInfo")&&De.hasOwnProperty("getAbrController")&&De.hasOwnProperty("useBufferOccupancyABR")))return Ge;var Et=De.getMediaInfo(),vt=De.getMediaType(),et=De.getScheduleController(),gt=De.getStreamInfo(),Oe=De.getAbrController(),Fe=Oe.getThroughputHistory(),it=gt?gt.id:null,w=gt&&gt.manifestInfo&&gt.manifestInfo.isDynamic,N=De.useBufferOccupancyABR();if(Ge.reason=Ge.reason||{},!N)return Ge;et.setTimeToLoadDelay(0);var G=(function(Ye){var nt=Ye.getMediaType(),mt=U[nt];return mt?mt.state!==0&&de(mt,nt):(mt=(function(Gt){var _t={},gn=Gt.getMediaInfo().bitrateList.map((function(On){return On.bandwidth})),Wt=(function(On){return On.map((function(zn){return Math.log(zn)}))})(gn);Wt=Wt.map((function(On){return On-Wt[0]+1}));var ln=F.getStableBufferTime(),cn=fe(ln,gn,Wt);return cn?(_t.state=1,_t.bitrates=gn,_t.utilities=Wt,_t.stableBufferTime=ln,_t.Vp=cn.Vp,_t.gp=cn.gp,_t.lastQuality=0,ne(_t)):_t.state=0,_t})(Ye),U[nt]=mt),mt})(De);if(G.state===0)return Ge;var V,ye=$.getCurrentBufferLevel(vt),he=Fe.getAverageThroughput(vt,w),He=Fe.getSafeAverageThroughput(vt,w),ut=Fe.getAverageLatency(vt);if(Ge.reason.state=G.state,Ge.reason.throughput=he,Ge.reason.latency=ut,isNaN(he))return Ge;switch(G.state){case 1:V=Oe.getQualityForBitrate(Et,He,it,ut),Ge.quality=V,Ge.reason.throughput=He,G.placeholderBuffer=Math.max(0,me(G,V)-ye),G.lastQuality=V,!isNaN(G.lastSegmentDurationS)&&ye>=G.lastSegmentDurationS&&(G.state=2);break;case 2:(function(Ye,nt){var mt=Date.now();if(isNaN(Ye.lastSegmentFinishTimeMs)){if(!isNaN(Ye.lastCallTimeMs)){var Gt=.001*(mt-Ye.lastCallTimeMs);Ye.placeholderBuffer+=Math.max(0,Gt)}}else{var _t=.001*(mt-Ye.lastSegmentFinishTimeMs);Ye.placeholderBuffer+=Math.max(0,_t)}Ye.lastCallTimeMs=mt,Ye.lastSegmentStart=NaN,Ye.lastSegmentRequestTimeMs=NaN,Ye.lastSegmentFinishTimeMs=NaN,de(Ye,nt)})(G,vt),V=(function(Ye,nt){for(var mt=Ye.bitrates.length,Gt=NaN,_t=NaN,gn=0;gn<mt;++gn){var Wt=(Ye.Vp*(Ye.utilities[gn]+Ye.gp)-nt)/Ye.bitrates[gn];(isNaN(_t)||Wt>=_t)&&(_t=Wt,Gt=gn)}return Gt})(G,ye+G.placeholderBuffer);var Je=Oe.getQualityForBitrate(Et,He,it,ut);V>G.lastQuality&&V>Je&&(V=Math.max(Je,G.lastQuality));var Qe=Math.max(0,ye+G.placeholderBuffer-Te(G,V));Qe<=G.placeholderBuffer?(G.placeholderBuffer-=Qe,Qe=0):(Qe-=G.placeholderBuffer,G.placeholderBuffer=0,V<Oe.getMaxAllowedIndexFor(vt,it)?et.setTimeToLoadDelay(1e3*Qe):Qe=0),Ge.quality=V,Ge.reason.throughput=he,Ge.reason.latency=ut,Ge.reason.bufferLevel=ye,Ge.reason.placeholderBuffer=G.placeholderBuffer,Ge.reason.delay=Qe,G.lastQuality=V;break;default:H.debug("BOLA ABR rule invoked in bad state."),Ge.quality=Oe.getQualityForBitrate(Et,He,it,ut),Ge.reason.state=G.state,Ge.reason.throughput=He,Ge.reason.latency=ut,G.state=1,ne(G)}return Ge},reset:function(){Ke(),W.off(b.Z.BUFFER_EMPTY,X,O),W.off(b.Z.PLAYBACK_SEEKING,Ie,O),W.off(b.Z.METRIC_ADDED,qe,O),W.off(b.Z.QUALITY_CHANGE_REQUESTED,_e,O),W.off(b.Z.FRAGMENT_LOADING_ABANDONED,Ze,O),W.off(_.Z.MEDIA_FRAGMENT_LOADED,Be,O)}},H=(0,E.Z)(Z).getInstance().getLogger(O),Ke(),W.on(b.Z.BUFFER_EMPTY,X,O),W.on(b.Z.PLAYBACK_SEEKING,Ie,O),W.on(b.Z.METRIC_ADDED,qe,O),W.on(b.Z.QUALITY_CHANGE_REQUESTED,_e,O),W.on(b.Z.FRAGMENT_LOADING_ABANDONED,Ze,O),W.on(_.Z.MEDIA_FRAGMENT_LOADED,Be,O),O}A.__dashjs_factory_name="BolaRule",y.Z=u.Z.getClassFactory(A)},895:function(f,y,g){var p=g(5448),m=g(2068),u=g(6398);function d(){var S,_,E=this.context;return S={getMaxIndex:function(b){var I=(0,m.Z)(E).create();if(!b||!b.hasOwnProperty("getDroppedFramesHistory"))return I;var T=b.getDroppedFramesHistory(),A=b.getStreamInfo().id;if(T){var R=T.getFrameHistory(A);if(!R||R.length===0)return I;for(var O=0,H=0,U=m.Z.NO_CHANGE,Z=1;Z<R.length;Z++)if(R[Z]&&(O=R[Z].droppedVideoFrames,(H=R[Z].totalVideoFrames)>375&&O/H>.15)){U=Z-1,_.debug("index: "+U+" Dropped Frames: "+O+" Total Frames: "+H);break}return(0,m.Z)(E).create(U,{droppedFrames:O})}return I}},_=(0,u.Z)(E).getInstance().getLogger(S),S}d.__dashjs_factory_name="DroppedFramesRule",y.Z=p.Z.getClassFactory(d)},6535:function(f,y,g){var p=g(5595),m=g(8512),u=g(5448),d=g(6398),S=g(2068),_=g(3393),E=g(3860),b=g(8825);function I(T){T=T||{};var A,R,O,H=this.context,U=(0,p.Z)(H).getInstance(),Z=T.dashMetrics;function $(){(O={})[_.Z.VIDEO]={ignoreCount:2},O[_.Z.AUDIO]={ignoreCount:2}}function F(){$()}function W(fe){isNaN(fe.startTime)||fe.mediaType!==_.Z.AUDIO&&fe.mediaType!==_.Z.VIDEO||O[fe.mediaType].ignoreCount>0&&O[fe.mediaType].ignoreCount--}return A={getMaxIndex:function(fe){var ne=(0,S.Z)(H).create();if(!fe||!fe.hasOwnProperty("getMediaType"))return ne;(function(){if(!Z||!Z.hasOwnProperty("getCurrentBufferLevel")||!Z.hasOwnProperty("getCurrentBufferState"))throw new Error(_.Z.MISSING_CONFIG_ERROR)})();var de=fe.getMediaType(),Te=Z.getCurrentBufferState(de),me=fe.getRepresentationInfo().fragmentDuration,X=fe.getStreamInfo(),Ie=X?X.id:null,Be=fe.getScheduleController(),qe=X&&X.manifestInfo&&X.manifestInfo.isDynamic;if((function(vt,et){return!vt&&O[et].ignoreCount>0})(Be.getPlaybackController().getLowLatencyModeEnabled(),de)||!me)return ne;if(Te&&Te.state===E.Z.BUFFER_EMPTY)R.debug("["+de+"] Switch to index 0; buffer is empty."),ne.quality=0,ne.reason="InsufficientBufferRule: Buffer is empty";else{var ee=fe.getMediaInfo(),_e=fe.getAbrController(),Ze=_e.getThroughputHistory(),Ke=Z.getCurrentBufferLevel(de),De=Ze.getAverageThroughput(de,qe),Ge=Ze.getAverageLatency(de),Et=De*(Ke/me)*.5;ne.quality=_e.getQualityForBitrate(ee,Et,Ie,Ge),ne.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return ne},reset:function(){$(),U.off(b.Z.PLAYBACK_SEEKING,F,A),U.off(m.Z.BYTES_APPENDED_END_FRAGMENT,W,A)}},R=(0,d.Z)(H).getInstance().getLogger(A),$(),U.on(b.Z.PLAYBACK_SEEKING,F,A),U.on(m.Z.BYTES_APPENDED_END_FRAGMENT,W,A),A}I.__dashjs_factory_name="InsufficientBufferRule",y.Z=u.Z.getClassFactory(I)},1914:function(f,y,g){var p=g(3860),m=g(2068),u=g(5448),d=g(7855),S=g(5595),_=g(8512),E=g(6398),b=g(3393);function I(T){T=T||{};var A,R,O,H,U=this.context,Z=T.dashMetrics,$=(0,S.Z)(U).getInstance();function F(Ie){Ie.placeholderBuffer=0,Ie.mostAdvancedSegmentStart=NaN,Ie.lastSegmentWasReplacement=!1,Ie.lastSegmentStart=NaN,Ie.lastSegmentDurationS=NaN,Ie.lastSegmentRequestTimeMs=NaN,Ie.lastSegmentFinishTimeMs=NaN,Ie.lastSegmentUrl=""}function W(){for(var Ie in R)if(R.hasOwnProperty(Ie)){var Be=R[Ie];Be.state!==0&&(Be.state=1,F(Be))}}function fe(Ie){if(Ie&&Ie.chunk&&Ie.chunk.mediaInfo){var Be=R[Ie.chunk.mediaInfo.type],qe=O[Ie.chunk.mediaInfo.type];if(Be&&Be.state!==0){var ee=Ie.chunk.start;isNaN(Be.mostAdvancedSegmentStart)||ee>Be.mostAdvancedSegmentStart?(Be.mostAdvancedSegmentStart=ee,Be.lastSegmentWasReplacement=!1):Be.lastSegmentWasReplacement=!0,Be.lastSegmentStart=ee,Be.lastSegmentDurationS=Ie.chunk.duration,Be.lastQuality=Ie.chunk.quality,de(Be,qe)}}}function ne(Ie){if(Ie&&Ie.metric===p.Z.HTTP_REQUEST&&Ie.value&&Ie.value.type===d.w.MEDIA_SEGMENT_TYPE&&Ie.value.trace&&Ie.value.trace.length){var Be=R[Ie.mediaType],qe=O[Ie.mediaType];Be&&Be.state!==0&&(Be.lastSegmentRequestTimeMs=Ie.value.trequest.getTime(),Be.lastSegmentFinishTimeMs=Ie.value._tfinish.getTime(),de(Be,qe))}}function de(Ie,Be){isNaN(Ie.lastSegmentStart)||isNaN(Ie.lastSegmentRequestTimeMs)||(Be.segment_request_start_s=.001*Ie.lastSegmentRequestTimeMs,Be.segment_download_finish_s=.001*Ie.lastSegmentFinishTimeMs,Ie.lastSegmentStart=NaN,Ie.lastSegmentRequestTimeMs=NaN)}function Te(Ie){if(Ie&&Ie.mediaType){var Be=R[Ie.mediaType];Be&&Be.state!==0&&(Be.abrQuality=Ie.newQuality)}}function me(Ie,Be){if(Ie.length!==Be.length)return-1;for(var qe=0,ee=0;ee<Ie.length;ee++)qe+=Ie[ee]*Be[ee];return qe}function X(){R={},O={}}return A={getMaxIndex:function(Ie){var Be,qe=(0,m.Z)(U).create(),ee=Math.pow(4,.99),_e=Math.max(Math.pow(4,1),ee*Math.sqrt(4)),Ze=Ie.getMediaInfo(),Ke=Ie.getMediaType(),De=Ze.bitrateList.map((function(cn){return cn.bandwidth})),Ge=De.length,Et=Ie.getScheduleController(),vt=Ie.getStreamInfo(),et=Ie.getAbrController(),gt=et.getThroughputHistory(),Oe=vt&&vt.manifestInfo&&vt.manifestInfo.isDynamic,Fe=Ie.useL2AABR(),it=Z.getCurrentBufferLevel(Ke,!0),w=gt.getSafeAverageThroughput(Ke,Oe),N=gt.getAverageThroughput(Ke,Oe),G=gt.getAverageLatency(Ke),V=Ie.getVideoModel().getPlaybackRate();if(!(Ie&&Ie.hasOwnProperty("getMediaInfo")&&Ie.hasOwnProperty("getMediaType")&&Ie.hasOwnProperty("getScheduleController")&&Ie.hasOwnProperty("getStreamInfo")&&Ie.hasOwnProperty("getAbrController")&&Ie.hasOwnProperty("useL2AABR"))||(qe.reason=qe.reason||{},!Fe||Ke===b.Z.AUDIO))return qe;Et.setTimeToLoadDelay(0);var ye=(function(cn){var On=cn.getMediaType(),zn=R[On];return zn||(zn=(function(ar){var er={},Rr=ar.getMediaInfo(),li=Rr.bitrateList.map((function(gr){return gr.bandwidth/1e3}));return er.state=1,er.bitrates=li,er.lastQuality=0,(function(gr){gr&&gr.type&&(O[gr.type]={},O[gr.type].w=[],O[gr.type].prev_w=[],O[gr.type].Q=0,O[gr.type].segment_request_start_s=0,O[gr.type].segment_download_finish_s=0,O[gr.type].B_target=1.5)})(Rr),F(er),er})(cn),R[On]=zn),zn})(Ie);if(ye.state===0)return qe;var he=O[Ke];if(!he||(qe.reason.state=ye.state,qe.reason.throughput=N,qe.reason.latency=G,isNaN(N)))return qe;switch(ye.state){case 1:if(Be=et.getQualityForBitrate(Ze,w,vt.id,G),qe.quality=Be,qe.reason.throughput=w,ye.lastQuality=Be,!isNaN(ye.lastSegmentDurationS)&&it>=he.B_target){ye.state=2,he.Q=ee;for(var He=0;He<Ge;++He)He===ye.lastQuality?he.prev_w[He]=1:he.prev_w[He]=0}break;case 2:var ut=[],Je=Z.getCurrentHttpRequest(Ke).trace.reduce((function(cn,On){return cn+On.d}),0),Qe=Z.getCurrentHttpRequest(Ke).trace.reduce((function(cn,On){return cn+On.b[0]}),0),Ye=Math.round(8*Qe/Je),nt=Z.getCurrentHttpRequest(Ke);if(Ye<1&&(Ye=1),nt.url===ye.lastSegmentUrl||nt.type===d.w.INIT_SEGMENT_TYPE)Be=ye.lastQuality;else{for(var mt=ye.lastSegmentDurationS,Gt=1,_t=0;_t<Ge;++_t)De[_t]=De[_t]/1e3,V*De[_t]>Ye&&(Gt=-1),he.w[_t]=he.prev_w[_t]+Gt*(mt/(2*_e))*((he.Q+ee)*(V*De[_t]/Ye));he.w=(function(cn){for(var On=cn.length,zn=!1,ar=[],er=0;er<On;++er)ar[er]=cn[er];for(var Rr=cn.sort((function(ui,ii){return ii-ui})),li=0,gr=0,gi=[],Zr=0;Zr<On-1;++Zr)if((gr=((li+=Rr[Zr])-1)/(Zr+1))>=Rr[Zr+1]){zn=!0;break}zn||(gr=(li+Rr[On-1]-1)/On);for(var ri=0;ri<On;++ri)gi[ri]=Math.max(ar[ri]-gr,0);return gi})(he.w);for(var gn=0;gn<Ge;++gn)ut[gn]=he.w[gn]-he.prev_w[gn],he.prev_w[gn]=he.w[gn];he.Q=Math.max(0,he.Q-mt+mt*V*((me(De,he.prev_w)+me(De,ut))/Ye));for(var Wt=[],ln=0;ln<Ge;++ln)Wt[ln]=Math.abs(De[ln]-me(he.w,De));(Be=Wt.indexOf(Math.min.apply(Math,Wt)))>ye.lastQuality&&De[ye.lastQuality+1]<=Ye&&(Be=ye.lastQuality+1),De[Be]>=Ye&&(he.Q=2*Math.max(ee,he.Q)),ye.lastSegmentUrl=nt.url}qe.quality=Be,qe.reason.throughput=N,qe.reason.latency=G,qe.reason.bufferLevel=it,ye.lastQuality=qe.quality;break;default:H.debug("L2A ABR rule invoked in bad state."),qe.quality=et.getQualityForBitrate(Ze,w,vt.id,G),qe.reason.state=ye.state,qe.reason.throughput=w,qe.reason.latency=G,ye.state=1,F(ye)}return qe},reset:function(){X(),$.off(_.Z.PLAYBACK_SEEKING,W,A),$.off(_.Z.MEDIA_FRAGMENT_LOADED,fe,A),$.off(_.Z.METRIC_ADDED,ne,A),$.off(_.Z.QUALITY_CHANGE_REQUESTED,Te,A)}},H=(0,E.Z)(U).getInstance().getLogger(A),X(),$.on(_.Z.PLAYBACK_SEEKING,W,A),$.on(_.Z.MEDIA_FRAGMENT_LOADED,fe,A),$.on(_.Z.METRIC_ADDED,ne,A),$.on(_.Z.QUALITY_CHANGE_REQUESTED,Te,A),A}I.__dashjs_factory_name="L2ARule",y.Z=u.Z.getClassFactory(I)},6070:function(f,y,g){var p=g(5448),m=g(6398),u=g(2068);function d(){var S,_,E=this.context;return S={getMaxIndex:function(b){for(var I=b?b.getSwitchHistory():null,T=I?I.getSwitchRequests():[],A=0,R=0,O=0,H=(0,u.Z)(E).create(),U=0;U<T.length;U++)if(T[U]!==void 0&&(A+=T[U].drops,R+=T[U].noDrops,O+=T[U].dropSize,A+R>=6&&A/R>.075)){H.quality=U>0&&T[U].drops>0?U-1:U,H.reason={index:H.quality,drops:A,noDrops:R,dropSize:O},_.debug("Switch history rule index: "+H.quality+" samples: "+(A+R)+" drops: "+A);break}return H}},_=(0,m.Z)(E).getInstance().getLogger(S),S}d.__dashjs_factory_name="SwitchHistoryRule",y.Z=p.Z.getClassFactory(d)},5628:function(f,y,g){var p=g(5448),m=g(2068),u=g(3393),d=g(3860);function S(_){_=_||{};var E=this.context,b=_.dashMetrics;return{getMaxIndex:function(I){var T=(0,m.Z)(E).create();if(!(I&&I.hasOwnProperty("getMediaInfo")&&I.hasOwnProperty("getMediaType")&&I.hasOwnProperty("useBufferOccupancyABR")&&I.hasOwnProperty("getAbrController")&&I.hasOwnProperty("getScheduleController")))return T;(function(){if(!b||!b.hasOwnProperty("getCurrentBufferState"))throw new Error(u.Z.MISSING_CONFIG_ERROR)})();var A=I.getMediaInfo(),R=I.getMediaType(),O=b.getCurrentBufferState(R),H=I.getScheduleController(),U=I.getAbrController(),Z=I.getStreamInfo(),$=Z?Z.id:null,F=Z&&Z.manifestInfo?Z.manifestInfo.isDynamic:null,W=U.getThroughputHistory(),fe=W.getSafeAverageThroughput(R,F),ne=W.getAverageLatency(R),de=I.useBufferOccupancyABR();return isNaN(fe)||!O||de||U.getAbandonmentStateFor($,R)!==d.Z.ABANDON_LOAD&&(O.state===d.Z.BUFFER_LOADED||F)&&(T.quality=U.getQualityForBitrate(A,fe,$,ne),H.setTimeToLoadDelay(0),T.reason={throughput:fe,latency:ne}),T},reset:function(){}}}S.__dashjs_factory_name="ThroughputRule",y.Z=p.Z.getClassFactory(S)},4722:function(f,y,g){var p=g(5448),m=g(6398);function u(){var d,S,_,E,b,I,T,A,R,O=this.context;function H(){_=null,E=1,b=100,I=0,T=null,A=null,R="dynamic_weight_selection"}function U(){var fe=0;if(_)for(var ne=0;ne<_.length;ne++){var de=_[ne];de.state.throughput>fe&&(fe=de.state.throughput)}return fe}function Z(fe,ne,de){var Te=fe.map((function(me,X){return de[X]*Math.pow(me-ne[X],2)})).reduce((function(me,X){return me+X}));return(Te<0?-1:1)*Math.sqrt(Math.abs(Te))}function $(fe,ne){return Z([fe.state.throughput,fe.state.latency,fe.state.rebuffer,fe.state.switch],[ne.state.throughput,ne.state.latency,ne.state.rebuffer,ne.state.switch],[1,1,1,1])}function F(fe,ne,de){for(var Te=0;Te<ne.length;Te++){var me=ne[Te],X=$(me,fe);W(me,de,Math.exp(-1*Math.pow(X,2)/(2*Math.pow(.1,2))))}}function W(fe,ne,de){var Te=fe.state,me=[.01,.01,.01,.01];Te.throughput=Te.throughput+(ne[0]-Te.throughput)*me[0]*de,Te.latency=Te.latency+(ne[1]-Te.latency)*me[1]*de,Te.rebuffer=Te.rebuffer+(ne[2]-Te.rebuffer)*me[2]*de,Te.switch=Te.switch+(ne[3]-Te.switch)*me[3]*de}return d={getNextQuality:function(fe,ne,de,Te,me,X,Ie){var Be=de,qe=Te,ee=ne,_e=(function(he){if(!_){_=[];var He=he.bitrateList,ut=[];I=He[0].bandwidth,He.forEach((function(nt){ut.push(nt.bandwidth),nt.bandwidth<I&&(I=nt.bandwidth)})),Ye=ut.map((function(nt){return Math.pow(nt,2)})).reduce((function(nt,mt){return nt+mt})),E=Math.sqrt(Ye);for(var Je=0;Je<He.length;Je++){var Qe={qualityIndex:Je,bitrate:He[Je].bandwidth,state:{throughput:He[Je].bandwidth/E,latency:0,rebuffer:0,switch:0}};_.push(Qe)}A=(function(nt){var mt=[],Gt=(function(Us){for(var qt=[],Vt=0;Vt<Us;Vt++){var Kt=[Math.random()*U(),Math.random(),Math.random(),Math.random()];qt.push(Kt)}return qt})(Math.pow(nt.length,2));mt.push(Gt[0]);for(var _t=[1,1,1,1],gn=1;gn<nt.length;gn++){for(var Wt=null,ln=null,cn=0;cn<Gt.length;cn++){for(var On=Gt[cn],zn=null,ar=0;ar<mt.length;ar++){var er=Z(On,mt[ar],_t);(zn===null||er<zn)&&(zn=er)}(ln===null||zn>ln)&&(Wt=On,ln=zn)}mt.push(Wt)}for(var Rr=null,li=null,gr=0;gr<mt.length;gr++){for(var gi=0,Zr=0;Zr<mt.length;Zr++)gr!==Zr&&(gi+=Z(mt[gr],mt[Zr],_t));(Rr===null||gi>Rr)&&(Rr=gi,li=gr)}var ri=[];for(ri.push(mt[li]),mt.splice(li,1);mt.length>0;){for(var ui=null,ii=null,bi=0;bi<mt.length;bi++){var zi=Z(ri[0],mt[bi],_t);(ui===null||zi<ui)&&(ui=zi,ii=bi)}ri.push(mt[ii]),mt.splice(ii,1)}return ri})(_)}var Ye;return _})(fe),Ze=ne/E;Ze>1&&(Ze=U()),de/=b,S.debug("getNextQuality called throughput:".concat(Ze," latency:").concat(de," bufferSize:").concat(Te," currentQualityIndex:").concat(X," playbackRate:").concat(me));var Ke=_e[X],De=Ke.bitrate*Ie.getSegmentDuration()/ee,Ge=Math.max(0,De-qe);if(qe-De<Ie.getMinBuffer())return S.debug("Buffer is low for bitrate= ".concat(Ke.bitrate," downloadTime=").concat(De," currentBuffer=").concat(qe," rebuffer=").concat(Ge)),(function(he,He){var ut=0,Je=he;if(_)for(var Qe=0;Qe<_.length;Qe++){var Ye=_[Qe];Ye.bitrate<he.bitrate&&Ye.bitrate>ut&&He>Ye.bitrate&&(ut=Ye.bitrate,Je=Ye)}return Je})(Ke,ee).qualityIndex;switch(R){case"manual_weight_selection":T=[.4,.4,.4,.4];break;case"random_weight_selection":(function(he){T=(function(He,ut){for(var Je=[],Qe=Math.sqrt(2/He),Ye=0;Ye<4;Ye++)Je.push(Math.random()*Qe);return T=Je})(he.length)})(_e);break;default:(function(he,He,ut,Je,Qe,Ye,nt){T||(T=A[A.length-1]);var mt=he.findWeightVector(He,ut,Je,Qe,Ye,nt);mt!==null&&mt!==-1&&(T=mt)})(Ie,_e,Be,qe,Ge,ee,me)}for(var Et=null,vt=null,et=null,gt=0;gt<_e.length;gt++){var Oe=_e[gt],Fe=Oe.state,it=[Fe.throughput,Fe.latency,Fe.rebuffer,Fe.switch],w=T.slice(),N=Ie.getNextBufferWithBitrate(Oe.bitrate,qe,ee),G=N<Ie.getMinBuffer();G&&S.debug("Buffer is low for bitrate=".concat(Oe.bitrate," downloadTime=").concat(De," currentBuffer=").concat(qe," nextBuffer=").concat(N)),(Oe.bitrate>ne-1e4||G)&&Oe.bitrate!==I&&(w[0]=100);var V=Z(it,[Ze,0,0,0],w);(Et===null||V<Et)&&(Et=V,vt=Oe.qualityIndex,et=Oe)}var ye=Math.abs(Ke.bitrate-et.bitrate)/E;return F(Ke,_e,[Ze,de,Ge,ye]),F(et,_e,[Ze,0,0,ye]),vt},reset:function(){H()}},S=(0,m.Z)(O).getInstance().getLogger(d),H(),d}u.__dashjs_factory_name="LearningAbrController",y.Z=p.Z.getClassFactory(u)},5317:function(f,y,g){var p=g(5448),m=g(2298);function u(){var d,S,_,E,b;function I(){S=null,_=null,E=null,b=null}function T(R,O,H,U){var Z=new m.Z;return Z.type=R,Z.weights.bitrateReward=O||1,Z.weights.bitrateSwitchPenalty=1,Z.weights.rebufferPenalty=H||1e3,Z.weights.latencyPenalty=[],Z.weights.latencyPenalty.push({threshold:1.1,penalty:.05*U}),Z.weights.latencyPenalty.push({threshold:1e8,penalty:.1*H}),Z.weights.playbackSpeedPenalty=U||200,Z}function A(R,O,H,U,Z){Z.bitrateWSum+=Z.weights.bitrateReward*R,Z.lastBitrate&&(Z.bitrateSwitchWSum+=Z.weights.bitrateSwitchPenalty*Math.abs(R-Z.lastBitrate)),Z.lastBitrate=R,Z.rebufferWSum+=Z.weights.rebufferPenalty*O;for(var $=0;$<Z.weights.latencyPenalty.length;$++){var F=Z.weights.latencyPenalty[$];if(H<=F.threshold){Z.latencyWSum+=F.penalty*H;break}}Z.playbackSpeedWSum+=Z.weights.playbackSpeedPenalty*Math.abs(1-U),Z.totalQoe=Z.bitrateWSum-Z.bitrateSwitchWSum-Z.rebufferWSum-Z.latencyWSum-Z.playbackSpeedWSum}return d={setupPerSegmentQoe:function(R,O,H){S=T("segment",R,O,H),_=R,E=O,b=H},logSegmentMetrics:function(R,O,H,U){S&&A(R,O,H,U,S)},getPerSegmentQoe:function(){return S},calculateSingleUseQoe:function(R,O,H,U){var Z=null;return _&&E&&b&&(Z=T("segment",_,E,b)),Z?(A(R,O,H,U,Z),Z.totalQoe):0},reset:function(){I()}},I(),d}u.__dashjs_factory_name="LoLpQoeEvaluator",y.Z=p.Z.getClassFactory(u)},5435:function(f,y,g){var p=g(6398),m=g(5448),u=g(4722),d=g(5317),S=g(2068),_=g(3860),E=g(6523),b=g(3393);function I(T){var A,R,O,H,U=(T=T||{}).dashMetrics,Z=this.context;return R={getMaxIndex:function($){try{var F=(0,S.Z)(Z).create(),W=$.getMediaInfo().type,fe=$.getAbrController(),ne=$.getStreamInfo(),de=fe.getQualityFor(W,ne.id),Te=$.getMediaInfo(),me=U.getCurrentBufferState(W),X=$.getScheduleController(),Ie=U.getCurrentBufferLevel(W,!0),Be=ne&&ne.manifestInfo?ne.manifestInfo.isDynamic:null,qe=X.getPlaybackController(),ee=qe.getCurrentLiveLatency();if(!$.useLoLPABR()||W===b.Z.AUDIO)return F;ee||(ee=0);var _e=qe.getPlaybackRate(),Ze=fe.getThroughputHistory().getSafeAverageThroughput(W,Be);if(A.debug("Throughput ".concat(Math.round(Ze)," kbps")),isNaN(Ze)||!me||fe.getAbandonmentStateFor(ne.id,W)===_.Z.ABANDON_LOAD)return F;for(var Ke=Te.bitrateList,De=$.getRepresentationInfo().fragmentDuration,Ge=Ke[0].bandwidth/1e3,Et=Ke[Ke.length-1].bandwidth/1e3,vt=0;vt<Ke.length;vt++){var et=Ke[vt].bandwidth/1e3;et>Et?Et=et:et<Ge&&(Ge=et)}var gt=Ke[de].bandwidth/1e3,Oe=U.getCurrentHttpRequest(W,!0),Fe=(Oe.tresponse.getTime()-Oe.trequest.getTime())/1e3,it=Fe>De?Fe-De:0;H.setupPerSegmentQoe(De,Et,Ge),H.logSegmentMetrics(gt,it,ee,_e);var w=(0,E.Z)(Z).create({targetLatency:1.5,bufferMin:.3,segmentDuration:De,qoeEvaluator:H});return F.quality=O.getNextQuality(Te,1e3*Ze,ee,Ie,_e,de,w),F.reason={throughput:Ze,latency:ee},F.priority=S.Z.PRIORITY.STRONG,X.setTimeToLoadDelay(0),F.quality!==de&&A.debug("[TgcLearningRule]["+W+"] requesting switch to index: ",F.quality,"Average throughput",Math.round(Ze),"kbps"),F}catch(N){throw N}},reset:function(){O.reset(),H.reset()}},A=(0,p.Z)(Z).getInstance().getLogger(R),O=(0,u.Z)(Z).create(),H=(0,d.Z)(Z).create(),R}I.__dashjs_factory_name="LoLPRule",y.Z=m.Z.getClassFactory(I)},6523:function(f,y,g){var p=g(5448);function m(u){var d,S,_,E,b=u.targetLatency,I=u.bufferMin,T=u.segmentDuration,A=u.qoeEvaluator;function R(){return T}function O(H,U){var Z=R();return U>Z?H-Z:H+Z-U}return d={getMinBuffer:function(){return I},getSegmentDuration:R,getNextBufferWithBitrate:function(H,U,Z){return O(U,H*T/Z)},getNextBuffer:O,findWeightVector:function(H,U,Z,$,F,W){var fe=null,ne=null,de=null,Te=Math.abs(U-_);return H.forEach((function(me){S.forEach((function(X){X[0];var Ie=X[1],Be=X[2],qe=(X[3],me.bitrate*T/F),ee=O(Z,qe),_e=(Be===0?10:1/Be)*Math.max(1e-5,qe-ee),Ze=(Ie===0?10:1/Ie)*me.state.latency,Ke=A.calculateSingleUseQoe(me.bitrate,_e,Ze,W);(fe===null||Ke>fe)&&(function(De,Ge,Et){return!(De>b+Et)&&Ge>=I})(U,ee,Te)&&(fe=Ke,ne=X,de=me.bitrate)}))})),ne===null&&de===null&&(ne=-1),_=U,ne}},S=(function H(U,Z,$){if($===Z)return U;for(var F=U.length,W=0;W<F;W++)for(var fe=U.shift(),ne=0;ne<E.length;ne++)U.push(fe.concat(E[ne]));return H(U,Z,$+1)})((E=[.2,.4,.6,.8,1]).map((function(H){return[H]})),4,1),_=0,d}m.__dashjs_factory_name="LoLpWeightSelector",y.Z=p.Z.getClassFactory(m)},2298:function(f,y){y.Z=function g(){(function(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")})(this,g),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0}},7803:function(f,y,g){g.d(y,{Y:function(){return A}});var p=g(3393),m=g(1553),u=g(5448),d=g(2128),S=g(2594),_=g(7387),E=g(7417),b=g(9032),I=g(9326),T=g(7802),A=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function R(O){var H,U,Z,$,F,W,fe,ne,de=this.context,Te=O.adapter,me=O.baseURLController,X=O.streamInfo,Ie=O.timelineConverter,Be=O.debug,qe=O.eventBus,ee=O.events,_e=O.dashConstants,Ze=(0,S.Z)(de).getInstance();function Ke(Ge,Et){var vt=new d.Z;vt.id=Ge.id,vt.bitrate=Ge.bandwidth,vt.width=Ge.width,vt.height=Ge.height,vt.tilesHor=1,vt.tilesVert=1,Ge.essentialProperties&&Ge.essentialProperties.forEach((function(et){if(A.indexOf(et.schemeIdUri)>=0&&et.value){var gt=et.value.split("x");gt.length!==2||isNaN(gt[0])||isNaN(gt[1])||(vt.tilesHor=parseInt(gt[0],10),vt.tilesVert=parseInt(gt[1],10))}})),Et?W.updateSegmentData(Ge).then((function(et){(function(gt,Oe,Fe){var it=[],w=(function(N,G){var V,ye,he,He,ut=[],Je=0;for(V=0,ye=N.segments.length;V<ye;V++)he=N.segments[V],(He=(0,_.TJ)(Ie,Te.getIsDynamic(),G,he.startTime,he.duration,he.timescale,he.media,he.mediaRange,Je))&&(ut.push(He),He=null,Je++);return ut})(Fe,Oe);Oe.segments=w,gt.segmentDuration=Oe.segments[0].duration,gt.readThumbnail=function(N,G){var V=null;it.some((function(ye){if(ye.start<=N&&ye.end>N)return V=ye.url,!0})),V?G(V):Oe.segments.some((function(ye){if(ye.mediaStartTime<=N&&ye.mediaStartTime+ye.duration>N){var he=me.resolve(Oe.path);return fe.load({method:"get",url:he.url,request:{range:ye.mediaRange,responseType:"arraybuffer"},onload:function(He){var ut=ne.getSamplesInfo(He.target.response),Je=new Blob([He.target.response.slice(ut.sampleList[0].offset,ut.sampleList[0].offset+ut.sampleList[0].size)],{type:"image/jpeg"}),Qe=window.URL.createObjectURL(Je);it.push({start:ye.mediaStartTime,end:ye.mediaStartTime+ye.duration,url:Qe}),G&&G(Qe)}}),!0}}))}})(vt,Ge,et)})):(vt.startNumber=Ge.startNumber,vt.segmentDuration=Ge.segmentDuration,vt.timescale=Ge.timescale,vt.templateUrl=(function(et){var gt=Ze.isRelative(et.media)?Ze.resolve(et.media,me.resolve(et.path).url):et.media;return gt?(0,_.Aj)(gt,et.id):""})(Ge)),vt.tilesHor>0&&vt.tilesVert>0&&(vt.widthPerTile=vt.width/vt.tilesHor,vt.heightPerTile=vt.height/vt.tilesVert,U.push(vt))}function De(){U=[],$=-1,F=null}return H={getTracks:function(){return U},addTracks:function(){if(X&&Te&&(F=Te.getMediaInfoForType(X,p.Z.IMAGE))){var Ge=Te.getVoRepresentations(F);Ge&&Ge.length>0&&Ge.forEach((function(Et){(Et.segmentInfoType===m.Z.SEGMENT_TEMPLATE&&Et.segmentDuration>0&&Et.media||Et.segmentInfoType===m.Z.SEGMENT_TIMELINE)&&Ke(Et),Et.segmentInfoType===m.Z.SEGMENT_BASE&&Ke(Et,!0)})),U.length>0&&U.sort((function(Et,vt){return Et.bitrate-vt.bitrate}))}},reset:De,setTrackByIndex:function(Ge){U&&U.length!==0&&(Ge>=U.length&&(Ge=U.length-1),$=Ge)},getCurrentTrack:function(){return $<0?null:U[$]},getCurrentTrackIndex:function(){return $},getThumbnailRequestForTime:function(Ge){for(var Et,vt=Te.getVoRepresentations(F),et=0;et<vt.length;et++)if(U[$].id===vt[et].id){Et=vt[et];break}return Z.getSegmentRequestForTime(F,Et,Ge)}},De(),fe=(0,b.Z)(de).create({}),ne=(0,E.Z)(de).getInstance(),W=(0,T.Z)(de).create({events:ee,eventBus:qe,streamInfo:X,timelineConverter:Ie,dashConstants:_e,dashMetrics:O.dashMetrics,segmentBaseController:O.segmentBaseController,type:p.Z.IMAGE}),(Z=(0,I.Z)(de).create({streamInfo:X,type:p.Z.IMAGE,timelineConverter:Ie,segmentsController:W,baseURLController:me,debug:Be,eventBus:qe,events:ee,dashConstants:_e,urlUtils:Ze})).initialize(!!Te&&Te.getIsDynamic()),H}R.__dashjs_factory_name="ThumbnailTracks",y.Z=u.Z.getClassFactory(R)},7417:function(f,y,g){var p=g(6398),m=g(8260),u=g(5448),d=g(6934),S=g(9597);function _(){var E,b,I=this.context;function T(O){if(!O)return null;O.fileStart===void 0&&(O.fileStart=0);var H=d.parseBuffer(O),U=(0,m.Z)(I).create();return U.setData(H),U}function A(O,H){return O[H+3]>>>0|O[H+2]<<8>>>0|O[H+1]<<16>>>0|O[H]<<24>>>0}function R(O,H){return String.fromCharCode(O[H++])+String.fromCharCode(O[H++])+String.fromCharCode(O[H++])+String.fromCharCode(O[H])}return b={parse:T,findLastTopIsoBoxCompleted:function(O,H,U){if(U===void 0&&(U=0),!H||U+8>=H.byteLength)return new S.Z(0,!1);for(var Z,$=H instanceof ArrayBuffer?new Uint8Array(H):H,F=0;U<$.byteLength;){var W=A($,U),fe=R($,U+4);if(W===0)break;U+W<=$.byteLength&&(O.indexOf(fe)>=0?Z=new S.Z(U,!0,W):F=U+W),U+=W}return Z||new S.Z(F,!1)},getMediaTimescaleFromMoov:function(O){var H=T(O),U=H?H.getBox("mdhd"):void 0;return U?U.timescale:NaN},getSamplesInfo:function(O){if(!O||O.byteLength===0)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var H,U,Z,$,F,W,fe,ne,de,Te,me,X,Ie,Be,qe,ee,_e=T(O),Ze=_e.getBoxes("moof"),Ke=_e.getBoxes("mfhd");qe=_e.getBoxes("moof").length,Be=Ke[Ke.length-1].sequence_number,U=0,F=[];var De=-1,Ge=-1;for(Te=0;Te<Ze.length;Te++){var Et=Ze[Te],vt=Et.getChildBoxes("traf");for(ne=0;ne<vt.length;ne++){var et=vt[ne],gt=et.getChildBox("tfhd"),Oe=et.getChildBox("tfdt");$=Oe.baseMediaDecodeTime;var Fe=et.getChildBoxes("trun"),it=et.getChildBoxes("subs");for(de=0;de<Fe.length;de++){var w=Fe[de];for(U=w.sample_count,Ie=(gt.base_data_offset||0)+(w.data_offset||0),fe=0;fe<U;fe++){H=(W=w.samples[fe]).sample_duration!==void 0?W.sample_duration:gt.default_sample_duration,Z=W.sample_size!==void 0?W.sample_size:gt.default_sample_size;var N={dts:$,cts:$+(W.sample_composition_time_offset!==void 0?W.sample_composition_time_offset:0),duration:H,offset:Et.offset+Ie,size:Z,subSizes:[Z]};if(it)for(me=0;me<it.length;me++){var G=it[me];if(De<G.entry_count-1&&fe>Ge&&(De++,Ge+=G.entries[De].sample_delta),fe==Ge){N.subSizes=[];var V=G.entries[De];for(X=0;X<V.subsample_count;X++)N.subSizes.push(V.subsamples[X].subsample_size)}}F.push(N),Ie+=Z,$+=H}}ee=$-Oe.baseMediaDecodeTime}}return{sampleList:F,lastSequenceNumber:Be,totalDuration:ee,numSequences:qe}},findInitRange:function(O){var H=null,U=T(O);if(!U)return H;var Z=U.getBox("ftyp"),$=U.getBox("moov");return E.debug("Searching for initialization."),$&&$.isComplete&&(H=(Z?Z.offset:$.offset)+"-"+($.offset+$.size-1),E.debug("Found the initialization.  Range: "+H)),H},parsePayload:function(O,H,U){if(U===void 0&&(U=0),!H||U+8>=H.byteLength)return new S.Z(0,!1);for(var Z,$=H instanceof ArrayBuffer?new Uint8Array(H):H,F=0;U<$.byteLength;){var W=A($,U),fe=R($,U+4);if(W===0)break;U+W<=$.byteLength&&(O.indexOf(fe)>=0?Z=new S.Z(U,!0,W,fe):F=U+W),U+=W}return Z||new S.Z(F,!1)}},E=(0,p.Z)(I).getInstance().getLogger(b),b}_.__dashjs_factory_name="BoxParser",y.Z=u.Z.getSingletonFactory(_)},1715:function(f,y,g){g.d(y,{B:function(){return S}});var p=g(5448),m=g(7803),u=g(3393),d=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function S(){var E="ManagedMediaSource"in window,b="WebKitMediaSource"in window,I="MediaSource"in window;return E||b||I}function _(){var E,b,I;return E={setConfig:function(T){T&&T.settings&&(b=T.settings)},supportsMediaSource:S,supportsEncryptedMedia:function(){return I},supportsCodec:function(T,A){return A!==u.Z.AUDIO&&A!==u.Z.VIDEO?Promise.resolve(!0):(function(R,O){return b.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(R.codec&&O===u.Z.AUDIO||O===u.Z.VIDEO&&R.codec&&R.width&&R.height&&R.bitrate&&R.framerate)})(T,A)?(function(R,O){return new Promise((function(H){if(R&&R.codec){var U={type:"media-source"};U[O]={},U[O].contentType=R.codec,U[O].width=R.width,U[O].height=R.height,U[O].bitrate=parseInt(R.bitrate),U[O].framerate=parseFloat(R.framerate),navigator.mediaCapabilities.decodingInfo(U).then((function(Z){H(Z.supported)})).catch((function(){H(!1)}))}else H(!1)}))})(T,A):(function(R){return new Promise((function(O){if(R&&R.codec){var H=R.codec;R.width&&R.height&&(H+=';width="'+R.width+'";height="'+R.height+'"'),"ManagedMediaSource"in window&&ManagedMediaSource.isTypeSupported(H)||"MediaSource"in window&&MediaSource.isTypeSupported(H)||"WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(H)?O(!0):O(!1)}else O(!1)}))})(T)},setEncryptedMediaSupported:function(T){I=T},supportsEssentialProperty:function(T){try{return m.Y.indexOf(T.schemeIdUri)!==-1||u.Z.FONT_DOWNLOAD_DVB_SCHEME===T.schemeIdUri}catch{return!0}},codecRootCompatibleWithCodec:function(T,A){for(var R,O=T.split(".")[0],H=A.indexOf(O)===0,U=0;U<d.length;U++)if(d[U].codec===O){R=d[U];break}return R?H||R.compatibleCodecs.some((function(Z){return A.indexOf(Z)===0})):H}},I=!1,E}_.__dashjs_factory_name="Capabilities",y.Z=p.Z.getSingletonFactory(_)},2295:function(f,y,g){var p=g(5448),m=g(3106);function u(){return{customTimeRangeArray:[],length:0,add:function(d,S){var _;for(_=0;_<this.customTimeRangeArray.length&&d>this.customTimeRangeArray[_].start;_++);for(this.customTimeRangeArray.splice(_,0,{start:d,end:S}),_=0;_<this.customTimeRangeArray.length-1;_++)this.mergeRanges(_,_+1)&&_--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(d,S){for(var _=0;_<this.customTimeRangeArray.length;_++)if(d<=this.customTimeRangeArray[_].start&&S>=this.customTimeRangeArray[_].end)this.customTimeRangeArray.splice(_,1),_--;else{if(d>this.customTimeRangeArray[_].start&&S<this.customTimeRangeArray[_].end){this.customTimeRangeArray.splice(_+1,0,{start:S,end:this.customTimeRangeArray[_].end}),this.customTimeRangeArray[_].end=d;break}d>this.customTimeRangeArray[_].start&&d<this.customTimeRangeArray[_].end?this.customTimeRangeArray[_].end=d:S>this.customTimeRangeArray[_].start&&S<this.customTimeRangeArray[_].end&&(this.customTimeRangeArray[_].start=S)}this.length=this.customTimeRangeArray.length},mergeRanges:function(d,S){var _=this.customTimeRangeArray[d],E=this.customTimeRangeArray[S];return _.start<=E.start&&E.start<=_.end&&_.end<=E.end?(_.end=E.end,this.customTimeRangeArray.splice(S,1),!0):E.start<=_.start&&_.start<=E.end&&E.end<=_.end?(_.start=E.start,this.customTimeRangeArray.splice(S,1),!0):E.start<=_.start&&_.start<=E.end&&_.end<=E.end?(this.customTimeRangeArray.splice(d,1),!0):_.start<=E.start&&E.start<=_.end&&E.end<=_.end&&(this.customTimeRangeArray.splice(S,1),!0)},start:function(d){return(0,m.SE)(d),d>=this.customTimeRangeArray.length||d<0?NaN:this.customTimeRangeArray[d].start},end:function(d){return(0,m.SE)(d),d>=this.customTimeRangeArray.length||d<0?NaN:this.customTimeRangeArray[d].end}}}u.__dashjs_factory_name="CustomTimeRanges",y.Z=p.Z.getClassFactory(u)},5:function(f,y,g){var p=g(5448);function m(){var u,d=/^[a-z][a-z0-9+\-_.]*:/i,S=/^https?:\/\//i,_=/^https:\/\//i,E=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,b=function(Z,$){try{return new window.URL(Z,$).toString()}catch{return Z}},I=function(Z,$){var F=T;if(!$||!O(Z))return Z;H(Z)&&(F=A),U(Z)&&(F=R);var W=F($),fe=W.charAt(W.length-1)!=="/"&&Z.charAt(0)!=="/"?"/":"";return[W,Z].join(fe)};function T(Z){var $=Z.indexOf("/"),F=Z.lastIndexOf("/");return $!==-1?F===$+1?Z:(Z.indexOf("?")!==-1&&(Z=Z.substring(0,Z.indexOf("?"))),Z.substring(0,F+1)):""}function A(Z){var $=Z.match(E);return $?$[1]:""}function R(Z){var $=Z.match(d);return $?$[0]:""}function O(Z){return!d.test(Z)}function H(Z){return O(Z)&&Z.charAt(0)==="/"}function U(Z){return Z.indexOf("//")===0}return(function(){try{new window.URL("x","http://y"),u=b}catch{}finally{u=u||I}})(),{parseBaseUrl:T,parseOrigin:A,parseScheme:R,isRelative:O,isPathAbsolute:H,isSchemeRelative:U,isHTTPURL:function(Z){return S.test(Z)},isHTTPS:function(Z){return _.test(Z)},removeHostname:function(Z){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(Z)[2].substring(1)},resolve:function(Z,$){return u(Z,$)}}}m.__dashjs_factory_name="DefaultURLUtils",y.Z=p.Z.getSingletonFactory(m)},8260:function(f,y,g){var p=g(2839),m=g(5448);function u(){var d;function S(E){var b=[];if(!E||!d||typeof d.fetchAll!="function")return b;for(var I,T=d.fetchAll(E),A=0,R=T.length;A<R;A++)(I=_(T[A]))&&b.push(I);return b}function _(E){if(!E)return null;var b=new p.Z(E);return E.hasOwnProperty("_incomplete")&&(b.isComplete=!E._incomplete),b}return{getBox:function(E){return E&&d&&d.boxes&&d.boxes.length!==0&&typeof d.fetch=="function"?_(d.fetch(E)):null},getBoxes:S,setData:function(E){d=E},getLastBox:function(){if(!d||!d.boxes||!d.boxes.length)return null;var E=S(d.boxes[d.boxes.length-1].type);return E.length>0?E[E.length-1]:null}}}u.__dashjs_factory_name="IsoFile",y.Z=m.Z.getClassFactory(u)},7473:function(f,y,g){g.d(y,{k:function(){return m}});var p=g(5448);function m(d,S){var _={url:d.url,method:d.method,headers:Object.assign({},d.headers),credentials:d.withCredentials?"include":void 0,range:d.request.range};return Promise.resolve(S.modifyRequest(_)).then((function(){return Object.assign(d,_,{withCredentials:_.credentials==="include"})}))}function u(){return{modifyRequest:null,modifyRequestURL:function(d){return d},modifyRequestHeader:function(d,S){return S.url,d}}}u.__dashjs_factory_name="RequestModifier",y.Z=p.Z.getSingletonFactory(u)},3106:function(f,y,g){g.d(y,{PS:function(){return u},SE:function(){return d}});var p=g(3393);function m(S){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},m(S)}function u(S,_){if(m(S)!==_)throw p.Z.BAD_ARGUMENT_ERROR}function d(S){if(S===null||isNaN(S)||S%1!=0)throw p.Z.BAD_ARGUMENT_ERROR+" : argument is not an integer"}},2594:function(f,y,g){var p=g(5448),m=g(5);function u(){var S,_=[],E=this.context;function b(I,T,A){var R=(function(O){var H;for(H=0;H<_.length;H++)if(_[H].regex.test(O))return _[H].utils;return S})(A||T);return R&&typeof R[I]=="function"?R[I](T,A):S[I](T,A)}return S=(0,m.Z)(E).getInstance(),{registerUrlRegex:function(I,T){_.push({regex:I,utils:T})},parseBaseUrl:function(I){return b("parseBaseUrl",I)},parseOrigin:function(I){return b("parseOrigin",I)},parseScheme:function(I){return b("parseScheme",I)},isRelative:function(I){return b("isRelative",I)},isPathAbsolute:function(I){return b("isPathAbsolute",I)},isSchemeRelative:function(I){return b("isSchemeRelative",I)},isHTTPURL:function(I){return b("isHTTPURL",I)},isHTTPS:function(I){return b("isHTTPS",I)},removeHostname:function(I){return b("removeHostname",I)},resolve:function(I,T){return b("resolve",I,T)}}}u.__dashjs_factory_name="URLUtils";var d=p.Z.getSingletonFactory(u);y.Z=d},5459:function(f,y){y.Z=function g(p,m,u){(function(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")})(this,g),this.code=p||null,this.message=m||null,this.data=u||null}},3186:function(f,y,g){var p=g(7855);function m(d,S){for(var _=0;_<S.length;_++){var E=S[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(d,E.key,E)}}var u=(function(){function d(E){(function(b,I){if(!(b instanceof I))throw new TypeError("Cannot call a class as a function")})(this,d),this.action=d.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=E||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}var S,_;return S=d,(_=[{key:"isInitializationRequest",value:function(){return this.type&&this.type===p.w.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(E){this.type=E&&E.init?p.w.INIT_SEGMENT_TYPE:p.w.MEDIA_SEGMENT_TYPE,this.url=E&&E.url?E.url:null,this.range=E&&E.range?E.range.start+"-"+E.range.end:null,this.mediaType=E&&E.mediaType?E.mediaType:null}}])&&m(S.prototype,_),d})();u.ACTION_DOWNLOAD="download",u.ACTION_COMPLETE="complete",y.Z=u},2839:function(f,y){function g(m,u){for(var d=0;d<u.length;d++){var S=u[d];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(m,S.key,S)}}var p=(function(){function m(S){if((function(R,O){if(!(R instanceof O))throw new TypeError("Cannot call a class as a function")})(this,m),this.offset=S._offset,this.type=S.type,this.size=S.size,this.boxes=[],S.boxes)for(var _=0;_<S.boxes.length;_++)this.boxes.push(new m(S.boxes[_]));switch(this.isComplete=!0,S.type){case"sidx":if(this.timescale=S.timescale,this.earliest_presentation_time=S.earliest_presentation_time,this.first_offset=S.first_offset,this.references=S.references,S.references){this.references=[];for(var E=0;E<S.references.length;E++){var b={reference_type:S.references[E].reference_type,referenced_size:S.references[E].referenced_size,subsegment_duration:S.references[E].subsegment_duration};this.references.push(b)}}break;case"emsg":this.id=S.id,this.version=S.version===1?1:0,this.value=S.value,this.timescale=S.timescale,this.scheme_id_uri=S.scheme_id_uri,this.presentation_time_delta=S.version===1?S.presentation_time:S.presentation_time_delta,this.event_duration=S.event_duration,this.message_data=S.message_data;break;case"mdhd":this.timescale=S.timescale;break;case"mfhd":this.sequence_number=S.sequence_number;break;case"subs":this.entry_count=S.entry_count,this.entries=S.entries;break;case"tfhd":this.base_data_offset=S.base_data_offset,this.sample_description_index=S.sample_description_index,this.default_sample_duration=S.default_sample_duration,this.default_sample_size=S.default_sample_size,this.default_sample_flags=S.default_sample_flags,this.flags=S.flags;break;case"tfdt":this.version=S.version,this.baseMediaDecodeTime=S.baseMediaDecodeTime,this.flags=S.flags;break;case"trun":if(this.sample_count=S.sample_count,this.first_sample_flags=S.first_sample_flags,this.data_offset=S.data_offset,this.flags=S.flags,this.samples=S.samples,S.samples){this.samples=[];for(var I=0,T=S.samples.length;I<T;I++){var A={sample_size:S.samples[I].sample_size,sample_duration:S.samples[I].sample_duration,sample_composition_time_offset:S.samples[I].sample_composition_time_offset};this.samples.push(A)}}break;case"prft":this.version=S.version,this.reference_track_ID=S.reference_track_ID,this.ntp_timestamp_sec=S.ntp_timestamp_sec,this.ntp_timestamp_frac=S.ntp_timestamp_frac,this.media_time=S.media_time,this.flags=S.flags}}var u,d;return u=m,(d=[{key:"getChildBox",value:function(S){for(var _=0;_<this.boxes.length;_++)if(this.boxes[_].type===S)return this.boxes[_]}},{key:"getChildBoxes",value:function(S){for(var _=[],E=0;E<this.boxes.length;E++)this.boxes[E].type===S&&_.push(this.boxes[E]);return _}}])&&g(u.prototype,d),m})();y.Z=p},9597:function(f,y){y.Z=function g(p,m,u){(function(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")})(this,g),this.lastCompletedOffset=p,this.found=m,this.size=u}},2128:function(f,y){y.Z=function g(){(function(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")})(this,g),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}},7855:function(f,y,g){function p(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")}g.d(y,{O:function(){return u},w:function(){return m}});var m=function d(){p(this,d),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null},u=function d(){p(this,d),this.s=null,this.d=null,this.b=[]};m.GET="GET",m.HEAD="HEAD",m.MPD_TYPE="MPD",m.XLINK_EXPANSION_TYPE="XLinkExpansion",m.INIT_SEGMENT_TYPE="InitializationSegment",m.INDEX_SEGMENT_TYPE="IndexSegment",m.MEDIA_SEGMENT_TYPE="MediaSegment",m.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",m.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",m.DVB_REPORTING_TYPE="DVBReporting",m.LICENSE="license",m.CONTENT_STEERING_TYPE="ContentSteering",m.OTHER_TYPE="other"},3039:function(f,y){function g(m,u){return function(d,S){for(var _,E,b,I=p(d,"tag"),T=p(S??"*","range"),A=[],R=-1;++R<T.length;)if(_=T[R].toLowerCase(),u||_!=="*"){for(E=-1,b=[];++E<I.length;)if(m(I[E].toLowerCase(),_)){if(!u)return I[E];A.push(I[E])}else b.push(I[E]);I=b}return u?A:void 0}}function p(m,u){var d=m&&typeof m=="string"?[m]:m;if(!d||typeof d!="object"||!("length"in d))throw new Error("Invalid "+u+" `"+d+"`, expected non-empty string");return d}y.basicFilter=g((function(m,u){return u==="*"||m===u||m.indexOf(u+"-")>-1}),!0),y.extendedFilter=g((function(m,u){var d=m.split("-"),S=u.split("-"),_=0,E=0;if(S[E]!=="*"&&d[_]!==S[E])return!1;for(_++,E++;E<S.length;)if(S[E]!=="*"){if(!d[_])return!1;if(d[_]!==S[E]){if(d[_].length===1)return!1;_++}else _++,E++}else E++;return!0}),!0),y.lookup=g((function(m,u){for(var d,S=u;;){if(S==="*"||m===S)return!0;if((d=S.lastIndexOf("-"))<0)return!1;S.charAt(d-2)==="-"&&(d-=2),S=S.slice(0,d)}}))},3973:function(f,y,g){f.exports=g(3854)},3854:function(f,y,g){var p=g(2415),m=g(3039),u=g(7778),d=g(5813),S=g(3165),_=g(9460);f.exports=function(H,U){var Z,$=U||{},F=p.parse(String(H||"").toLowerCase(),$),W=p.stringify(F),fe=-1;if(!W)return W;for(;++fe<u.length;)m.extendedFilter(W,u[fe].from).length&&(T(F,u[fe].from,u[fe].to),W=p.stringify(F));for(fe=-1;++fe<d.length;)A(F,d[fe].from.field,d[fe].from.value)&&R(F,d[fe].to.field,d[fe].to.value);for(W=p.stringify(Object.assign({},F,I)),fe=-1;++fe<S.length;)W===S[fe]&&(T(F,S[fe],S[fe].split("-").slice(0,-1).join("-")),W=p.stringify(Object.assign({},F,I)));if(F.extensions.sort(O),$.warning)for(Z in _)E.call(_[Z],F[Z])&&$.warning("Deprecated "+Z+" `"+F[Z]+"`, expected one of `"+_[Z][F[Z]].join("`, `")+"`",null,7);return F.script&&(F.script=F.script.charAt(0).toUpperCase()+F.script.slice(1)),F.region&&(F.region=F.region.toUpperCase()),p.stringify(F)};var E={}.hasOwnProperty,b=new Intl.Collator,I={variants:[],extensions:[],privateuse:[],irregular:null,regular:null};function T(H,U,Z){var $,F=p.parse(U),W=p.parse(Z),fe=[];for($ in F)F[$]&&F[$].length&&A(H,$,F[$])&&fe.push($);for($ in W)W[$]&&W[$].length&&(fe.indexOf($)>-1||!H[$]||!H[$].length)&&R(H,$,W[$])}function A(H,U,Z){var $,F,W,fe,ne=!1;if(Z){if(F=$=H[U],$&&typeof $=="object")for(F=[],W=-1;++W<$.length;)fe=$[W],Z.indexOf(fe)<0?F.push(fe):ne=!0;else $===Z&&(F=null,ne=!0);H[U]=F}return ne}function R(H,U,Z){var $,F,W,fe=H[U];if(fe&&typeof fe=="object")for($=[].concat(Z),F=-1;++F<$.length;)W=$[F],fe.indexOf(W)<0&&fe.push(W);else H[U]=Z}function O(H,U){return b.compare(H.singleton,U.singleton)}},2415:function(f,y,g){y.parse=g(6903),y.stringify=g(6713)},6903:function(f,y,g){var p=g(2219),m=g(3516),u=g(395),d=g(858),S=g(8589);f.exports=function E(b,I){var T,A,R,O=I||{},H={language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null},U=String(b),Z=U.toLowerCase(),$=0;if(b==null)throw new Error("Expected string, got `"+b+"`");if(_.call(S,Z))return(O.normalize==null||O.normalize)&&S[Z]?E(S[Z]):(H[d.indexOf(Z)===-1?"irregular":"regular"]=U,H);for(;m(Z.charCodeAt($))&&$<9;)$++;if($>1&&$<9){if(H.language=U.slice(0,$),$<4)for(A=0;Z.charCodeAt($)===45&&m(Z.charCodeAt($+1))&&m(Z.charCodeAt($+2))&&m(Z.charCodeAt($+3))&&!m(Z.charCodeAt($+4));){if(A>2)return F($,3,"Too many extended language subtags, expected at most 3 subtags");H.extendedLanguageSubtags.push(U.slice($+1,$+4)),$+=4,A++}for(Z.charCodeAt($)===45&&m(Z.charCodeAt($+1))&&m(Z.charCodeAt($+2))&&m(Z.charCodeAt($+3))&&m(Z.charCodeAt($+4))&&!m(Z.charCodeAt($+5))&&(H.script=U.slice($+1,$+5),$+=5),Z.charCodeAt($)===45&&(m(Z.charCodeAt($+1))&&m(Z.charCodeAt($+2))&&!m(Z.charCodeAt($+3))?(H.region=U.slice($+1,$+3),$+=3):u(Z.charCodeAt($+1))&&u(Z.charCodeAt($+2))&&u(Z.charCodeAt($+3))&&!u(Z.charCodeAt($+4))&&(H.region=U.slice($+1,$+4),$+=4));Z.charCodeAt($)===45;){for(R=T=$+1;p(Z.charCodeAt(R));){if(R-T>7)return F(R,1,"Too long variant, expected at most 8 characters");R++}if(!(R-T>4||R-T>3&&u(Z.charCodeAt(T))))break;H.variants.push(U.slice(T,R)),$=R}for(;Z.charCodeAt($)===45&&Z.charCodeAt($+1)!==120&&p(Z.charCodeAt($+1))&&Z.charCodeAt($+2)===45&&p(Z.charCodeAt($+3));){for(R=$+2,A=0;Z.charCodeAt(R)===45&&p(Z.charCodeAt(R+1))&&p(Z.charCodeAt(R+2));)for(R=(T=R+1)+2,A++;p(Z.charCodeAt(R));){if(R-T>7)return F(R,2,"Too long extension, expected at most 8 characters");R++}if(!A)return F(R,4,"Empty extension, extensions must have at least 2 characters of content");H.extensions.push({singleton:U.charAt($+1),extensions:U.slice($+3,R).split("-")}),$=R}}else $=0;if($===0&&Z.charCodeAt($)===120||Z.charCodeAt($)===45&&Z.charCodeAt($+1)===120)for(R=$=$?$+2:1;Z.charCodeAt(R)===45&&p(Z.charCodeAt(R+1));){for(R=T=$+1;p(Z.charCodeAt(R));){if(R-T>7)return F(R,5,"Too long private-use area, expected at most 8 characters");R++}H.privateuse.push(U.slice($+1,R)),$=R}return $!==U.length?F($,6,"Found superfluous content after tag"):H;function F(W,fe,ne){return O.warning&&O.warning(ne,fe,W),O.forgiving?H:{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}};var _={}.hasOwnProperty},6713:function(f){f.exports=function(y){var g,p,m,u=y||{},d=[];if(u.irregular||u.regular)return u.irregular||u.regular;if(u.language)for(d=d.concat(u.language,u.extendedLanguageSubtags||[],u.script||[],u.region||[],u.variants||[]),g=u.extensions||[],p=-1;++p<g.length;)(m=g[p]).singleton&&m.extensions&&m.extensions.length&&(d=d.concat(m.singleton,m.extensions));return u.privateuse&&u.privateuse.length&&(d=d.concat("x",u.privateuse)),d.join("-")}},1549:function(f,y,g){var p=g(6693),m=g(2165),u=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;y.Buffer=_,y.SlowBuffer=function(w){return+w!=w&&(w=0),_.alloc(+w)},y.INSPECT_MAX_BYTES=50;var d=2147483647;function S(w){if(w>d)throw new RangeError('The value "'+w+'" is invalid for option "size"');var N=new Uint8Array(w);return Object.setPrototypeOf(N,_.prototype),N}function _(w,N,G){if(typeof w=="number"){if(typeof N=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return I(w)}return E(w,N,G)}function E(w,N,G){if(typeof w=="string")return(function(he,He){if(typeof He=="string"&&He!==""||(He="utf8"),!_.isEncoding(He))throw new TypeError("Unknown encoding: "+He);var ut=0|O(he,He),Je=S(ut),Qe=Je.write(he,He);return Qe!==ut&&(Je=Je.slice(0,Qe)),Je})(w,N);if(ArrayBuffer.isView(w))return(function(he){if(Oe(he,Uint8Array)){var He=new Uint8Array(he);return A(He.buffer,He.byteOffset,He.byteLength)}return T(he)})(w);if(w==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof w);if(Oe(w,ArrayBuffer)||w&&Oe(w.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Oe(w,SharedArrayBuffer)||w&&Oe(w.buffer,SharedArrayBuffer)))return A(w,N,G);if(typeof w=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var V=w.valueOf&&w.valueOf();if(V!=null&&V!==w)return _.from(V,N,G);var ye=(function(he){if(_.isBuffer(he)){var He=0|R(he.length),ut=S(He);return ut.length===0||he.copy(ut,0,0,He),ut}return he.length!==void 0?typeof he.length!="number"||Fe(he.length)?S(0):T(he):he.type==="Buffer"&&Array.isArray(he.data)?T(he.data):void 0})(w);if(ye)return ye;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof w[Symbol.toPrimitive]=="function")return _.from(w[Symbol.toPrimitive]("string"),N,G);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof w)}function b(w){if(typeof w!="number")throw new TypeError('"size" argument must be of type number');if(w<0)throw new RangeError('The value "'+w+'" is invalid for option "size"')}function I(w){return b(w),S(w<0?0:0|R(w))}function T(w){for(var N=w.length<0?0:0|R(w.length),G=S(N),V=0;V<N;V+=1)G[V]=255&w[V];return G}function A(w,N,G){if(N<0||w.byteLength<N)throw new RangeError('"offset" is outside of buffer bounds');if(w.byteLength<N+(G||0))throw new RangeError('"length" is outside of buffer bounds');var V;return V=N===void 0&&G===void 0?new Uint8Array(w):G===void 0?new Uint8Array(w,N):new Uint8Array(w,N,G),Object.setPrototypeOf(V,_.prototype),V}function R(w){if(w>=d)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d.toString(16)+" bytes");return 0|w}function O(w,N){if(_.isBuffer(w))return w.length;if(ArrayBuffer.isView(w)||Oe(w,ArrayBuffer))return w.byteLength;if(typeof w!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof w);var G=w.length,V=arguments.length>2&&arguments[2]===!0;if(!V&&G===0)return 0;for(var ye=!1;;)switch(N){case"ascii":case"latin1":case"binary":return G;case"utf8":case"utf-8":return vt(w).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*G;case"hex":return G>>>1;case"base64":return et(w).length;default:if(ye)return V?-1:vt(w).length;N=(""+N).toLowerCase(),ye=!0}}function H(w,N,G){var V=!1;if((N===void 0||N<0)&&(N=0),N>this.length||((G===void 0||G>this.length)&&(G=this.length),G<=0)||(G>>>=0)<=(N>>>=0))return"";for(w||(w="utf8");;)switch(w){case"hex":return qe(this,N,G);case"utf8":case"utf-8":return me(this,N,G);case"ascii":return Ie(this,N,G);case"latin1":case"binary":return Be(this,N,G);case"base64":return Te(this,N,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ee(this,N,G);default:if(V)throw new TypeError("Unknown encoding: "+w);w=(w+"").toLowerCase(),V=!0}}function U(w,N,G){var V=w[N];w[N]=w[G],w[G]=V}function Z(w,N,G,V,ye){if(w.length===0)return-1;if(typeof G=="string"?(V=G,G=0):G>2147483647?G=2147483647:G<-2147483648&&(G=-2147483648),Fe(G=+G)&&(G=ye?0:w.length-1),G<0&&(G=w.length+G),G>=w.length){if(ye)return-1;G=w.length-1}else if(G<0){if(!ye)return-1;G=0}if(typeof N=="string"&&(N=_.from(N,V)),_.isBuffer(N))return N.length===0?-1:$(w,N,G,V,ye);if(typeof N=="number")return N&=255,typeof Uint8Array.prototype.indexOf=="function"?ye?Uint8Array.prototype.indexOf.call(w,N,G):Uint8Array.prototype.lastIndexOf.call(w,N,G):$(w,[N],G,V,ye);throw new TypeError("val must be string, number or Buffer")}function $(w,N,G,V,ye){var he,He=1,ut=w.length,Je=N.length;if(V!==void 0&&((V=String(V).toLowerCase())==="ucs2"||V==="ucs-2"||V==="utf16le"||V==="utf-16le")){if(w.length<2||N.length<2)return-1;He=2,ut/=2,Je/=2,G/=2}function Qe(Gt,_t){return He===1?Gt[_t]:Gt.readUInt16BE(_t*He)}if(ye){var Ye=-1;for(he=G;he<ut;he++)if(Qe(w,he)===Qe(N,Ye===-1?0:he-Ye)){if(Ye===-1&&(Ye=he),he-Ye+1===Je)return Ye*He}else Ye!==-1&&(he-=he-Ye),Ye=-1}else for(G+Je>ut&&(G=ut-Je),he=G;he>=0;he--){for(var nt=!0,mt=0;mt<Je;mt++)if(Qe(w,he+mt)!==Qe(N,mt)){nt=!1;break}if(nt)return he}return-1}function F(w,N,G,V){G=Number(G)||0;var ye=w.length-G;V?(V=Number(V))>ye&&(V=ye):V=ye;var he=N.length;V>he/2&&(V=he/2);for(var He=0;He<V;++He){var ut=parseInt(N.substr(2*He,2),16);if(Fe(ut))return He;w[G+He]=ut}return He}function W(w,N,G,V){return gt(vt(N,w.length-G),w,G,V)}function fe(w,N,G,V){return gt((function(ye){for(var he=[],He=0;He<ye.length;++He)he.push(255&ye.charCodeAt(He));return he})(N),w,G,V)}function ne(w,N,G,V){return gt(et(N),w,G,V)}function de(w,N,G,V){return gt((function(ye,he){for(var He,ut,Je,Qe=[],Ye=0;Ye<ye.length&&!((he-=2)<0);++Ye)ut=(He=ye.charCodeAt(Ye))>>8,Je=He%256,Qe.push(Je),Qe.push(ut);return Qe})(N,w.length-G),w,G,V)}function Te(w,N,G){return N===0&&G===w.length?p.fromByteArray(w):p.fromByteArray(w.slice(N,G))}function me(w,N,G){G=Math.min(w.length,G);for(var V=[],ye=N;ye<G;){var he,He,ut,Je,Qe=w[ye],Ye=null,nt=Qe>239?4:Qe>223?3:Qe>191?2:1;if(ye+nt<=G)switch(nt){case 1:Qe<128&&(Ye=Qe);break;case 2:(192&(he=w[ye+1]))==128&&(Je=(31&Qe)<<6|63&he)>127&&(Ye=Je);break;case 3:he=w[ye+1],He=w[ye+2],(192&he)==128&&(192&He)==128&&(Je=(15&Qe)<<12|(63&he)<<6|63&He)>2047&&(Je<55296||Je>57343)&&(Ye=Je);break;case 4:he=w[ye+1],He=w[ye+2],ut=w[ye+3],(192&he)==128&&(192&He)==128&&(192&ut)==128&&(Je=(15&Qe)<<18|(63&he)<<12|(63&He)<<6|63&ut)>65535&&Je<1114112&&(Ye=Je)}Ye===null?(Ye=65533,nt=1):Ye>65535&&(Ye-=65536,V.push(Ye>>>10&1023|55296),Ye=56320|1023&Ye),V.push(Ye),ye+=nt}return(function(mt){var Gt=mt.length;if(Gt<=X)return String.fromCharCode.apply(String,mt);for(var _t="",gn=0;gn<Gt;)_t+=String.fromCharCode.apply(String,mt.slice(gn,gn+=X));return _t})(V)}y.kMaxLength=d,_.TYPED_ARRAY_SUPPORT=(function(){try{var w=new Uint8Array(1),N={foo:function(){return 42}};return Object.setPrototypeOf(N,Uint8Array.prototype),Object.setPrototypeOf(w,N),w.foo()===42}catch{return!1}})(),_.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(_.prototype,"parent",{enumerable:!0,get:function(){if(_.isBuffer(this))return this.buffer}}),Object.defineProperty(_.prototype,"offset",{enumerable:!0,get:function(){if(_.isBuffer(this))return this.byteOffset}}),_.poolSize=8192,_.from=function(w,N,G){return E(w,N,G)},Object.setPrototypeOf(_.prototype,Uint8Array.prototype),Object.setPrototypeOf(_,Uint8Array),_.alloc=function(w,N,G){return(function(V,ye,he){return b(V),V<=0?S(V):ye!==void 0?typeof he=="string"?S(V).fill(ye,he):S(V).fill(ye):S(V)})(w,N,G)},_.allocUnsafe=function(w){return I(w)},_.allocUnsafeSlow=function(w){return I(w)},_.isBuffer=function(w){return w!=null&&w._isBuffer===!0&&w!==_.prototype},_.compare=function(w,N){if(Oe(w,Uint8Array)&&(w=_.from(w,w.offset,w.byteLength)),Oe(N,Uint8Array)&&(N=_.from(N,N.offset,N.byteLength)),!_.isBuffer(w)||!_.isBuffer(N))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(w===N)return 0;for(var G=w.length,V=N.length,ye=0,he=Math.min(G,V);ye<he;++ye)if(w[ye]!==N[ye]){G=w[ye],V=N[ye];break}return G<V?-1:V<G?1:0},_.isEncoding=function(w){switch(String(w).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},_.concat=function(w,N){if(!Array.isArray(w))throw new TypeError('"list" argument must be an Array of Buffers');if(w.length===0)return _.alloc(0);var G;if(N===void 0)for(N=0,G=0;G<w.length;++G)N+=w[G].length;var V=_.allocUnsafe(N),ye=0;for(G=0;G<w.length;++G){var he=w[G];if(Oe(he,Uint8Array))ye+he.length>V.length?_.from(he).copy(V,ye):Uint8Array.prototype.set.call(V,he,ye);else{if(!_.isBuffer(he))throw new TypeError('"list" argument must be an Array of Buffers');he.copy(V,ye)}ye+=he.length}return V},_.byteLength=O,_.prototype._isBuffer=!0,_.prototype.swap16=function(){var w=this.length;if(w%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var N=0;N<w;N+=2)U(this,N,N+1);return this},_.prototype.swap32=function(){var w=this.length;if(w%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var N=0;N<w;N+=4)U(this,N,N+3),U(this,N+1,N+2);return this},_.prototype.swap64=function(){var w=this.length;if(w%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var N=0;N<w;N+=8)U(this,N,N+7),U(this,N+1,N+6),U(this,N+2,N+5),U(this,N+3,N+4);return this},_.prototype.toString=function(){var w=this.length;return w===0?"":arguments.length===0?me(this,0,w):H.apply(this,arguments)},_.prototype.toLocaleString=_.prototype.toString,_.prototype.equals=function(w){if(!_.isBuffer(w))throw new TypeError("Argument must be a Buffer");return this===w||_.compare(this,w)===0},_.prototype.inspect=function(){var w="",N=y.INSPECT_MAX_BYTES;return w=this.toString("hex",0,N).replace(/(.{2})/g,"$1 ").trim(),this.length>N&&(w+=" ... "),"<Buffer "+w+">"},u&&(_.prototype[u]=_.prototype.inspect),_.prototype.compare=function(w,N,G,V,ye){if(Oe(w,Uint8Array)&&(w=_.from(w,w.offset,w.byteLength)),!_.isBuffer(w))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof w);if(N===void 0&&(N=0),G===void 0&&(G=w?w.length:0),V===void 0&&(V=0),ye===void 0&&(ye=this.length),N<0||G>w.length||V<0||ye>this.length)throw new RangeError("out of range index");if(V>=ye&&N>=G)return 0;if(V>=ye)return-1;if(N>=G)return 1;if(this===w)return 0;for(var he=(ye>>>=0)-(V>>>=0),He=(G>>>=0)-(N>>>=0),ut=Math.min(he,He),Je=this.slice(V,ye),Qe=w.slice(N,G),Ye=0;Ye<ut;++Ye)if(Je[Ye]!==Qe[Ye]){he=Je[Ye],He=Qe[Ye];break}return he<He?-1:He<he?1:0},_.prototype.includes=function(w,N,G){return this.indexOf(w,N,G)!==-1},_.prototype.indexOf=function(w,N,G){return Z(this,w,N,G,!0)},_.prototype.lastIndexOf=function(w,N,G){return Z(this,w,N,G,!1)},_.prototype.write=function(w,N,G,V){if(N===void 0)V="utf8",G=this.length,N=0;else if(G===void 0&&typeof N=="string")V=N,G=this.length,N=0;else{if(!isFinite(N))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");N>>>=0,isFinite(G)?(G>>>=0,V===void 0&&(V="utf8")):(V=G,G=void 0)}var ye=this.length-N;if((G===void 0||G>ye)&&(G=ye),w.length>0&&(G<0||N<0)||N>this.length)throw new RangeError("Attempt to write outside buffer bounds");V||(V="utf8");for(var he=!1;;)switch(V){case"hex":return F(this,w,N,G);case"utf8":case"utf-8":return W(this,w,N,G);case"ascii":case"latin1":case"binary":return fe(this,w,N,G);case"base64":return ne(this,w,N,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return de(this,w,N,G);default:if(he)throw new TypeError("Unknown encoding: "+V);V=(""+V).toLowerCase(),he=!0}},_.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var X=4096;function Ie(w,N,G){var V="";G=Math.min(w.length,G);for(var ye=N;ye<G;++ye)V+=String.fromCharCode(127&w[ye]);return V}function Be(w,N,G){var V="";G=Math.min(w.length,G);for(var ye=N;ye<G;++ye)V+=String.fromCharCode(w[ye]);return V}function qe(w,N,G){var V=w.length;(!N||N<0)&&(N=0),(!G||G<0||G>V)&&(G=V);for(var ye="",he=N;he<G;++he)ye+=it[w[he]];return ye}function ee(w,N,G){for(var V=w.slice(N,G),ye="",he=0;he<V.length-1;he+=2)ye+=String.fromCharCode(V[he]+256*V[he+1]);return ye}function _e(w,N,G){if(w%1!=0||w<0)throw new RangeError("offset is not uint");if(w+N>G)throw new RangeError("Trying to access beyond buffer length")}function Ze(w,N,G,V,ye,he){if(!_.isBuffer(w))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>ye||N<he)throw new RangeError('"value" argument is out of bounds');if(G+V>w.length)throw new RangeError("Index out of range")}function Ke(w,N,G,V,ye,he){if(G+V>w.length)throw new RangeError("Index out of range");if(G<0)throw new RangeError("Index out of range")}function De(w,N,G,V,ye){return N=+N,G>>>=0,ye||Ke(w,0,G,4),m.write(w,N,G,V,23,4),G+4}function Ge(w,N,G,V,ye){return N=+N,G>>>=0,ye||Ke(w,0,G,8),m.write(w,N,G,V,52,8),G+8}_.prototype.slice=function(w,N){var G=this.length;(w=~~w)<0?(w+=G)<0&&(w=0):w>G&&(w=G),(N=N===void 0?G:~~N)<0?(N+=G)<0&&(N=0):N>G&&(N=G),N<w&&(N=w);var V=this.subarray(w,N);return Object.setPrototypeOf(V,_.prototype),V},_.prototype.readUintLE=_.prototype.readUIntLE=function(w,N,G){w>>>=0,N>>>=0,G||_e(w,N,this.length);for(var V=this[w],ye=1,he=0;++he<N&&(ye*=256);)V+=this[w+he]*ye;return V},_.prototype.readUintBE=_.prototype.readUIntBE=function(w,N,G){w>>>=0,N>>>=0,G||_e(w,N,this.length);for(var V=this[w+--N],ye=1;N>0&&(ye*=256);)V+=this[w+--N]*ye;return V},_.prototype.readUint8=_.prototype.readUInt8=function(w,N){return w>>>=0,N||_e(w,1,this.length),this[w]},_.prototype.readUint16LE=_.prototype.readUInt16LE=function(w,N){return w>>>=0,N||_e(w,2,this.length),this[w]|this[w+1]<<8},_.prototype.readUint16BE=_.prototype.readUInt16BE=function(w,N){return w>>>=0,N||_e(w,2,this.length),this[w]<<8|this[w+1]},_.prototype.readUint32LE=_.prototype.readUInt32LE=function(w,N){return w>>>=0,N||_e(w,4,this.length),(this[w]|this[w+1]<<8|this[w+2]<<16)+16777216*this[w+3]},_.prototype.readUint32BE=_.prototype.readUInt32BE=function(w,N){return w>>>=0,N||_e(w,4,this.length),16777216*this[w]+(this[w+1]<<16|this[w+2]<<8|this[w+3])},_.prototype.readIntLE=function(w,N,G){w>>>=0,N>>>=0,G||_e(w,N,this.length);for(var V=this[w],ye=1,he=0;++he<N&&(ye*=256);)V+=this[w+he]*ye;return V>=(ye*=128)&&(V-=Math.pow(2,8*N)),V},_.prototype.readIntBE=function(w,N,G){w>>>=0,N>>>=0,G||_e(w,N,this.length);for(var V=N,ye=1,he=this[w+--V];V>0&&(ye*=256);)he+=this[w+--V]*ye;return he>=(ye*=128)&&(he-=Math.pow(2,8*N)),he},_.prototype.readInt8=function(w,N){return w>>>=0,N||_e(w,1,this.length),128&this[w]?-1*(255-this[w]+1):this[w]},_.prototype.readInt16LE=function(w,N){w>>>=0,N||_e(w,2,this.length);var G=this[w]|this[w+1]<<8;return 32768&G?4294901760|G:G},_.prototype.readInt16BE=function(w,N){w>>>=0,N||_e(w,2,this.length);var G=this[w+1]|this[w]<<8;return 32768&G?4294901760|G:G},_.prototype.readInt32LE=function(w,N){return w>>>=0,N||_e(w,4,this.length),this[w]|this[w+1]<<8|this[w+2]<<16|this[w+3]<<24},_.prototype.readInt32BE=function(w,N){return w>>>=0,N||_e(w,4,this.length),this[w]<<24|this[w+1]<<16|this[w+2]<<8|this[w+3]},_.prototype.readFloatLE=function(w,N){return w>>>=0,N||_e(w,4,this.length),m.read(this,w,!0,23,4)},_.prototype.readFloatBE=function(w,N){return w>>>=0,N||_e(w,4,this.length),m.read(this,w,!1,23,4)},_.prototype.readDoubleLE=function(w,N){return w>>>=0,N||_e(w,8,this.length),m.read(this,w,!0,52,8)},_.prototype.readDoubleBE=function(w,N){return w>>>=0,N||_e(w,8,this.length),m.read(this,w,!1,52,8)},_.prototype.writeUintLE=_.prototype.writeUIntLE=function(w,N,G,V){w=+w,N>>>=0,G>>>=0,V||Ze(this,w,N,G,Math.pow(2,8*G)-1,0);var ye=1,he=0;for(this[N]=255&w;++he<G&&(ye*=256);)this[N+he]=w/ye&255;return N+G},_.prototype.writeUintBE=_.prototype.writeUIntBE=function(w,N,G,V){w=+w,N>>>=0,G>>>=0,V||Ze(this,w,N,G,Math.pow(2,8*G)-1,0);var ye=G-1,he=1;for(this[N+ye]=255&w;--ye>=0&&(he*=256);)this[N+ye]=w/he&255;return N+G},_.prototype.writeUint8=_.prototype.writeUInt8=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,1,255,0),this[N]=255&w,N+1},_.prototype.writeUint16LE=_.prototype.writeUInt16LE=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,2,65535,0),this[N]=255&w,this[N+1]=w>>>8,N+2},_.prototype.writeUint16BE=_.prototype.writeUInt16BE=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,2,65535,0),this[N]=w>>>8,this[N+1]=255&w,N+2},_.prototype.writeUint32LE=_.prototype.writeUInt32LE=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,4,4294967295,0),this[N+3]=w>>>24,this[N+2]=w>>>16,this[N+1]=w>>>8,this[N]=255&w,N+4},_.prototype.writeUint32BE=_.prototype.writeUInt32BE=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,4,4294967295,0),this[N]=w>>>24,this[N+1]=w>>>16,this[N+2]=w>>>8,this[N+3]=255&w,N+4},_.prototype.writeIntLE=function(w,N,G,V){if(w=+w,N>>>=0,!V){var ye=Math.pow(2,8*G-1);Ze(this,w,N,G,ye-1,-ye)}var he=0,He=1,ut=0;for(this[N]=255&w;++he<G&&(He*=256);)w<0&&ut===0&&this[N+he-1]!==0&&(ut=1),this[N+he]=(w/He>>0)-ut&255;return N+G},_.prototype.writeIntBE=function(w,N,G,V){if(w=+w,N>>>=0,!V){var ye=Math.pow(2,8*G-1);Ze(this,w,N,G,ye-1,-ye)}var he=G-1,He=1,ut=0;for(this[N+he]=255&w;--he>=0&&(He*=256);)w<0&&ut===0&&this[N+he+1]!==0&&(ut=1),this[N+he]=(w/He>>0)-ut&255;return N+G},_.prototype.writeInt8=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,1,127,-128),w<0&&(w=255+w+1),this[N]=255&w,N+1},_.prototype.writeInt16LE=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,2,32767,-32768),this[N]=255&w,this[N+1]=w>>>8,N+2},_.prototype.writeInt16BE=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,2,32767,-32768),this[N]=w>>>8,this[N+1]=255&w,N+2},_.prototype.writeInt32LE=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,4,2147483647,-2147483648),this[N]=255&w,this[N+1]=w>>>8,this[N+2]=w>>>16,this[N+3]=w>>>24,N+4},_.prototype.writeInt32BE=function(w,N,G){return w=+w,N>>>=0,G||Ze(this,w,N,4,2147483647,-2147483648),w<0&&(w=4294967295+w+1),this[N]=w>>>24,this[N+1]=w>>>16,this[N+2]=w>>>8,this[N+3]=255&w,N+4},_.prototype.writeFloatLE=function(w,N,G){return De(this,w,N,!0,G)},_.prototype.writeFloatBE=function(w,N,G){return De(this,w,N,!1,G)},_.prototype.writeDoubleLE=function(w,N,G){return Ge(this,w,N,!0,G)},_.prototype.writeDoubleBE=function(w,N,G){return Ge(this,w,N,!1,G)},_.prototype.copy=function(w,N,G,V){if(!_.isBuffer(w))throw new TypeError("argument should be a Buffer");if(G||(G=0),V||V===0||(V=this.length),N>=w.length&&(N=w.length),N||(N=0),V>0&&V<G&&(V=G),V===G||w.length===0||this.length===0)return 0;if(N<0)throw new RangeError("targetStart out of bounds");if(G<0||G>=this.length)throw new RangeError("Index out of range");if(V<0)throw new RangeError("sourceEnd out of bounds");V>this.length&&(V=this.length),w.length-N<V-G&&(V=w.length-N+G);var ye=V-G;return this===w&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(N,G,V):Uint8Array.prototype.set.call(w,this.subarray(G,V),N),ye},_.prototype.fill=function(w,N,G,V){if(typeof w=="string"){if(typeof N=="string"?(V=N,N=0,G=this.length):typeof G=="string"&&(V=G,G=this.length),V!==void 0&&typeof V!="string")throw new TypeError("encoding must be a string");if(typeof V=="string"&&!_.isEncoding(V))throw new TypeError("Unknown encoding: "+V);if(w.length===1){var ye=w.charCodeAt(0);(V==="utf8"&&ye<128||V==="latin1")&&(w=ye)}}else typeof w=="number"?w&=255:typeof w=="boolean"&&(w=Number(w));if(N<0||this.length<N||this.length<G)throw new RangeError("Out of range index");if(G<=N)return this;var he;if(N>>>=0,G=G===void 0?this.length:G>>>0,w||(w=0),typeof w=="number")for(he=N;he<G;++he)this[he]=w;else{var He=_.isBuffer(w)?w:_.from(w,V),ut=He.length;if(ut===0)throw new TypeError('The value "'+w+'" is invalid for argument "value"');for(he=0;he<G-N;++he)this[he+N]=He[he%ut]}return this};var Et=/[^+/0-9A-Za-z-_]/g;function vt(w,N){var G;N=N||1/0;for(var V=w.length,ye=null,he=[],He=0;He<V;++He){if((G=w.charCodeAt(He))>55295&&G<57344){if(!ye){if(G>56319){(N-=3)>-1&&he.push(239,191,189);continue}if(He+1===V){(N-=3)>-1&&he.push(239,191,189);continue}ye=G;continue}if(G<56320){(N-=3)>-1&&he.push(239,191,189),ye=G;continue}G=65536+(ye-55296<<10|G-56320)}else ye&&(N-=3)>-1&&he.push(239,191,189);if(ye=null,G<128){if((N-=1)<0)break;he.push(G)}else if(G<2048){if((N-=2)<0)break;he.push(G>>6|192,63&G|128)}else if(G<65536){if((N-=3)<0)break;he.push(G>>12|224,G>>6&63|128,63&G|128)}else{if(!(G<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;he.push(G>>18|240,G>>12&63|128,G>>6&63|128,63&G|128)}}return he}function et(w){return p.toByteArray((function(N){if((N=(N=N.split("=")[0]).trim().replace(Et,"")).length<2)return"";for(;N.length%4!=0;)N+="=";return N})(w))}function gt(w,N,G,V){for(var ye=0;ye<V&&!(ye+G>=N.length||ye>=w.length);++ye)N[ye+G]=w[ye];return ye}function Oe(w,N){return w instanceof N||w!=null&&w.constructor!=null&&w.constructor.name!=null&&w.constructor.name===N.name}function Fe(w){return w!=w}var it=(function(){for(var w="0123456789abcdef",N=new Array(256),G=0;G<16;++G)for(var V=16*G,ye=0;ye<16;++ye)N[V+ye]=w[G]+w[ye];return N})()},6693:function(f,y){y.byteLength=function(b){var I=_(b),T=I[0],A=I[1];return 3*(T+A)/4-A},y.toByteArray=function(b){var I,T,A=_(b),R=A[0],O=A[1],H=new m((function($,F,W){return 3*(F+W)/4-W})(0,R,O)),U=0,Z=O>0?R-4:R;for(T=0;T<Z;T+=4)I=p[b.charCodeAt(T)]<<18|p[b.charCodeAt(T+1)]<<12|p[b.charCodeAt(T+2)]<<6|p[b.charCodeAt(T+3)],H[U++]=I>>16&255,H[U++]=I>>8&255,H[U++]=255&I;return O===2&&(I=p[b.charCodeAt(T)]<<2|p[b.charCodeAt(T+1)]>>4,H[U++]=255&I),O===1&&(I=p[b.charCodeAt(T)]<<10|p[b.charCodeAt(T+1)]<<4|p[b.charCodeAt(T+2)]>>2,H[U++]=I>>8&255,H[U++]=255&I),H},y.fromByteArray=function(b){for(var I,T=b.length,A=T%3,R=[],O=16383,H=0,U=T-A;H<U;H+=O)R.push(E(b,H,H+O>U?U:H+O));return A===1?(I=b[T-1],R.push(g[I>>2]+g[I<<4&63]+"==")):A===2&&(I=(b[T-2]<<8)+b[T-1],R.push(g[I>>10]+g[I>>4&63]+g[I<<2&63]+"=")),R.join("")};for(var g=[],p=[],m=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,S=u.length;d<S;++d)g[d]=u[d],p[u.charCodeAt(d)]=d;function _(b){var I=b.length;if(I%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var T=b.indexOf("=");return T===-1&&(T=I),[T,T===I?0:4-T%4]}function E(b,I,T){for(var A,R,O=[],H=I;H<T;H+=3)A=(b[H]<<16&16711680)+(b[H+1]<<8&65280)+(255&b[H+2]),O.push(g[(R=A)>>18&63]+g[R>>12&63]+g[R>>6&63]+g[63&R]);return O.join("")}p[45]=62,p[95]=63},2165:function(f,y){y.read=function(g,p,m,u,d){var S,_,E=8*d-u-1,b=(1<<E)-1,I=b>>1,T=-7,A=m?d-1:0,R=m?-1:1,O=g[p+A];for(A+=R,S=O&(1<<-T)-1,O>>=-T,T+=E;T>0;S=256*S+g[p+A],A+=R,T-=8);for(_=S&(1<<-T)-1,S>>=-T,T+=u;T>0;_=256*_+g[p+A],A+=R,T-=8);if(S===0)S=1-I;else{if(S===b)return _?NaN:1/0*(O?-1:1);_+=Math.pow(2,u),S-=I}return(O?-1:1)*_*Math.pow(2,S-u)},y.write=function(g,p,m,u,d,S){var _,E,b,I=8*S-d-1,T=(1<<I)-1,A=T>>1,R=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=u?0:S-1,H=u?1:-1,U=p<0||p===0&&1/p<0?1:0;for(p=Math.abs(p),isNaN(p)||p===1/0?(E=isNaN(p)?1:0,_=T):(_=Math.floor(Math.log(p)/Math.LN2),p*(b=Math.pow(2,-_))<1&&(_--,b*=2),(p+=_+A>=1?R/b:R*Math.pow(2,1-A))*b>=2&&(_++,b/=2),_+A>=T?(E=0,_=T):_+A>=1?(E=(p*b-1)*Math.pow(2,d),_+=A):(E=p*Math.pow(2,A-1)*Math.pow(2,d),_=0));d>=8;g[m+O]=255&E,O+=H,E/=256,d-=8);for(_=_<<d|E,I+=d;I>0;g[m+O]=255&_,O+=H,_/=256,I-=8);g[m+O-H]|=128*U}},6934:function(f,y){var g={parseBuffer:function(u){return new p(u).parse()},addBoxProcessor:function(u,d){typeof u=="string"&&typeof d=="function"&&(m.prototype._boxProcessors[u]=d)},createFile:function(){return new p},createBox:function(u,d,S){var _=m.create(u);return d&&d.append(_,S),_},createFullBox:function(u,d,S){var _=g.createBox(u,d,S);return _.version=0,_.flags=0,_},Utils:{}};g.Utils.dataViewToString=function(u,d){var S=d||"utf-8";if(typeof TextDecoder<"u")return new TextDecoder(S).decode(u);var _=[],E=0;if(S==="utf-8")for(;E<u.byteLength;){var b=u.getUint8(E++);b<128||(b<224?(b=(31&b)<<6,b|=63&u.getUint8(E++)):b<240?(b=(15&b)<<12,b|=(63&u.getUint8(E++))<<6,b|=63&u.getUint8(E++)):(b=(7&b)<<18,b|=(63&u.getUint8(E++))<<12,b|=(63&u.getUint8(E++))<<6,b|=63&u.getUint8(E++))),_.push(String.fromCharCode(b))}else for(;E<u.byteLength;)_.push(String.fromCharCode(u.getUint8(E++)));return _.join("")},g.Utils.utf8ToByteArray=function(u){var d,S;if(typeof TextEncoder<"u")d=new TextEncoder().encode(u);else for(d=[],S=0;S<u.length;++S){var _=u.charCodeAt(S);_<128?d.push(_):_<2048?(d.push(192|_>>6),d.push(128|63&_)):_<65536?(d.push(224|_>>12),d.push(128|63&_>>6),d.push(128|63&_)):(d.push(240|_>>18),d.push(128|63&_>>12),d.push(128|63&_>>6),d.push(128|63&_))}return d},g.Utils.appendBox=function(u,d,S){if(d._offset=u._cursor.offset,d._root=u._root?u._root:u,d._raw=u._raw,d._parent=u,S!==-1)if(S!=null){var _,E=-1;if(typeof S=="number")E=S;else{if(typeof S=="string")_=S;else{if(typeof S!="object"||!S.type)return void u.boxes.push(d);_=S.type}for(var b=0;b<u.boxes.length;b++)if(_===u.boxes[b].type){E=b+1;break}}u.boxes.splice(E,0,d)}else u.boxes.push(d)},y.parseBuffer=g.parseBuffer,y.addBoxProcessor=g.addBoxProcessor,y.createFile=g.createFile,y.createBox=g.createBox,y.createFullBox=g.createFullBox,y.Utils=g.Utils,g.Cursor=function(u){this.offset=u===void 0?0:u};var p=function(u){this._cursor=new g.Cursor,this.boxes=[],u&&(this._raw=new DataView(u))};p.prototype.fetch=function(u){var d=this.fetchAll(u,!0);return d.length?d[0]:null},p.prototype.fetchAll=function(u,d){var S=[];return p._sweep.call(this,u,S,d),S},p.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var u=m.parse(this);if(u.type===void 0)break;this.boxes.push(u)}return this},p._sweep=function(u,d,S){for(var _ in this.type&&this.type==u&&d.push(this),this.boxes){if(d.length&&S)return;p._sweep.call(this.boxes[_],u,d,S)}},p.prototype.write=function(){var u,d=0;for(u=0;u<this.boxes.length;u++)d+=this.boxes[u].getLength(!1);var S=new Uint8Array(d);for(this._rawo=new DataView(S.buffer),this.bytes=S,this._cursor.offset=0,u=0;u<this.boxes.length;u++)this.boxes[u].write();return S.buffer},p.prototype.append=function(u,d){g.Utils.appendBox(this,u,d)};var m=function(){this._cursor=new g.Cursor};m.parse=function(u){var d=new m;return d._offset=u._cursor.offset,d._root=u._root?u._root:u,d._raw=u._raw,d._parent=u,d._parseBox(),u._cursor.offset=d._raw.byteOffset+d._raw.byteLength,d},m.create=function(u){var d=new m;return d.type=u,d.boxes=[],d},m.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],m.prototype._boxProcessors={},m.prototype._procField=function(u,d,S){this._parsing?this[u]=this._readField(d,S):this._writeField(d,S,this[u])},m.prototype._procFieldArray=function(u,d,S,_){var E;if(this._parsing)for(this[u]=[],E=0;E<d;E++)this[u][E]=this._readField(S,_);else for(E=0;E<this[u].length;E++)this._writeField(S,_,this[u][E])},m.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},m.prototype._procEntries=function(u,d,S){var _;if(this._parsing)for(this[u]=[],_=0;_<d;_++)this[u].push({}),S.call(this,this[u][_]);else for(_=0;_<d;_++)S.call(this,this[u][_])},m.prototype._procSubEntries=function(u,d,S,_){var E;if(this._parsing)for(u[d]=[],E=0;E<S;E++)u[d].push({}),_.call(this,u[d][E]);else for(E=0;E<S;E++)_.call(this,u[d][E])},m.prototype._procEntryField=function(u,d,S,_){this._parsing?u[d]=this._readField(S,_):this._writeField(S,_,u[d])},m.prototype._procSubBoxes=function(u,d){var S;if(this._parsing)for(this[u]=[],S=0;S<d;S++)this[u].push(m.parse(this));else for(S=0;S<d;S++)this._rawo?this[u][S].write():this.size+=this[u][S].getLength()},m.prototype._readField=function(u,d){switch(u){case"uint":return this._readUint(d);case"int":return this._readInt(d);case"template":return this._readTemplate(d);case"string":return d===-1?this._readTerminatedString():this._readString(d);case"data":return this._readData(d);case"utf8":return this._readUTF8String();default:return-1}},m.prototype._readInt=function(u){var d=null,S=this._cursor.offset-this._raw.byteOffset;switch(u){case 8:d=this._raw.getInt8(S);break;case 16:d=this._raw.getInt16(S);break;case 32:d=this._raw.getInt32(S);break;case 64:var _=this._raw.getInt32(S),E=this._raw.getInt32(S+4);d=_*Math.pow(2,32)+E}return this._cursor.offset+=u>>3,d},m.prototype._readUint=function(u){var d,S,_=null,E=this._cursor.offset-this._raw.byteOffset;switch(u){case 8:_=this._raw.getUint8(E);break;case 16:_=this._raw.getUint16(E);break;case 24:_=((d=this._raw.getUint16(E))<<8)+(S=this._raw.getUint8(E+2));break;case 32:_=this._raw.getUint32(E);break;case 64:d=this._raw.getUint32(E),S=this._raw.getUint32(E+4),_=d*Math.pow(2,32)+S}return this._cursor.offset+=u>>3,_},m.prototype._readString=function(u){for(var d="",S=0;S<u;S++){var _=this._readUint(8);d+=String.fromCharCode(_)}return d},m.prototype._readTemplate=function(u){return this._readUint(u/2)+this._readUint(u/2)/Math.pow(2,u/2)},m.prototype._readTerminatedString=function(){for(var u="";this._cursor.offset-this._offset<this._raw.byteLength;){var d=this._readUint(8);if(d===0)break;u+=String.fromCharCode(d)}return u},m.prototype._readData=function(u){var d=u>0?u:this._raw.byteLength-(this._cursor.offset-this._offset);if(d>0){var S=new Uint8Array(this._raw.buffer,this._cursor.offset,d);return this._cursor.offset+=d,S}return null},m.prototype._readUTF8String=function(){var u=this._raw.byteLength-(this._cursor.offset-this._offset),d=null;return u>0&&(d=new DataView(this._raw.buffer,this._cursor.offset,u),this._cursor.offset+=u),d&&g.Utils.dataViewToString(d)},m.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1?this._parseContainerBox():this._data=this._readData())}},m.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},m.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(m.parse(this))},m.prototype.append=function(u,d){g.Utils.appendBox(this,u,d)},m.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var u=0;u<this.boxes.length;u++)this.size+=this.boxes[u].getLength();return this._data&&this._writeData(this._data),this.size},m.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var u=0;u<this.boxes.length;u++)this.boxes[u].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},m.prototype._writeInt=function(u,d){if(this._rawo){var S=this._cursor.offset-this._rawo.byteOffset;switch(u){case 8:this._rawo.setInt8(S,d);break;case 16:this._rawo.setInt16(S,d);break;case 32:this._rawo.setInt32(S,d);break;case 64:var _=Math.floor(d/Math.pow(2,32)),E=d-_*Math.pow(2,32);this._rawo.setUint32(S,_),this._rawo.setUint32(S+4,E)}this._cursor.offset+=u>>3}else this.size+=u>>3},m.prototype._writeUint=function(u,d){if(this._rawo){var S,_,E=this._cursor.offset-this._rawo.byteOffset;switch(u){case 8:this._rawo.setUint8(E,d);break;case 16:this._rawo.setUint16(E,d);break;case 24:S=(16776960&d)>>8,_=255&d,this._rawo.setUint16(E,S),this._rawo.setUint8(E+2,_);break;case 32:this._rawo.setUint32(E,d);break;case 64:_=d-(S=Math.floor(d/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(E,S),this._rawo.setUint32(E+4,_)}this._cursor.offset+=u>>3}else this.size+=u>>3},m.prototype._writeString=function(u,d){for(var S=0;S<u;S++)this._writeUint(8,d.charCodeAt(S))},m.prototype._writeTerminatedString=function(u){if(u.length!==0){for(var d=0;d<u.length;d++)this._writeUint(8,u.charCodeAt(d));this._writeUint(8,0)}},m.prototype._writeTemplate=function(u,d){var S=Math.floor(d),_=(d-S)*Math.pow(2,u/2);this._writeUint(u/2,S),this._writeUint(u/2,_)},m.prototype._writeData=function(u){if(u)if(this._rawo){if(u instanceof Array){for(var d=this._cursor.offset-this._rawo.byteOffset,S=0;S<u.length;S++)this._rawo.setInt8(d+S,u[S]);this._cursor.offset+=u.length}u instanceof Uint8Array&&(this._root.bytes.set(u,this._cursor.offset),this._cursor.offset+=u.length)}else this.size+=u.length},m.prototype._writeUTF8String=function(u){var d=g.Utils.utf8ToByteArray(u);if(this._rawo)for(var S=new DataView(this._rawo.buffer,this._cursor.offset,d.length),_=0;_<d.length;_++)S.setUint8(_,d[_]);else this.size+=d.length},m.prototype._writeField=function(u,d,S){switch(u){case"uint":this._writeUint(d,S);break;case"int":this._writeInt(d,S);break;case"template":this._writeTemplate(d,S);break;case"string":d==-1?this._writeTerminatedString(S):this._writeString(d,S);break;case"data":this._writeData(S);break;case"utf8":this._writeUTF8String(S)}},m.prototype._boxProcessors.avc1=m.prototype._boxProcessors.avc2=m.prototype._boxProcessors.avc3=m.prototype._boxProcessors.avc4=m.prototype._boxProcessors.hvc1=m.prototype._boxProcessors.hev1=m.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},m.prototype._boxProcessors.ctts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(u){this._procEntryField(u,"sample_count","uint",32),this._procEntryField(u,"sample_offset",this.version===1?"int":"uint",32)}))},m.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},m.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(u){this._procEntryField(u,"segment_duration","uint",this.version===1?64:32),this._procEntryField(u,"media_time","int",this.version===1?64:32),this._procEntryField(u,"media_rate_integer","int",16),this._procEntryField(u,"media_rate_fraction","int",16)}))},m.prototype._boxProcessors.emsg=function(){this._procFullBox(),this.version==1?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},m.prototype._boxProcessors.free=m.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},m.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},m.prototype._boxProcessors.ftyp=m.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var u=-1;this._parsing&&(u=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",u,"string",4)},m.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},m.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},m.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._parsing||typeof this.language!="string"||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},m.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",this.version==1?64:32)},m.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},m.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},m.prototype._boxProcessors.mp4a=m.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},m.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},m.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},m.prototype._boxProcessors.prft=function(){this._procFullBox(),this._procField("reference_track_ID","uint",32),this._procField("ntp_timestamp_sec","uint",32),this._procField("ntp_timestamp_frac","uint",32),this._procField("media_time","uint",this.version==1?64:32)},m.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},m.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},m.prototype._boxProcessors.sdtp=function(){this._procFullBox();var u=-1;this._parsing&&(u=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",u,"uint",8)},m.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",this.version==1?64:32),this._procField("first_offset","uint",this.version==1?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,(function(u){this._parsing||(u.reference=(1&u.reference_type)<<31,u.reference|=2147483647&u.referenced_size,u.sap=(1&u.starts_with_SAP)<<31,u.sap|=(3&u.SAP_type)<<28,u.sap|=268435455&u.SAP_delta_time),this._procEntryField(u,"reference","uint",32),this._procEntryField(u,"subsegment_duration","uint",32),this._procEntryField(u,"sap","uint",32),this._parsing&&(u.reference_type=u.reference>>31&1,u.referenced_size=2147483647&u.reference,u.starts_with_SAP=u.sap>>31&1,u.SAP_type=u.sap>>28&7,u.SAP_delta_time=268435455&u.sap)}))},m.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},m.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,(function(u){this._procEntryField(u,"ranges_count","uint",32),this._procSubEntries(u,"ranges",u.ranges_count,(function(d){this._procEntryField(d,"level","uint",8),this._procEntryField(d,"range_size","uint",24)}))}))},m.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},m.prototype._boxProcessors.sttg=function(){this._procField("settings","utf8")},m.prototype._boxProcessors.stts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(u){this._procEntryField(u,"sample_count","uint",32),this._procEntryField(u,"sample_delta","uint",32)}))},m.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(u){this._procEntryField(u,"sample_delta","uint",32),this._procEntryField(u,"subsample_count","uint",16),this._procSubEntries(u,"subsamples",u.subsample_count,(function(d){this._procEntryField(d,"subsample_size","uint",this.version===1?32:16),this._procEntryField(d,"subsample_priority","uint",8),this._procEntryField(d,"discardable","uint",8),this._procEntryField(d,"codec_specific_parameters","uint",32)}))}))},m.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},m.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",this.version==1?64:32)},m.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},m.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,(function(u){this._procEntryField(u,"time","uint",this.version===1?64:32),this._procEntryField(u,"moof_offset","uint",this.version===1?64:32),this._procEntryField(u,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(u,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(u,"sample_number","uint",8*(this.length_size_of_sample_num+1))}))},m.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},m.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},m.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,(function(u){256&this.flags&&this._procEntryField(u,"sample_duration","uint",32),512&this.flags&&this._procEntryField(u,"sample_size","uint",32),1024&this.flags&&this._procEntryField(u,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(u,"sample_composition_time_offset",this.version===1?"int":"uint",32)}))},m.prototype._boxProcessors["url "]=m.prototype._boxProcessors["urn "]=function(){this._procFullBox(),this.type==="urn "&&this._procField("name","string",-1),this._procField("location","string",-1)},m.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},m.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},m.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},m.prototype._boxProcessors.vtte=function(){}},5530:function(f,y,g){f.exports=g(6146).polyfill()},6146:function(f,y,g){f.exports=(function(){function p(et){return typeof et=="function"}var m=Array.isArray?Array.isArray:function(et){return Object.prototype.toString.call(et)==="[object Array]"},u=0,d=void 0,S=void 0,_=function(et,gt){O[u]=et,O[u+1]=gt,(u+=2)===2&&(S?S(H):W())},E=typeof window<"u"?window:void 0,b=E||{},I=b.MutationObserver||b.WebKitMutationObserver,T=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",A=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function R(){var et=setTimeout;return function(){return et(H,1)}}var O=new Array(1e3);function H(){for(var et=0;et<u;et+=2)(0,O[et])(O[et+1]),O[et]=void 0,O[et+1]=void 0;u=0}var U,Z,$,F,W=void 0;function fe(et,gt){var Oe=this,Fe=new this.constructor(Te);Fe[de]===void 0&&Ge(Fe);var it=Oe._state;if(it){var w=arguments[it-1];_((function(){return Ke(it,Fe,w,Oe._result)}))}else _e(Oe,Fe,et,gt);return Fe}function ne(et){if(et&&typeof et=="object"&&et.constructor===this)return et;var gt=new this(Te);return Ie(gt,et),gt}W=T?function(){return process.nextTick(H)}:I?(Z=0,$=new I(H),F=document.createTextNode(""),$.observe(F,{characterData:!0}),function(){F.data=Z=++Z%2}):A?((U=new MessageChannel).port1.onmessage=H,function(){return U.port2.postMessage(0)}):E===void 0?(function(){try{var et=Function("return this")().require("vertx");return(d=et.runOnLoop||et.runOnContext)!==void 0?function(){d(H)}:R()}catch{return R()}})():R();var de=Math.random().toString(36).substring(2);function Te(){}var me=void 0;function X(et,gt,Oe){gt.constructor===et.constructor&&Oe===fe&&gt.constructor.resolve===ne?(function(Fe,it){it._state===1?qe(Fe,it._result):it._state===2?ee(Fe,it._result):_e(it,void 0,(function(w){return Ie(Fe,w)}),(function(w){return ee(Fe,w)}))})(et,gt):Oe===void 0?qe(et,gt):p(Oe)?(function(Fe,it,w){_((function(N){var G=!1,V=(function(ye,he,He,ut){try{ye.call(he,He,ut)}catch(Je){return Je}})(w,it,(function(ye){G||(G=!0,it!==ye?Ie(N,ye):qe(N,ye))}),(function(ye){G||(G=!0,ee(N,ye))}),N._label);!G&&V&&(G=!0,ee(N,V))}),Fe)})(et,gt,Oe):qe(et,gt)}function Ie(et,gt){if(et===gt)ee(et,new TypeError("You cannot resolve a promise with itself"));else if(it=typeof(Fe=gt),Fe===null||it!=="object"&&it!=="function")qe(et,gt);else{var Oe=void 0;try{Oe=gt.then}catch(w){return void ee(et,w)}X(et,gt,Oe)}var Fe,it}function Be(et){et._onerror&&et._onerror(et._result),Ze(et)}function qe(et,gt){et._state===me&&(et._result=gt,et._state=1,et._subscribers.length!==0&&_(Ze,et))}function ee(et,gt){et._state===me&&(et._state=2,et._result=gt,_(Be,et))}function _e(et,gt,Oe,Fe){var it=et._subscribers,w=it.length;et._onerror=null,it[w]=gt,it[w+1]=Oe,it[w+2]=Fe,w===0&&et._state&&_(Ze,et)}function Ze(et){var gt=et._subscribers,Oe=et._state;if(gt.length!==0){for(var Fe=void 0,it=void 0,w=et._result,N=0;N<gt.length;N+=3)Fe=gt[N],it=gt[N+Oe],Fe?Ke(Oe,Fe,it,w):it(w);et._subscribers.length=0}}function Ke(et,gt,Oe,Fe){var it=p(Oe),w=void 0,N=void 0,G=!0;if(it){try{w=Oe(Fe)}catch(V){G=!1,N=V}if(gt===w)return void ee(gt,new TypeError("A promises callback cannot return that same promise."))}else w=Fe;gt._state!==me||(it&&G?Ie(gt,w):G===!1?ee(gt,N):et===1?qe(gt,w):et===2&&ee(gt,w))}var De=0;function Ge(et){et[de]=De++,et._state=void 0,et._result=void 0,et._subscribers=[]}var Et=(function(){function et(gt,Oe){this._instanceConstructor=gt,this.promise=new gt(Te),this.promise[de]||Ge(this.promise),m(Oe)?(this.length=Oe.length,this._remaining=Oe.length,this._result=new Array(this.length),this.length===0?qe(this.promise,this._result):(this.length=this.length||0,this._enumerate(Oe),this._remaining===0&&qe(this.promise,this._result))):ee(this.promise,new Error("Array Methods must be provided an Array"))}return et.prototype._enumerate=function(gt){for(var Oe=0;this._state===me&&Oe<gt.length;Oe++)this._eachEntry(gt[Oe],Oe)},et.prototype._eachEntry=function(gt,Oe){var Fe=this._instanceConstructor,it=Fe.resolve;if(it===ne){var w=void 0,N=void 0,G=!1;try{w=gt.then}catch(ye){G=!0,N=ye}if(w===fe&&gt._state!==me)this._settledAt(gt._state,Oe,gt._result);else if(typeof w!="function")this._remaining--,this._result[Oe]=gt;else if(Fe===vt){var V=new Fe(Te);G?ee(V,N):X(V,gt,w),this._willSettleAt(V,Oe)}else this._willSettleAt(new Fe((function(ye){return ye(gt)})),Oe)}else this._willSettleAt(it(gt),Oe)},et.prototype._settledAt=function(gt,Oe,Fe){var it=this.promise;it._state===me&&(this._remaining--,gt===2?ee(it,Fe):this._result[Oe]=Fe),this._remaining===0&&qe(it,this._result)},et.prototype._willSettleAt=function(gt,Oe){var Fe=this;_e(gt,void 0,(function(it){return Fe._settledAt(1,Oe,it)}),(function(it){return Fe._settledAt(2,Oe,it)}))},et})(),vt=(function(){function et(gt){this[de]=De++,this._result=this._state=void 0,this._subscribers=[],Te!==gt&&(typeof gt!="function"&&(function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")})(),this instanceof et?(function(Oe,Fe){try{Fe((function(it){Ie(Oe,it)}),(function(it){ee(Oe,it)}))}catch(it){ee(Oe,it)}})(this,gt):(function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")})())}return et.prototype.catch=function(gt){return this.then(null,gt)},et.prototype.finally=function(gt){var Oe=this,Fe=Oe.constructor;return p(gt)?Oe.then((function(it){return Fe.resolve(gt()).then((function(){return it}))}),(function(it){return Fe.resolve(gt()).then((function(){throw it}))})):Oe.then(gt,gt)},et})();return vt.prototype.then=fe,vt.all=function(et){return new Et(this,et).promise},vt.race=function(et){var gt=this;return m(et)?new gt((function(Oe,Fe){for(var it=et.length,w=0;w<it;w++)gt.resolve(et[w]).then(Oe,Fe)})):new gt((function(Oe,Fe){return Fe(new TypeError("You must pass an array to race."))}))},vt.resolve=ne,vt.reject=function(et){var gt=new this(Te);return ee(gt,et),gt},vt._setScheduler=function(et){S=et},vt._setAsap=function(et){_=et},vt._asap=_,vt.polyfill=function(){var et=void 0;if(g.g!==void 0)et=g.g;else if(typeof self<"u")et=self;else try{et=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var gt=et.Promise;if(gt){var Oe=null;try{Oe=Object.prototype.toString.call(gt.resolve())}catch{}if(Oe==="[object Promise]"&&!gt.cast)return}et.Promise=vt},vt.Promise=vt,vt})()},1159:function(f){var y,g=typeof Reflect=="object"?Reflect:null,p=g&&typeof g.apply=="function"?g.apply:function(H,U,Z){return Function.prototype.apply.call(H,U,Z)};y=g&&typeof g.ownKeys=="function"?g.ownKeys:Object.getOwnPropertySymbols?function(H){return Object.getOwnPropertyNames(H).concat(Object.getOwnPropertySymbols(H))}:function(H){return Object.getOwnPropertyNames(H)};var m=Number.isNaN||function(H){return H!=H};function u(){u.init.call(this)}f.exports=u,f.exports.once=function(H,U){return new Promise((function(Z,$){function F(fe){H.removeListener(U,W),$(fe)}function W(){typeof H.removeListener=="function"&&H.removeListener("error",F),Z([].slice.call(arguments))}O(H,U,W,{once:!0}),U!=="error"&&(function(fe,ne,de){typeof fe.on=="function"&&O(fe,"error",ne,{once:!0})})(H,F)}))},u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var d=10;function S(H){if(typeof H!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof H)}function _(H){return H._maxListeners===void 0?u.defaultMaxListeners:H._maxListeners}function E(H,U,Z,$){var F,W,fe,ne;if(S(Z),(W=H._events)===void 0?(W=H._events=Object.create(null),H._eventsCount=0):(W.newListener!==void 0&&(H.emit("newListener",U,Z.listener?Z.listener:Z),W=H._events),fe=W[U]),fe===void 0)fe=W[U]=Z,++H._eventsCount;else if(typeof fe=="function"?fe=W[U]=$?[Z,fe]:[fe,Z]:$?fe.unshift(Z):fe.push(Z),(F=_(H))>0&&fe.length>F&&!fe.warned){fe.warned=!0;var de=new Error("Possible EventEmitter memory leak detected. "+fe.length+" "+String(U)+" listeners added. Use emitter.setMaxListeners() to increase limit");de.name="MaxListenersExceededWarning",de.emitter=H,de.type=U,de.count=fe.length,ne=de,console&&console.warn&&console.warn(ne)}return H}function b(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function I(H,U,Z){var $={fired:!1,wrapFn:void 0,target:H,type:U,listener:Z},F=b.bind($);return F.listener=Z,$.wrapFn=F,F}function T(H,U,Z){var $=H._events;if($===void 0)return[];var F=$[U];return F===void 0?[]:typeof F=="function"?Z?[F.listener||F]:[F]:Z?(function(W){for(var fe=new Array(W.length),ne=0;ne<fe.length;++ne)fe[ne]=W[ne].listener||W[ne];return fe})(F):R(F,F.length)}function A(H){var U=this._events;if(U!==void 0){var Z=U[H];if(typeof Z=="function")return 1;if(Z!==void 0)return Z.length}return 0}function R(H,U){for(var Z=new Array(U),$=0;$<U;++$)Z[$]=H[$];return Z}function O(H,U,Z,$){if(typeof H.on=="function")$.once?H.once(U,Z):H.on(U,Z);else{if(typeof H.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof H);H.addEventListener(U,(function F(W){$.once&&H.removeEventListener(U,F),Z(W)}))}}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(H){if(typeof H!="number"||H<0||m(H))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+H+".");d=H}}),u.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(H){if(typeof H!="number"||H<0||m(H))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+H+".");return this._maxListeners=H,this},u.prototype.getMaxListeners=function(){return _(this)},u.prototype.emit=function(H){for(var U=[],Z=1;Z<arguments.length;Z++)U.push(arguments[Z]);var $=H==="error",F=this._events;if(F!==void 0)$=$&&F.error===void 0;else if(!$)return!1;if($){var W;if(U.length>0&&(W=U[0]),W instanceof Error)throw W;var fe=new Error("Unhandled error."+(W?" ("+W.message+")":""));throw fe.context=W,fe}var ne=F[H];if(ne===void 0)return!1;if(typeof ne=="function")p(ne,this,U);else{var de=ne.length,Te=R(ne,de);for(Z=0;Z<de;++Z)p(Te[Z],this,U)}return!0},u.prototype.addListener=function(H,U){return E(this,H,U,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(H,U){return E(this,H,U,!0)},u.prototype.once=function(H,U){return S(U),this.on(H,I(this,H,U)),this},u.prototype.prependOnceListener=function(H,U){return S(U),this.prependListener(H,I(this,H,U)),this},u.prototype.removeListener=function(H,U){var Z,$,F,W,fe;if(S(U),($=this._events)===void 0)return this;if((Z=$[H])===void 0)return this;if(Z===U||Z.listener===U)--this._eventsCount==0?this._events=Object.create(null):(delete $[H],$.removeListener&&this.emit("removeListener",H,Z.listener||U));else if(typeof Z!="function"){for(F=-1,W=Z.length-1;W>=0;W--)if(Z[W]===U||Z[W].listener===U){fe=Z[W].listener,F=W;break}if(F<0)return this;F===0?Z.shift():(function(ne,de){for(;de+1<ne.length;de++)ne[de]=ne[de+1];ne.pop()})(Z,F),Z.length===1&&($[H]=Z[0]),$.removeListener!==void 0&&this.emit("removeListener",H,fe||U)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(H){var U,Z,$;if((Z=this._events)===void 0)return this;if(Z.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Z[H]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete Z[H]),this;if(arguments.length===0){var F,W=Object.keys(Z);for($=0;$<W.length;++$)(F=W[$])!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(U=Z[H])=="function")this.removeListener(H,U);else if(U!==void 0)for($=U.length-1;$>=0;$--)this.removeListener(H,U[$]);return this},u.prototype.listeners=function(H){return T(this,H,!0)},u.prototype.rawListeners=function(H){return T(this,H,!1)},u.listenerCount=function(H,U){return typeof H.listenerCount=="function"?H.listenerCount(U):A.call(H,U)},u.prototype.listenerCount=A,u.prototype.eventNames=function(){return this._eventsCount>0?y(this._events):[]}},3101:function(f){var y=Array.isArray,g=Object.keys,p=Object.prototype.hasOwnProperty;f.exports=function m(u,d){if(u===d)return!0;if(u&&d&&typeof u=="object"&&typeof d=="object"){var S,_,E,b=y(u),I=y(d);if(b&&I){if((_=u.length)!=d.length)return!1;for(S=_;S--!=0;)if(!m(u[S],d[S]))return!1;return!0}if(b!=I)return!1;var T=u instanceof Date,A=d instanceof Date;if(T!=A)return!1;if(T&&A)return u.getTime()==d.getTime();var R=u instanceof RegExp,O=d instanceof RegExp;if(R!=O)return!1;if(R&&O)return u.toString()==d.toString();var H=g(u);if((_=H.length)!==g(d).length)return!1;for(S=_;S--!=0;)if(!p.call(d,H[S]))return!1;for(S=_;S--!=0;)if(!m(u[E=H[S]],d[E]))return!1;return!0}return u!=u&&d!=d}},3362:function(f,y,g){(function(p,m,u,d,S){function _(N){if("contents"in N)for(var G=("styleAttrs"in N)?N.styleAttrs[d.byName.ruby.qname]:null,V=N.kind==="span"&&(G==="container"||G==="textContainer"||G==="baseContainer"),ye=N.contents.length-1;ye>=0;ye--)!V||"styleAttrs"in N.contents[ye]&&d.byName.ruby.qname in N.contents[ye].styleAttrs?_(N.contents[ye]):delete N.contents[ye]}function E(N,G,V,ye){var he=ye&&ye.timeContainer==="seq",He=0;ye&&(He=he&&V?V.end:ye.begin),G.begin=G.explicit_begin?G.explicit_begin+He:He;var ut=G.begin,Je=null;if("sets"in G)for(var Qe=0;Qe<G.sets.length;Qe++)E(N,G.sets[Qe],Je,G),ut=G.timeContainer==="seq"?G.sets[Qe].end:Math.max(ut,G.sets[Qe].end),Je=G.sets[Qe];if("contents"in G){if("contents"in G)for(var Ye=0;Ye<G.contents.length;Ye++)E(N,G.contents[Ye],Je,G),ut=G.timeContainer==="seq"?G.contents[Ye].end:Math.max(ut,G.contents[Ye].end),Je=G.contents[Ye]}else ut=he?G.begin:Number.POSITIVE_INFINITY;G.explicit_end!==null&&G.explicit_dur!==null?G.end=Math.min(G.begin+G.explicit_dur,He+G.explicit_end):G.explicit_end===null&&G.explicit_dur!==null?G.end=G.begin+G.explicit_dur:G.explicit_end!==null&&G.explicit_dur===null?G.end=He+G.explicit_end:G.end=ut,delete G.explicit_begin,delete G.explicit_dur,delete G.explicit_end,N._registerEvent(G)}function b(N){this.node=N}function I(){this.events=[],this.head=new T,this.body=null}function T(){this.styling=new A,this.layout=new H}function A(){this.styles={},this.initials={}}function R(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function O(){this.styleAttrs=null}function H(){this.regions={}}function U(N,G){Z.call(this,"image"),this.src=N,this.type=G}function Z(N){this.kind=N}function $(N){this.id=N}function F(N){this.regionID=N}function W(N){this.styleAttrs=N}function fe(N){this.sets=N}function ne(N){this.contents=N}function de(N,G,V){this.explicit_begin=N,this.explicit_end=G,this.explicit_dur=V}function Te(){Z.call(this,"body")}function me(){Z.call(this,"div")}function X(){Z.call(this,"p")}function Ie(){Z.call(this,"span")}function Be(){Z.call(this,"span")}function qe(){Z.call(this,"br")}function ee(){}function _e(){}function Ze(N){return N&&"xml:id"in N.attributes&&N.attributes["xml:id"].value||null}function Ke(N){return N&&"style"in N.attributes?N.attributes.style.value.split(" "):[]}function De(N,G){var V={};if(N!==null)for(var ye in N.attributes){var he=N.attributes[ye].uri+" "+N.attributes[ye].local,He=d.byQName[he];if(He!==void 0){var ut=He.parse(N.attributes[ye].value);ut!==null?(V[he]=ut,He===d.byName.zIndex&&Oe(G,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):Fe(G,"Cannot parse styling attribute "+he+" --> "+N.attributes[ye].value)}}return V}function Ge(N,G,V){for(var ye in N.attributes)if(N.attributes[ye].uri===G&&N.attributes[ye].local===V)return N.attributes[ye].value;return null}function Et(N,G,V){var ye,he=null;return(ye=/^(\d+(?:\.\d+)?)f$/.exec(V))!==null?G!==null&&(he=parseFloat(ye[1])/G):(ye=/^(\d+(?:\.\d+)?)t$/.exec(V))!==null?N!==null&&(he=parseFloat(ye[1])/N):(ye=/^(\d+(?:\.\d+)?)ms$/.exec(V))!==null?he=parseFloat(ye[1])/1e3:(ye=/^(\d+(?:\.\d+)?)s$/.exec(V))!==null?he=parseFloat(ye[1]):(ye=/^(\d+(?:\.\d+)?)h$/.exec(V))!==null?he=3600*parseFloat(ye[1]):(ye=/^(\d+(?:\.\d+)?)m$/.exec(V))!==null?he=60*parseFloat(ye[1]):(ye=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(V))!==null?he=3600*parseInt(ye[1])+60*parseInt(ye[2])+parseFloat(ye[3]):(ye=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(V))!==null&&G!==null&&(he=3600*parseInt(ye[1])+60*parseInt(ye[2])+parseInt(ye[3])+(ye[4]===null?0:parseInt(ye[4])/G)),he}function vt(N,G,V){for(;G.styleRefs.length>0;){var ye=G.styleRefs.pop();ye in N.styles?(vt(N,N.styles[ye],V),gt(N.styles[ye].styleAttrs,G.styleAttrs)):Fe(V,"Non-existant style id referenced")}}function et(N,G,V,ye){for(var he=G.length-1;he>=0;he--){var He=G[he];He in N.styles?gt(N.styles[He].styleAttrs,V):Fe(ye,"Non-existant style id referenced")}}function gt(N,G){for(var V in N)N.hasOwnProperty(V)&&(V in G||(G[V]=N[V]))}function Oe(N,G){if(N&&N.warn&&N.warn(G))throw G}function Fe(N,G){if(N&&N.error&&N.error(G))throw G}function it(N,G){throw N&&N.fatal&&N.fatal(G),G}function w(N,G){for(var V,ye=0,he=N.length-1;ye<=he;){var He=N[V=Math.floor((ye+he)/2)];if(He<G)ye=V+1;else{if(!(He>G))return{found:!0,index:V};he=V-1}}return{found:!1,index:ye}}p.fromXML=function(N,G,V){var ye=m.parser(!0,{xmlns:!0}),he=[],He=[],ut=[],Je=0,Qe=null;ye.onclosetag=function(_t){if(he[0]instanceof ee)Qe.head!==null&&Qe.head.styling!==null&&et(Qe.head.styling,he[0].styleRefs,he[0].styleAttrs,G),delete he[0].styleRefs;else if(he[0]instanceof A)for(var gn in he[0].styles)he[0].styles.hasOwnProperty(gn)&&vt(he[0],he[0].styles[gn],G);else if(he[0]instanceof X||he[0]instanceof Ie){if(he[0].contents.length>1){var Wt,ln=[he[0].contents[0]];for(Wt=1;Wt<he[0].contents.length;Wt++)he[0].contents[Wt]instanceof Be&&ln[ln.length-1]instanceof Be?ln[ln.length-1].text+=he[0].contents[Wt].text:ln.push(he[0].contents[Wt]);he[0].contents=ln}he[0]instanceof Ie&&he[0].contents.length===1&&he[0].contents[0]instanceof Be&&(he[0].text=he[0].contents[0].text,delete he[0].contents)}else he[0]instanceof b&&(he[0].node.uri===u.ns_tt&&he[0].node.local==="metadata"?Je--:Je>0&&V&&"onCloseTag"in V&&V.onCloseTag());ut.shift(),He.shift(),he.shift()},ye.ontext=function(_t){if(he[0]!==void 0)if(he[0]instanceof Ie||he[0]instanceof X){if(he[0]instanceof Ie){var gn=he[0].styleAttrs[d.byName.ruby.qname];if(gn==="container"||gn==="textContainer"||gn==="baseContainer")return}var Wt=new Be;Wt.initFromText(Qe,he[0],_t,He[0],ut[0],G),he[0].contents.push(Wt)}else he[0]instanceof b&&Je>0&&V&&"onText"in V&&V.onText(_t)},ye.onopentag=function(_t){var gn=_t.attributes["xml:space"];gn?ut.unshift(gn.value):ut.length===0?ut.unshift("default"):ut.unshift(ut[0]);var Wt=_t.attributes["xml:lang"];if(Wt?He.unshift(Wt.value):He.length===0?He.unshift(""):He.unshift(He[0]),_t.uri===u.ns_tt)if(_t.local==="tt")Qe!==null&&it(G,"Two <tt> elements at ("+this.line+","+this.column+")"),(Qe=new I).initFromNode(_t,He[0],G),he.unshift(Qe);else if(_t.local==="head")he[0]instanceof I||it(G,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),he.unshift(Qe.head);else if(_t.local==="styling")he[0]instanceof T||it(G,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),he.unshift(Qe.head.styling);else if(_t.local==="style"){var ln;he[0]instanceof A?((ln=new R).initFromNode(_t,G),ln.id?Qe.head.styling.styles[ln.id]=ln:Fe(G,"<style> element missing @id attribute"),he.unshift(ln)):he[0]instanceof ee?((ln=new R).initFromNode(_t,G),gt(ln.styleAttrs,he[0].styleAttrs),he.unshift(ln)):it(G,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if(_t.local==="initial"){var cn;if(he[0]instanceof A){for(var On in(cn=new O).initFromNode(_t,G),cn.styleAttrs)cn.styleAttrs.hasOwnProperty(On)&&(Qe.head.styling.initials[On]=cn.styleAttrs[On]);he.unshift(cn)}else it(G,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if(_t.local==="layout")he[0]instanceof T||it(G,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),he.unshift(Qe.head.layout);else if(_t.local==="region"){he[0]instanceof H||it(G,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var zn=new ee;zn.initFromNode(Qe,_t,He[0],G),!zn.id||zn.id in Qe.head.layout.regions?Fe(G,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):Qe.head.layout.regions[zn.id]=zn,he.unshift(zn)}else if(_t.local==="body"){he[0]instanceof I||it(G,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),Qe.body!==null&&it(G,"Second <body> element at "+this.line+","+this.column+")");var ar=new Te;ar.initFromNode(Qe,_t,He[0],G),Qe.body=ar,he.unshift(ar)}else if(_t.local==="div"){he[0]instanceof me||he[0]instanceof Te||it(G,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var er=new me;er.initFromNode(Qe,he[0],_t,He[0],G);var Rr=er.styleAttrs[d.byName.backgroundImage.qname];Rr&&(er.contents.push(new U(Rr)),delete er.styleAttrs[d.byName.backgroundImage.qname]),he[0].contents.push(er),he.unshift(er)}else if(_t.local==="image"){he[0]instanceof me||it(G,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var li=new U;li.initFromNode(Qe,he[0],_t,He[0],G),he[0].contents.push(li),he.unshift(li)}else if(_t.local==="p"){he[0]instanceof me||it(G,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var gr=new X;gr.initFromNode(Qe,he[0],_t,He[0],G),he[0].contents.push(gr),he.unshift(gr)}else if(_t.local==="span"){he[0]instanceof Ie||he[0]instanceof X||it(G,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var gi=new Ie;gi.initFromNode(Qe,he[0],_t,He[0],ut[0],G),he[0].contents.push(gi),he.unshift(gi)}else if(_t.local==="br"){he[0]instanceof Ie||he[0]instanceof X||it(G,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var Zr=new qe;Zr.initFromNode(Qe,he[0],_t,He[0],G),he[0].contents.push(Zr),he.unshift(Zr)}else if(_t.local==="set"){he[0]instanceof Ie||he[0]instanceof X||he[0]instanceof me||he[0]instanceof Te||he[0]instanceof ee||he[0]instanceof qe||it(G,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var ri=new _e;ri.initFromNode(Qe,he[0],_t,G),he[0].sets.push(ri),he.unshift(ri)}else he.unshift(new b(_t));else he.unshift(new b(_t));if(he[0]instanceof b){if(_t.uri===u.ns_tt&&_t.local==="metadata")Je++;else if(Je>0&&V&&"onOpenTag"in V){var ui=[];for(var ii in _t.attributes)ui[_t.attributes[ii].uri+" "+_t.attributes[ii].local]={uri:_t.attributes[ii].uri,local:_t.attributes[ii].local,value:_t.attributes[ii].value};V.onOpenTag(_t.uri,_t.local,ui)}}},ye.write(N).close(),delete Qe.head.styling.styles;var Ye=!1;for(var nt in Qe.head.layout.regions)if(Qe.head.layout.regions.hasOwnProperty(nt)){Ye=!0;break}if(!Ye){var mt=ee.prototype.createDefaultRegion(Qe.lang);Qe.head.layout.regions[mt.id]=mt}for(var Gt in Qe.head.layout.regions)Qe.head.layout.regions.hasOwnProperty(Gt)&&E(Qe,Qe.head.layout.regions[Gt],null,null);return Qe.body&&E(Qe,Qe.body,null,null),Qe.body&&_(Qe.body),Qe},I.prototype.initFromNode=function(N,G,V){var ye=(function(Je,Qe){var Ye=Ge(Je,u.ns_ttp,"cellResolution"),nt=15,mt=32;if(Ye!==null){var Gt=/(\d+) (\d+)/.exec(Ye);Gt!==null?(mt=parseInt(Gt[1]),nt=parseInt(Gt[2])):Oe(Qe,"Malformed cellResolution value (using initial value instead)")}return{w:mt,h:nt}})(N,V);this.cellLength={h:new S.ComputedLength(0,1/ye.h),w:new S.ComputedLength(1/ye.w,0)};var he=(function(Je,Qe){var Ye,nt=Ge(Je,u.ns_ttp,"frameRate"),mt=30;nt!==null&&((Ye=/(\d+)/.exec(nt))!==null?mt=parseInt(Ye[1]):Oe(Qe,"Malformed frame rate attribute (using initial value instead)"));var Gt=Ge(Je,u.ns_ttp,"frameRateMultiplier"),_t=1;Gt!==null&&((Ye=/(\d+) (\d+)/.exec(Gt))!==null?_t=parseInt(Ye[1])/parseInt(Ye[2]):Oe(Qe,"Malformed frame rate multiplier attribute (using initial value instead)"));var gn=_t*mt,Wt=1,ln=Ge(Je,u.ns_ttp,"tickRate");return ln===null?nt!==null&&(Wt=gn):(Ye=/(\d+)/.exec(ln))!==null?Wt=parseInt(Ye[1]):Oe(Qe,"Malformed tick rate attribute (using initial value instead)"),{effectiveFrameRate:gn,tickRate:Wt}})(N,V);this.effectiveFrameRate=he.effectiveFrameRate,this.tickRate=he.tickRate,this.aspectRatio=(function(Je,Qe){var Ye=Ge(Je,u.ns_ittp,"aspectRatio");Ye===null&&(Ye=Ge(Je,u.ns_ttp,"displayAspectRatio"));var nt=null;if(Ye!==null){var mt=/(\d+)\s+(\d+)/.exec(Ye);if(mt!==null){var Gt=parseInt(mt[1]),_t=parseInt(mt[2]);Gt!==0&&_t!==0?nt=Gt/_t:Fe(Qe,"Illegal aspectRatio values (ignoring)")}else Fe(Qe,"Malformed aspectRatio attribute (ignoring)")}return nt})(N,V);var He=Ge(N,u.ns_ttp,"timeBase");He!==null&&He!=="media"&&it(V,"Unsupported time base");var ut=(function(Je,Qe){var Ye=Ge(Je,u.ns_tts,"extent");if(Ye===null)return null;var nt=Ye.split(" ");if(nt.length!==2)return Oe(Qe,"Malformed extent (ignoring)"),null;var mt=S.parseLength(nt[0]),Gt=S.parseLength(nt[1]);return Gt&&mt?{h:Gt,w:mt}:(Oe(Qe,"Malformed extent values (ignoring)"),null)})(N,V);ut===null?this.pxLength={h:null,w:null}:(ut.h.unit==="px"&&ut.w.unit==="px"||it(V,"Extent on TT must be in px or absent"),this.pxLength={h:new S.ComputedLength(0,1/ut.h.value),w:new S.ComputedLength(1/ut.w.value,0)}),this.dimensions={h:new S.ComputedLength(0,1),w:new S.ComputedLength(1,0)},this.lang=G},I.prototype._registerEvent=function(N){if(!(N.end<=N.begin)){var G=w(this.events,N.begin);if(G.found||this.events.splice(G.index,0,N.begin),N.end!==Number.POSITIVE_INFINITY){var V=w(this.events,N.end);V.found||this.events.splice(V.index,0,N.end)}}},I.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},I.prototype.getMediaTimeEvents=function(){return this.events},R.prototype.initFromNode=function(N,G){this.id=Ze(N),this.styleAttrs=De(N,G),this.styleRefs=Ke(N)},O.prototype.initFromNode=function(N,G){for(var V in this.styleAttrs={},N.attributes)if(N.attributes[V].uri===u.ns_itts||N.attributes[V].uri===u.ns_ebutts||N.attributes[V].uri===u.ns_tts){var ye=N.attributes[V].uri+" "+N.attributes[V].local;this.styleAttrs[ye]=N.attributes[V].value}},U.prototype.initFromNode=function(N,G,V,ye,he){this.src="src"in V.attributes?V.attributes.src.value:null,this.src||Fe(he,"Invalid image@src attribute"),this.type="type"in V.attributes?V.attributes.type.value:null,this.type||Fe(he,"Invalid image@type attribute"),W.prototype.initFromNode.call(this,N,G,V,he),de.prototype.initFromNode.call(this,N,G,V,he),fe.prototype.initFromNode.call(this,N,G,V,he),F.prototype.initFromNode.call(this,N,G,V,he),this.lang=ye},$.prototype.initFromNode=function(N,G,V,ye){this.id=Ze(V)},F.prototype.initFromNode=function(N,G,V,ye){this.regionID=(function(he){return he&&"region"in he.attributes?he.attributes.region.value:""})(V)},W.prototype.initFromNode=function(N,G,V,ye){this.styleAttrs=De(V,ye),N.head!==null&&N.head.styling!==null&&et(N.head.styling,Ke(V),this.styleAttrs,ye)},fe.prototype.initFromNode=function(N,G,V,ye){this.sets=[]},ne.prototype.initFromNode=function(N,G,V,ye){this.contents=[]},de.prototype.initFromNode=function(N,G,V,ye){var he=(function(He,ut,Je,Qe){var Ye=null;Je&&"begin"in Je.attributes&&(Ye=Et(He.tickRate,He.effectiveFrameRate,Je.attributes.begin.value))===null&&Oe(Qe,"Malformed begin value "+Je.attributes.begin.value+" (using 0)");var nt=null;Je&&"dur"in Je.attributes&&(nt=Et(He.tickRate,He.effectiveFrameRate,Je.attributes.dur.value))===null&&Oe(Qe,"Malformed dur value "+Je.attributes.dur.value+" (ignoring)");var mt=null;return Je&&"end"in Je.attributes&&(mt=Et(He.tickRate,He.effectiveFrameRate,Je.attributes.end.value))===null&&Oe(Qe,"Malformed end value (ignoring)"),{explicit_begin:Ye,explicit_end:mt,explicit_dur:nt}})(N,0,V,ye);this.explicit_begin=he.explicit_begin,this.explicit_end=he.explicit_end,this.explicit_dur=he.explicit_dur,this.timeContainer=(function(He,ut){var Je=He&&"timeContainer"in He.attributes?He.attributes.timeContainer.value:null;return Je&&Je!=="par"?Je==="seq"?"seq":(Fe(ut,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"})(V,ye)},Te.prototype.initFromNode=function(N,G,V,ye){W.prototype.initFromNode.call(this,N,null,G,ye),de.prototype.initFromNode.call(this,N,null,G,ye),fe.prototype.initFromNode.call(this,N,null,G,ye),F.prototype.initFromNode.call(this,N,null,G,ye),ne.prototype.initFromNode.call(this,N,null,G,ye),this.lang=V},me.prototype.initFromNode=function(N,G,V,ye,he){W.prototype.initFromNode.call(this,N,G,V,he),de.prototype.initFromNode.call(this,N,G,V,he),fe.prototype.initFromNode.call(this,N,G,V,he),F.prototype.initFromNode.call(this,N,G,V,he),ne.prototype.initFromNode.call(this,N,G,V,he),this.lang=ye},X.prototype.initFromNode=function(N,G,V,ye,he){W.prototype.initFromNode.call(this,N,G,V,he),de.prototype.initFromNode.call(this,N,G,V,he),fe.prototype.initFromNode.call(this,N,G,V,he),F.prototype.initFromNode.call(this,N,G,V,he),ne.prototype.initFromNode.call(this,N,G,V,he),this.lang=ye},Ie.prototype.initFromNode=function(N,G,V,ye,he,He){W.prototype.initFromNode.call(this,N,G,V,He),de.prototype.initFromNode.call(this,N,G,V,He),fe.prototype.initFromNode.call(this,N,G,V,He),F.prototype.initFromNode.call(this,N,G,V,He),ne.prototype.initFromNode.call(this,N,G,V,He),this.space=he,this.lang=ye},Be.prototype.initFromText=function(N,G,V,ye,he,He){de.prototype.initFromNode.call(this,N,G,null,He),this.text=V,this.space=he,this.lang=ye},qe.prototype.initFromNode=function(N,G,V,ye,he){F.prototype.initFromNode.call(this,N,G,V,he),de.prototype.initFromNode.call(this,N,G,V,he),this.lang=ye},ee.prototype.createDefaultRegion=function(N){var G=new ee;return $.call(G,""),W.call(G,{}),fe.call(G,[]),de.call(G,0,Number.POSITIVE_INFINITY,null),this.lang=N,G},ee.prototype.initFromNode=function(N,G,V,ye){$.prototype.initFromNode.call(this,N,null,G,ye),de.prototype.initFromNode.call(this,N,null,G,ye),fe.prototype.initFromNode.call(this,N,null,G,ye),this.styleAttrs=De(G,ye),this.styleRefs=Ke(G),this.lang=V},_e.prototype.initFromNode=function(N,G,V,ye){de.prototype.initFromNode.call(this,N,G,V,ye);var he=De(V,ye);for(var He in this.qname=null,this.value=null,he)if(he.hasOwnProperty(He)){if(this.qname){Fe(ye,"More than one style specified on set");break}this.qname=He,this.value=he[He]}}})(y,typeof sax>"u"?g(5378):sax,typeof imscNames>"u"?g(210):imscNames,typeof imscStyles>"u"?g(6811):imscStyles,typeof imscUtils>"u"?g(5926):imscUtils)},506:function(f,y,g){var p=/firefox/i.test(navigator.userAgent);(function(m,u,d){function S(ne,de,Te,me){var X;if(Te.kind==="region")(X=document.createElement("div")).style.position="absolute";else if(Te.kind==="body")X=document.createElement("div");else if(Te.kind==="div")X=document.createElement("div");else if(Te.kind==="image"){if(X=document.createElement("img"),ne.imgResolver!==null&&Te.src!==null){var Ie=ne.imgResolver(Te.src,X);Ie&&(X.src=Ie),X.height=ne.regionH,X.width=ne.regionW}}else if(Te.kind==="p")X=document.createElement("p");else if(Te.kind==="span")if(Te.styleAttrs[d.byName.ruby.qname]==="container")X=document.createElement("ruby"),ne.ruby=!0;else if(Te.styleAttrs[d.byName.ruby.qname]==="base")X=document.createElement("span");else if(Te.styleAttrs[d.byName.ruby.qname]==="text")X=document.createElement("rt");else if(Te.styleAttrs[d.byName.ruby.qname]==="baseContainer")X=document.createElement("rbc");else if(Te.styleAttrs[d.byName.ruby.qname]==="textContainer")X=document.createElement("rtc");else{if(Te.styleAttrs[d.byName.ruby.qname]==="delimiter")return;X=document.createElement("span")}else Te.kind==="br"&&(X=document.createElement("br"));if(X){if(Te.lang&&(Te.kind!=="region"&&Te.lang===me.lang||(X.lang=Te.lang)),de.appendChild(X),X.style.margin="0",Te.kind==="region"){var Be=Te.styleAttrs[d.byName.writingMode.qname];Be==="lrtb"||Be==="lr"?(ne.ipd="lr",ne.bpd="tb"):Be==="rltb"||Be==="rl"?(ne.ipd="rl",ne.bpd="tb"):Be==="tblr"?(ne.ipd="tb",ne.bpd="lr"):Be!=="tbrl"&&Be!=="tb"||(ne.ipd="tb",ne.bpd="rl")}else if(Te.kind==="p"&&ne.bpd==="tb"){var qe=Te.styleAttrs[d.byName.direction.qname];ne.ipd=qe==="ltr"?"lr":"rl"}for(var ee=0;ee<O.length;ee++){var _e=O[ee],Ze=Te.styleAttrs[_e.qname];Ze!==void 0&&_e.map!==null&&_e.map(ne,X,Te,Ze)}var Ke=X,De=Te.styleAttrs[d.byName.linePadding.qname];if(De&&!De.isZero()){var Ge=De.toUsedLength(ne.w,ne.h);if(Ge>0){var Et=Math.ceil(Ge)+"px";ne.bpd==="tb"?(Ke.style.paddingLeft=Et,Ke.style.paddingRight=Et):(Ke.style.paddingTop=Et,Ke.style.paddingBottom=Et),ne.lp=De}}var vt=Te.styleAttrs[d.byName.multiRowAlign.qname];if(vt&&vt!=="auto"){var et=document.createElement("span");et.style.display="inline-block",et.style.textAlign=vt,X.appendChild(et),Ke=et,ne.mra=vt}var gt=Te.styleAttrs[d.byName.rubyReserve.qname];if(gt&&gt[0]!=="none"&&(ne.rubyReserve=gt),Te.styleAttrs[d.byName.fillLineGap.qname]&&(ne.flg=!0),Te.kind==="span"&&Te.text){var Oe=Te.styleAttrs[d.byName.textEmphasis.qname];if(Oe&&Oe.style!=="none"&&(ne.textEmphasis=!0),d.byName.textCombine.qname in Te.styleAttrs&&Te.styleAttrs[d.byName.textCombine.qname]==="all")X.textContent=Te.text,X._isd_element=Te,Oe&&A(ne,X,0,Oe);else for(var Fe="",it=0;it<Te.text.length;it++){Fe+=Te.text.charAt(it);var w=Te.text.charCodeAt(it);if(w<55296||w>56319||it===Te.text.length-1){var N=document.createElement("span");N.textContent=Fe,Oe&&A(ne,N,0,Oe),X.appendChild(N),Fe="",N._isd_element=Te}}}if("contents"in Te)for(var G=0;G<Te.contents.length;G++)S(ne,Ke,Te.contents[G],Te);var V=[];if(Te.kind==="p"&&(T(ne,Ke,V,null),ne.rubyReserve&&((function(Je,Qe){for(var Ye=0;Ye<Je.length;Ye++){var nt,mt,Gt=document.createElement("ruby"),_t=document.createElement("span");_t.textContent="",Gt.appendChild(_t);var gn,Wt=Qe.rubyReserve[1].toUsedLength(Qe.w,Qe.h)+"px";Qe.rubyReserve[0]==="both"||Qe.rubyReserve[0]==="outside"&&Je.length==1?((nt=document.createElement("rtc")).style[$]=Z?"after":"under",nt.textContent="",nt.style.fontSize=Wt,(mt=document.createElement("rtc")).style[$]=Z?"before":"over",mt.textContent="",mt.style.fontSize=Wt,Gt.appendChild(nt),Gt.appendChild(mt)):((nt=document.createElement("rtc")).textContent="",nt.style.fontSize=Wt,gn=Qe.rubyReserve[0]==="after"||Qe.rubyReserve[0]==="outside"&&Ye>0?Z?"after":Qe.bpd==="tb"||Qe.bpd==="rl"?"under":"over":Z?"before":Qe.bpd==="tb"||Qe.bpd==="rl"?"over":"under",nt.style[$]=gn,Gt.appendChild(nt));for(var ln=null,cn=0;cn<Je[Ye].rbc.length;cn++)if(Je[Ye].rbc[cn].localName==="ruby"){ln=Je[Ye].rbc[cn];for(var On=0;On<ln.style.length;On++)Gt.style.setProperty(ln.style.item(On),ln.style.getPropertyValue(ln.style.item(On)));break}(ln=ln||Je[Ye].elements[0].node).parentElement.insertBefore(Gt,ln)}})(V,ne),ne.rubyReserve=null),(ne.ruby||ne.rubyReserve)&&((function(Je,Qe){for(var Ye=0;Ye<Je.length;Ye++)for(var nt=0;nt<Je[Ye].rbc.length;nt++){var mt;Je[Ye].rbc[nt].style[$]||(mt=Z?Ye===0?"before":"after":Qe.bpd==="tb"||Qe.bpd==="rl"?Ye===0?"over":"under":Ye===0?"under":"over",Je[Ye].rbc[nt].style[$]=mt)}})(V,ne),ne.ruby=null),ne.textEmphasis&&((function(Je,Qe){for(var Ye=0;Ye<Je.length;Ye++)for(var nt=0;nt<Je[Ye].te.length;nt++){var mt;Je[Ye].te[nt].style[W]&&Je[Ye].te[nt].style[W]!=="none"||(mt=Qe.bpd==="tb"?Ye===0?"left over":"left under":Qe.bpd==="rl"?Ye===0?"right under":"left under":Ye===0?"left under":"right under",Je[Ye].te[nt].style[W]=mt)}})(V,ne),ne.textEmphasis=null),ne.mra&&((function(Je){for(var Qe=0;Qe<Je.length-1;Qe++){var Ye=Je[Qe].elements.length;if(Ye!==0&&Je[Qe].br===!1){var nt=document.createElement("br"),mt=Je[Qe].elements[Ye-1].node;mt.parentElement.insertBefore(nt,mt.nextSibling)}}})(V),ne.mra=null),ne.lp&&((function(Je,Qe,Ye){if(Je!==null)for(var nt=0;nt<Je.length;nt++){var mt=Je[nt].elements.length,Gt=Math.ceil(Qe)+"px",_t="-"+Math.ceil(Qe)+"px";if(mt!==0){var gn=Je[nt].elements[Je[nt].start_elem],Wt=Je[nt].elements[Je[nt].end_elem];if(gn===Wt){var ln=gn.node.getBoundingClientRect();if(ln.width==0||ln.height==0)continue}Ye.ipd==="lr"?(gn.node.style.marginLeft=_t,gn.node.style.paddingLeft=Gt):Ye.ipd==="rl"?(gn.node.style.paddingRight=Gt,gn.node.style.marginRight=_t):Ye.ipd==="tb"&&(gn.node.style.paddingTop=Gt,gn.node.style.marginTop=_t),Ye.ipd==="lr"?(p||(Wt.node.style.marginRight=_t),Wt.node.style.paddingRight=Gt):Ye.ipd==="rl"?(Wt.node.style.paddingLeft=Gt,p||(Wt.node.style.marginLeft=_t)):Ye.ipd==="tb"&&(Wt.node.style.paddingBottom=Gt,Wt.node.style.marginBottom=_t)}}})(V,ne.lp.toUsedLength(ne.w,ne.h),ne),ne.lp=null),(function(Je,Qe){for(var Ye=0;Ye<Je.length;Ye++)for(var nt=Je[Ye],mt=1;mt<nt.elements.length;){var Gt=nt.elements[mt-1],_t=nt.elements[mt];E(Gt.node,_t.node,Qe)?nt.elements.splice(mt,1):mt++}for(var gn,Wt,ln=[],cn=0;cn<Je.length;cn++)for(var On=0;On<Je[cn].elements.length;On++)(Wt=_(gn=Je[cn].elements[On].node,ln,!1))&&(gn.style.backgroundColor=Wt);for(var zn=0;zn<ln.length;zn++)ln[zn].style.backgroundColor=""})(V,ne),ne.flg)){var ye=I(Ke.getBoundingClientRect(),ne);(function(Je,Qe,Ye,nt,mt){for(var Gt=Math.sign(Ye-Qe),_t=0;_t<=Je.length;_t++){var gn,Wt,ln,cn;if(gn=_t===0?Math.round(Qe):_t===Je.length?Math.round(Ye):Math.round((Je[_t-1].after+Je[_t].before)/2),_t>0&&Je[_t-1])for(ln=0;ln<Je[_t-1].elements.length;ln++)Wt=Gt*(gn-(cn=Je[_t-1].elements[ln]).after)+"px",nt.bpd==="lr"?cn.node.style.paddingRight=Wt:nt.bpd==="rl"?cn.node.style.paddingLeft=Wt:nt.bpd==="tb"&&(cn.node.style.paddingBottom=Wt);if(_t<Je.length)for(ln=0;ln<Je[_t].elements.length;ln++)Wt=Gt*((cn=Je[_t].elements[ln]).before-gn)+"px",nt.bpd==="lr"?cn.node.style.paddingLeft=Wt:nt.bpd==="rl"?cn.node.style.paddingRight=Wt:nt.bpd==="tb"&&(cn.node.style.paddingTop=Wt)}})(V,ye.before,ye.after,ne),ne.flg=null}if(Te.kind==="region"&&ne.bpd==="tb"&&ne.enableRollUp&&Te.contents.length>0&&Te.styleAttrs[d.byName.displayAlign.qname]==="after"){T(ne,Ke,V,null);var he=new b(Te.id===""?"_":Te.id,V);if(ne.currentISDState[he.id]=he,ne.previousISDState&&he.id in ne.previousISDState&&ne.previousISDState[he.id].plist.length>0&&he.plist.length>1&&he.plist[he.plist.length-2].text===ne.previousISDState[he.id].plist[ne.previousISDState[he.id].plist.length-1].text){var He=X.firstElementChild,ut=he.plist[he.plist.length-1].after-he.plist[he.plist.length-1].before;He.style.bottom="-"+ut+"px",He.style.transition="transform 0.4s",He.style.position="relative",He.style.transform="translateY(-"+ut+"px)"}}}else fe(ne.errorHandler,"Error processing ISD element kind: "+Te.kind)}function _(ne,de,Te){return ne.style.backgroundColor?(Te&&!de.includes(ne)&&de.push(ne),ne.style.backgroundColor):ne.parentElement.nodeName==="SPAN"||ne.parentElement.nodeName==="RUBY"||ne.parentElement.nodeName==="RBC"||ne.parentElement.nodeName==="RTC"||ne.parentElement.nodeName==="RT"?_(ne.parentElement,de,!0):void 0}function E(ne,de,Te){if(ne.tagName==="SPAN"&&de.tagName==="SPAN"&&ne._isd_element===de._isd_element){if(!ne._isd_element)return fe(Te.errorHandler,"Internal error: HTML span is not linked to a source element; cannot merge spans."),!1;ne.textContent+=de.textContent;for(var me=0;me<de.style.length;me++){var X=de.style[me];(X.indexOf("border")>=0||X.indexOf("padding")>=0||X.indexOf("margin")>=0)&&(ne.style[X]=de.style[X])}return de.parentElement.removeChild(de),!0}return!1}function b(ne,de){this.id=ne,this.plist=de}function I(ne,de){var Te={before:null,after:null,start:null,end:null};return de.bpd==="tb"?(Te.before=ne.top,Te.after=ne.bottom,de.ipd==="lr"?(Te.start=ne.left,Te.end=ne.right):(Te.start=ne.right,Te.end=ne.left)):de.bpd==="lr"?(Te.before=ne.left,Te.after=ne.right,Te.start=ne.top,Te.end=ne.bottom):de.bpd==="rl"&&(Te.before=ne.right,Te.after=ne.left,Te.start=ne.top,Te.end=ne.bottom),Te}function T(ne,de,Te,me){if(de.localName!=="rt"&&de.localName!=="rtc"){var X,Ie,Be,qe,ee=de.style.backgroundColor||me;if(de.childElementCount===0)if(de.localName==="span"||de.localName==="rb"){var _e=I(de.getBoundingClientRect(),ne);if(Te.length!==0&&(X=_e.before,Ie=_e.after,Be=Te[Te.length-1].before,Ie<(qe=Te[Te.length-1].after)&&X>Be||qe<=Ie&&Be>=X)){var Ze=Math.sign(_e.after-_e.before),Ke=Math.sign(_e.end-_e.start);Ze*(_e.before-Te[Te.length-1].before)<0&&(Te[Te.length-1].before=_e.before),Ze*(_e.after-Te[Te.length-1].after)>0&&(Te[Te.length-1].after=_e.after),Ke*(_e.start-Te[Te.length-1].start)<0&&(Te[Te.length-1].start=_e.start,Te[Te.length-1].start_elem=Te[Te.length-1].elements.length),Ke*(_e.end-Te[Te.length-1].end)>0&&(Te[Te.length-1].end=_e.end,Te[Te.length-1].end_elem=Te[Te.length-1].elements.length)}else Te.push({before:_e.before,after:_e.after,start:_e.start,end:_e.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});Te[Te.length-1].text+=de.textContent,Te[Te.length-1].elements.push({node:de,bgcolor:ee,before:_e.before,after:_e.after})}else de.localName==="br"&&Te.length!==0&&(Te[Te.length-1].br=!0);else for(var De=de.firstChild;De;)De.nodeType===Node.ELEMENT_NODE&&(T(ne,De,Te,ee),De.localName==="ruby"||De.localName==="rtc"?Te.length>0&&Te[Te.length-1].rbc.push(De):De.localName==="span"&&De.style[F]&&De.style[F]!=="none"&&Te.length>0&&Te[Te.length-1].te.push(De)),De=De.nextSibling}}function A(ne,de,Te,me){var X;me.style!=="none"&&(me.style==="auto"?de.style[F]="filled":de.style[F]=me.style+" "+me.symbol,(me.position==="before"||me.position==="after")&&(X=ne.bpd==="tb"?me.position==="before"?"left over":"left under":ne.bpd==="rl"?me.position==="before"?"right under":"left under":me.position==="before"?"left under":"right under",de.style[W]=X))}function R(ne,de){this.qname=ne,this.map=de}m.render=function(ne,de,Te,me,X,Ie,Be,qe,ee){var _e=me||de.clientHeight,Ze=X||de.clientWidth;if(ne.aspectRatio!==null){var Ke=_e*ne.aspectRatio;Ke>Ze?_e=Math.round(Ze/ne.aspectRatio):Ze=Ke}var De=document.createElement("div");De.style.position="relative",De.style.width=Ze+"px",De.style.height=_e+"px",De.style.margin="auto",De.style.top=0,De.style.bottom=0,De.style.left=0,De.style.right=0,De.style.zIndex=0;var Ge={h:_e,w:Ze,regionH:null,regionW:null,imgResolver:Te,displayForcedOnlyMode:Ie||!1,isd:ne,errorHandler:Be,previousISDState:qe,enableRollUp:ee||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};if(de.appendChild(De),"contents"in ne)for(var Et=0;Et<ne.contents.length;Et++)S(Ge,De,ne.contents[Et],ne);return Ge.currentISDState};for(var O=[new R("http://www.w3.org/ns/ttml#styling backgroundColor",(function(ne,de,Te,me){me[3]!==0&&(de.style.backgroundColor="rgba("+me[0].toString()+","+me[1].toString()+","+me[2].toString()+","+(me[3]/255).toString()+")")})),new R("http://www.w3.org/ns/ttml#styling color",(function(ne,de,Te,me){de.style.color="rgba("+me[0].toString()+","+me[1].toString()+","+me[2].toString()+","+(me[3]/255).toString()+")"})),new R("http://www.w3.org/ns/ttml#styling direction",(function(ne,de,Te,me){de.style.direction=me})),new R("http://www.w3.org/ns/ttml#styling display",(function(ne,de,Te,me){})),new R("http://www.w3.org/ns/ttml#styling displayAlign",(function(ne,de,Te,me){de.style.display="flex",de.style.flexDirection="column",me==="before"?de.style.justifyContent="flex-start":me==="center"?de.style.justifyContent="center":me==="after"&&(de.style.justifyContent="flex-end")})),new R("http://www.w3.org/ns/ttml#styling extent",(function(ne,de,Te,me){ne.regionH=me.h.toUsedLength(ne.w,ne.h),ne.regionW=me.w.toUsedLength(ne.w,ne.h);var X=0,Ie=0,Be=Te.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];Be&&(X=Be[0].toUsedLength(ne.w,ne.h)+Be[2].toUsedLength(ne.w,ne.h),Ie=Be[1].toUsedLength(ne.w,ne.h)+Be[3].toUsedLength(ne.w,ne.h)),de.style.height=ne.regionH-X+"px",de.style.width=ne.regionW-Ie+"px"})),new R("http://www.w3.org/ns/ttml#styling fontFamily",(function(ne,de,Te,me){for(var X=[],Ie=0;Ie<me.length;Ie++)me[Ie]=me[Ie].trim(),me[Ie]==="monospaceSerif"?(X.push("Courier New"),X.push('"Liberation Mono"'),X.push("Courier"),X.push("monospace")):me[Ie]==="proportionalSansSerif"?(X.push("Arial"),X.push("Helvetica"),X.push('"Liberation Sans"'),X.push("sans-serif")):me[Ie]==="monospace"?X.push("monospace"):me[Ie]==="sansSerif"?X.push("sans-serif"):me[Ie]==="serif"?X.push("serif"):me[Ie]==="monospaceSansSerif"?(X.push("Consolas"),X.push("monospace")):me[Ie]==="proportionalSerif"?X.push("serif"):X.push(me[Ie]);if(X.length>0){for(var Be=[X[0]],qe=1;qe<X.length;qe++)Be.indexOf(X[qe])==-1&&Be.push(X[qe]);X=Be}de.style.fontFamily=X.join(",")})),new R("http://www.w3.org/ns/ttml#styling shear",(function(ne,de,Te,me){if(me!==0){var X=-.9*me;ne.bpd==="tb"?de.style.transform="skewX("+X+"deg)":de.style.transform="skewY("+X+"deg)"}})),new R("http://www.w3.org/ns/ttml#styling fontSize",(function(ne,de,Te,me){de.style.fontSize=me.toUsedLength(ne.w,ne.h)+"px"})),new R("http://www.w3.org/ns/ttml#styling fontStyle",(function(ne,de,Te,me){de.style.fontStyle=me})),new R("http://www.w3.org/ns/ttml#styling fontWeight",(function(ne,de,Te,me){de.style.fontWeight=me})),new R("http://www.w3.org/ns/ttml#styling lineHeight",(function(ne,de,Te,me){de.style.lineHeight=me==="normal"?"normal":me.toUsedLength(ne.w,ne.h)+"px"})),new R("http://www.w3.org/ns/ttml#styling opacity",(function(ne,de,Te,me){de.style.opacity=me})),new R("http://www.w3.org/ns/ttml#styling origin",(function(ne,de,Te,me){de.style.top=me.h.toUsedLength(ne.w,ne.h)+"px",de.style.left=me.w.toUsedLength(ne.w,ne.h)+"px"})),new R("http://www.w3.org/ns/ttml#styling overflow",(function(ne,de,Te,me){de.style.overflow=me})),new R("http://www.w3.org/ns/ttml#styling padding",(function(ne,de,Te,me){var X=[];X[0]=me[0].toUsedLength(ne.w,ne.h)+"px",X[1]=me[3].toUsedLength(ne.w,ne.h)+"px",X[2]=me[2].toUsedLength(ne.w,ne.h)+"px",X[3]=me[1].toUsedLength(ne.w,ne.h)+"px",de.style.padding=X.join(" ")})),new R("http://www.w3.org/ns/ttml#styling position",(function(ne,de,Te,me){de.style.top=me.h.toUsedLength(ne.w,ne.h)+"px",de.style.left=me.w.toUsedLength(ne.w,ne.h)+"px"})),new R("http://www.w3.org/ns/ttml#styling rubyAlign",(function(ne,de,Te,me){de.style.rubyAlign=me==="spaceAround"?"space-around":"center"})),new R("http://www.w3.org/ns/ttml#styling rubyPosition",(function(ne,de,Te,me){var X;me!=="before"&&me!=="after"||(X=Z?me:ne.bpd==="tb"||ne.bpd==="rl"?me==="before"?"over":"under":me==="before"?"under":"over",de.parentElement.style[$]=X)})),new R("http://www.w3.org/ns/ttml#styling showBackground",null),new R("http://www.w3.org/ns/ttml#styling textAlign",(function(ne,de,Te,me){var X;X=me==="start"?ne.ipd==="rl"?"right":"left":me==="end"?ne.ipd==="rl"?"left":"right":me,de.style.textAlign=X})),new R("http://www.w3.org/ns/ttml#styling textDecoration",(function(ne,de,Te,me){de.style.textDecoration=me.join(" ").replace("lineThrough","line-through")})),new R("http://www.w3.org/ns/ttml#styling textOutline",(function(ne,de,Te,me){})),new R("http://www.w3.org/ns/ttml#styling textShadow",(function(ne,de,Te,me){var X=Te.styleAttrs[d.byName.textOutline.qname];if(me==="none"&&X==="none")de.style.textShadow="";else{var Ie=[];if(X!=="none"){var Be="rgba("+X.color[0].toString()+","+X.color[1].toString()+","+X.color[2].toString()+","+(X.color[3]/255).toString()+")";Ie.push("1px 1px 1px "+Be),Ie.push("-1px 1px 1px "+Be),Ie.push("1px -1px 1px "+Be),Ie.push("-1px -1px 1px "+Be)}if(me!=="none")for(var qe=0;qe<me.length;qe++)Ie.push(me[qe].x_off.toUsedLength(ne.w,ne.h)+"px "+me[qe].y_off.toUsedLength(ne.w,ne.h)+"px "+me[qe].b_radius.toUsedLength(ne.w,ne.h)+"px rgba("+me[qe].color[0].toString()+","+me[qe].color[1].toString()+","+me[qe].color[2].toString()+","+(me[qe].color[3]/255).toString()+")");de.style.textShadow=Ie.join(",")}})),new R("http://www.w3.org/ns/ttml#styling textCombine",(function(ne,de,Te,me){de.style.textCombineUpright=me})),new R("http://www.w3.org/ns/ttml#styling textEmphasis",(function(ne,de,Te,me){})),new R("http://www.w3.org/ns/ttml#styling unicodeBidi",(function(ne,de,Te,me){var X;X=me==="bidiOverride"?"bidi-override":me,de.style.unicodeBidi=X})),new R("http://www.w3.org/ns/ttml#styling visibility",(function(ne,de,Te,me){de.style.visibility=me})),new R("http://www.w3.org/ns/ttml#styling wrapOption",(function(ne,de,Te,me){me==="wrap"?Te.space==="preserve"?de.style.whiteSpace="pre-wrap":de.style.whiteSpace="normal":Te.space==="preserve"?de.style.whiteSpace="pre":de.style.whiteSpace="noWrap"})),new R("http://www.w3.org/ns/ttml#styling writingMode",(function(ne,de,Te,me){me==="lrtb"||me==="lr"||me==="rltb"||me==="rl"?de.style.writingMode="horizontal-tb":me==="tblr"?de.style.writingMode="vertical-lr":me!=="tbrl"&&me!=="tb"||(de.style.writingMode="vertical-rl")})),new R("http://www.w3.org/ns/ttml#styling zIndex",(function(ne,de,Te,me){de.style.zIndex=me})),new R("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",(function(ne,de,Te,me){ne.displayForcedOnlyMode&&me===!1&&(de.style.visibility="hidden")}))],H={},U=0;U<O.length;U++)H[O[U].qname]=O[U];var Z="webkitRubyPosition"in window.getComputedStyle(document.documentElement),$=Z?"webkitRubyPosition":"rubyPosition",F="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",W="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition";function fe(ne,de){if(ne&&ne.error&&ne.error(de))throw de}})(y,typeof imscNames>"u"?g(210):imscNames,typeof imscStyles>"u"?g(6811):imscStyles,typeof imscUtils>"u"?g(5926):imscUtils)},4080:function(f,y,g){(function(p,m,u,d){p.generateISD=function(R,O,H){var U,Z=new I(R),$={},F={},W=R.head.styling.initials[u.byName.showBackground.qname],fe=R.head.styling.initials[u.byName.backgroundColor.qname];for(var ne in R.head.layout.regions)if(R.head.layout.regions.hasOwnProperty(ne)){var de=R.head.layout.regions[ne],Te=de.styleAttrs[u.byName.showBackground.qname]||W,me=de.styleAttrs[u.byName.backgroundColor.qname]||fe;F[de.id]=(Te==="always"||Te===void 0)&&me!==void 0&&!(O<de.begin||O>=de.end)}for(var X in R.body&&R.body.regionID&&(F[R.body.regionID]=!0),U=R.body!==null?(function Be(qe,ee){if(ee.contents){var _e={};for(var Ze in ee)ee.hasOwnProperty(Ze)&&(_e[Ze]=ee[Ze]);return _e.contents=[],ee.contents.filter((function(Ke){return!(qe<Ke.begin||qe>=Ke.end)})).forEach((function(Ke){var De=Be(qe,Ke);De.regionID&&(F[De.regionID]=!0),De!==null&&_e.contents.push(De)})),_e}return ee})(O,R.body):null,F[""]!==void 0&&(F[""]=!0),F)if(F[X]){var Ie=_(R,O,R.head.layout.regions[X],U,null,"",R.head.layout.regions[X],H,$);Ie!==null&&Z.contents.push(Ie.element)}return Z};var S=[u.byName.color.qname,u.byName.textCombine.qname,u.byName.textDecoration.qname,u.byName.textEmphasis.qname,u.byName.textOutline.qname,u.byName.textShadow.qname];function _(R,O,H,U,Z,$,F,W,fe){if(O<F.begin||O>=F.end)return null;var ne="regionID"in F&&F.regionID!==""?F.regionID:$;if(Z!==null&&ne!==H.id&&(!("contents"in F)||"contents"in F&&F.contents.length===0||ne!==""))return null;var de=new T(F);if("sets"in F)for(var Te=0;Te<F.sets.length;Te++)O<F.sets[Te].begin||O>=F.sets[Te].end||(de.styleAttrs[F.sets[Te].qname]=F.sets[Te].value);var me={};for(var X in de.styleAttrs)if(de.styleAttrs.hasOwnProperty(X)&&(me[X]=!0,de.kind==="region"&&X===u.byName.writingMode.qname&&!(u.byName.direction.qname in de.styleAttrs))){var Ie=de.styleAttrs[X];Ie==="lrtb"||Ie==="lr"?de.styleAttrs[u.byName.direction.qname]="ltr":Ie!=="rltb"&&Ie!=="rl"||(de.styleAttrs[u.byName.direction.qname]="rtl")}if(Z!==null)for(var Be=0;Be<u.all.length;Be++){var qe=u.all[Be];if(qe.qname===u.byName.textDecoration.qname){var ee=Z.styleAttrs[qe.qname],_e=de.styleAttrs[qe.qname],Ze=[];_e===void 0?Ze=ee:_e.indexOf("none")===-1?((_e.indexOf("noUnderline")===-1&&ee.indexOf("underline")!==-1||_e.indexOf("underline")!==-1)&&Ze.push("underline"),(_e.indexOf("noLineThrough")===-1&&ee.indexOf("lineThrough")!==-1||_e.indexOf("lineThrough")!==-1)&&Ze.push("lineThrough"),(_e.indexOf("noOverline")===-1&&ee.indexOf("overline")!==-1||_e.indexOf("overline")!==-1)&&Ze.push("overline")):Ze.push("none"),de.styleAttrs[qe.qname]=Ze}else if(qe.qname!==u.byName.fontSize.qname||qe.qname in de.styleAttrs||de.kind!=="span"||de.styleAttrs[u.byName.ruby.qname]!=="textContainer")if(qe.qname!==u.byName.fontSize.qname||qe.qname in de.styleAttrs||de.kind!=="span"||de.styleAttrs[u.byName.ruby.qname]!=="text")qe.inherit&&qe.qname in Z.styleAttrs&&!(qe.qname in de.styleAttrs)&&(de.styleAttrs[qe.qname]=Z.styleAttrs[qe.qname]);else{var Ke=Z.styleAttrs[u.byName.fontSize.qname];Z.styleAttrs[u.byName.ruby.qname]==="textContainer"?de.styleAttrs[qe.qname]=Ke:de.styleAttrs[qe.qname]=new d.ComputedLength(.5*Ke.rw,.5*Ke.rh)}else{var De=Z.styleAttrs[u.byName.fontSize.qname];de.styleAttrs[qe.qname]=new d.ComputedLength(.5*De.rw,.5*De.rh)}}for(var Ge=0;Ge<u.all.length;Ge++){var Et=u.all[Ge];if(!(Et.qname in de.styleAttrs)&&!(Et.qname===u.byName.position.qname&&u.byName.origin.qname in de.styleAttrs||Et.qname===u.byName.origin.qname&&u.byName.position.qname in de.styleAttrs)){var vt=R.head.styling.initials[Et.qname]||Et.initial;if(vt!==null&&(de.kind==="region"||Et.inherit===!1&&vt!==null)){var et=Et.parse(vt);et!==null?(de.styleAttrs[Et.qname]=et,me[Et.qname]=!0):A(W,"Invalid initial value for '"+Et.qname+"' on element '"+de.kind)}}}for(var gt=0;gt<u.all.length;gt++){var Oe=u.all[gt];if(Oe.qname in me&&Oe.compute!==null){var Fe=Oe.compute(R,Z,de,de.styleAttrs[Oe.qname],fe);Fe!==null?de.styleAttrs[Oe.qname]=Fe:(de.styleAttrs[Oe.qname]=Oe.compute(R,Z,de,Oe.parse(Oe.initial),fe),A(W,"Style '"+Oe.qname+"' on element '"+de.kind+"' cannot be computed"))}}if(de.styleAttrs[u.byName.display.qname]==="none")return null;var it=null;Z===null?it=U===null?[]:[U]:"contents"in F&&(it=F.contents);for(var w=0;it!==null&&w<it.length;w++){var N=_(R,O,H,U,de,ne,it[w],W,fe);N!==null&&de.contents.push(N.element)}for(var G in de.styleAttrs)if(de.styleAttrs.hasOwnProperty(G)){var V=!1;if(de.kind==="span"){var ye=de.styleAttrs[u.byName.ruby.qname];(V=(ye==="container"||ye==="textContainer"||ye==="baseContainer")&&S.indexOf(G)!==-1)||(V=ye!=="container"&&G===u.byName.rubyAlign.qname),V||(V=!(ye==="textContainer"||ye==="text")&&G===u.byName.rubyPosition.qname)}if(!V){var he=u.byQName[G];"applies"in he&&(V=he.applies.indexOf(de.kind)===-1)}V&&delete de.styleAttrs[G]}var He=de.styleAttrs[u.byName.ruby.qname];if(de.kind==="p"||de.kind==="span"&&(He==="textContainer"||He==="text")){var ut=[];E(de,ut),(function(Je){for(var Qe,Ye=0;Ye<Je.length;)if((Qe=Je[Ye]).kind!=="br"&&Qe.space!=="preserve"){var nt=Qe.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(nt)&&(Ye===0||(mt=Je[Ye-1]).kind==="br"||/[\r\n\t ]$/.test(mt.text))&&(nt=nt.substring(1)),Qe.text=nt,nt.length===0?Je.splice(Ye,1):Ye++}else Ye++;var mt,Gt;for(Ye=0;Ye<Je.length;Ye++)(Qe=Je[Ye]).kind!=="br"&&Qe.space!=="preserve"?/[ ]$/.test(Qe.text)&&(Ye===Je.length-1||(Gt=Je[Ye+1]).kind==="br"||Gt.space==="preserve"&&/^[\r\n]/.test(Gt.text))&&(Qe.text=Qe.text.slice(0,-1)):Ye++})(ut),b(de)}return de.kind==="div"&&u.byName.backgroundImage.qname in de.styleAttrs||de.kind==="br"||de.kind==="image"||"contents"in de&&de.contents.length>0||de.kind==="span"&&de.text!==null||de.kind==="region"&&de.styleAttrs[u.byName.showBackground.qname]==="always"?{region_id:ne,element:de}:null}function E(R,O){if("contents"in R)for(var H=0;H<R.contents.length;H++){var U=R.contents[H],Z=U.styleAttrs[u.byName.ruby.qname];(U.kind!=="span"||Z!=="textContainer"&&Z!=="text")&&("contents"in U?E(U,O):(U.kind==="span"&&U.text.length!==0||U.kind==="br")&&O.push(U))}}function b(R){if(R.kind==="br")return!1;if("text"in R)return R.text.length===0;if("contents"in R){for(var O=R.contents.length;O--;)b(R.contents[O])&&R.contents.splice(O,1);return R.contents.length===0}}function I(R){this.contents=[],this.aspectRatio=R.aspectRatio,this.lang=R.lang}function T(R){for(var O in this.kind=R.kind||"region",this.lang=R.lang,R.id&&(this.id=R.id),this.styleAttrs={},R.styleAttrs)R.styleAttrs.hasOwnProperty(O)&&(this.styleAttrs[O]=R.styleAttrs[O]);"src"in R&&(this.src=R.src),"type"in R&&(this.type=R.type),"text"in R?this.text=R.text:(this.kind==="region"||"contents"in R)&&(this.contents=[]),"space"in R&&(this.space=R.space)}function A(R,O){if(R&&R.error&&R.error(O))throw O}})(y,typeof imscNames>"u"?g(210):imscNames,typeof imscStyles>"u"?g(6811):imscStyles,typeof imscUtils>"u"?g(5926):imscUtils)},4403:function(f,y,g){y.generateISD=g(4080).generateISD,y.fromXML=g(3362).fromXML,y.renderHTML=g(506).render},210:function(f,y){(function(g){g.ns_tt="http://www.w3.org/ns/ttml",g.ns_tts="http://www.w3.org/ns/ttml#styling",g.ns_ttp="http://www.w3.org/ns/ttml#parameter",g.ns_xml="http://www.w3.org/XML/1998/namespace",g.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",g.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",g.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",g.ns_ebutts="urn:ebu:tt:style"})(y)},6811:function(f,y,g){(function(p,m,u){function d(E,b,I,T,A,R,O,H){this.name=b,this.ns=E,this.qname=E+" "+b,this.inherit=A,this.animatable=R,this.initial=I,this.applies=T,this.parse=O,this.compute=H}for(var S in p.all=[new d(m.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,u.parseColor,null),new d(m.ns_tts,"color","white",["span"],!0,!0,u.parseColor,null),new d(m.ns_tts,"direction","ltr",["p","span"],!0,!0,(function(E){return E}),null),new d(m.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,(function(E){return E}),null),new d(m.ns_tts,"displayAlign","before",["region"],!1,!0,(function(E){return E}),null),new d(m.ns_tts,"extent","auto",["tt","region"],!1,!0,(function(E){if(E==="auto")return E;var b=E.split(" ");if(b.length!==2)return null;var I=u.parseLength(b[0]),T=u.parseLength(b[1]);return T&&I?{h:T,w:I}:null}),(function(E,b,I,T,A){var R,O;if(T==="auto")R=new u.ComputedLength(0,1);else if((R=u.toComputedLength(T.h.value,T.h.unit,null,E.dimensions.h,null,E.pxLength.h))===null)return null;if(T==="auto")O=new u.ComputedLength(1,0);else if((O=u.toComputedLength(T.w.value,T.w.unit,null,E.dimensions.w,null,E.pxLength.w))===null)return null;return{h:R,w:O}})),new d(m.ns_tts,"fontFamily","default",["span","p"],!0,!0,(function(E){for(var b=E.split(","),I=[],T=0;T<b.length;T++)b[T]=b[T].trim(),b[T].charAt(0)!=="'"&&b[T].charAt(0)!=='"'&&b[T]==="default"?I.push("monospaceSerif"):I.push(b[T]);return I}),null),new d(m.ns_tts,"shear","0%",["p"],!0,!0,u.parseLength,(function(E,b,I,T){return T.unit!=="%"?null:Math.abs(T.value)>100?100*Math.sign(T.value):T.value})),new d(m.ns_tts,"fontSize","1c",["span","p"],!0,!0,u.parseLength,(function(E,b,I,T,A){return u.toComputedLength(T.value,T.unit,b!==null?b.styleAttrs[p.byName.fontSize.qname]:E.cellLength.h,b!==null?b.styleAttrs[p.byName.fontSize.qname]:E.cellLength.h,E.cellLength.h,E.pxLength.h)})),new d(m.ns_tts,"fontStyle","normal",["span","p"],!0,!0,(function(E){return E}),null),new d(m.ns_tts,"fontWeight","normal",["span","p"],!0,!0,(function(E){return E}),null),new d(m.ns_tts,"lineHeight","normal",["p"],!0,!0,(function(E){return E==="normal"?E:u.parseLength(E)}),(function(E,b,I,T,A){var R;if(T==="normal")R=T;else if((R=u.toComputedLength(T.value,T.unit,I.styleAttrs[p.byName.fontSize.qname],I.styleAttrs[p.byName.fontSize.qname],E.cellLength.h,E.pxLength.h))===null)return null;return R})),new d(m.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new d(m.ns_tts,"origin","auto",["region"],!1,!0,(function(E){if(E==="auto")return E;var b=E.split(" ");if(b.length!==2)return null;var I=u.parseLength(b[0]),T=u.parseLength(b[1]);return T&&I?{h:T,w:I}:null}),(function(E,b,I,T,A){var R,O;if(T==="auto")R=new u.ComputedLength(0,0);else if((R=u.toComputedLength(T.h.value,T.h.unit,null,E.dimensions.h,null,E.pxLength.h))===null)return null;if(T==="auto")O=new u.ComputedLength(0,0);else if((O=u.toComputedLength(T.w.value,T.w.unit,null,E.dimensions.w,null,E.pxLength.w))===null)return null;return{h:R,w:O}})),new d(m.ns_tts,"overflow","hidden",["region"],!1,!0,(function(E){return E}),null),new d(m.ns_tts,"padding","0px",["region"],!1,!0,(function(E){var b=E.split(" ");if(b.length>4)return null;for(var I=[],T=0;T<b.length;T++){var A=u.parseLength(b[T]);if(!A)return null;I.push(A)}return I}),(function(E,b,I,T,A){var R;if(T.length===1)R=[T[0],T[0],T[0],T[0]];else if(T.length===2)R=[T[0],T[1],T[0],T[1]];else if(T.length===3)R=[T[0],T[1],T[2],T[1]];else{if(T.length!==4)return null;R=[T[0],T[1],T[2],T[3]]}var O=I.styleAttrs[p.byName.writingMode.qname];if(O==="lrtb"||O==="lr")R=[R[0],R[3],R[2],R[1]];else if(O==="rltb"||O==="rl")R=[R[0],R[1],R[2],R[3]];else if(O==="tblr")R=[R[3],R[0],R[1],R[2]];else{if(O!=="tbrl"&&O!=="tb")return null;R=[R[3],R[2],R[1],R[0]]}for(var H=[],U=0;U<R.length;U++)if(R[U].value===0)H[U]=new u.ComputedLength(0,0);else if(H[U]=u.toComputedLength(R[U].value,R[U].unit,I.styleAttrs[p.byName.fontSize.qname],U===0||U===2?I.styleAttrs[p.byName.extent.qname].h:I.styleAttrs[p.byName.extent.qname].w,U===0||U===2?E.cellLength.h:E.cellLength.w,U===0||U===2?E.pxLength.h:E.pxLength.w),H[U]===null)return null;return H})),new d(m.ns_tts,"position","top left",["region"],!1,!0,(function(E){return u.parsePosition(E)}),(function(E,b,I,T){var A,R;return(A=u.toComputedLength(T.v.offset.value,T.v.offset.unit,null,new u.ComputedLength(-I.styleAttrs[p.byName.extent.qname].h.rw,E.dimensions.h.rh-I.styleAttrs[p.byName.extent.qname].h.rh),null,E.pxLength.h))===null?null:(T.v.edge==="bottom"&&(A=new u.ComputedLength(-A.rw-I.styleAttrs[p.byName.extent.qname].h.rw,E.dimensions.h.rh-A.rh-I.styleAttrs[p.byName.extent.qname].h.rh)),R=u.toComputedLength(T.h.offset.value,T.h.offset.unit,null,new u.ComputedLength(E.dimensions.w.rw-I.styleAttrs[p.byName.extent.qname].w.rw,-I.styleAttrs[p.byName.extent.qname].w.rh),null,E.pxLength.w),A===null?null:(T.h.edge==="right"&&(R=new u.ComputedLength(E.dimensions.w.rw-R.rw-I.styleAttrs[p.byName.extent.qname].w.rw,-R.rh-I.styleAttrs[p.byName.extent.qname].w.rh)),{h:A,w:R}))})),new d(m.ns_tts,"ruby","none",["span"],!1,!0,(function(E){return E}),null),new d(m.ns_tts,"rubyAlign","center",["span"],!0,!0,(function(E){return E!=="center"&&E!=="spaceAround"?null:E}),null),new d(m.ns_tts,"rubyPosition","outside",["span"],!0,!0,(function(E){return E}),null),new d(m.ns_tts,"rubyReserve","none",["p"],!0,!0,(function(E){var b=E.split(" "),I=[null,null];if(b.length===0||b.length>2||b[0]!=="none"&&b[0]!=="both"&&b[0]!=="after"&&b[0]!=="before"&&b[0]!=="outside")return null;if(I[0]=b[0],b.length===2&&b[0]!=="none"){var T=u.parseLength(b[1]);if(!T)return null;I[1]=T}return I}),(function(E,b,I,T,A){if(T[0]==="none")return T;var R;return(R=T[1]===null?new u.ComputedLength(.5*I.styleAttrs[p.byName.fontSize.qname].rw,.5*I.styleAttrs[p.byName.fontSize.qname].rh):u.toComputedLength(T[1].value,T[1].unit,I.styleAttrs[p.byName.fontSize.qname],I.styleAttrs[p.byName.fontSize.qname],E.cellLength.h,E.pxLength.h))===null?null:[T[0],R]})),new d(m.ns_tts,"showBackground","always",["region"],!1,!0,(function(E){return E}),null),new d(m.ns_tts,"textAlign","start",["p"],!0,!0,(function(E){return E}),(function(E,b,I,T,A){return T==="left"?"start":T==="right"?"end":T})),new d(m.ns_tts,"textCombine","none",["span"],!0,!0,(function(E){return E==="none"||E==="all"?E:null}),null),new d(m.ns_tts,"textDecoration","none",["span"],!0,!0,(function(E){return E.split(" ")}),null),new d(m.ns_tts,"textEmphasis","none",["span"],!0,!0,(function(E){for(var b=E.split(" "),I={style:null,symbol:null,color:null,position:null},T=0;T<b.length;T++)if(b[T]==="none"||b[T]==="auto")I.style=b[T];else if(b[T]==="filled"||b[T]==="open")I.style=b[T];else if(b[T]==="circle"||b[T]==="dot"||b[T]==="sesame")I.symbol=b[T];else if(b[T]==="current")I.color=b[T];else if(b[T]==="outside"||b[T]==="before"||b[T]==="after")I.position=b[T];else if(I.color=u.parseColor(b[T]),I.color===null)return null;return I.style==null&&I.symbol==null?I.style="auto":(I.symbol=I.symbol||"circle",I.style=I.style||"filled"),I.position=I.position||"outside",I.color=I.color||"current",I}),null),new d(m.ns_tts,"textOutline","none",["span"],!0,!0,(function(E){if(E==="none")return E;var b={},I=E.split(" ");if(I.length===0||I.length>2)return null;var T=u.parseColor(I[0]);if(b.color=T,T!==null&&I.shift(),I.length!==1)return null;var A=u.parseLength(I[0]);return A?(b.thickness=A,b):null}),(function(E,b,I,T,A){if(T==="none")return T;var R={};return T.color===null?R.color=I.styleAttrs[p.byName.color.qname]:R.color=T.color,R.thickness=u.toComputedLength(T.thickness.value,T.thickness.unit,I.styleAttrs[p.byName.fontSize.qname],I.styleAttrs[p.byName.fontSize.qname],E.cellLength.h,E.pxLength.h),R.thickness===null?null:R})),new d(m.ns_tts,"textShadow","none",["span"],!0,!0,u.parseTextShadow,(function(E,b,I,T){if(T==="none")return T;for(var A=[],R=0;R<T.length;R++){var O={};if(O.x_off=u.toComputedLength(T[R][0].value,T[R][0].unit,null,I.styleAttrs[p.byName.fontSize.qname],null,E.pxLength.w),O.x_off===null||(O.y_off=u.toComputedLength(T[R][1].value,T[R][1].unit,null,I.styleAttrs[p.byName.fontSize.qname],null,E.pxLength.h),O.y_off===null))return null;if(T[R][2]===null)O.b_radius=0;else if(O.b_radius=u.toComputedLength(T[R][2].value,T[R][2].unit,null,I.styleAttrs[p.byName.fontSize.qname],null,E.pxLength.h),O.b_radius===null)return null;T[R][3]===null?O.color=I.styleAttrs[p.byName.color.qname]:O.color=T[R][3],A.push(O)}return A})),new d(m.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,(function(E){return E}),null),new d(m.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,(function(E){return E}),null),new d(m.ns_tts,"wrapOption","wrap",["span"],!0,!0,(function(E){return E}),null),new d(m.ns_tts,"writingMode","lrtb",["region"],!1,!0,(function(E){return E}),null),new d(m.ns_tts,"zIndex","auto",["region"],!1,!0,(function(E){var b;return E==="auto"?b=E:(b=parseInt(E),isNaN(b)&&(b=null)),b}),null),new d(m.ns_ebutts,"linePadding","0c",["p"],!0,!1,u.parseLength,(function(E,b,I,T,A){return u.toComputedLength(T.value,T.unit,null,null,E.cellLength.w,null)})),new d(m.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,(function(E){return E}),null),new d(m.ns_smpte,"backgroundImage",null,["div"],!1,!1,(function(E){return E}),null),new d(m.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,(function(E){return E==="true"}),null),new d(m.ns_itts,"fillLineGap","false",["p"],!0,!0,(function(E){return E==="true"}),null)],p.byQName={},p.all)p.byQName[p.all[S].qname]=p.all[S];for(var _ in p.byName={},p.all)p.byName[p.all[_].name]=p.all[_]})(y,typeof imscNames>"u"?g(210):imscNames,typeof imscUtils>"u"?g(5926):imscUtils)},5926:function(f,y){(function(g){var p=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,m=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,u=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,d={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};g.parseColor=function(_){var E,b=null,I=d[_.toLowerCase()];return I!==void 0?b=I:(E=p.exec(_))!==null?b=[parseInt(E[1],16),parseInt(E[2],16),parseInt(E[3],16),E[4]!==void 0?parseInt(E[4],16):255]:(E=m.exec(_))!==null?b=[parseInt(E[1]),parseInt(E[2]),parseInt(E[3]),255]:(E=u.exec(_))!==null&&(b=[parseInt(E[1]),parseInt(E[2]),parseInt(E[3]),parseInt(E[4])]),b};var S=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;g.parseLength=function(_){var E,b=null;return(E=S.exec(_))!==null&&(b={value:parseFloat(E[1]),unit:E[2]}),b},g.parseTextShadow=function(_){for(var E=_.match(/([^\(,\)]|\([^\)]+\))+/g),b=[],I=0;I<E.length;I++){var T=E[I].split(" ");if(T.length===1&&T[0]==="none")return"none";if(T.length>1&&T.length<5){var A=[null,null,null,null],R=g.parseLength(T.shift());if(R===null||(A[0]=R,(R=g.parseLength(T.shift()))===null))return null;if(A[1]=R,T.length===0){b.push(A);continue}if((R=g.parseLength(T[0]))!==null&&(A[2]=R,T.shift()),T.length===0){b.push(A);continue}var O=g.parseColor(T[0]);if(O===null)return null;A[3]=O,b.push(A)}}return b},g.parsePosition=function(_){var E=_.split(" "),b=function(U){return U==="center"||U==="left"||U==="top"||U==="bottom"||U==="right"};if(E.length>4)return null;for(var I=0;I<E.length;I++)if(!b(E[I])){var T=g.parseLength(E[I]);if(T===null)return null;E[I]=T}for(var A={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},R=0;R<E.length;){var O=E[R++];if(b(O)){var H={value:0,unit:"%"};E.length!==2&&R<E.length&&!b(E[R])&&(H=E[R++]),O==="right"?(A.h.edge=O,A.h.offset=H):O==="bottom"?(A.v.edge=O,A.v.offset=H):O==="left"?A.h.offset=H:O==="top"&&(A.v.offset=H)}else{if(E.length!==1&&E.length!==2)return null;R===1?A.h.offset=O:A.v.offset=O}}return A},g.ComputedLength=function(_,E){this.rw=_,this.rh=E},g.ComputedLength.prototype.toUsedLength=function(_,E){return _*this.rw+E*this.rh},g.ComputedLength.prototype.isZero=function(){return this.rw===0&&this.rh===0},g.toComputedLength=function(_,E,b,I,T,A){return E==="%"&&I?new g.ComputedLength(I.rw*_/100,I.rh*_/100):E==="em"&&b?new g.ComputedLength(b.rw*_,b.rh*_):E==="c"&&T?new g.ComputedLength(_*T.rw,_*T.rh):E==="px"&&A?new g.ComputedLength(_*A.rw,_*A.rh):E==="rh"?new g.ComputedLength(0,_/100):E==="rw"?new g.ComputedLength(_/100,0):null}})(y)},3516:function(f){f.exports=function(y){var g=typeof y=="string"?y.charCodeAt(0):y;return g>=97&&g<=122||g>=65&&g<=90}},2219:function(f,y,g){var p=g(3516),m=g(395);f.exports=function(u){return p(u)||m(u)}},395:function(f){f.exports=function(y){var g=typeof y=="string"?y.charCodeAt(0):y;return g>=48&&g<=57}},3875:function(f){function y(m){if(typeof m!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(m))}function g(m,u){for(var d,S="",_=0,E=-1,b=0,I=0;I<=m.length;++I){if(I<m.length)d=m.charCodeAt(I);else{if(d===47)break;d=47}if(d===47){if(!(E===I-1||b===1))if(E!==I-1&&b===2){if(S.length<2||_!==2||S.charCodeAt(S.length-1)!==46||S.charCodeAt(S.length-2)!==46){if(S.length>2){var T=S.lastIndexOf("/");if(T!==S.length-1){T===-1?(S="",_=0):_=(S=S.slice(0,T)).length-1-S.lastIndexOf("/"),E=I,b=0;continue}}else if(S.length===2||S.length===1){S="",_=0,E=I,b=0;continue}}u&&(S.length>0?S+="/..":S="..",_=2)}else S.length>0?S+="/"+m.slice(E+1,I):S=m.slice(E+1,I),_=I-E-1;E=I,b=0}else d===46&&b!==-1?++b:b=-1}return S}var p={resolve:function(){for(var m,u="",d=!1,S=arguments.length-1;S>=-1&&!d;S--){var _;S>=0?_=arguments[S]:(m===void 0&&(m=process.cwd()),_=m),y(_),_.length!==0&&(u=_+"/"+u,d=_.charCodeAt(0)===47)}return u=g(u,!d),d?u.length>0?"/"+u:"/":u.length>0?u:"."},normalize:function(m){if(y(m),m.length===0)return".";var u=m.charCodeAt(0)===47,d=m.charCodeAt(m.length-1)===47;return(m=g(m,!u)).length!==0||u||(m="."),m.length>0&&d&&(m+="/"),u?"/"+m:m},isAbsolute:function(m){return y(m),m.length>0&&m.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var m,u=0;u<arguments.length;++u){var d=arguments[u];y(d),d.length>0&&(m===void 0?m=d:m+="/"+d)}return m===void 0?".":p.normalize(m)},relative:function(m,u){if(y(m),y(u),m===u||(m=p.resolve(m))===(u=p.resolve(u)))return"";for(var d=1;d<m.length&&m.charCodeAt(d)===47;++d);for(var S=m.length,_=S-d,E=1;E<u.length&&u.charCodeAt(E)===47;++E);for(var b=u.length-E,I=_<b?_:b,T=-1,A=0;A<=I;++A){if(A===I){if(b>I){if(u.charCodeAt(E+A)===47)return u.slice(E+A+1);if(A===0)return u.slice(E+A)}else _>I&&(m.charCodeAt(d+A)===47?T=A:A===0&&(T=0));break}var R=m.charCodeAt(d+A);if(R!==u.charCodeAt(E+A))break;R===47&&(T=A)}var O="";for(A=d+T+1;A<=S;++A)A!==S&&m.charCodeAt(A)!==47||(O.length===0?O+="..":O+="/..");return O.length>0?O+u.slice(E+T):(E+=T,u.charCodeAt(E)===47&&++E,u.slice(E))},_makeLong:function(m){return m},dirname:function(m){if(y(m),m.length===0)return".";for(var u=m.charCodeAt(0),d=u===47,S=-1,_=!0,E=m.length-1;E>=1;--E)if((u=m.charCodeAt(E))===47){if(!_){S=E;break}}else _=!1;return S===-1?d?"/":".":d&&S===1?"//":m.slice(0,S)},basename:function(m,u){if(u!==void 0&&typeof u!="string")throw new TypeError('"ext" argument must be a string');y(m);var d,S=0,_=-1,E=!0;if(u!==void 0&&u.length>0&&u.length<=m.length){if(u.length===m.length&&u===m)return"";var b=u.length-1,I=-1;for(d=m.length-1;d>=0;--d){var T=m.charCodeAt(d);if(T===47){if(!E){S=d+1;break}}else I===-1&&(E=!1,I=d+1),b>=0&&(T===u.charCodeAt(b)?--b==-1&&(_=d):(b=-1,_=I))}return S===_?_=I:_===-1&&(_=m.length),m.slice(S,_)}for(d=m.length-1;d>=0;--d)if(m.charCodeAt(d)===47){if(!E){S=d+1;break}}else _===-1&&(E=!1,_=d+1);return _===-1?"":m.slice(S,_)},extname:function(m){y(m);for(var u=-1,d=0,S=-1,_=!0,E=0,b=m.length-1;b>=0;--b){var I=m.charCodeAt(b);if(I!==47)S===-1&&(_=!1,S=b+1),I===46?u===-1?u=b:E!==1&&(E=1):u!==-1&&(E=-1);else if(!_){d=b+1;break}}return u===-1||S===-1||E===0||E===1&&u===S-1&&u===d+1?"":m.slice(u,S)},format:function(m){if(m===null||typeof m!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof m);return(function(u,d){var S=d.dir||d.root,_=d.base||(d.name||"")+(d.ext||"");return S?S===d.root?S+_:S+"/"+_:_})(0,m)},parse:function(m){y(m);var u={root:"",dir:"",base:"",ext:"",name:""};if(m.length===0)return u;var d,S=m.charCodeAt(0),_=S===47;_?(u.root="/",d=1):d=0;for(var E=-1,b=0,I=-1,T=!0,A=m.length-1,R=0;A>=d;--A)if((S=m.charCodeAt(A))!==47)I===-1&&(T=!1,I=A+1),S===46?E===-1?E=A:R!==1&&(R=1):E!==-1&&(R=-1);else if(!T){b=A+1;break}return E===-1||I===-1||R===0||R===1&&E===I-1&&E===b+1?I!==-1&&(u.base=u.name=b===0&&_?m.slice(1,I):m.slice(b,I)):(b===0&&_?(u.name=m.slice(1,E),u.base=m.slice(1,I)):(u.name=m.slice(b,E),u.base=m.slice(b,I)),u.ext=m.slice(E,I)),b>0?u.dir=m.slice(0,b-1):_&&(u.dir="/"),u},sep:"/",delimiter:":",win32:null,posix:null};p.posix=p,f.exports=p},8387:function(f,y,g){var p=g(1549),m=p.Buffer;function u(S,_){for(var E in S)_[E]=S[E]}function d(S,_,E){return m(S,_,E)}m.from&&m.alloc&&m.allocUnsafe&&m.allocUnsafeSlow?f.exports=p:(u(p,y),y.Buffer=d),u(m,d),d.from=function(S,_,E){if(typeof S=="number")throw new TypeError("Argument must not be a number");return m(S,_,E)},d.alloc=function(S,_,E){if(typeof S!="number")throw new TypeError("Argument must be a number");var b=m(S);return _!==void 0?typeof E=="string"?b.fill(_,E):b.fill(_):b.fill(0),b},d.allocUnsafe=function(S){if(typeof S!="number")throw new TypeError("Argument must be a number");return m(S)},d.allocUnsafeSlow=function(S){if(typeof S!="number")throw new TypeError("Argument must be a number");return p.SlowBuffer(S)}},5378:function(f,y,g){(function(p){p.parser=function(w,N){return new d(w,N)},p.SAXParser=d,p.SAXStream=_,p.createStream=function(w,N){return new _(w,N)},p.MAX_BUFFER_LENGTH=65536;var m,u=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function d(w,N){if(!(this instanceof d))return new d(w,N);var G=this;(function(V){for(var ye=0,he=u.length;ye<he;ye++)V[u[ye]]=""})(G),G.q=G.c="",G.bufferCheckPosition=p.MAX_BUFFER_LENGTH,G.opt=N||{},G.opt.lowercase=G.opt.lowercase||G.opt.lowercasetags,G.looseCase=G.opt.lowercase?"toLowerCase":"toUpperCase",G.tags=[],G.closed=G.closedRoot=G.sawRoot=!1,G.tag=G.error=null,G.strict=!!w,G.noscript=!(!w&&!G.opt.noscript),G.state=X.BEGIN,G.strictEntities=G.opt.strictEntities,G.ENTITIES=G.strictEntities?Object.create(p.XML_ENTITIES):Object.create(p.ENTITIES),G.attribList=[],G.opt.xmlns&&(G.ns=Object.create(H)),G.trackPosition=G.opt.position!==!1,G.trackPosition&&(G.position=G.line=G.column=0),Be(G,"onready")}p.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(w){function N(){}return N.prototype=w,new N}),Object.keys||(Object.keys=function(w){var N=[];for(var G in w)w.hasOwnProperty(G)&&N.push(G);return N}),d.prototype={end:function(){Ke(this)},write:function(w){var N=this;if(this.error)throw this.error;if(N.closed)return Ze(N,"Cannot write after close. Assign an onready handler.");if(w===null)return Ke(N);typeof w=="object"&&(w=w.toString());for(var G=0,V="";V=it(w,G++),N.c=V,V;)switch(N.trackPosition&&(N.position++,V===`
`?(N.line++,N.column=0):N.column++),N.state){case X.BEGIN:if(N.state=X.BEGIN_WHITESPACE,V==="\uFEFF")continue;Fe(N,V);continue;case X.BEGIN_WHITESPACE:Fe(N,V);continue;case X.TEXT:if(N.sawRoot&&!N.closedRoot){for(var ye=G-1;V&&V!=="<"&&V!=="&";)(V=it(w,G++))&&N.trackPosition&&(N.position++,V===`
`?(N.line++,N.column=0):N.column++);N.textNode+=w.substring(ye,G-1)}V!=="<"||N.sawRoot&&N.closedRoot&&!N.strict?(!ne(E,V)||N.sawRoot&&!N.closedRoot||De(N,"Text data outside of root node."),V==="&"?N.state=X.TEXT_ENTITY:N.textNode+=V):(N.state=X.OPEN_WAKA,N.startTagPosition=N.position);continue;case X.SCRIPT:V==="<"?N.state=X.SCRIPT_ENDING:N.script+=V;continue;case X.SCRIPT_ENDING:V==="/"?N.state=X.CLOSE_TAG:(N.script+="<"+V,N.state=X.SCRIPT);continue;case X.OPEN_WAKA:if(V==="!")N.state=X.SGML_DECL,N.sgmlDecl="";else if(!fe(E,V))if(fe(U,V))N.state=X.OPEN_TAG,N.tagName=V;else if(V==="/")N.state=X.CLOSE_TAG,N.tagName="";else if(V==="?")N.state=X.PROC_INST,N.procInstName=N.procInstBody="";else{if(De(N,"Unencoded <"),N.startTagPosition+1<N.position){var he=N.position-N.startTagPosition;V=new Array(he).join(" ")+V}N.textNode+="<"+V,N.state=X.TEXT}continue;case X.SGML_DECL:(N.sgmlDecl+V).toUpperCase()==="[CDATA["?(qe(N,"onopencdata"),N.state=X.CDATA,N.sgmlDecl="",N.cdata=""):N.sgmlDecl+V==="--"?(N.state=X.COMMENT,N.comment="",N.sgmlDecl=""):(N.sgmlDecl+V).toUpperCase()==="DOCTYPE"?(N.state=X.DOCTYPE,(N.doctype||N.sawRoot)&&De(N,"Inappropriately located doctype declaration"),N.doctype="",N.sgmlDecl=""):V===">"?(qe(N,"onsgmldeclaration",N.sgmlDecl),N.sgmlDecl="",N.state=X.TEXT):(fe(T,V)&&(N.state=X.SGML_DECL_QUOTED),N.sgmlDecl+=V);continue;case X.SGML_DECL_QUOTED:V===N.q&&(N.state=X.SGML_DECL,N.q=""),N.sgmlDecl+=V;continue;case X.DOCTYPE:V===">"?(N.state=X.TEXT,qe(N,"ondoctype",N.doctype),N.doctype=!0):(N.doctype+=V,V==="["?N.state=X.DOCTYPE_DTD:fe(T,V)&&(N.state=X.DOCTYPE_QUOTED,N.q=V));continue;case X.DOCTYPE_QUOTED:N.doctype+=V,V===N.q&&(N.q="",N.state=X.DOCTYPE);continue;case X.DOCTYPE_DTD:N.doctype+=V,V==="]"?N.state=X.DOCTYPE:fe(T,V)&&(N.state=X.DOCTYPE_DTD_QUOTED,N.q=V);continue;case X.DOCTYPE_DTD_QUOTED:N.doctype+=V,V===N.q&&(N.state=X.DOCTYPE_DTD,N.q="");continue;case X.COMMENT:V==="-"?N.state=X.COMMENT_ENDING:N.comment+=V;continue;case X.COMMENT_ENDING:V==="-"?(N.state=X.COMMENT_ENDED,N.comment=_e(N.opt,N.comment),N.comment&&qe(N,"oncomment",N.comment),N.comment=""):(N.comment+="-"+V,N.state=X.COMMENT);continue;case X.COMMENT_ENDED:V!==">"?(De(N,"Malformed comment"),N.comment+="--"+V,N.state=X.COMMENT):N.state=X.TEXT;continue;case X.CDATA:V==="]"?N.state=X.CDATA_ENDING:N.cdata+=V;continue;case X.CDATA_ENDING:V==="]"?N.state=X.CDATA_ENDING_2:(N.cdata+="]"+V,N.state=X.CDATA);continue;case X.CDATA_ENDING_2:V===">"?(N.cdata&&qe(N,"oncdata",N.cdata),qe(N,"onclosecdata"),N.cdata="",N.state=X.TEXT):V==="]"?N.cdata+="]":(N.cdata+="]]"+V,N.state=X.CDATA);continue;case X.PROC_INST:V==="?"?N.state=X.PROC_INST_ENDING:fe(E,V)?N.state=X.PROC_INST_BODY:N.procInstName+=V;continue;case X.PROC_INST_BODY:if(!N.procInstBody&&fe(E,V))continue;V==="?"?N.state=X.PROC_INST_ENDING:N.procInstBody+=V;continue;case X.PROC_INST_ENDING:V===">"?(qe(N,"onprocessinginstruction",{name:N.procInstName,body:N.procInstBody}),N.procInstName=N.procInstBody="",N.state=X.TEXT):(N.procInstBody+="?"+V,N.state=X.PROC_INST_BODY);continue;case X.OPEN_TAG:fe(Z,V)?N.tagName+=V:(Ge(N),V===">"?et(N):V==="/"?N.state=X.OPEN_TAG_SLASH:(ne(E,V)&&De(N,"Invalid character in tag name"),N.state=X.ATTRIB));continue;case X.OPEN_TAG_SLASH:V===">"?(et(N,!0),gt(N)):(De(N,"Forward-slash in opening tag not followed by >"),N.state=X.ATTRIB);continue;case X.ATTRIB:if(fe(E,V))continue;V===">"?et(N):V==="/"?N.state=X.OPEN_TAG_SLASH:fe(U,V)?(N.attribName=V,N.attribValue="",N.state=X.ATTRIB_NAME):De(N,"Invalid attribute name");continue;case X.ATTRIB_NAME:V==="="?N.state=X.ATTRIB_VALUE:V===">"?(De(N,"Attribute without value"),N.attribValue=N.attribName,vt(N),et(N)):fe(E,V)?N.state=X.ATTRIB_NAME_SAW_WHITE:fe(Z,V)?N.attribName+=V:De(N,"Invalid attribute name");continue;case X.ATTRIB_NAME_SAW_WHITE:if(V==="=")N.state=X.ATTRIB_VALUE;else{if(fe(E,V))continue;De(N,"Attribute without value"),N.tag.attributes[N.attribName]="",N.attribValue="",qe(N,"onattribute",{name:N.attribName,value:""}),N.attribName="",V===">"?et(N):fe(U,V)?(N.attribName=V,N.state=X.ATTRIB_NAME):(De(N,"Invalid attribute name"),N.state=X.ATTRIB)}continue;case X.ATTRIB_VALUE:if(fe(E,V))continue;fe(T,V)?(N.q=V,N.state=X.ATTRIB_VALUE_QUOTED):(De(N,"Unquoted attribute value"),N.state=X.ATTRIB_VALUE_UNQUOTED,N.attribValue=V);continue;case X.ATTRIB_VALUE_QUOTED:if(V!==N.q){V==="&"?N.state=X.ATTRIB_VALUE_ENTITY_Q:N.attribValue+=V;continue}vt(N),N.q="",N.state=X.ATTRIB_VALUE_CLOSED;continue;case X.ATTRIB_VALUE_CLOSED:fe(E,V)?N.state=X.ATTRIB:V===">"?et(N):V==="/"?N.state=X.OPEN_TAG_SLASH:fe(U,V)?(De(N,"No whitespace between attributes"),N.attribName=V,N.attribValue="",N.state=X.ATTRIB_NAME):De(N,"Invalid attribute name");continue;case X.ATTRIB_VALUE_UNQUOTED:if(ne(A,V)){V==="&"?N.state=X.ATTRIB_VALUE_ENTITY_U:N.attribValue+=V;continue}vt(N),V===">"?et(N):N.state=X.ATTRIB;continue;case X.CLOSE_TAG:if(N.tagName)V===">"?gt(N):fe(Z,V)?N.tagName+=V:N.script?(N.script+="</"+N.tagName,N.tagName="",N.state=X.SCRIPT):(ne(E,V)&&De(N,"Invalid tagname in closing tag"),N.state=X.CLOSE_TAG_SAW_WHITE);else{if(fe(E,V))continue;ne(U,V)?N.script?(N.script+="</"+V,N.state=X.SCRIPT):De(N,"Invalid tagname in closing tag."):N.tagName=V}continue;case X.CLOSE_TAG_SAW_WHITE:if(fe(E,V))continue;V===">"?gt(N):De(N,"Invalid characters in closing tag");continue;case X.TEXT_ENTITY:case X.ATTRIB_VALUE_ENTITY_Q:case X.ATTRIB_VALUE_ENTITY_U:var He,ut;switch(N.state){case X.TEXT_ENTITY:He=X.TEXT,ut="textNode";break;case X.ATTRIB_VALUE_ENTITY_Q:He=X.ATTRIB_VALUE_QUOTED,ut="attribValue";break;case X.ATTRIB_VALUE_ENTITY_U:He=X.ATTRIB_VALUE_UNQUOTED,ut="attribValue"}V===";"?(N[ut]+=Oe(N),N.entity="",N.state=He):fe(N.entity.length?F:$,V)?N.entity+=V:(De(N,"Invalid character in entity name"),N[ut]+="&"+N.entity+V,N.entity="",N.state=He);continue;default:throw new Error(N,"Unknown state: "+N.state)}return N.position>=N.bufferCheckPosition&&(function(Je){for(var Qe=Math.max(p.MAX_BUFFER_LENGTH,10),Ye=0,nt=0,mt=u.length;nt<mt;nt++){var Gt=Je[u[nt]].length;if(Gt>Qe)switch(u[nt]){case"textNode":ee(Je);break;case"cdata":qe(Je,"oncdata",Je.cdata),Je.cdata="";break;case"script":qe(Je,"onscript",Je.script),Je.script="";break;default:Ze(Je,"Max buffer length exceeded: "+u[nt])}Ye=Math.max(Ye,Gt)}var _t=p.MAX_BUFFER_LENGTH-Ye;Je.bufferCheckPosition=_t+Je.position})(N),N},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var w;ee(w=this),w.cdata!==""&&(qe(w,"oncdata",w.cdata),w.cdata=""),w.script!==""&&(qe(w,"onscript",w.script),w.script="")}};try{m=g(182).Stream}catch{m=function(){}}var S=p.EVENTS.filter((function(w){return w!=="error"&&w!=="end"}));function _(w,N){if(!(this instanceof _))return new _(w,N);m.apply(this),this._parser=new d(w,N),this.writable=!0,this.readable=!0;var G=this;this._parser.onend=function(){G.emit("end")},this._parser.onerror=function(V){G.emit("error",V),G._parser.error=null},this._decoder=null,S.forEach((function(V){Object.defineProperty(G,"on"+V,{get:function(){return G._parser["on"+V]},set:function(ye){if(!ye)return G.removeAllListeners(V),G._parser["on"+V]=ye,ye;G.on(V,ye)},enumerable:!0,configurable:!1})}))}_.prototype=Object.create(m.prototype,{constructor:{value:_}}),_.prototype.write=function(w){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(w)){if(!this._decoder){var N=g(7503).s;this._decoder=new N("utf8")}w=this._decoder.write(w)}return this._parser.write(w.toString()),this.emit("data",w),!0},_.prototype.end=function(w){return w&&w.length&&this.write(w),this._parser.end(),!0},_.prototype.on=function(w,N){var G=this;return G._parser["on"+w]||S.indexOf(w)===-1||(G._parser["on"+w]=function(){var V=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);V.splice(0,0,w),G.emit.apply(G,V)}),m.prototype.on.call(G,w,N)};var E=`\r
	 `,b="0124356789",I="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",T=`'"`,A=E+">",R="http://www.w3.org/XML/1998/namespace",O="http://www.w3.org/2000/xmlns/",H={xml:R,xmlns:O};E=W(E),b=W(b),I=W(I);var U=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Z=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,$=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,F=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function W(w){return w.split("").reduce((function(N,G){return N[G]=!0,N}),{})}function fe(w,N){return(function(G){return Object.prototype.toString.call(G)==="[object RegExp]"})(w)?!!N.match(w):w[N]}function ne(w,N){return!fe(w,N)}T=W(T),A=W(A);var de,Te,me,X=0;for(var Ie in p.STATE={BEGIN:X++,BEGIN_WHITESPACE:X++,TEXT:X++,TEXT_ENTITY:X++,OPEN_WAKA:X++,SGML_DECL:X++,SGML_DECL_QUOTED:X++,DOCTYPE:X++,DOCTYPE_QUOTED:X++,DOCTYPE_DTD:X++,DOCTYPE_DTD_QUOTED:X++,COMMENT_STARTING:X++,COMMENT:X++,COMMENT_ENDING:X++,COMMENT_ENDED:X++,CDATA:X++,CDATA_ENDING:X++,CDATA_ENDING_2:X++,PROC_INST:X++,PROC_INST_BODY:X++,PROC_INST_ENDING:X++,OPEN_TAG:X++,OPEN_TAG_SLASH:X++,ATTRIB:X++,ATTRIB_NAME:X++,ATTRIB_NAME_SAW_WHITE:X++,ATTRIB_VALUE:X++,ATTRIB_VALUE_QUOTED:X++,ATTRIB_VALUE_CLOSED:X++,ATTRIB_VALUE_UNQUOTED:X++,ATTRIB_VALUE_ENTITY_Q:X++,ATTRIB_VALUE_ENTITY_U:X++,CLOSE_TAG:X++,CLOSE_TAG_SAW_WHITE:X++,SCRIPT:X++,SCRIPT_ENDING:X++},p.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},p.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(p.ENTITIES).forEach((function(w){var N=p.ENTITIES[w],G=typeof N=="number"?String.fromCharCode(N):N;p.ENTITIES[w]=G})),p.STATE)p.STATE[p.STATE[Ie]]=Ie;function Be(w,N,G){w[N]&&w[N](G)}function qe(w,N,G){w.textNode&&ee(w),Be(w,N,G)}function ee(w){w.textNode=_e(w.opt,w.textNode),w.textNode&&Be(w,"ontext",w.textNode),w.textNode=""}function _e(w,N){return w.trim&&(N=N.trim()),w.normalize&&(N=N.replace(/\s+/g," ")),N}function Ze(w,N){return ee(w),w.trackPosition&&(N+=`
Line: `+w.line+`
Column: `+w.column+`
Char: `+w.c),N=new Error(N),w.error=N,Be(w,"onerror",N),w}function Ke(w){return w.sawRoot&&!w.closedRoot&&De(w,"Unclosed root tag"),w.state!==X.BEGIN&&w.state!==X.BEGIN_WHITESPACE&&w.state!==X.TEXT&&Ze(w,"Unexpected end"),ee(w),w.c="",w.closed=!0,Be(w,"onend"),d.call(w,w.strict,w.opt),w}function De(w,N){if(typeof w!="object"||!(w instanceof d))throw new Error("bad call to strictFail");w.strict&&Ze(w,N)}function Ge(w){w.strict||(w.tagName=w.tagName[w.looseCase]());var N=w.tags[w.tags.length-1]||w,G=w.tag={name:w.tagName,attributes:{}};w.opt.xmlns&&(G.ns=N.ns),w.attribList.length=0,qe(w,"onopentagstart",G)}function Et(w,N){var G=w.indexOf(":")<0?["",w]:w.split(":"),V=G[0],ye=G[1];return N&&w==="xmlns"&&(V="xmlns",ye=""),{prefix:V,local:ye}}function vt(w){if(w.strict||(w.attribName=w.attribName[w.looseCase]()),w.attribList.indexOf(w.attribName)!==-1||w.tag.attributes.hasOwnProperty(w.attribName))w.attribName=w.attribValue="";else{if(w.opt.xmlns){var N=Et(w.attribName,!0),G=N.prefix,V=N.local;if(G==="xmlns")if(V==="xml"&&w.attribValue!==R)De(w,"xml: prefix must be bound to "+R+`
Actual: `+w.attribValue);else if(V==="xmlns"&&w.attribValue!==O)De(w,"xmlns: prefix must be bound to "+O+`
Actual: `+w.attribValue);else{var ye=w.tag,he=w.tags[w.tags.length-1]||w;ye.ns===he.ns&&(ye.ns=Object.create(he.ns)),ye.ns[V]=w.attribValue}w.attribList.push([w.attribName,w.attribValue])}else w.tag.attributes[w.attribName]=w.attribValue,qe(w,"onattribute",{name:w.attribName,value:w.attribValue});w.attribName=w.attribValue=""}}function et(w,N){if(w.opt.xmlns){var G=w.tag,V=Et(w.tagName);G.prefix=V.prefix,G.local=V.local,G.uri=G.ns[V.prefix]||"",G.prefix&&!G.uri&&(De(w,"Unbound namespace prefix: "+JSON.stringify(w.tagName)),G.uri=V.prefix);var ye=w.tags[w.tags.length-1]||w;G.ns&&ye.ns!==G.ns&&Object.keys(G.ns).forEach((function(gn){qe(w,"onopennamespace",{prefix:gn,uri:G.ns[gn]})}));for(var he=0,He=w.attribList.length;he<He;he++){var ut=w.attribList[he],Je=ut[0],Qe=ut[1],Ye=Et(Je,!0),nt=Ye.prefix,mt=Ye.local,Gt=nt===""?"":G.ns[nt]||"",_t={name:Je,value:Qe,prefix:nt,local:mt,uri:Gt};nt&&nt!=="xmlns"&&!Gt&&(De(w,"Unbound namespace prefix: "+JSON.stringify(nt)),_t.uri=nt),w.tag.attributes[Je]=_t,qe(w,"onattribute",_t)}w.attribList.length=0}w.tag.isSelfClosing=!!N,w.sawRoot=!0,w.tags.push(w.tag),qe(w,"onopentag",w.tag),N||(w.noscript||w.tagName.toLowerCase()!=="script"?w.state=X.TEXT:w.state=X.SCRIPT,w.tag=null,w.tagName=""),w.attribName=w.attribValue="",w.attribList.length=0}function gt(w){if(!w.tagName)return De(w,"Weird empty close tag."),w.textNode+="</>",void(w.state=X.TEXT);if(w.script){if(w.tagName!=="script")return w.script+="</"+w.tagName+">",w.tagName="",void(w.state=X.SCRIPT);qe(w,"onscript",w.script),w.script=""}var N=w.tags.length,G=w.tagName;w.strict||(G=G[w.looseCase]());for(var V=G;N--&&w.tags[N].name!==V;)De(w,"Unexpected close tag");if(N<0)return De(w,"Unmatched closing tag: "+w.tagName),w.textNode+="</"+w.tagName+">",void(w.state=X.TEXT);w.tagName=G;for(var ye=w.tags.length;ye-- >N;){var he=w.tag=w.tags.pop();w.tagName=w.tag.name,qe(w,"onclosetag",w.tagName);var He={};for(var ut in he.ns)He[ut]=he.ns[ut];var Je=w.tags[w.tags.length-1]||w;w.opt.xmlns&&he.ns!==Je.ns&&Object.keys(he.ns).forEach((function(Qe){var Ye=he.ns[Qe];qe(w,"onclosenamespace",{prefix:Qe,uri:Ye})}))}N===0&&(w.closedRoot=!0),w.tagName=w.attribValue=w.attribName="",w.attribList.length=0,w.state=X.TEXT}function Oe(w){var N,G=w.entity,V=G.toLowerCase(),ye="";return w.ENTITIES[G]?w.ENTITIES[G]:w.ENTITIES[V]?w.ENTITIES[V]:((G=V).charAt(0)==="#"&&(G.charAt(1)==="x"?(G=G.slice(2),ye=(N=parseInt(G,16)).toString(16)):(G=G.slice(1),ye=(N=parseInt(G,10)).toString(10))),G=G.replace(/^0+/,""),ye.toLowerCase()!==G?(De(w,"Invalid character entity"),"&"+w.entity+";"):String.fromCodePoint(N))}function Fe(w,N){N==="<"?(w.state=X.OPEN_WAKA,w.startTagPosition=w.position):ne(E,N)&&(De(w,"Non-whitespace before first tag."),w.textNode=N,w.state=X.TEXT)}function it(w,N){var G="";return N<w.length&&(G=w.charAt(N)),G}X=p.STATE,String.fromCodePoint||(de=String.fromCharCode,Te=Math.floor,me=function(){var w,N,G=16384,V=[],ye=-1,he=arguments.length;if(!he)return"";for(var He="";++ye<he;){var ut=Number(arguments[ye]);if(!isFinite(ut)||ut<0||ut>1114111||Te(ut)!==ut)throw RangeError("Invalid code point: "+ut);ut<=65535?V.push(ut):(w=55296+((ut-=65536)>>10),N=ut%1024+56320,V.push(w,N)),(ye+1===he||V.length>G)&&(He+=de.apply(null,V),V.length=0)}return He},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:me,configurable:!0,writable:!0}):String.fromCodePoint=me)})(y)},182:function(f,y,g){f.exports=m;var p=g(1159).EventEmitter;function m(){p.call(this)}g(1765)(m,p),m.Readable=g(2846),m.Writable=g(8318),m.Duplex=g(6138),m.Transform=g(9798),m.PassThrough=g(5472),m.finished=g(8800),m.pipeline=g(7295),m.Stream=m,m.prototype.pipe=function(u,d){var S=this;function _(O){u.writable&&u.write(O)===!1&&S.pause&&S.pause()}function E(){S.readable&&S.resume&&S.resume()}S.on("data",_),u.on("drain",E),u._isStdio||d&&d.end===!1||(S.on("end",I),S.on("close",T));var b=!1;function I(){b||(b=!0,u.end())}function T(){b||(b=!0,typeof u.destroy=="function"&&u.destroy())}function A(O){if(R(),p.listenerCount(this,"error")===0)throw O}function R(){S.removeListener("data",_),u.removeListener("drain",E),S.removeListener("end",I),S.removeListener("close",T),S.removeListener("error",A),u.removeListener("error",A),S.removeListener("end",R),S.removeListener("close",R),u.removeListener("close",R)}return S.on("error",A),u.on("error",A),S.on("end",R),S.on("close",R),u.on("close",R),u.emit("pipe",S),u}},1765:function(f){typeof Object.create=="function"?f.exports=function(y,g){g&&(y.super_=g,y.prototype=Object.create(g.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}))}:f.exports=function(y,g){if(g){y.super_=g;var p=function(){};p.prototype=g.prototype,y.prototype=new p,y.prototype.constructor=y}}},3690:function(f){var y={};function g(m,u,d){d||(d=Error);var S=(function(_){var E,b;function I(T,A,R){return _.call(this,(function(O,H,U){return typeof u=="string"?u:u(O,H,U)})(T,A,R))||this}return b=_,(E=I).prototype=Object.create(b.prototype),E.prototype.constructor=E,E.__proto__=b,I})(d);S.prototype.name=d.name,S.prototype.code=m,y[m]=S}function p(m,u){if(Array.isArray(m)){var d=m.length;return m=m.map((function(S){return String(S)})),d>2?"one of ".concat(u," ").concat(m.slice(0,d-1).join(", "),", or ")+m[d-1]:d===2?"one of ".concat(u," ").concat(m[0]," or ").concat(m[1]):"of ".concat(u," ").concat(m[0])}return"of ".concat(u," ").concat(String(m))}g("ERR_INVALID_OPT_VALUE",(function(m,u){return'The value "'+u+'" is invalid for option "'+m+'"'}),TypeError),g("ERR_INVALID_ARG_TYPE",(function(m,u,d){var S,_,E,b,I;if(typeof u=="string"&&(_="not ",u.substr(0,_.length)===_)?(S="must not be",u=u.replace(/^not /,"")):S="must be",(function(A,R,O){return(O===void 0||O>A.length)&&(O=A.length),A.substring(O-R.length,O)===R})(m," argument"))E="The ".concat(m," ").concat(S," ").concat(p(u,"type"));else{var T=(typeof I!="number"&&(I=0),I+1>(b=m).length||b.indexOf(".",I)===-1?"argument":"property");E='The "'.concat(m,'" ').concat(T," ").concat(S," ").concat(p(u,"type"))}return E+". Received type ".concat(typeof d)}),TypeError),g("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),g("ERR_METHOD_NOT_IMPLEMENTED",(function(m){return"The "+m+" method is not implemented"})),g("ERR_STREAM_PREMATURE_CLOSE","Premature close"),g("ERR_STREAM_DESTROYED",(function(m){return"Cannot call "+m+" after a stream was destroyed"})),g("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),g("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),g("ERR_STREAM_WRITE_AFTER_END","write after end"),g("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),g("ERR_UNKNOWN_ENCODING",(function(m){return"Unknown encoding: "+m}),TypeError),g("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),f.exports.q=y},6138:function(f,y,g){var p=Object.keys||function(T){var A=[];for(var R in T)A.push(R);return A};f.exports=E;var m=g(2846),u=g(8318);g(1765)(E,m);for(var d=p(u.prototype),S=0;S<d.length;S++){var _=d[S];E.prototype[_]||(E.prototype[_]=u.prototype[_])}function E(T){if(!(this instanceof E))return new E(T);m.call(this,T),u.call(this,T),this.allowHalfOpen=!0,T&&(T.readable===!1&&(this.readable=!1),T.writable===!1&&(this.writable=!1),T.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",b)))}function b(){this._writableState.ended||process.nextTick(I,this)}function I(T){T.end()}Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(E.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(E.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(T){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=T,this._writableState.destroyed=T)}})},5472:function(f,y,g){f.exports=m;var p=g(9798);function m(u){if(!(this instanceof m))return new m(u);p.call(this,u)}g(1765)(m,p),m.prototype._transform=function(u,d,S){S(null,u)}},2846:function(f,y,g){var p;f.exports=de,de.ReadableState=ne,g(1159).EventEmitter;var m,u=function(Oe,Fe){return Oe.listeners(Fe).length},d=g(9299),S=g(1549).Buffer,_=g.g.Uint8Array||function(){},E=g(964);m=E&&E.debuglog?E.debuglog("stream"):function(){};var b,I,T,A=g(8393),R=g(6163),O=g(7269).getHighWaterMark,H=g(3690).q,U=H.ERR_INVALID_ARG_TYPE,Z=H.ERR_STREAM_PUSH_AFTER_EOF,$=H.ERR_METHOD_NOT_IMPLEMENTED,F=H.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;g(1765)(de,d);var W=R.errorOrDestroy,fe=["error","close","destroy","pause","resume"];function ne(Oe,Fe,it){p=p||g(6138),Oe=Oe||{},typeof it!="boolean"&&(it=Fe instanceof p),this.objectMode=!!Oe.objectMode,it&&(this.objectMode=this.objectMode||!!Oe.readableObjectMode),this.highWaterMark=O(this,Oe,"readableHighWaterMark",it),this.buffer=new A,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Oe.emitClose!==!1,this.autoDestroy=!!Oe.autoDestroy,this.destroyed=!1,this.defaultEncoding=Oe.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Oe.encoding&&(b||(b=g(7503).s),this.decoder=new b(Oe.encoding),this.encoding=Oe.encoding)}function de(Oe){if(p=p||g(6138),!(this instanceof de))return new de(Oe);var Fe=this instanceof p;this._readableState=new ne(Oe,this,Fe),this.readable=!0,Oe&&(typeof Oe.read=="function"&&(this._read=Oe.read),typeof Oe.destroy=="function"&&(this._destroy=Oe.destroy)),d.call(this)}function Te(Oe,Fe,it,w,N){m("readableAddChunk",Fe);var G,V=Oe._readableState;if(Fe===null)V.reading=!1,(function(ye,he){if(m("onEofChunk"),!he.ended){if(he.decoder){var He=he.decoder.end();He&&He.length&&(he.buffer.push(He),he.length+=he.objectMode?1:He.length)}he.ended=!0,he.sync?Be(ye):(he.needReadable=!1,he.emittedReadable||(he.emittedReadable=!0,qe(ye)))}})(Oe,V);else if(N||(G=(function(ye,he){var He,ut;return ut=he,S.isBuffer(ut)||ut instanceof _||typeof he=="string"||he===void 0||ye.objectMode||(He=new U("chunk",["string","Buffer","Uint8Array"],he)),He})(V,Fe)),G)W(Oe,G);else if(V.objectMode||Fe&&Fe.length>0)if(typeof Fe=="string"||V.objectMode||Object.getPrototypeOf(Fe)===S.prototype||(Fe=(function(ye){return S.from(ye)})(Fe)),w)V.endEmitted?W(Oe,new F):me(Oe,V,Fe,!0);else if(V.ended)W(Oe,new Z);else{if(V.destroyed)return!1;V.reading=!1,V.decoder&&!it?(Fe=V.decoder.write(Fe),V.objectMode||Fe.length!==0?me(Oe,V,Fe,!1):ee(Oe,V)):me(Oe,V,Fe,!1)}else w||(V.reading=!1,ee(Oe,V));return!V.ended&&(V.length<V.highWaterMark||V.length===0)}function me(Oe,Fe,it,w){Fe.flowing&&Fe.length===0&&!Fe.sync?(Fe.awaitDrain=0,Oe.emit("data",it)):(Fe.length+=Fe.objectMode?1:it.length,w?Fe.buffer.unshift(it):Fe.buffer.push(it),Fe.needReadable&&Be(Oe)),ee(Oe,Fe)}Object.defineProperty(de.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(Oe){this._readableState&&(this._readableState.destroyed=Oe)}}),de.prototype.destroy=R.destroy,de.prototype._undestroy=R.undestroy,de.prototype._destroy=function(Oe,Fe){Fe(Oe)},de.prototype.push=function(Oe,Fe){var it,w=this._readableState;return w.objectMode?it=!0:typeof Oe=="string"&&((Fe=Fe||w.defaultEncoding)!==w.encoding&&(Oe=S.from(Oe,Fe),Fe=""),it=!0),Te(this,Oe,Fe,!1,it)},de.prototype.unshift=function(Oe){return Te(this,Oe,null,!0,!1)},de.prototype.isPaused=function(){return this._readableState.flowing===!1},de.prototype.setEncoding=function(Oe){b||(b=g(7503).s);var Fe=new b(Oe);this._readableState.decoder=Fe,this._readableState.encoding=this._readableState.decoder.encoding;for(var it=this._readableState.buffer.head,w="";it!==null;)w+=Fe.write(it.data),it=it.next;return this._readableState.buffer.clear(),w!==""&&this._readableState.buffer.push(w),this._readableState.length=w.length,this};var X=1073741824;function Ie(Oe,Fe){return Oe<=0||Fe.length===0&&Fe.ended?0:Fe.objectMode?1:Oe!=Oe?Fe.flowing&&Fe.length?Fe.buffer.head.data.length:Fe.length:(Oe>Fe.highWaterMark&&(Fe.highWaterMark=(function(it){return it>=X?it=X:(it--,it|=it>>>1,it|=it>>>2,it|=it>>>4,it|=it>>>8,it|=it>>>16,it++),it})(Oe)),Oe<=Fe.length?Oe:Fe.ended?Fe.length:(Fe.needReadable=!0,0))}function Be(Oe){var Fe=Oe._readableState;m("emitReadable",Fe.needReadable,Fe.emittedReadable),Fe.needReadable=!1,Fe.emittedReadable||(m("emitReadable",Fe.flowing),Fe.emittedReadable=!0,process.nextTick(qe,Oe))}function qe(Oe){var Fe=Oe._readableState;m("emitReadable_",Fe.destroyed,Fe.length,Fe.ended),Fe.destroyed||!Fe.length&&!Fe.ended||(Oe.emit("readable"),Fe.emittedReadable=!1),Fe.needReadable=!Fe.flowing&&!Fe.ended&&Fe.length<=Fe.highWaterMark,Ge(Oe)}function ee(Oe,Fe){Fe.readingMore||(Fe.readingMore=!0,process.nextTick(_e,Oe,Fe))}function _e(Oe,Fe){for(;!Fe.reading&&!Fe.ended&&(Fe.length<Fe.highWaterMark||Fe.flowing&&Fe.length===0);){var it=Fe.length;if(m("maybeReadMore read 0"),Oe.read(0),it===Fe.length)break}Fe.readingMore=!1}function Ze(Oe){var Fe=Oe._readableState;Fe.readableListening=Oe.listenerCount("readable")>0,Fe.resumeScheduled&&!Fe.paused?Fe.flowing=!0:Oe.listenerCount("data")>0&&Oe.resume()}function Ke(Oe){m("readable nexttick read 0"),Oe.read(0)}function De(Oe,Fe){m("resume",Fe.reading),Fe.reading||Oe.read(0),Fe.resumeScheduled=!1,Oe.emit("resume"),Ge(Oe),Fe.flowing&&!Fe.reading&&Oe.read(0)}function Ge(Oe){var Fe=Oe._readableState;for(m("flow",Fe.flowing);Fe.flowing&&Oe.read()!==null;);}function Et(Oe,Fe){return Fe.length===0?null:(Fe.objectMode?it=Fe.buffer.shift():!Oe||Oe>=Fe.length?(it=Fe.decoder?Fe.buffer.join(""):Fe.buffer.length===1?Fe.buffer.first():Fe.buffer.concat(Fe.length),Fe.buffer.clear()):it=Fe.buffer.consume(Oe,Fe.decoder),it);var it}function vt(Oe){var Fe=Oe._readableState;m("endReadable",Fe.endEmitted),Fe.endEmitted||(Fe.ended=!0,process.nextTick(et,Fe,Oe))}function et(Oe,Fe){if(m("endReadableNT",Oe.endEmitted,Oe.length),!Oe.endEmitted&&Oe.length===0&&(Oe.endEmitted=!0,Fe.readable=!1,Fe.emit("end"),Oe.autoDestroy)){var it=Fe._writableState;(!it||it.autoDestroy&&it.finished)&&Fe.destroy()}}function gt(Oe,Fe){for(var it=0,w=Oe.length;it<w;it++)if(Oe[it]===Fe)return it;return-1}de.prototype.read=function(Oe){m("read",Oe),Oe=parseInt(Oe,10);var Fe=this._readableState,it=Oe;if(Oe!==0&&(Fe.emittedReadable=!1),Oe===0&&Fe.needReadable&&((Fe.highWaterMark!==0?Fe.length>=Fe.highWaterMark:Fe.length>0)||Fe.ended))return m("read: emitReadable",Fe.length,Fe.ended),Fe.length===0&&Fe.ended?vt(this):Be(this),null;if((Oe=Ie(Oe,Fe))===0&&Fe.ended)return Fe.length===0&&vt(this),null;var w,N=Fe.needReadable;return m("need readable",N),(Fe.length===0||Fe.length-Oe<Fe.highWaterMark)&&m("length less than watermark",N=!0),Fe.ended||Fe.reading?m("reading or ended",N=!1):N&&(m("do read"),Fe.reading=!0,Fe.sync=!0,Fe.length===0&&(Fe.needReadable=!0),this._read(Fe.highWaterMark),Fe.sync=!1,Fe.reading||(Oe=Ie(it,Fe))),(w=Oe>0?Et(Oe,Fe):null)===null?(Fe.needReadable=Fe.length<=Fe.highWaterMark,Oe=0):(Fe.length-=Oe,Fe.awaitDrain=0),Fe.length===0&&(Fe.ended||(Fe.needReadable=!0),it!==Oe&&Fe.ended&&vt(this)),w!==null&&this.emit("data",w),w},de.prototype._read=function(Oe){W(this,new $("_read()"))},de.prototype.pipe=function(Oe,Fe){var it=this,w=this._readableState;switch(w.pipesCount){case 0:w.pipes=Oe;break;case 1:w.pipes=[w.pipes,Oe];break;default:w.pipes.push(Oe)}w.pipesCount+=1,m("pipe count=%d opts=%j",w.pipesCount,Fe);var N=Fe&&Fe.end===!1||Oe===process.stdout||Oe===process.stderr?Qe:G;function G(){m("onend"),Oe.end()}w.endEmitted?process.nextTick(N):it.once("end",N),Oe.on("unpipe",(function Ye(nt,mt){m("onunpipe"),nt===it&&mt&&mt.hasUnpiped===!1&&(mt.hasUnpiped=!0,m("cleanup"),Oe.removeListener("close",ut),Oe.removeListener("finish",Je),Oe.removeListener("drain",V),Oe.removeListener("error",He),Oe.removeListener("unpipe",Ye),it.removeListener("end",G),it.removeListener("end",Qe),it.removeListener("data",he),ye=!0,!w.awaitDrain||Oe._writableState&&!Oe._writableState.needDrain||V())}));var V=(function(Ye){return function(){var nt=Ye._readableState;m("pipeOnDrain",nt.awaitDrain),nt.awaitDrain&&nt.awaitDrain--,nt.awaitDrain===0&&u(Ye,"data")&&(nt.flowing=!0,Ge(Ye))}})(it);Oe.on("drain",V);var ye=!1;function he(Ye){m("ondata");var nt=Oe.write(Ye);m("dest.write",nt),nt===!1&&((w.pipesCount===1&&w.pipes===Oe||w.pipesCount>1&&gt(w.pipes,Oe)!==-1)&&!ye&&(m("false write response, pause",w.awaitDrain),w.awaitDrain++),it.pause())}function He(Ye){m("onerror",Ye),Qe(),Oe.removeListener("error",He),u(Oe,"error")===0&&W(Oe,Ye)}function ut(){Oe.removeListener("finish",Je),Qe()}function Je(){m("onfinish"),Oe.removeListener("close",ut),Qe()}function Qe(){m("unpipe"),it.unpipe(Oe)}return it.on("data",he),(function(Ye,nt,mt){if(typeof Ye.prependListener=="function")return Ye.prependListener(nt,mt);Ye._events&&Ye._events[nt]?Array.isArray(Ye._events[nt])?Ye._events[nt].unshift(mt):Ye._events[nt]=[mt,Ye._events[nt]]:Ye.on(nt,mt)})(Oe,"error",He),Oe.once("close",ut),Oe.once("finish",Je),Oe.emit("pipe",it),w.flowing||(m("pipe resume"),it.resume()),Oe},de.prototype.unpipe=function(Oe){var Fe=this._readableState,it={hasUnpiped:!1};if(Fe.pipesCount===0)return this;if(Fe.pipesCount===1)return Oe&&Oe!==Fe.pipes||(Oe||(Oe=Fe.pipes),Fe.pipes=null,Fe.pipesCount=0,Fe.flowing=!1,Oe&&Oe.emit("unpipe",this,it)),this;if(!Oe){var w=Fe.pipes,N=Fe.pipesCount;Fe.pipes=null,Fe.pipesCount=0,Fe.flowing=!1;for(var G=0;G<N;G++)w[G].emit("unpipe",this,{hasUnpiped:!1});return this}var V=gt(Fe.pipes,Oe);return V===-1||(Fe.pipes.splice(V,1),Fe.pipesCount-=1,Fe.pipesCount===1&&(Fe.pipes=Fe.pipes[0]),Oe.emit("unpipe",this,it)),this},de.prototype.on=function(Oe,Fe){var it=d.prototype.on.call(this,Oe,Fe),w=this._readableState;return Oe==="data"?(w.readableListening=this.listenerCount("readable")>0,w.flowing!==!1&&this.resume()):Oe==="readable"&&(w.endEmitted||w.readableListening||(w.readableListening=w.needReadable=!0,w.flowing=!1,w.emittedReadable=!1,m("on readable",w.length,w.reading),w.length?Be(this):w.reading||process.nextTick(Ke,this))),it},de.prototype.addListener=de.prototype.on,de.prototype.removeListener=function(Oe,Fe){var it=d.prototype.removeListener.call(this,Oe,Fe);return Oe==="readable"&&process.nextTick(Ze,this),it},de.prototype.removeAllListeners=function(Oe){var Fe=d.prototype.removeAllListeners.apply(this,arguments);return Oe!=="readable"&&Oe!==void 0||process.nextTick(Ze,this),Fe},de.prototype.resume=function(){var Oe=this._readableState;return Oe.flowing||(m("resume"),Oe.flowing=!Oe.readableListening,(function(Fe,it){it.resumeScheduled||(it.resumeScheduled=!0,process.nextTick(De,Fe,it))})(this,Oe)),Oe.paused=!1,this},de.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},de.prototype.wrap=function(Oe){var Fe=this,it=this._readableState,w=!1;for(var N in Oe.on("end",(function(){if(m("wrapped end"),it.decoder&&!it.ended){var V=it.decoder.end();V&&V.length&&Fe.push(V)}Fe.push(null)})),Oe.on("data",(function(V){m("wrapped data"),it.decoder&&(V=it.decoder.write(V)),it.objectMode&&V==null||(it.objectMode||V&&V.length)&&(Fe.push(V)||(w=!0,Oe.pause()))})),Oe)this[N]===void 0&&typeof Oe[N]=="function"&&(this[N]=(function(V){return function(){return Oe[V].apply(Oe,arguments)}})(N));for(var G=0;G<fe.length;G++)Oe.on(fe[G],this.emit.bind(this,fe[G]));return this._read=function(V){m("wrapped _read",V),w&&(w=!1,Oe.resume())},this},typeof Symbol=="function"&&(de.prototype[Symbol.asyncIterator]=function(){return I===void 0&&(I=g(7299)),I(this)}),Object.defineProperty(de.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(de.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(de.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Oe){this._readableState&&(this._readableState.flowing=Oe)}}),de._fromList=Et,Object.defineProperty(de.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(de.from=function(Oe,Fe){return T===void 0&&(T=g(6233)),T(de,Oe,Fe)})},9798:function(f,y,g){f.exports=b;var p=g(3690).q,m=p.ERR_METHOD_NOT_IMPLEMENTED,u=p.ERR_MULTIPLE_CALLBACK,d=p.ERR_TRANSFORM_ALREADY_TRANSFORMING,S=p.ERR_TRANSFORM_WITH_LENGTH_0,_=g(6138);function E(A,R){var O=this._transformState;O.transforming=!1;var H=O.writecb;if(H===null)return this.emit("error",new u);O.writechunk=null,O.writecb=null,R!=null&&this.push(R),H(A);var U=this._readableState;U.reading=!1,(U.needReadable||U.length<U.highWaterMark)&&this._read(U.highWaterMark)}function b(A){if(!(this instanceof b))return new b(A);_.call(this,A),this._transformState={afterTransform:E.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,A&&(typeof A.transform=="function"&&(this._transform=A.transform),typeof A.flush=="function"&&(this._flush=A.flush)),this.on("prefinish",I)}function I(){var A=this;typeof this._flush!="function"||this._readableState.destroyed?T(this,null,null):this._flush((function(R,O){T(A,R,O)}))}function T(A,R,O){if(R)return A.emit("error",R);if(O!=null&&A.push(O),A._writableState.length)throw new S;if(A._transformState.transforming)throw new d;return A.push(null)}g(1765)(b,_),b.prototype.push=function(A,R){return this._transformState.needTransform=!1,_.prototype.push.call(this,A,R)},b.prototype._transform=function(A,R,O){O(new m("_transform()"))},b.prototype._write=function(A,R,O){var H=this._transformState;if(H.writecb=O,H.writechunk=A,H.writeencoding=R,!H.transforming){var U=this._readableState;(H.needTransform||U.needReadable||U.length<U.highWaterMark)&&this._read(U.highWaterMark)}},b.prototype._read=function(A){var R=this._transformState;R.writechunk===null||R.transforming?R.needTransform=!0:(R.transforming=!0,this._transform(R.writechunk,R.writeencoding,R.afterTransform))},b.prototype._destroy=function(A,R){_.prototype._destroy.call(this,A,(function(O){R(O)}))}},8318:function(f,y,g){function p(ee){var _e=this;this.next=null,this.entry=null,this.finish=function(){(function(Ze,Ke,De){var Ge=Ze.entry;for(Ze.entry=null;Ge;){var Et=Ge.callback;Ke.pendingcb--,Et(void 0),Ge=Ge.next}Ke.corkedRequestsFree.next=Ze})(_e,ee)}}var m;f.exports=de,de.WritableState=ne;var u,d={deprecate:g(7839)},S=g(9299),_=g(1549).Buffer,E=g.g.Uint8Array||function(){},b=g(6163),I=g(7269).getHighWaterMark,T=g(3690).q,A=T.ERR_INVALID_ARG_TYPE,R=T.ERR_METHOD_NOT_IMPLEMENTED,O=T.ERR_MULTIPLE_CALLBACK,H=T.ERR_STREAM_CANNOT_PIPE,U=T.ERR_STREAM_DESTROYED,Z=T.ERR_STREAM_NULL_VALUES,$=T.ERR_STREAM_WRITE_AFTER_END,F=T.ERR_UNKNOWN_ENCODING,W=b.errorOrDestroy;function fe(){}function ne(ee,_e,Ze){m=m||g(6138),ee=ee||{},typeof Ze!="boolean"&&(Ze=_e instanceof m),this.objectMode=!!ee.objectMode,Ze&&(this.objectMode=this.objectMode||!!ee.writableObjectMode),this.highWaterMark=I(this,ee,"writableHighWaterMark",Ze),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Ke=ee.decodeStrings===!1;this.decodeStrings=!Ke,this.defaultEncoding=ee.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(De){(function(Ge,Et){var vt=Ge._writableState,et=vt.sync,gt=vt.writecb;if(typeof gt!="function")throw new O;if((function(Fe){Fe.writing=!1,Fe.writecb=null,Fe.length-=Fe.writelen,Fe.writelen=0})(vt),Et)(function(Fe,it,w,N,G){--it.pendingcb,w?(process.nextTick(G,N),process.nextTick(qe,Fe,it),Fe._writableState.errorEmitted=!0,W(Fe,N)):(G(N),Fe._writableState.errorEmitted=!0,W(Fe,N),qe(Fe,it))})(Ge,vt,et,Et,gt);else{var Oe=Ie(vt)||Ge.destroyed;Oe||vt.corked||vt.bufferProcessing||!vt.bufferedRequest||X(Ge,vt),et?process.nextTick(me,Ge,vt,Oe,gt):me(Ge,vt,Oe,gt)}})(_e,De)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=ee.emitClose!==!1,this.autoDestroy=!!ee.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new p(this)}function de(ee){var _e=this instanceof(m=m||g(6138));if(!_e&&!u.call(de,this))return new de(ee);this._writableState=new ne(ee,this,_e),this.writable=!0,ee&&(typeof ee.write=="function"&&(this._write=ee.write),typeof ee.writev=="function"&&(this._writev=ee.writev),typeof ee.destroy=="function"&&(this._destroy=ee.destroy),typeof ee.final=="function"&&(this._final=ee.final)),S.call(this)}function Te(ee,_e,Ze,Ke,De,Ge,Et){_e.writelen=Ke,_e.writecb=Et,_e.writing=!0,_e.sync=!0,_e.destroyed?_e.onwrite(new U("write")):Ze?ee._writev(De,_e.onwrite):ee._write(De,Ge,_e.onwrite),_e.sync=!1}function me(ee,_e,Ze,Ke){Ze||(function(De,Ge){Ge.length===0&&Ge.needDrain&&(Ge.needDrain=!1,De.emit("drain"))})(ee,_e),_e.pendingcb--,Ke(),qe(ee,_e)}function X(ee,_e){_e.bufferProcessing=!0;var Ze=_e.bufferedRequest;if(ee._writev&&Ze&&Ze.next){var Ke=_e.bufferedRequestCount,De=new Array(Ke),Ge=_e.corkedRequestsFree;Ge.entry=Ze;for(var Et=0,vt=!0;Ze;)De[Et]=Ze,Ze.isBuf||(vt=!1),Ze=Ze.next,Et+=1;De.allBuffers=vt,Te(ee,_e,!0,_e.length,De,"",Ge.finish),_e.pendingcb++,_e.lastBufferedRequest=null,Ge.next?(_e.corkedRequestsFree=Ge.next,Ge.next=null):_e.corkedRequestsFree=new p(_e),_e.bufferedRequestCount=0}else{for(;Ze;){var et=Ze.chunk,gt=Ze.encoding,Oe=Ze.callback;if(Te(ee,_e,!1,_e.objectMode?1:et.length,et,gt,Oe),Ze=Ze.next,_e.bufferedRequestCount--,_e.writing)break}Ze===null&&(_e.lastBufferedRequest=null)}_e.bufferedRequest=Ze,_e.bufferProcessing=!1}function Ie(ee){return ee.ending&&ee.length===0&&ee.bufferedRequest===null&&!ee.finished&&!ee.writing}function Be(ee,_e){ee._final((function(Ze){_e.pendingcb--,Ze&&W(ee,Ze),_e.prefinished=!0,ee.emit("prefinish"),qe(ee,_e)}))}function qe(ee,_e){var Ze=Ie(_e);if(Ze&&((function(De,Ge){Ge.prefinished||Ge.finalCalled||(typeof De._final!="function"||Ge.destroyed?(Ge.prefinished=!0,De.emit("prefinish")):(Ge.pendingcb++,Ge.finalCalled=!0,process.nextTick(Be,De,Ge)))})(ee,_e),_e.pendingcb===0&&(_e.finished=!0,ee.emit("finish"),_e.autoDestroy))){var Ke=ee._readableState;(!Ke||Ke.autoDestroy&&Ke.endEmitted)&&ee.destroy()}return Ze}g(1765)(de,S),ne.prototype.getBuffer=function(){for(var ee=this.bufferedRequest,_e=[];ee;)_e.push(ee),ee=ee.next;return _e},(function(){try{Object.defineProperty(ne.prototype,"buffer",{get:d.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(de,Symbol.hasInstance,{value:function(ee){return!!u.call(this,ee)||this===de&&ee&&ee._writableState instanceof ne}})):u=function(ee){return ee instanceof this},de.prototype.pipe=function(){W(this,new H)},de.prototype.write=function(ee,_e,Ze){var Ke,De=this._writableState,Ge=!1,Et=!De.objectMode&&(Ke=ee,_.isBuffer(Ke)||Ke instanceof E);return Et&&!_.isBuffer(ee)&&(ee=(function(vt){return _.from(vt)})(ee)),typeof _e=="function"&&(Ze=_e,_e=null),Et?_e="buffer":_e||(_e=De.defaultEncoding),typeof Ze!="function"&&(Ze=fe),De.ending?(function(vt,et){var gt=new $;W(vt,gt),process.nextTick(et,gt)})(this,Ze):(Et||(function(vt,et,gt,Oe){var Fe;return gt===null?Fe=new Z:typeof gt=="string"||et.objectMode||(Fe=new A("chunk",["string","Buffer"],gt)),!Fe||(W(vt,Fe),process.nextTick(Oe,Fe),!1)})(this,De,ee,Ze))&&(De.pendingcb++,Ge=(function(vt,et,gt,Oe,Fe,it){if(!gt){var w=(function(ye,he,He){return ye.objectMode||ye.decodeStrings===!1||typeof he!="string"||(he=_.from(he,He)),he})(et,Oe,Fe);Oe!==w&&(gt=!0,Fe="buffer",Oe=w)}var N=et.objectMode?1:Oe.length;et.length+=N;var G=et.length<et.highWaterMark;if(G||(et.needDrain=!0),et.writing||et.corked){var V=et.lastBufferedRequest;et.lastBufferedRequest={chunk:Oe,encoding:Fe,isBuf:gt,callback:it,next:null},V?V.next=et.lastBufferedRequest:et.bufferedRequest=et.lastBufferedRequest,et.bufferedRequestCount+=1}else Te(vt,et,!1,N,Oe,Fe,it);return G})(this,De,Et,ee,_e,Ze)),Ge},de.prototype.cork=function(){this._writableState.corked++},de.prototype.uncork=function(){var ee=this._writableState;ee.corked&&(ee.corked--,ee.writing||ee.corked||ee.bufferProcessing||!ee.bufferedRequest||X(this,ee))},de.prototype.setDefaultEncoding=function(ee){if(typeof ee=="string"&&(ee=ee.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ee+"").toLowerCase())>-1))throw new F(ee);return this._writableState.defaultEncoding=ee,this},Object.defineProperty(de.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(de.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),de.prototype._write=function(ee,_e,Ze){Ze(new R("_write()"))},de.prototype._writev=null,de.prototype.end=function(ee,_e,Ze){var Ke=this._writableState;return typeof ee=="function"?(Ze=ee,ee=null,_e=null):typeof _e=="function"&&(Ze=_e,_e=null),ee!=null&&this.write(ee,_e),Ke.corked&&(Ke.corked=1,this.uncork()),Ke.ending||(function(De,Ge,Et){Ge.ending=!0,qe(De,Ge),Et&&(Ge.finished?process.nextTick(Et):De.once("finish",Et)),Ge.ended=!0,De.writable=!1})(this,Ke,Ze),this},Object.defineProperty(de.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(de.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(ee){this._writableState&&(this._writableState.destroyed=ee)}}),de.prototype.destroy=b.destroy,de.prototype._undestroy=b.undestroy,de.prototype._destroy=function(ee,_e){_e(ee)}},7299:function(f,y,g){var p;function m(Z,$,F){return $ in Z?Object.defineProperty(Z,$,{value:F,enumerable:!0,configurable:!0,writable:!0}):Z[$]=F,Z}var u=g(8800),d=Symbol("lastResolve"),S=Symbol("lastReject"),_=Symbol("error"),E=Symbol("ended"),b=Symbol("lastPromise"),I=Symbol("handlePromise"),T=Symbol("stream");function A(Z,$){return{value:Z,done:$}}function R(Z){var $=Z[d];if($!==null){var F=Z[T].read();F!==null&&(Z[b]=null,Z[d]=null,Z[S]=null,$(A(F,!1)))}}function O(Z){process.nextTick(R,Z)}var H=Object.getPrototypeOf((function(){})),U=Object.setPrototypeOf((m(p={get stream(){return this[T]},next:function(){var Z=this,$=this[_];if($!==null)return Promise.reject($);if(this[E])return Promise.resolve(A(void 0,!0));if(this[T].destroyed)return new Promise((function(ne,de){process.nextTick((function(){Z[_]?de(Z[_]):ne(A(void 0,!0))}))}));var F,W=this[b];if(W)F=new Promise((function(ne,de){return function(Te,me){ne.then((function(){de[E]?Te(A(void 0,!0)):de[I](Te,me)}),me)}})(W,this));else{var fe=this[T].read();if(fe!==null)return Promise.resolve(A(fe,!1));F=new Promise(this[I])}return this[b]=F,F}},Symbol.asyncIterator,(function(){return this})),m(p,"return",(function(){var Z=this;return new Promise((function($,F){Z[T].destroy(null,(function(W){W?F(W):$(A(void 0,!0))}))}))})),p),H);f.exports=function(Z){var $,F=Object.create(U,(m($={},T,{value:Z,writable:!0}),m($,d,{value:null,writable:!0}),m($,S,{value:null,writable:!0}),m($,_,{value:null,writable:!0}),m($,E,{value:Z._readableState.endEmitted,writable:!0}),m($,I,{value:function(W,fe){var ne=F[T].read();ne?(F[b]=null,F[d]=null,F[S]=null,W(A(ne,!1))):(F[d]=W,F[S]=fe)},writable:!0}),$));return F[b]=null,u(Z,(function(W){if(W&&W.code!=="ERR_STREAM_PREMATURE_CLOSE"){var fe=F[S];return fe!==null&&(F[b]=null,F[d]=null,F[S]=null,fe(W)),void(F[_]=W)}var ne=F[d];ne!==null&&(F[b]=null,F[d]=null,F[S]=null,ne(A(void 0,!0))),F[E]=!0})),Z.on("readable",O.bind(null,F)),F}},8393:function(f,y,g){function p(E,b){var I=Object.keys(E);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(E);b&&(T=T.filter((function(A){return Object.getOwnPropertyDescriptor(E,A).enumerable}))),I.push.apply(I,T)}return I}function m(E,b,I){return b in E?Object.defineProperty(E,b,{value:I,enumerable:!0,configurable:!0,writable:!0}):E[b]=I,E}function u(E,b){for(var I=0;I<b.length;I++){var T=b[I];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(E,T.key,T)}}var d=g(1549).Buffer,S=g(9862).inspect,_=S&&S.custom||"inspect";f.exports=(function(){function E(){(function(T,A){if(!(T instanceof A))throw new TypeError("Cannot call a class as a function")})(this,E),this.head=null,this.tail=null,this.length=0}var b,I;return b=E,I=[{key:"push",value:function(T){var A={data:T,next:null};this.length>0?this.tail.next=A:this.head=A,this.tail=A,++this.length}},{key:"unshift",value:function(T){var A={data:T,next:this.head};this.length===0&&(this.tail=A),this.head=A,++this.length}},{key:"shift",value:function(){if(this.length!==0){var T=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,T}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(T){if(this.length===0)return"";for(var A=this.head,R=""+A.data;A=A.next;)R+=T+A.data;return R}},{key:"concat",value:function(T){if(this.length===0)return d.alloc(0);for(var A,R,O,H=d.allocUnsafe(T>>>0),U=this.head,Z=0;U;)A=U.data,R=H,O=Z,d.prototype.copy.call(A,R,O),Z+=U.data.length,U=U.next;return H}},{key:"consume",value:function(T,A){var R;return T<this.head.data.length?(R=this.head.data.slice(0,T),this.head.data=this.head.data.slice(T)):R=T===this.head.data.length?this.shift():A?this._getString(T):this._getBuffer(T),R}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(T){var A=this.head,R=1,O=A.data;for(T-=O.length;A=A.next;){var H=A.data,U=T>H.length?H.length:T;if(U===H.length?O+=H:O+=H.slice(0,T),(T-=U)==0){U===H.length?(++R,A.next?this.head=A.next:this.head=this.tail=null):(this.head=A,A.data=H.slice(U));break}++R}return this.length-=R,O}},{key:"_getBuffer",value:function(T){var A=d.allocUnsafe(T),R=this.head,O=1;for(R.data.copy(A),T-=R.data.length;R=R.next;){var H=R.data,U=T>H.length?H.length:T;if(H.copy(A,A.length-T,0,U),(T-=U)==0){U===H.length?(++O,R.next?this.head=R.next:this.head=this.tail=null):(this.head=R,R.data=H.slice(U));break}++O}return this.length-=O,A}},{key:_,value:function(T,A){return S(this,(function(R){for(var O=1;O<arguments.length;O++){var H=arguments[O]!=null?arguments[O]:{};O%2?p(Object(H),!0).forEach((function(U){m(R,U,H[U])})):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(H)):p(Object(H)).forEach((function(U){Object.defineProperty(R,U,Object.getOwnPropertyDescriptor(H,U))}))}return R})({},A,{depth:0,customInspect:!1}))}}],I&&u(b.prototype,I),E})()},6163:function(f){function y(m,u){p(m,u),g(m)}function g(m){m._writableState&&!m._writableState.emitClose||m._readableState&&!m._readableState.emitClose||m.emit("close")}function p(m,u){m.emit("error",u)}f.exports={destroy:function(m,u){var d=this,S=this._readableState&&this._readableState.destroyed,_=this._writableState&&this._writableState.destroyed;return S||_?(u?u(m):m&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(p,this,m)):process.nextTick(p,this,m)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(m||null,(function(E){!u&&E?d._writableState?d._writableState.errorEmitted?process.nextTick(g,d):(d._writableState.errorEmitted=!0,process.nextTick(y,d,E)):process.nextTick(y,d,E):u?(process.nextTick(g,d),u(E)):process.nextTick(g,d)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(m,u){var d=m._readableState,S=m._writableState;d&&d.autoDestroy||S&&S.autoDestroy?m.destroy(u):m.emit("error",u)}}},8800:function(f,y,g){var p=g(3690).q.ERR_STREAM_PREMATURE_CLOSE;function m(){}f.exports=function u(d,S,_){if(typeof S=="function")return u(d,null,S);S||(S={}),_=(function($){var F=!1;return function(){if(!F){F=!0;for(var W=arguments.length,fe=new Array(W),ne=0;ne<W;ne++)fe[ne]=arguments[ne];$.apply(this,fe)}}})(_||m);var E=S.readable||S.readable!==!1&&d.readable,b=S.writable||S.writable!==!1&&d.writable,I=function(){d.writable||A()},T=d._writableState&&d._writableState.finished,A=function(){b=!1,T=!0,E||_.call(d)},R=d._readableState&&d._readableState.endEmitted,O=function(){E=!1,R=!0,b||_.call(d)},H=function($){_.call(d,$)},U=function(){var $;return E&&!R?(d._readableState&&d._readableState.ended||($=new p),_.call(d,$)):b&&!T?(d._writableState&&d._writableState.ended||($=new p),_.call(d,$)):void 0},Z=function(){d.req.on("finish",A)};return(function($){return $.setHeader&&typeof $.abort=="function"})(d)?(d.on("complete",A),d.on("abort",U),d.req?Z():d.on("request",Z)):b&&!d._writableState&&(d.on("end",I),d.on("close",I)),d.on("end",O),d.on("finish",A),S.error!==!1&&d.on("error",H),d.on("close",U),function(){d.removeListener("complete",A),d.removeListener("abort",U),d.removeListener("request",Z),d.req&&d.req.removeListener("finish",A),d.removeListener("end",I),d.removeListener("close",I),d.removeListener("finish",A),d.removeListener("end",O),d.removeListener("error",H),d.removeListener("close",U)}}},6233:function(f){f.exports=function(){throw new Error("Readable.from is not available in the browser")}},7295:function(f,y,g){var p,m=g(3690).q,u=m.ERR_MISSING_ARGS,d=m.ERR_STREAM_DESTROYED;function S(T){if(T)throw T}function _(T,A,R,O){O=(function(Z){var $=!1;return function(){$||($=!0,Z.apply(void 0,arguments))}})(O);var H=!1;T.on("close",(function(){H=!0})),p===void 0&&(p=g(8800)),p(T,{readable:A,writable:R},(function(Z){if(Z)return O(Z);H=!0,O()}));var U=!1;return function(Z){if(!H&&!U)return U=!0,(function($){return $.setHeader&&typeof $.abort=="function"})(T)?T.abort():typeof T.destroy=="function"?T.destroy():void O(Z||new d("pipe"))}}function E(T){T()}function b(T,A){return T.pipe(A)}function I(T){return T.length?typeof T[T.length-1]!="function"?S:T.pop():S}f.exports=function(){for(var T=arguments.length,A=new Array(T),R=0;R<T;R++)A[R]=arguments[R];var O,H=I(A);if(Array.isArray(A[0])&&(A=A[0]),A.length<2)throw new u("streams");var U=A.map((function(Z,$){var F=$<A.length-1;return _(Z,F,$>0,(function(W){O||(O=W),W&&U.forEach(E),F||(U.forEach(E),H(O))}))}));return A.reduce(b)}},7269:function(f,y,g){var p=g(3690).q.ERR_INVALID_OPT_VALUE;f.exports={getHighWaterMark:function(m,u,d,S){var _=(function(E,b,I){return E.highWaterMark!=null?E.highWaterMark:b?E[I]:null})(u,S,d);if(_!=null){if(!isFinite(_)||Math.floor(_)!==_||_<0)throw new p(S?d:"highWaterMark",_);return Math.floor(_)}return m.objectMode?16:16384}}},9299:function(f,y,g){f.exports=g(1159).EventEmitter},7503:function(f,y,g){var p=g(8387).Buffer,m=p.isEncoding||function(R){switch((R=""+R)&&R.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function u(R){var O;switch(this.encoding=(function(H){var U=(function(Z){if(!Z)return"utf8";for(var $;;)switch(Z){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return Z;default:if($)return;Z=(""+Z).toLowerCase(),$=!0}})(H);if(typeof U!="string"&&(p.isEncoding===m||!m(H)))throw new Error("Unknown encoding: "+H);return U||H})(R),this.encoding){case"utf16le":this.text=_,this.end=E,O=4;break;case"utf8":this.fillLast=S,O=4;break;case"base64":this.text=b,this.end=I,O=3;break;default:return this.write=T,void(this.end=A)}this.lastNeed=0,this.lastTotal=0,this.lastChar=p.allocUnsafe(O)}function d(R){return R<=127?0:R>>5==6?2:R>>4==14?3:R>>3==30?4:R>>6==2?-1:-2}function S(R){var O=this.lastTotal-this.lastNeed,H=(function(U,Z,$){if((192&Z[0])!=128)return U.lastNeed=0,"";if(U.lastNeed>1&&Z.length>1){if((192&Z[1])!=128)return U.lastNeed=1,"";if(U.lastNeed>2&&Z.length>2&&(192&Z[2])!=128)return U.lastNeed=2,""}})(this,R);return H!==void 0?H:this.lastNeed<=R.length?(R.copy(this.lastChar,O,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(R.copy(this.lastChar,O,0,R.length),void(this.lastNeed-=R.length))}function _(R,O){if((R.length-O)%2==0){var H=R.toString("utf16le",O);if(H){var U=H.charCodeAt(H.length-1);if(U>=55296&&U<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=R[R.length-2],this.lastChar[1]=R[R.length-1],H.slice(0,-1)}return H}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=R[R.length-1],R.toString("utf16le",O,R.length-1)}function E(R){var O=R&&R.length?this.write(R):"";if(this.lastNeed){var H=this.lastTotal-this.lastNeed;return O+this.lastChar.toString("utf16le",0,H)}return O}function b(R,O){var H=(R.length-O)%3;return H===0?R.toString("base64",O):(this.lastNeed=3-H,this.lastTotal=3,H===1?this.lastChar[0]=R[R.length-1]:(this.lastChar[0]=R[R.length-2],this.lastChar[1]=R[R.length-1]),R.toString("base64",O,R.length-H))}function I(R){var O=R&&R.length?this.write(R):"";return this.lastNeed?O+this.lastChar.toString("base64",0,3-this.lastNeed):O}function T(R){return R.toString(this.encoding)}function A(R){return R&&R.length?this.write(R):""}y.s=u,u.prototype.write=function(R){if(R.length===0)return"";var O,H;if(this.lastNeed){if((O=this.fillLast(R))===void 0)return"";H=this.lastNeed,this.lastNeed=0}else H=0;return H<R.length?O?O+this.text(R,H):this.text(R,H):O||""},u.prototype.end=function(R){var O=R&&R.length?this.write(R):"";return this.lastNeed?O+"":O},u.prototype.text=function(R,O){var H=(function(Z,$,F){var W=$.length-1;if(W<F)return 0;var fe=d($[W]);return fe>=0?(fe>0&&(Z.lastNeed=fe-1),fe):--W<F||fe===-2?0:(fe=d($[W]))>=0?(fe>0&&(Z.lastNeed=fe-2),fe):--W<F||fe===-2?0:(fe=d($[W]))>=0?(fe>0&&(fe===2?fe=0:Z.lastNeed=fe-3),fe):0})(this,R,O);if(!this.lastNeed)return R.toString("utf8",O);this.lastTotal=H;var U=R.length-(H-this.lastNeed);return R.copy(this.lastChar,0,U),R.toString("utf8",O,U)},u.prototype.fillLast=function(R){if(this.lastNeed<=R.length)return R.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);R.copy(this.lastChar,this.lastTotal-this.lastNeed,0,R.length),this.lastNeed-=R.length}},1067:function(f,y,g){var p;(function(m,u){var d="function",S="undefined",_="object",E="string",b="major",I="model",T="name",A="type",R="vendor",O="version",H="architecture",U="console",Z="mobile",$="tablet",F="smarttv",W="wearable",fe="embedded",ne="Amazon",de="Apple",Te="ASUS",me="BlackBerry",X="Browser",Ie="Chrome",Be="Firefox",qe="Google",ee="Huawei",_e="LG",Ze="Microsoft",Ke="Motorola",De="Opera",Ge="Samsung",Et="Sharp",vt="Sony",et="Xiaomi",gt="Zebra",Oe="Facebook",Fe="Chromium OS",it="Mac OS",w=function(nt){for(var mt={},Gt=0;Gt<nt.length;Gt++)mt[nt[Gt].toUpperCase()]=nt[Gt];return mt},N=function(nt,mt){return typeof nt===E&&G(mt).indexOf(G(nt))!==-1},G=function(nt){return nt.toLowerCase()},V=function(nt,mt){if(typeof nt===E)return nt=nt.replace(/^\s\s*/,""),typeof mt===S?nt:nt.substring(0,500)},ye=function(nt,mt){for(var Gt,_t,gn,Wt,ln,cn,On=0;On<mt.length&&!ln;){var zn=mt[On],ar=mt[On+1];for(Gt=_t=0;Gt<zn.length&&!ln&&zn[Gt];)if(ln=zn[Gt++].exec(nt))for(gn=0;gn<ar.length;gn++)cn=ln[++_t],typeof(Wt=ar[gn])===_&&Wt.length>0?Wt.length===2?typeof Wt[1]==d?this[Wt[0]]=Wt[1].call(this,cn):this[Wt[0]]=Wt[1]:Wt.length===3?typeof Wt[1]!==d||Wt[1].exec&&Wt[1].test?this[Wt[0]]=cn?cn.replace(Wt[1],Wt[2]):u:this[Wt[0]]=cn?Wt[1].call(this,cn,Wt[2]):u:Wt.length===4&&(this[Wt[0]]=cn?Wt[3].call(this,cn.replace(Wt[1],Wt[2])):u):this[Wt]=cn||u;On+=2}},he=function(nt,mt){for(var Gt in mt)if(typeof mt[Gt]===_&&mt[Gt].length>0){for(var _t=0;_t<mt[Gt].length;_t++)if(N(mt[Gt][_t],nt))return Gt==="?"?u:Gt}else if(N(mt[Gt],nt))return Gt==="?"?u:Gt;return nt},He={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ut={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[O,[T,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[O,[T,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[T,O],[/opios[\/ ]+([\w\.]+)/i],[O,[T,De+" Mini"]],[/\bopr\/([\w\.]+)/i],[O,[T,De]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[O,[T,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[T,O],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[O,[T,"UC"+X]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[O,[T,"WeChat"]],[/konqueror\/([\w\.]+)/i],[O,[T,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[O,[T,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[O,[T,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[O,[T,"Smart Lenovo "+X]],[/(avast|avg)\/([\w\.]+)/i],[[T,/(.+)/,"$1 Secure "+X],O],[/\bfocus\/([\w\.]+)/i],[O,[T,Be+" Focus"]],[/\bopt\/([\w\.]+)/i],[O,[T,De+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[O,[T,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[O,[T,"Dolphin"]],[/coast\/([\w\.]+)/i],[O,[T,De+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[O,[T,"MIUI "+X]],[/fxios\/([-\w\.]+)/i],[O,[T,Be]],[/\bqihu|(qi?ho?o?|360)browser/i],[[T,"360 "+X]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[T,/(.+)/,"$1 "+X],O],[/samsungbrowser\/([\w\.]+)/i],[O,[T,Ge+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[T,/_/g," "],O],[/metasr[\/ ]?([\d\.]+)/i],[O,[T,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[T,"Sogou Mobile"],O],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[T,O],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[T],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[T,Oe],O],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[T,O],[/\bgsa\/([\w\.]+) .*safari\//i],[O,[T,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[O,[T,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[O,[T,Ie+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[T,Ie+" WebView"],O],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[O,[T,"Android "+X]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[T,O],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[O,[T,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[O,T],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[T,[O,he,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[T,O],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[T,"Netscape"],O],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[O,[T,Be+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[T,O],[/(cobalt)\/([\w\.]+)/i],[T,[O,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[H,"amd64"]],[/(ia32(?=;))/i],[[H,G]],[/((?:i[346]|x)86)[;\)]/i],[[H,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[H,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[H,"armhf"]],[/windows (ce|mobile); ppc;/i],[[H,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[H,/ower/,"",G]],[/(sun4\w)[;\)]/i],[[H,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[H,G]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[I,[R,Ge],[A,$]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[I,[R,Ge],[A,Z]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[I,[R,de],[A,Z]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[I,[R,de],[A,$]],[/(macintosh);/i],[I,[R,de]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[I,[R,Et],[A,Z]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[I,[R,ee],[A,$]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[I,[R,ee],[A,Z]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[I,/_/g," "],[R,et],[A,Z]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[I,/_/g," "],[R,et],[A,$]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[I,[R,"OPPO"],[A,Z]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[I,[R,"Vivo"],[A,Z]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[I,[R,"Realme"],[A,Z]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[I,[R,Ke],[A,Z]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[I,[R,Ke],[A,$]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[I,[R,_e],[A,$]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[I,[R,_e],[A,Z]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[I,[R,"Lenovo"],[A,$]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[I,/_/g," "],[R,"Nokia"],[A,Z]],[/(pixel c)\b/i],[I,[R,qe],[A,$]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[I,[R,qe],[A,Z]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[I,[R,vt],[A,Z]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[I,"Xperia Tablet"],[R,vt],[A,$]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[I,[R,"OnePlus"],[A,Z]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[I,[R,ne],[A,$]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[I,/(.+)/g,"Fire Phone $1"],[R,ne],[A,Z]],[/(playbook);[-\w\),; ]+(rim)/i],[I,R,[A,$]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[I,[R,me],[A,Z]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[I,[R,Te],[A,$]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[I,[R,Te],[A,Z]],[/(nexus 9)/i],[I,[R,"HTC"],[A,$]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[R,[I,/_/g," "],[A,Z]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[I,[R,"Acer"],[A,$]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[I,[R,"Meizu"],[A,Z]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[I,[R,"Ulefone"],[A,Z]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[R,I,[A,Z]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[R,I,[A,$]],[/(surface duo)/i],[I,[R,Ze],[A,$]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[I,[R,"Fairphone"],[A,Z]],[/(u304aa)/i],[I,[R,"AT&T"],[A,Z]],[/\bsie-(\w*)/i],[I,[R,"Siemens"],[A,Z]],[/\b(rct\w+) b/i],[I,[R,"RCA"],[A,$]],[/\b(venue[\d ]{2,7}) b/i],[I,[R,"Dell"],[A,$]],[/\b(q(?:mv|ta)\w+) b/i],[I,[R,"Verizon"],[A,$]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[I,[R,"Barnes & Noble"],[A,$]],[/\b(tm\d{3}\w+) b/i],[I,[R,"NuVision"],[A,$]],[/\b(k88) b/i],[I,[R,"ZTE"],[A,$]],[/\b(nx\d{3}j) b/i],[I,[R,"ZTE"],[A,Z]],[/\b(gen\d{3}) b.+49h/i],[I,[R,"Swiss"],[A,Z]],[/\b(zur\d{3}) b/i],[I,[R,"Swiss"],[A,$]],[/\b((zeki)?tb.*\b) b/i],[I,[R,"Zeki"],[A,$]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[R,"Dragon Touch"],I,[A,$]],[/\b(ns-?\w{0,9}) b/i],[I,[R,"Insignia"],[A,$]],[/\b((nxa|next)-?\w{0,9}) b/i],[I,[R,"NextBook"],[A,$]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[R,"Voice"],I,[A,Z]],[/\b(lvtel\-)?(v1[12]) b/i],[[R,"LvTel"],I,[A,Z]],[/\b(ph-1) /i],[I,[R,"Essential"],[A,Z]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[I,[R,"Envizen"],[A,$]],[/\b(trio[-\w\. ]+) b/i],[I,[R,"MachSpeed"],[A,$]],[/\btu_(1491) b/i],[I,[R,"Rotor"],[A,$]],[/(shield[\w ]+) b/i],[I,[R,"Nvidia"],[A,$]],[/(sprint) (\w+)/i],[R,I,[A,Z]],[/(kin\.[onetw]{3})/i],[[I,/\./g," "],[R,Ze],[A,Z]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[I,[R,gt],[A,$]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[I,[R,gt],[A,Z]],[/smart-tv.+(samsung)/i],[R,[A,F]],[/hbbtv.+maple;(\d+)/i],[[I,/^/,"SmartTV"],[R,Ge],[A,F]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[R,_e],[A,F]],[/(apple) ?tv/i],[R,[I,de+" TV"],[A,F]],[/crkey/i],[[I,Ie+"cast"],[R,qe],[A,F]],[/droid.+aft(\w+)( bui|\))/i],[I,[R,ne],[A,F]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[I,[R,Et],[A,F]],[/(bravia[\w ]+)( bui|\))/i],[I,[R,vt],[A,F]],[/(mitv-\w{5}) bui/i],[I,[R,et],[A,F]],[/Hbbtv.*(technisat) (.*);/i],[R,I,[A,F]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[R,V],[I,V],[A,F]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[A,F]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[R,I,[A,U]],[/droid.+; (shield) bui/i],[I,[R,"Nvidia"],[A,U]],[/(playstation [345portablevi]+)/i],[I,[R,vt],[A,U]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[I,[R,Ze],[A,U]],[/((pebble))app/i],[R,I,[A,W]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[I,[R,de],[A,W]],[/droid.+; (glass) \d/i],[I,[R,qe],[A,W]],[/droid.+; (wt63?0{2,3})\)/i],[I,[R,gt],[A,W]],[/(quest( 2| pro)?)/i],[I,[R,Oe],[A,W]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[R,[A,fe]],[/(aeobc)\b/i],[I,[R,ne],[A,fe]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[I,[A,Z]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[I,[A,$]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[A,$]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[A,Z]],[/(android[-\w\. ]{0,9});.+buil/i],[I,[R,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[O,[T,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[O,[T,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[T,O],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[O,T]],os:[[/microsoft (windows) (vista|xp)/i],[T,O],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[T,[O,he,He]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[O,he,He],[T,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[O,/_/g,"."],[T,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[T,it],[O,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[O,T],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[T,O],[/\(bb(10);/i],[O,[T,me]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[O,[T,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[O,[T,Be+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[O,[T,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[O,[T,"watchOS"]],[/crkey\/([\d\.]+)/i],[O,[T,Ie+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[T,Fe],O],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[T,O],[/(sunos) ?([\w\.\d]*)/i],[[T,"Solaris"],O],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[T,O]]},Je=function(nt,mt){if(typeof nt===_&&(mt=nt,nt=u),!(this instanceof Je))return new Je(nt,mt).getResult();var Gt=typeof m!==S&&m.navigator?m.navigator:u,_t=nt||(Gt&&Gt.userAgent?Gt.userAgent:""),gn=Gt&&Gt.userAgentData?Gt.userAgentData:u,Wt=mt?(function(cn,On){var zn={};for(var ar in cn)On[ar]&&On[ar].length%2==0?zn[ar]=On[ar].concat(cn[ar]):zn[ar]=cn[ar];return zn})(ut,mt):ut,ln=Gt&&Gt.userAgent==_t;return this.getBrowser=function(){var cn,On={};return On[T]=u,On[O]=u,ye.call(On,_t,Wt.browser),On[b]=typeof(cn=On[O])===E?cn.replace(/[^\d\.]/g,"").split(".")[0]:u,ln&&Gt&&Gt.brave&&typeof Gt.brave.isBrave==d&&(On[T]="Brave"),On},this.getCPU=function(){var cn={};return cn[H]=u,ye.call(cn,_t,Wt.cpu),cn},this.getDevice=function(){var cn={};return cn[R]=u,cn[I]=u,cn[A]=u,ye.call(cn,_t,Wt.device),ln&&!cn[A]&&gn&&gn.mobile&&(cn[A]=Z),ln&&cn[I]=="Macintosh"&&Gt&&typeof Gt.standalone!==S&&Gt.maxTouchPoints&&Gt.maxTouchPoints>2&&(cn[I]="iPad",cn[A]=$),cn},this.getEngine=function(){var cn={};return cn[T]=u,cn[O]=u,ye.call(cn,_t,Wt.engine),cn},this.getOS=function(){var cn={};return cn[T]=u,cn[O]=u,ye.call(cn,_t,Wt.os),ln&&!cn[T]&&gn&&gn.platform!="Unknown"&&(cn[T]=gn.platform.replace(/chrome os/i,Fe).replace(/macos/i,it)),cn},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return _t},this.setUA=function(cn){return _t=typeof cn===E&&cn.length>500?V(cn,500):cn,this},this.setUA(_t),this};Je.VERSION="1.0.37",Je.BROWSER=w([T,O,b]),Je.CPU=w([H]),Je.DEVICE=w([I,R,A,U,Z,F,$,W,fe]),Je.ENGINE=Je.OS=w([T,O]),typeof y!==S?(f.exports&&(y=f.exports=Je),y.UAParser=Je):g.amdO?(p=(function(){return Je}).call(y,g,y,f))===u||(f.exports=p):typeof m!==S&&(m.UAParser=Je);var Qe=typeof m!==S&&(m.jQuery||m.Zepto);if(Qe&&!Qe.ua){var Ye=new Je;Qe.ua=Ye.getResult(),Qe.ua.get=function(){return Ye.getUA()},Qe.ua.set=function(nt){Ye.setUA(nt);var mt=Ye.getResult();for(var Gt in mt)Qe.ua[Gt]=mt[Gt]}}})(typeof window=="object"?window:this)},7839:function(f,y,g){function p(m){try{if(!g.g.localStorage)return!1}catch{return!1}var u=g.g.localStorage[m];return u!=null&&String(u).toLowerCase()==="true"}f.exports=function(m,u){if(p("noDeprecation"))return m;var d=!1;return function(){if(!d){if(p("throwDeprecation"))throw new Error(u);p("traceDeprecation")?console.trace(u):console.warn(u),d=!0}return m.apply(this,arguments)}}},9862:function(){},964:function(){},3165:function(f){f.exports=JSON.parse('["mni-beng-in","mni-mtei-in","sat-deva-in","sat-olck-in","shi-latn-ma","shi-tfng-ma","vai-latn-lr","vai-vaii-lr","yue-hans-cn","yue-hant-hk","az-arab-ir","az-cyrl-az","az-latn-az","bm-nkoo-ml","bs-cyrl-ba","bs-latn-ba","en-dsrt-us","ff-adlm-gn","ff-latn-sn","ha-arab-ng","hi-latn-in","iu-latn-ca","ks-arab-in","ks-deva-in","mn-mong-cn","ms-arab-my","pa-arab-pk","pa-guru-in","sd-arab-pk","sd-deva-in","sr-cyrl-rs","sr-latn-rs","su-latn-id","uz-arab-af","uz-cyrl-uz","uz-latn-uz","zh-hans-cn","zh-hant-tw","mni-beng","sat-olck","shi-tfng","vai-vaii","yue-hant","az-latn","bs-latn","ff-latn","jbo-001","ks-arab","pa-guru","prg-001","sd-arab","sr-cyrl","su-latn","uz-latn","zh-hans","agq-cm","ar-001","arn-cl","asa-tz","ast-es","bas-cm","bem-zm","bez-tz","bgn-pk","blt-vn","brx-in","bss-cm","byn-er","cad-us","cch-ng","ccp-bd","ceb-ph","cgg-ug","chr-us","cic-us","ckb-iq","dav-ke","dje-ne","doi-in","dsb-de","dua-cm","dyo-sn","ebu-ke","eo-001","ewo-cm","fil-ph","fur-it","gaa-gh","gez-et","gsw-ch","guz-ke","haw-us","hsb-de","ia-001","ife-tg","io-001","jgo-cm","jmc-tz","kab-dz","kaj-ng","kam-ke","kcg-ng","kde-tz","kea-cv","ken-cm","khq-ml","kkj-cm","kln-ke","kok-in","kpe-lr","ksb-tz","ksf-cm","ksh-de","lag-tz","lkt-us","lrc-ir","luo-ke","luy-ke","mai-in","mas-ke","mer-ke","mfe-mu","mgh-mz","mgo-cm","moh-ca","mua-cm","mus-us","myv-ru","mzn-ir","naq-na","nds-de","nmg-cm","nnh-cm","nqo-gn","nso-za","nus-ss","nyn-ug","osa-us","pcm-ng","quc-gt","rof-tz","rwk-tz","sah-ru","saq-ke","sbp-tz","scn-it","sdh-ir","seh-mz","ses-ml","sid-et","sma-se","smj-se","smn-fi","sms-fi","ssy-er","syr-iq","szl-pl","teo-ug","tig-er","trv-tw","trw-pk","twq-ne","tzm-ma","vo-001","vun-tz","wae-ch","wal-et","wbp-au","xog-ug","yav-cm","yi-001","zgh-ma","aa-et","af-za","ak-gh","am-et","an-es","as-in","ba-ru","be-by","bg-bg","bm-ml","bn-bd","bo-cn","br-fr","ca-es","ce-ru","co-fr","cs-cz","cu-ru","cv-ru","cy-gb","da-dk","de-de","dv-mv","dz-bt","ee-gh","el-gr","en-us","es-es","et-ee","eu-es","fa-ir","fi-fi","fo-fo","fr-fr","fy-nl","ga-ie","gd-gb","gl-es","gn-py","gu-in","gv-im","ha-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","ig-ng","ii-cn","is-is","it-it","iu-ca","ja-jp","jv-id","ka-ge","ki-ke","kk-kz","kl-gl","km-kh","kn-in","ko-kr","ku-tr","kw-gb","ky-kg","lb-lu","lg-ug","ln-cd","lo-la","lt-lt","lu-cd","lv-lv","mg-mg","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","my-mm","nb-no","nd-zw","ne-np","nl-nl","nn-no","nr-za","nv-us","ny-mw","oc-fr","om-et","or-in","os-ge","pl-pl","ps-af","pt-br","qu-pe","rm-ch","rn-bi","ro-ro","ru-ru","rw-rw","sa-in","sc-it","se-no","sg-cf","si-lk","sk-sk","sl-si","sn-zw","so-so","sq-al","ss-za","st-za","sv-se","sw-tz","ta-in","te-in","tg-tj","th-th","ti-et","tk-tm","tn-za","to-to","tr-tr","ts-za","tt-ru","ug-cn","uk-ua","ur-pk","ve-za","vi-vn","wa-be","wo-sn","xh-za","yo-ng","zu-za"]')},5813:function(f){f.exports=JSON.parse('[{"from":{"field":"script","value":"qaai"},"to":{"field":"script","value":"zinh"}},{"from":{"field":"region","value":"bu"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"ct"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"dd"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"dy"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"fx"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"hv"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"jt"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"mi"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"nh"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"nq"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"pu"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"pz"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"qu"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"rh"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"tp"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"uk"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"vd"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"wk"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"yd"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"zr"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"230"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"280"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"736"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"886"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"958"},"to":{"field":"region","value":"aa"}},{"from":{"field":"region","value":"020"},"to":{"field":"region","value":"ad"}},{"from":{"field":"region","value":"784"},"to":{"field":"region","value":"ae"}},{"from":{"field":"region","value":"004"},"to":{"field":"region","value":"af"}},{"from":{"field":"region","value":"028"},"to":{"field":"region","value":"ag"}},{"from":{"field":"region","value":"660"},"to":{"field":"region","value":"ai"}},{"from":{"field":"region","value":"008"},"to":{"field":"region","value":"al"}},{"from":{"field":"region","value":"051"},"to":{"field":"region","value":"am"}},{"from":{"field":"region","value":"024"},"to":{"field":"region","value":"ao"}},{"from":{"field":"region","value":"010"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"032"},"to":{"field":"region","value":"ar"}},{"from":{"field":"region","value":"016"},"to":{"field":"region","value":"as"}},{"from":{"field":"region","value":"040"},"to":{"field":"region","value":"at"}},{"from":{"field":"region","value":"036"},"to":{"field":"region","value":"au"}},{"from":{"field":"region","value":"533"},"to":{"field":"region","value":"aw"}},{"from":{"field":"region","value":"248"},"to":{"field":"region","value":"ax"}},{"from":{"field":"region","value":"031"},"to":{"field":"region","value":"az"}},{"from":{"field":"region","value":"070"},"to":{"field":"region","value":"ba"}},{"from":{"field":"region","value":"052"},"to":{"field":"region","value":"bb"}},{"from":{"field":"region","value":"050"},"to":{"field":"region","value":"bd"}},{"from":{"field":"region","value":"056"},"to":{"field":"region","value":"be"}},{"from":{"field":"region","value":"854"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"100"},"to":{"field":"region","value":"bg"}},{"from":{"field":"region","value":"048"},"to":{"field":"region","value":"bh"}},{"from":{"field":"region","value":"108"},"to":{"field":"region","value":"bi"}},{"from":{"field":"region","value":"204"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"652"},"to":{"field":"region","value":"bl"}},{"from":{"field":"region","value":"060"},"to":{"field":"region","value":"bm"}},{"from":{"field":"region","value":"096"},"to":{"field":"region","value":"bn"}},{"from":{"field":"region","value":"068"},"to":{"field":"region","value":"bo"}},{"from":{"field":"region","value":"535"},"to":{"field":"region","value":"bq"}},{"from":{"field":"region","value":"076"},"to":{"field":"region","value":"br"}},{"from":{"field":"region","value":"044"},"to":{"field":"region","value":"bs"}},{"from":{"field":"region","value":"064"},"to":{"field":"region","value":"bt"}},{"from":{"field":"region","value":"104"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"074"},"to":{"field":"region","value":"bv"}},{"from":{"field":"region","value":"072"},"to":{"field":"region","value":"bw"}},{"from":{"field":"region","value":"112"},"to":{"field":"region","value":"by"}},{"from":{"field":"region","value":"084"},"to":{"field":"region","value":"bz"}},{"from":{"field":"region","value":"124"},"to":{"field":"region","value":"ca"}},{"from":{"field":"region","value":"166"},"to":{"field":"region","value":"cc"}},{"from":{"field":"region","value":"180"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"140"},"to":{"field":"region","value":"cf"}},{"from":{"field":"region","value":"178"},"to":{"field":"region","value":"cg"}},{"from":{"field":"region","value":"756"},"to":{"field":"region","value":"ch"}},{"from":{"field":"region","value":"384"},"to":{"field":"region","value":"ci"}},{"from":{"field":"region","value":"184"},"to":{"field":"region","value":"ck"}},{"from":{"field":"region","value":"152"},"to":{"field":"region","value":"cl"}},{"from":{"field":"region","value":"120"},"to":{"field":"region","value":"cm"}},{"from":{"field":"region","value":"156"},"to":{"field":"region","value":"cn"}},{"from":{"field":"region","value":"170"},"to":{"field":"region","value":"co"}},{"from":{"field":"region","value":"188"},"to":{"field":"region","value":"cr"}},{"from":{"field":"region","value":"192"},"to":{"field":"region","value":"cu"}},{"from":{"field":"region","value":"132"},"to":{"field":"region","value":"cv"}},{"from":{"field":"region","value":"531"},"to":{"field":"region","value":"cw"}},{"from":{"field":"region","value":"162"},"to":{"field":"region","value":"cx"}},{"from":{"field":"region","value":"196"},"to":{"field":"region","value":"cy"}},{"from":{"field":"region","value":"203"},"to":{"field":"region","value":"cz"}},{"from":{"field":"region","value":"278"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"276"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"262"},"to":{"field":"region","value":"dj"}},{"from":{"field":"region","value":"208"},"to":{"field":"region","value":"dk"}},{"from":{"field":"region","value":"212"},"to":{"field":"region","value":"dm"}},{"from":{"field":"region","value":"214"},"to":{"field":"region","value":"do"}},{"from":{"field":"region","value":"012"},"to":{"field":"region","value":"dz"}},{"from":{"field":"region","value":"218"},"to":{"field":"region","value":"ec"}},{"from":{"field":"region","value":"233"},"to":{"field":"region","value":"ee"}},{"from":{"field":"region","value":"818"},"to":{"field":"region","value":"eg"}},{"from":{"field":"region","value":"732"},"to":{"field":"region","value":"eh"}},{"from":{"field":"region","value":"232"},"to":{"field":"region","value":"er"}},{"from":{"field":"region","value":"724"},"to":{"field":"region","value":"es"}},{"from":{"field":"region","value":"231"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"246"},"to":{"field":"region","value":"fi"}},{"from":{"field":"region","value":"242"},"to":{"field":"region","value":"fj"}},{"from":{"field":"region","value":"238"},"to":{"field":"region","value":"fk"}},{"from":{"field":"region","value":"583"},"to":{"field":"region","value":"fm"}},{"from":{"field":"region","value":"234"},"to":{"field":"region","value":"fo"}},{"from":{"field":"region","value":"250"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"249"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"266"},"to":{"field":"region","value":"ga"}},{"from":{"field":"region","value":"826"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"308"},"to":{"field":"region","value":"gd"}},{"from":{"field":"region","value":"268"},"to":{"field":"region","value":"ge"}},{"from":{"field":"region","value":"254"},"to":{"field":"region","value":"gf"}},{"from":{"field":"region","value":"831"},"to":{"field":"region","value":"gg"}},{"from":{"field":"region","value":"288"},"to":{"field":"region","value":"gh"}},{"from":{"field":"region","value":"292"},"to":{"field":"region","value":"gi"}},{"from":{"field":"region","value":"304"},"to":{"field":"region","value":"gl"}},{"from":{"field":"region","value":"270"},"to":{"field":"region","value":"gm"}},{"from":{"field":"region","value":"324"},"to":{"field":"region","value":"gn"}},{"from":{"field":"region","value":"312"},"to":{"field":"region","value":"gp"}},{"from":{"field":"region","value":"226"},"to":{"field":"region","value":"gq"}},{"from":{"field":"region","value":"300"},"to":{"field":"region","value":"gr"}},{"from":{"field":"region","value":"239"},"to":{"field":"region","value":"gs"}},{"from":{"field":"region","value":"320"},"to":{"field":"region","value":"gt"}},{"from":{"field":"region","value":"316"},"to":{"field":"region","value":"gu"}},{"from":{"field":"region","value":"624"},"to":{"field":"region","value":"gw"}},{"from":{"field":"region","value":"328"},"to":{"field":"region","value":"gy"}},{"from":{"field":"region","value":"344"},"to":{"field":"region","value":"hk"}},{"from":{"field":"region","value":"334"},"to":{"field":"region","value":"hm"}},{"from":{"field":"region","value":"340"},"to":{"field":"region","value":"hn"}},{"from":{"field":"region","value":"191"},"to":{"field":"region","value":"hr"}},{"from":{"field":"region","value":"332"},"to":{"field":"region","value":"ht"}},{"from":{"field":"region","value":"348"},"to":{"field":"region","value":"hu"}},{"from":{"field":"region","value":"360"},"to":{"field":"region","value":"id"}},{"from":{"field":"region","value":"372"},"to":{"field":"region","value":"ie"}},{"from":{"field":"region","value":"376"},"to":{"field":"region","value":"il"}},{"from":{"field":"region","value":"833"},"to":{"field":"region","value":"im"}},{"from":{"field":"region","value":"356"},"to":{"field":"region","value":"in"}},{"from":{"field":"region","value":"086"},"to":{"field":"region","value":"io"}},{"from":{"field":"region","value":"368"},"to":{"field":"region","value":"iq"}},{"from":{"field":"region","value":"364"},"to":{"field":"region","value":"ir"}},{"from":{"field":"region","value":"352"},"to":{"field":"region","value":"is"}},{"from":{"field":"region","value":"380"},"to":{"field":"region","value":"it"}},{"from":{"field":"region","value":"832"},"to":{"field":"region","value":"je"}},{"from":{"field":"region","value":"388"},"to":{"field":"region","value":"jm"}},{"from":{"field":"region","value":"400"},"to":{"field":"region","value":"jo"}},{"from":{"field":"region","value":"392"},"to":{"field":"region","value":"jp"}},{"from":{"field":"region","value":"404"},"to":{"field":"region","value":"ke"}},{"from":{"field":"region","value":"417"},"to":{"field":"region","value":"kg"}},{"from":{"field":"region","value":"116"},"to":{"field":"region","value":"kh"}},{"from":{"field":"region","value":"296"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"174"},"to":{"field":"region","value":"km"}},{"from":{"field":"region","value":"659"},"to":{"field":"region","value":"kn"}},{"from":{"field":"region","value":"408"},"to":{"field":"region","value":"kp"}},{"from":{"field":"region","value":"410"},"to":{"field":"region","value":"kr"}},{"from":{"field":"region","value":"414"},"to":{"field":"region","value":"kw"}},{"from":{"field":"region","value":"136"},"to":{"field":"region","value":"ky"}},{"from":{"field":"region","value":"398"},"to":{"field":"region","value":"kz"}},{"from":{"field":"region","value":"418"},"to":{"field":"region","value":"la"}},{"from":{"field":"region","value":"422"},"to":{"field":"region","value":"lb"}},{"from":{"field":"region","value":"662"},"to":{"field":"region","value":"lc"}},{"from":{"field":"region","value":"438"},"to":{"field":"region","value":"li"}},{"from":{"field":"region","value":"144"},"to":{"field":"region","value":"lk"}},{"from":{"field":"region","value":"430"},"to":{"field":"region","value":"lr"}},{"from":{"field":"region","value":"426"},"to":{"field":"region","value":"ls"}},{"from":{"field":"region","value":"440"},"to":{"field":"region","value":"lt"}},{"from":{"field":"region","value":"442"},"to":{"field":"region","value":"lu"}},{"from":{"field":"region","value":"428"},"to":{"field":"region","value":"lv"}},{"from":{"field":"region","value":"434"},"to":{"field":"region","value":"ly"}},{"from":{"field":"region","value":"504"},"to":{"field":"region","value":"ma"}},{"from":{"field":"region","value":"492"},"to":{"field":"region","value":"mc"}},{"from":{"field":"region","value":"498"},"to":{"field":"region","value":"md"}},{"from":{"field":"region","value":"499"},"to":{"field":"region","value":"me"}},{"from":{"field":"region","value":"663"},"to":{"field":"region","value":"mf"}},{"from":{"field":"region","value":"450"},"to":{"field":"region","value":"mg"}},{"from":{"field":"region","value":"584"},"to":{"field":"region","value":"mh"}},{"from":{"field":"region","value":"807"},"to":{"field":"region","value":"mk"}},{"from":{"field":"region","value":"466"},"to":{"field":"region","value":"ml"}},{"from":{"field":"region","value":"496"},"to":{"field":"region","value":"mn"}},{"from":{"field":"region","value":"446"},"to":{"field":"region","value":"mo"}},{"from":{"field":"region","value":"580"},"to":{"field":"region","value":"mp"}},{"from":{"field":"region","value":"474"},"to":{"field":"region","value":"mq"}},{"from":{"field":"region","value":"478"},"to":{"field":"region","value":"mr"}},{"from":{"field":"region","value":"500"},"to":{"field":"region","value":"ms"}},{"from":{"field":"region","value":"470"},"to":{"field":"region","value":"mt"}},{"from":{"field":"region","value":"480"},"to":{"field":"region","value":"mu"}},{"from":{"field":"region","value":"462"},"to":{"field":"region","value":"mv"}},{"from":{"field":"region","value":"454"},"to":{"field":"region","value":"mw"}},{"from":{"field":"region","value":"484"},"to":{"field":"region","value":"mx"}},{"from":{"field":"region","value":"458"},"to":{"field":"region","value":"my"}},{"from":{"field":"region","value":"508"},"to":{"field":"region","value":"mz"}},{"from":{"field":"region","value":"516"},"to":{"field":"region","value":"na"}},{"from":{"field":"region","value":"540"},"to":{"field":"region","value":"nc"}},{"from":{"field":"region","value":"562"},"to":{"field":"region","value":"ne"}},{"from":{"field":"region","value":"574"},"to":{"field":"region","value":"nf"}},{"from":{"field":"region","value":"566"},"to":{"field":"region","value":"ng"}},{"from":{"field":"region","value":"558"},"to":{"field":"region","value":"ni"}},{"from":{"field":"region","value":"528"},"to":{"field":"region","value":"nl"}},{"from":{"field":"region","value":"578"},"to":{"field":"region","value":"no"}},{"from":{"field":"region","value":"524"},"to":{"field":"region","value":"np"}},{"from":{"field":"region","value":"520"},"to":{"field":"region","value":"nr"}},{"from":{"field":"region","value":"570"},"to":{"field":"region","value":"nu"}},{"from":{"field":"region","value":"554"},"to":{"field":"region","value":"nz"}},{"from":{"field":"region","value":"512"},"to":{"field":"region","value":"om"}},{"from":{"field":"region","value":"591"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"604"},"to":{"field":"region","value":"pe"}},{"from":{"field":"region","value":"258"},"to":{"field":"region","value":"pf"}},{"from":{"field":"region","value":"598"},"to":{"field":"region","value":"pg"}},{"from":{"field":"region","value":"608"},"to":{"field":"region","value":"ph"}},{"from":{"field":"region","value":"586"},"to":{"field":"region","value":"pk"}},{"from":{"field":"region","value":"616"},"to":{"field":"region","value":"pl"}},{"from":{"field":"region","value":"666"},"to":{"field":"region","value":"pm"}},{"from":{"field":"region","value":"612"},"to":{"field":"region","value":"pn"}},{"from":{"field":"region","value":"630"},"to":{"field":"region","value":"pr"}},{"from":{"field":"region","value":"275"},"to":{"field":"region","value":"ps"}},{"from":{"field":"region","value":"620"},"to":{"field":"region","value":"pt"}},{"from":{"field":"region","value":"585"},"to":{"field":"region","value":"pw"}},{"from":{"field":"region","value":"600"},"to":{"field":"region","value":"py"}},{"from":{"field":"region","value":"634"},"to":{"field":"region","value":"qa"}},{"from":{"field":"region","value":"959"},"to":{"field":"region","value":"qm"}},{"from":{"field":"region","value":"960"},"to":{"field":"region","value":"qn"}},{"from":{"field":"region","value":"962"},"to":{"field":"region","value":"qp"}},{"from":{"field":"region","value":"963"},"to":{"field":"region","value":"qq"}},{"from":{"field":"region","value":"964"},"to":{"field":"region","value":"qr"}},{"from":{"field":"region","value":"965"},"to":{"field":"region","value":"qs"}},{"from":{"field":"region","value":"966"},"to":{"field":"region","value":"qt"}},{"from":{"field":"region","value":"967"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"968"},"to":{"field":"region","value":"qv"}},{"from":{"field":"region","value":"969"},"to":{"field":"region","value":"qw"}},{"from":{"field":"region","value":"970"},"to":{"field":"region","value":"qx"}},{"from":{"field":"region","value":"971"},"to":{"field":"region","value":"qy"}},{"from":{"field":"region","value":"972"},"to":{"field":"region","value":"qz"}},{"from":{"field":"region","value":"638"},"to":{"field":"region","value":"re"}},{"from":{"field":"region","value":"642"},"to":{"field":"region","value":"ro"}},{"from":{"field":"region","value":"688"},"to":{"field":"region","value":"rs"}},{"from":{"field":"region","value":"643"},"to":{"field":"region","value":"ru"}},{"from":{"field":"region","value":"646"},"to":{"field":"region","value":"rw"}},{"from":{"field":"region","value":"682"},"to":{"field":"region","value":"sa"}},{"from":{"field":"region","value":"090"},"to":{"field":"region","value":"sb"}},{"from":{"field":"region","value":"690"},"to":{"field":"region","value":"sc"}},{"from":{"field":"region","value":"729"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"752"},"to":{"field":"region","value":"se"}},{"from":{"field":"region","value":"702"},"to":{"field":"region","value":"sg"}},{"from":{"field":"region","value":"654"},"to":{"field":"region","value":"sh"}},{"from":{"field":"region","value":"705"},"to":{"field":"region","value":"si"}},{"from":{"field":"region","value":"744"},"to":{"field":"region","value":"sj"}},{"from":{"field":"region","value":"703"},"to":{"field":"region","value":"sk"}},{"from":{"field":"region","value":"694"},"to":{"field":"region","value":"sl"}},{"from":{"field":"region","value":"674"},"to":{"field":"region","value":"sm"}},{"from":{"field":"region","value":"686"},"to":{"field":"region","value":"sn"}},{"from":{"field":"region","value":"706"},"to":{"field":"region","value":"so"}},{"from":{"field":"region","value":"740"},"to":{"field":"region","value":"sr"}},{"from":{"field":"region","value":"728"},"to":{"field":"region","value":"ss"}},{"from":{"field":"region","value":"678"},"to":{"field":"region","value":"st"}},{"from":{"field":"region","value":"222"},"to":{"field":"region","value":"sv"}},{"from":{"field":"region","value":"534"},"to":{"field":"region","value":"sx"}},{"from":{"field":"region","value":"760"},"to":{"field":"region","value":"sy"}},{"from":{"field":"region","value":"748"},"to":{"field":"region","value":"sz"}},{"from":{"field":"region","value":"796"},"to":{"field":"region","value":"tc"}},{"from":{"field":"region","value":"148"},"to":{"field":"region","value":"td"}},{"from":{"field":"region","value":"260"},"to":{"field":"region","value":"tf"}},{"from":{"field":"region","value":"768"},"to":{"field":"region","value":"tg"}},{"from":{"field":"region","value":"764"},"to":{"field":"region","value":"th"}},{"from":{"field":"region","value":"762"},"to":{"field":"region","value":"tj"}},{"from":{"field":"region","value":"772"},"to":{"field":"region","value":"tk"}},{"from":{"field":"region","value":"626"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"795"},"to":{"field":"region","value":"tm"}},{"from":{"field":"region","value":"788"},"to":{"field":"region","value":"tn"}},{"from":{"field":"region","value":"776"},"to":{"field":"region","value":"to"}},{"from":{"field":"region","value":"792"},"to":{"field":"region","value":"tr"}},{"from":{"field":"region","value":"780"},"to":{"field":"region","value":"tt"}},{"from":{"field":"region","value":"798"},"to":{"field":"region","value":"tv"}},{"from":{"field":"region","value":"158"},"to":{"field":"region","value":"tw"}},{"from":{"field":"region","value":"834"},"to":{"field":"region","value":"tz"}},{"from":{"field":"region","value":"804"},"to":{"field":"region","value":"ua"}},{"from":{"field":"region","value":"800"},"to":{"field":"region","value":"ug"}},{"from":{"field":"region","value":"581"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"840"},"to":{"field":"region","value":"us"}},{"from":{"field":"region","value":"858"},"to":{"field":"region","value":"uy"}},{"from":{"field":"region","value":"860"},"to":{"field":"region","value":"uz"}},{"from":{"field":"region","value":"336"},"to":{"field":"region","value":"va"}},{"from":{"field":"region","value":"670"},"to":{"field":"region","value":"vc"}},{"from":{"field":"region","value":"862"},"to":{"field":"region","value":"ve"}},{"from":{"field":"region","value":"092"},"to":{"field":"region","value":"vg"}},{"from":{"field":"region","value":"850"},"to":{"field":"region","value":"vi"}},{"from":{"field":"region","value":"704"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"548"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"876"},"to":{"field":"region","value":"wf"}},{"from":{"field":"region","value":"882"},"to":{"field":"region","value":"ws"}},{"from":{"field":"region","value":"973"},"to":{"field":"region","value":"xa"}},{"from":{"field":"region","value":"974"},"to":{"field":"region","value":"xb"}},{"from":{"field":"region","value":"975"},"to":{"field":"region","value":"xc"}},{"from":{"field":"region","value":"976"},"to":{"field":"region","value":"xd"}},{"from":{"field":"region","value":"977"},"to":{"field":"region","value":"xe"}},{"from":{"field":"region","value":"978"},"to":{"field":"region","value":"xf"}},{"from":{"field":"region","value":"979"},"to":{"field":"region","value":"xg"}},{"from":{"field":"region","value":"980"},"to":{"field":"region","value":"xh"}},{"from":{"field":"region","value":"981"},"to":{"field":"region","value":"xi"}},{"from":{"field":"region","value":"982"},"to":{"field":"region","value":"xj"}},{"from":{"field":"region","value":"983"},"to":{"field":"region","value":"xk"}},{"from":{"field":"region","value":"984"},"to":{"field":"region","value":"xl"}},{"from":{"field":"region","value":"985"},"to":{"field":"region","value":"xm"}},{"from":{"field":"region","value":"986"},"to":{"field":"region","value":"xn"}},{"from":{"field":"region","value":"987"},"to":{"field":"region","value":"xo"}},{"from":{"field":"region","value":"988"},"to":{"field":"region","value":"xp"}},{"from":{"field":"region","value":"989"},"to":{"field":"region","value":"xq"}},{"from":{"field":"region","value":"990"},"to":{"field":"region","value":"xr"}},{"from":{"field":"region","value":"991"},"to":{"field":"region","value":"xs"}},{"from":{"field":"region","value":"992"},"to":{"field":"region","value":"xt"}},{"from":{"field":"region","value":"993"},"to":{"field":"region","value":"xu"}},{"from":{"field":"region","value":"994"},"to":{"field":"region","value":"xv"}},{"from":{"field":"region","value":"995"},"to":{"field":"region","value":"xw"}},{"from":{"field":"region","value":"996"},"to":{"field":"region","value":"xx"}},{"from":{"field":"region","value":"997"},"to":{"field":"region","value":"xy"}},{"from":{"field":"region","value":"998"},"to":{"field":"region","value":"xz"}},{"from":{"field":"region","value":"720"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"887"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"175"},"to":{"field":"region","value":"yt"}},{"from":{"field":"region","value":"710"},"to":{"field":"region","value":"za"}},{"from":{"field":"region","value":"894"},"to":{"field":"region","value":"zm"}},{"from":{"field":"region","value":"716"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"999"},"to":{"field":"region","value":"zz"}},{"from":{"field":"variants","value":"aaland"},"to":{"field":"region","value":"ax"}},{"from":{"field":"variants","value":"polytoni"},"to":{"field":"variants","value":"polyton"}},{"from":{"field":"variants","value":"heploc"},"to":{"field":"variants","value":"alalc97"}},{"from":{"field":"variants","value":"arevela"},"to":{"field":"language","value":"hy"}},{"from":{"field":"variants","value":"arevmda"},"to":{"field":"language","value":"hyw"}}]')},9460:function(f){f.exports=JSON.parse('{"region":{"172":["ru","am","az","by","ge","kg","kz","md","tj","tm","ua","uz"],"200":["cz","sk"],"530":["cw","sx","bq"],"532":["cw","sx","bq"],"536":["sa","iq"],"582":["fm","mh","mp","pw"],"810":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"830":["je","gg"],"890":["rs","me","si","hr","mk","ba"],"891":["rs","me"],"an":["cw","sx","bq"],"cs":["rs","me"],"fq":["aq","tf"],"nt":["sa","iq"],"pc":["fm","mh","mp","pw"],"su":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yu":["rs","me"],"062":["034","143"],"ant":["cw","sx","bq"],"scg":["rs","me"],"ntz":["sa","iq"],"sun":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yug":["rs","me"]}}')},7778:function(f){f.exports=JSON.parse('[{"from":"in","to":"id"},{"from":"iw","to":"he"},{"from":"ji","to":"yi"},{"from":"jw","to":"jv"},{"from":"mo","to":"ro"},{"from":"scc","to":"sr"},{"from":"scr","to":"hr"},{"from":"aam","to":"aas"},{"from":"adp","to":"dz"},{"from":"aue","to":"ktz"},{"from":"ayx","to":"nun"},{"from":"bgm","to":"bcg"},{"from":"bjd","to":"drl"},{"from":"ccq","to":"rki"},{"from":"cjr","to":"mom"},{"from":"cka","to":"cmr"},{"from":"cmk","to":"xch"},{"from":"coy","to":"pij"},{"from":"cqu","to":"quh"},{"from":"drh","to":"mn"},{"from":"drw","to":"fa-af"},{"from":"gav","to":"dev"},{"from":"gfx","to":"vaj"},{"from":"ggn","to":"gvr"},{"from":"gti","to":"nyc"},{"from":"guv","to":"duz"},{"from":"hrr","to":"jal"},{"from":"ibi","to":"opa"},{"from":"ilw","to":"gal"},{"from":"jeg","to":"oyb"},{"from":"kgc","to":"tdf"},{"from":"kgh","to":"kml"},{"from":"koj","to":"kwv"},{"from":"krm","to":"bmf"},{"from":"ktr","to":"dtp"},{"from":"kvs","to":"gdj"},{"from":"kwq","to":"yam"},{"from":"kxe","to":"tvd"},{"from":"kzj","to":"dtp"},{"from":"kzt","to":"dtp"},{"from":"lii","to":"raq"},{"from":"lmm","to":"rmx"},{"from":"meg","to":"cir"},{"from":"mst","to":"mry"},{"from":"mwj","to":"vaj"},{"from":"myt","to":"mry"},{"from":"nad","to":"xny"},{"from":"ncp","to":"kdz"},{"from":"nnx","to":"ngv"},{"from":"nts","to":"pij"},{"from":"oun","to":"vaj"},{"from":"pcr","to":"adx"},{"from":"pmc","to":"huw"},{"from":"pmu","to":"phr"},{"from":"ppa","to":"bfy"},{"from":"ppr","to":"lcq"},{"from":"pry","to":"prt"},{"from":"puz","to":"pub"},{"from":"sca","to":"hle"},{"from":"skk","to":"oyb"},{"from":"tdu","to":"dtp"},{"from":"thc","to":"tpo"},{"from":"thx","to":"oyb"},{"from":"tie","to":"ras"},{"from":"tkk","to":"twm"},{"from":"tlw","to":"weo"},{"from":"tmp","to":"tyj"},{"from":"tne","to":"kak"},{"from":"tnf","to":"fa-af"},{"from":"tsf","to":"taj"},{"from":"uok","to":"ema"},{"from":"xba","to":"cax"},{"from":"xia","to":"acn"},{"from":"xkh","to":"waw"},{"from":"xsj","to":"suj"},{"from":"ybd","to":"rki"},{"from":"yma","to":"lrr"},{"from":"ymt","to":"mtm"},{"from":"yos","to":"zom"},{"from":"yuu","to":"yug"},{"from":"asd","to":"snz"},{"from":"dit","to":"dif"},{"from":"llo","to":"ngt"},{"from":"myd","to":"aog"},{"from":"nns","to":"nbr"},{"from":"sgn-br","to":"bzs"},{"from":"sgn-co","to":"csn"},{"from":"sgn-de","to":"gsg"},{"from":"sgn-dk","to":"dsl"},{"from":"sgn-fr","to":"fsl"},{"from":"sgn-gb","to":"bfi"},{"from":"sgn-gr","to":"gss"},{"from":"sgn-ie","to":"isg"},{"from":"sgn-it","to":"ise"},{"from":"sgn-jp","to":"jsl"},{"from":"sgn-mx","to":"mfs"},{"from":"sgn-ni","to":"ncs"},{"from":"sgn-nl","to":"dse"},{"from":"sgn-no","to":"nsi"},{"from":"sgn-pt","to":"psr"},{"from":"sgn-se","to":"swl"},{"from":"sgn-us","to":"ase"},{"from":"sgn-za","to":"sfs"},{"from":"no-bokmal","to":"nb"},{"from":"no-nynorsk","to":"nn"},{"from":"aa-saaho","to":"ssy"},{"from":"sh","to":"sr-latn"},{"from":"cnr","to":"sr-me"},{"from":"no","to":"nb"},{"from":"tl","to":"fil"},{"from":"az-az","to":"az-latn-az"},{"from":"bs-ba","to":"bs-latn-ba"},{"from":"ha-latn-gh","to":"ha-gh"},{"from":"ha-latn-ne","to":"ha-ne"},{"from":"ha-latn-ng","to":"ha-ng"},{"from":"kk-cyrl-kz","to":"kk-kz"},{"from":"ky-cyrl-kg","to":"ky-kg"},{"from":"ks-arab-in","to":"ks-in"},{"from":"mn-cyrl-mn","to":"mn-mn"},{"from":"ms-latn-bn","to":"ms-bn"},{"from":"ms-latn-my","to":"ms-my"},{"from":"ms-latn-sg","to":"ms-sg"},{"from":"pa-in","to":"pa-guru-in"},{"from":"pa-pk","to":"pa-arab-pk"},{"from":"shi-ma","to":"shi-tfng-ma"},{"from":"sr-ba","to":"sr-cyrl-ba"},{"from":"sr-me","to":"sr-latn-me"},{"from":"sr-rs","to":"sr-cyrl-rs"},{"from":"sr-xk","to":"sr-cyrl-xk"},{"from":"tzm-latn-ma","to":"tzm-ma"},{"from":"ug-arab-cn","to":"ug-cn"},{"from":"uz-af","to":"uz-arab-af"},{"from":"uz-uz","to":"uz-latn-uz"},{"from":"vai-lr","to":"vai-vaii-lr"},{"from":"yue-cn","to":"yue-hans-cn"},{"from":"yue-hk","to":"yue-hant-hk"},{"from":"zh-cn","to":"zh-hans-cn"},{"from":"zh-hk","to":"zh-hant-hk"},{"from":"zh-mo","to":"zh-hant-mo"},{"from":"zh-sg","to":"zh-hans-sg"},{"from":"zh-tw","to":"zh-hant-tw"},{"from":"aju","to":"jrb"},{"from":"als","to":"sq"},{"from":"arb","to":"ar"},{"from":"ayr","to":"ay"},{"from":"azj","to":"az"},{"from":"bcc","to":"bal"},{"from":"bcl","to":"bik"},{"from":"bxk","to":"luy"},{"from":"bxr","to":"bua"},{"from":"cld","to":"syr"},{"from":"cmn","to":"zh"},{"from":"cwd","to":"cr"},{"from":"dgo","to":"doi"},{"from":"dhd","to":"mwr"},{"from":"dik","to":"din"},{"from":"diq","to":"zza"},{"from":"lbk","to":"bnc"},{"from":"ekk","to":"et"},{"from":"emk","to":"man"},{"from":"esk","to":"ik"},{"from":"fat","to":"ak"},{"from":"fuc","to":"ff"},{"from":"gaz","to":"om"},{"from":"gbo","to":"grb"},{"from":"gno","to":"gon"},{"from":"gug","to":"gn"},{"from":"gya","to":"gba"},{"from":"hdn","to":"hai"},{"from":"hea","to":"hmn"},{"from":"ike","to":"iu"},{"from":"kmr","to":"ku"},{"from":"knc","to":"kr"},{"from":"kng","to":"kg"},{"from":"knn","to":"kok"},{"from":"kpv","to":"kv"},{"from":"lvs","to":"lv"},{"from":"mhr","to":"chm"},{"from":"mup","to":"raj"},{"from":"khk","to":"mn"},{"from":"npi","to":"ne"},{"from":"ojg","to":"oj"},{"from":"ory","to":"or"},{"from":"pbu","to":"ps"},{"from":"pes","to":"fa"},{"from":"plt","to":"mg"},{"from":"pnb","to":"lah"},{"from":"quz","to":"qu"},{"from":"rmy","to":"rom"},{"from":"spy","to":"kln"},{"from":"src","to":"sc"},{"from":"swh","to":"sw"},{"from":"ttq","to":"tmh"},{"from":"tw","to":"ak"},{"from":"umu","to":"del"},{"from":"uzn","to":"uz"},{"from":"xpe","to":"kpe"},{"from":"xsl","to":"den"},{"from":"ydd","to":"yi"},{"from":"zai","to":"zap"},{"from":"zsm","to":"ms"},{"from":"zyb","to":"za"},{"from":"him","to":"srx"},{"from":"mnk","to":"man"},{"from":"bh","to":"bho"},{"from":"prs","to":"fa-af"},{"from":"swc","to":"sw-cd"},{"from":"aar","to":"aa"},{"from":"abk","to":"ab"},{"from":"ave","to":"ae"},{"from":"afr","to":"af"},{"from":"aka","to":"ak"},{"from":"amh","to":"am"},{"from":"arg","to":"an"},{"from":"ara","to":"ar"},{"from":"asm","to":"as"},{"from":"ava","to":"av"},{"from":"aym","to":"ay"},{"from":"aze","to":"az"},{"from":"bak","to":"ba"},{"from":"bel","to":"be"},{"from":"bul","to":"bg"},{"from":"bih","to":"bho"},{"from":"bis","to":"bi"},{"from":"bam","to":"bm"},{"from":"ben","to":"bn"},{"from":"bod","to":"bo"},{"from":"bre","to":"br"},{"from":"bos","to":"bs"},{"from":"cat","to":"ca"},{"from":"che","to":"ce"},{"from":"cha","to":"ch"},{"from":"cos","to":"co"},{"from":"cre","to":"cr"},{"from":"ces","to":"cs"},{"from":"chu","to":"cu"},{"from":"chv","to":"cv"},{"from":"cym","to":"cy"},{"from":"dan","to":"da"},{"from":"deu","to":"de"},{"from":"div","to":"dv"},{"from":"dzo","to":"dz"},{"from":"ewe","to":"ee"},{"from":"ell","to":"el"},{"from":"eng","to":"en"},{"from":"epo","to":"eo"},{"from":"spa","to":"es"},{"from":"est","to":"et"},{"from":"eus","to":"eu"},{"from":"fas","to":"fa"},{"from":"ful","to":"ff"},{"from":"fin","to":"fi"},{"from":"fij","to":"fj"},{"from":"fao","to":"fo"},{"from":"fra","to":"fr"},{"from":"fry","to":"fy"},{"from":"gle","to":"ga"},{"from":"gla","to":"gd"},{"from":"glg","to":"gl"},{"from":"grn","to":"gn"},{"from":"guj","to":"gu"},{"from":"glv","to":"gv"},{"from":"hau","to":"ha"},{"from":"heb","to":"he"},{"from":"hin","to":"hi"},{"from":"hmo","to":"ho"},{"from":"hrv","to":"hr"},{"from":"hat","to":"ht"},{"from":"hun","to":"hu"},{"from":"hye","to":"hy"},{"from":"her","to":"hz"},{"from":"ina","to":"ia"},{"from":"ind","to":"id"},{"from":"ile","to":"ie"},{"from":"ibo","to":"ig"},{"from":"iii","to":"ii"},{"from":"ipk","to":"ik"},{"from":"ido","to":"io"},{"from":"isl","to":"is"},{"from":"ita","to":"it"},{"from":"iku","to":"iu"},{"from":"jpn","to":"ja"},{"from":"jav","to":"jv"},{"from":"kat","to":"ka"},{"from":"kon","to":"kg"},{"from":"kik","to":"ki"},{"from":"kua","to":"kj"},{"from":"kaz","to":"kk"},{"from":"kal","to":"kl"},{"from":"khm","to":"km"},{"from":"kan","to":"kn"},{"from":"kor","to":"ko"},{"from":"kau","to":"kr"},{"from":"kas","to":"ks"},{"from":"kur","to":"ku"},{"from":"kom","to":"kv"},{"from":"cor","to":"kw"},{"from":"kir","to":"ky"},{"from":"lat","to":"la"},{"from":"ltz","to":"lb"},{"from":"lug","to":"lg"},{"from":"lim","to":"li"},{"from":"lin","to":"ln"},{"from":"lao","to":"lo"},{"from":"lit","to":"lt"},{"from":"lub","to":"lu"},{"from":"lav","to":"lv"},{"from":"mlg","to":"mg"},{"from":"mah","to":"mh"},{"from":"mri","to":"mi"},{"from":"mkd","to":"mk"},{"from":"mal","to":"ml"},{"from":"mon","to":"mn"},{"from":"mol","to":"ro"},{"from":"mar","to":"mr"},{"from":"msa","to":"ms"},{"from":"mlt","to":"mt"},{"from":"mya","to":"my"},{"from":"nau","to":"na"},{"from":"nob","to":"nb"},{"from":"nde","to":"nd"},{"from":"nep","to":"ne"},{"from":"ndo","to":"ng"},{"from":"nld","to":"nl"},{"from":"nno","to":"nn"},{"from":"nor","to":"nb"},{"from":"nbl","to":"nr"},{"from":"nav","to":"nv"},{"from":"nya","to":"ny"},{"from":"oci","to":"oc"},{"from":"oji","to":"oj"},{"from":"orm","to":"om"},{"from":"ori","to":"or"},{"from":"oss","to":"os"},{"from":"pan","to":"pa"},{"from":"pli","to":"pi"},{"from":"pol","to":"pl"},{"from":"pus","to":"ps"},{"from":"por","to":"pt"},{"from":"que","to":"qu"},{"from":"roh","to":"rm"},{"from":"run","to":"rn"},{"from":"ron","to":"ro"},{"from":"rus","to":"ru"},{"from":"kin","to":"rw"},{"from":"san","to":"sa"},{"from":"srd","to":"sc"},{"from":"snd","to":"sd"},{"from":"sme","to":"se"},{"from":"sag","to":"sg"},{"from":"hbs","to":"sr-latn"},{"from":"sin","to":"si"},{"from":"slk","to":"sk"},{"from":"slv","to":"sl"},{"from":"smo","to":"sm"},{"from":"sna","to":"sn"},{"from":"som","to":"so"},{"from":"sqi","to":"sq"},{"from":"srp","to":"sr"},{"from":"ssw","to":"ss"},{"from":"sot","to":"st"},{"from":"sun","to":"su"},{"from":"swe","to":"sv"},{"from":"swa","to":"sw"},{"from":"tam","to":"ta"},{"from":"tel","to":"te"},{"from":"tgk","to":"tg"},{"from":"tha","to":"th"},{"from":"tir","to":"ti"},{"from":"tuk","to":"tk"},{"from":"tgl","to":"fil"},{"from":"tsn","to":"tn"},{"from":"ton","to":"to"},{"from":"tur","to":"tr"},{"from":"tso","to":"ts"},{"from":"tat","to":"tt"},{"from":"twi","to":"ak"},{"from":"tah","to":"ty"},{"from":"uig","to":"ug"},{"from":"ukr","to":"uk"},{"from":"urd","to":"ur"},{"from":"uzb","to":"uz"},{"from":"ven","to":"ve"},{"from":"vie","to":"vi"},{"from":"vol","to":"vo"},{"from":"wln","to":"wa"},{"from":"wol","to":"wo"},{"from":"xho","to":"xh"},{"from":"yid","to":"yi"},{"from":"yor","to":"yo"},{"from":"zha","to":"za"},{"from":"zho","to":"zh"},{"from":"zul","to":"zu"},{"from":"alb","to":"sq"},{"from":"arm","to":"hy"},{"from":"baq","to":"eu"},{"from":"bur","to":"my"},{"from":"chi","to":"zh"},{"from":"cze","to":"cs"},{"from":"dut","to":"nl"},{"from":"fre","to":"fr"},{"from":"geo","to":"ka"},{"from":"ger","to":"de"},{"from":"gre","to":"el"},{"from":"ice","to":"is"},{"from":"mac","to":"mk"},{"from":"mao","to":"mi"},{"from":"may","to":"ms"},{"from":"per","to":"fa"},{"from":"rum","to":"ro"},{"from":"slo","to":"sk"},{"from":"tib","to":"bo"},{"from":"wel","to":"cy"}]')},8589:function(f){f.exports=JSON.parse('{"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"}')},858:function(f){f.exports=JSON.parse('["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"]')}},r={};function o(f){var y=r[f];if(y!==void 0)return y.exports;var g=r[f]={exports:{}};return t[f].call(g.exports,g,g.exports,o),g.exports}o.amdO={},o.n=function(f){var y=f&&f.__esModule?function(){return f.default}:function(){return f};return o.d(y,{a:y}),y},o.d=function(f,y){for(var g in y)o.o(y,g)&&!o.o(f,g)&&Object.defineProperty(f,g,{enumerable:!0,get:y[g]})},o.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})(),o.o=function(f,y){return Object.prototype.hasOwnProperty.call(f,y)};var l={};return(function(){o.d(l,{default:function(){return _}}),o(8416);var f,y=o(1715),g=o(8080),p=o(1737),m=o(1139),u=(function(){var E,b="application/dash+xml";function I(A,R,O){if(!A||!/^VIDEO$/i.test(A.nodeName))return null;if(A._dashjs_player)return A._dashjs_player;var H,U=A.id||A.name||"video element";if(!(R=R||[].slice.call(A.querySelectorAll("source")).filter((function(Z){return Z.type==b}))[0])&&A.src)(R=document.createElement("source")).src=A.src;else if(!R&&!A.src)return null;return O=O||{},(H=(0,m.Z)(O).create()).initialize(A,R.src,A.autoplay),E||(E=H.getDebug().getLogger()),E.debug("Converted "+U+" to dash.js player and added content: "+R.src),A._dashjs_player=H,H}function T(A){return/^VIDEO$/i.test(A.nodeName)?A:T(A.parentNode)}return{create:I,createAll:function(A,R){var O=[];A=A||"[data-dashjs-player]";for(var H=(R=R||document).querySelectorAll(A),U=0;U<H.length;U++){var Z=I(H[U],null);O.push(Z)}for(var $=R.querySelectorAll('source[type="'+b+'"]'),F=0;F<$.length;F++){var W=I(T($[F]),null);O.push(W)}return O}}})();!(typeof window<"u"&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&typeof window<"u"&&window&&window.addEventListener&&(window.document.readyState==="complete"?window.dashjs?u.createAll():f=window.setInterval((function(){window.dashjs&&(window.clearInterval(f),u.createAll())}),500):window.addEventListener("load",(function E(){window.removeEventListener("load",E),u.createAll()})));var d=u,S=o(6398);dashjs.Protection=p.default,dashjs.MetricsReporting=g.default,dashjs.MediaPlayerFactory=d,dashjs.Debug=S.Z,dashjs.supportsMediaSource=y.B;var _=dashjs})(),l.default})()}))})(Hg)),Hg.exports}var KR=qR();const qv=lm(KR);var Kv=h=>{let e;const t=new Set,r=(p,m)=>{const u=typeof p=="function"?p(e):p;if(!Object.is(u,e)){const d=e;e=m??(typeof u!="object"||u===null)?u:Object.assign({},e,u),t.forEach(S=>S(e,d))}},o=()=>e,y={setState:r,getState:o,getInitialState:()=>g,subscribe:p=>(t.add(p),()=>t.delete(p))},g=e=h(r,o,y);return y},zv=(h=>h?Kv(h):Kv),$v=()=>({currentTime:0,duration:0,paused:!0,muted:!1,volume:1,videoStatus:"WAITING",buffered:[],playbackRate:1,isFullscreen:!1,isPictureInPicture:!1,error:null}),zR={videoInteractionOnce:!1,setVideoInteractionOnce:()=>{}},$R=()=>{const h={};return zv((e,t)=>({...zR,videos:h,getOrCreateStore:r=>{if(h[r])return h[r];const o=zv(l=>({...$v(),setCurrentTime:f=>l({currentTime:f}),setDuration:f=>l({duration:f}),setPaused:f=>{l({paused:f,videoStatus:f?"PAUSED":"PLAYING"})},setMuted:f=>l({muted:f}),setVolume:f=>l({volume:f}),setVideoStatus:f=>l({videoStatus:f}),setBuffered:f=>l({buffered:f}),setPlaybackRate:f=>l({playbackRate:f}),setFullscreen:f=>l({isFullscreen:f}),setPictureInPicture:f=>l({isPictureInPicture:f}),setError:f=>{l({error:f,videoStatus:f?"ERROR":"WAITING"})},reset:()=>l({...$v()})}));return h[r]=o,o},getStore:r=>h[r],removeStore:r=>{const o=h[r];o&&o.getState().reset(),delete h[r]},setVideoInteractionOnce:r=>{e({videoInteractionOnce:r})}}))},Wc=$R();function WR(h){const e=wn.useRef(null),t=Wc.getState().getOrCreateStore(h),r=Wc.getState(),o=wn.useCallback(()=>{e.current&&(t.getState().setDuration(e.current.duration),t.getState().setVideoStatus("CAN_PLAY"))},[t]),l=wn.useCallback(()=>{e.current&&t.getState().setCurrentTime(e.current.currentTime)},[t]),f=wn.useCallback(()=>{t.getState().setPaused(!1),t.getState().setVideoStatus("PLAYING")},[t]),y=wn.useCallback(()=>{t.getState().setPaused(!0),t.getState().setVideoStatus("PAUSED")},[t]),g=wn.useCallback(()=>{t.getState().setVideoStatus("WAITING")},[t]),p=wn.useCallback(()=>{t.getState().setVideoStatus("CAN_PLAY")},[t]),m=wn.useCallback(()=>{t.getState().setPaused(!0),t.getState().setVideoStatus("ENDED")},[t]),u=wn.useCallback(()=>{t.getState().setVideoStatus("SEEKING")},[t]),d=wn.useCallback(()=>{t.getState().setVideoStatus(t.getState().paused?"PAUSED":"PLAYING")},[t]),S=wn.useCallback(()=>{if(e.current){const T=[];for(let A=0;A<e.current.buffered.length;A++)T.push({start:e.current.buffered.start(A),end:e.current.buffered.end(A)});t.getState().setBuffered(T)}},[t]),_=wn.useCallback(()=>{t.getState().setError("Video playback error")},[t]),E=wn.useCallback(()=>{e.current&&(t.getState().setMuted(e.current.muted),t.getState().setVolume(e.current.volume))},[t]),b=wn.useCallback(()=>{e.current&&t.getState().setPlaybackRate(e.current.playbackRate)},[t]);wn.useEffect(()=>{const T=e.current;if(!T)return;const A=t.getState(),R=[["loadedmetadata",o],["timeupdate",l],["play",f],["pause",y],["waiting",g],["canplaythrough",p],["ended",m],["seeking",u],["seeked",d],["progress",S],["error",_],["volumechange",E],["ratechange",b],["fullscreenchange",()=>{A.setFullscreen(!!document.fullscreenElement)}],["enterpictureinpicture",()=>{A.setPictureInPicture(!0)}],["leavepictureinpicture",()=>{A.setPictureInPicture(!1)}]];return R.forEach(([O,H])=>{T.addEventListener(O,H)}),()=>{R.forEach(([O,H])=>{T.removeEventListener(O,H)})}},[t,o,l,f,y,g,p,m,u,d,S,_,E,b]);const I=wn.useCallback(()=>{r.setVideoInteractionOnce(!0)},[r]);return{videoRef:e,onUserInteract:I}}function mo(h){const t=Wc.getState().getOrCreateStore(h).getState(),r=wn.useCallback(()=>{t.setPaused(!1)},[t]),o=wn.useCallback(()=>{t.setPaused(!0)},[t]),l=wn.useCallback(()=>{t.setPaused(!t.paused)},[t]),f=wn.useCallback(E=>{t.setCurrentTime(E)},[t]),y=wn.useCallback(E=>{t.setCurrentTime(E),t.setVideoStatus("SEEKING")},[t]),g=wn.useCallback(E=>{t.setMuted(E)},[t]),p=wn.useCallback(()=>{t.setMuted(!t.muted)},[t]),m=wn.useCallback(E=>{const b=Math.max(0,Math.min(1,E));t.setVolume(b),b>0&&t.muted&&t.setMuted(!1)},[t]),u=wn.useCallback(E=>{t.setPlaybackRate(E)},[t]),d=wn.useCallback(async E=>{document.fullscreenElement?await document.exitFullscreen():await E.requestFullscreen()},[]),S=wn.useCallback(async E=>{document.pictureInPictureElement?await document.exitPictureInPicture():await E.requestPictureInPicture()},[]),_=wn.useCallback(()=>{t.reset()},[t]);return{currentTime:t.currentTime,duration:t.duration,paused:t.paused,muted:t.muted,volume:t.volume,videoStatus:t.videoStatus,buffered:t.buffered,playbackRate:t.playbackRate,isFullscreen:t.isFullscreen,isPictureInPicture:t.isPictureInPicture,error:t.error,play:r,pause:o,togglePlay:l,setCurrentTime:f,seek:y,setMuted:g,toggleMute:p,setVolume:m,setPlaybackRate:u,toggleFullscreen:d,togglePictureInPicture:S,reset:_}}function C0(h){var e,t,r="";if(typeof h=="string"||typeof h=="number")r+=h;else if(typeof h=="object")if(Array.isArray(h)){var o=h.length;for(e=0;e<o;e++)h[e]&&(t=C0(h[e]))&&(r&&(r+=" "),r+=t)}else for(t in h)h[t]&&(r&&(r+=" "),r+=t);return r}function XR(){for(var h,e,t=0,r="",o=arguments.length;t<o;t++)(h=arguments[t])&&(e=C0(h))&&(r&&(r+=" "),r+=e);return r}var us=XR,D0=wn.forwardRef(({id:h,src:e,autoPlay:t=!1,muted:r=!1,poster:o,onLoaded:l,onTimeUpdate:f,onStatusChange:y,children:g},p)=>{wn.useRef(null);const m=wn.useRef(null),{videoRef:u,onUserInteract:d}=WR(h),S=mo(h),{getStore:_}=Wc.getState(),E=_(h),[b,I]=wn.useState(!1);wn.useEffect(()=>{E&&S.setMuted(r)},[r,S]),wn.useEffect(()=>{u.current&&(p&&(typeof p=="function"?p(u.current):p.current=u.current),l==null||l(u.current),I(!0))},[u.current,p,l]),wn.useEffect(()=>{t&&e&&(async()=>{var O;try{await((O=u.current)==null?void 0:O.play())}catch(H){console.warn("Auto-play was prevented:",H)}})()},[t,e]),wn.useEffect(()=>{if(E&&f)return()=>{f(E.getState().currentTime)}},[E==null?void 0:E.getState().currentTime,f]),wn.useEffect(()=>{if(E&&y)return()=>{y(E.getState().videoStatus)}},[E==null?void 0:E.getState().videoStatus,y]);const T=R=>{d()},A=R=>{switch(d(),R.key){case" ":case"k":R.preventDefault(),S.paused?S.play():S.pause();break;case"ArrowLeft":R.preventDefault(),S.seek(Math.max(0,S.currentTime-10));break;case"ArrowRight":R.preventDefault(),S.seek(Math.min(S.duration,S.currentTime+10));break;case"ArrowUp":R.preventDefault(),S.setVolume(S.volume+.1);break;case"ArrowDown":R.preventDefault(),S.setVolume(Math.max(0,S.volume-.1));break;case"m":S.toggleMute();break;case"f":m.current&&S.toggleFullscreen(m.current);break}};return Dt.jsxs("div",{ref:m,className:us("vp-player",{"is-ready":b,"is-playing":S.paused===!1}),onClick:T,onKeyDown:A,tabIndex:0,children:[Dt.jsx("video",{ref:R=>{u.current=R},className:"vp-video",src:e,poster:o,playsInline:!0,muted:r}),g]})});D0.displayName="VideoPlayer";var QR=({id:h,className:e})=>{const{paused:t,togglePlay:r}=mo(h);return Dt.jsx("button",{className:us("vp-play-button",e),onClick:r,"aria-label":t?"Play":"Pause",children:t?Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Dt.jsx("path",{d:"M8 5v14l11-7z"})}):Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Dt.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})})})},JR=({id:h,className:e,showTime:t=!0,showBuffered:r=!0})=>{const{currentTime:o,duration:l,paused:f,seek:y,buffered:g}=mo(h),p=wn.useRef(null),[m,u]=wn.useState(!1),d=wn.useCallback(T=>{const A=Math.floor(T/3600),R=Math.floor(T%3600/60),O=Math.floor(T%60);return A>0?`${A}:${R.toString().padStart(2,"0")}:${O.toString().padStart(2,"0")}`:`${R}:${O.toString().padStart(2,"0")}`},[]),S=wn.useCallback(T=>{if(!p.current)return 0;const A=p.current.getBoundingClientRect(),R=T.clientX-A.left;return Math.max(0,Math.min(1,R/A.width))},[]),_=wn.useCallback(T=>{u(!0);const A=S(T);y(A*l)},[l,S,y]),E=wn.useCallback(T=>{if(!m)return;const A=S(T);y(A*l)},[m,l,S,y]),b=wn.useCallback(()=>{u(!1)},[]);wn.useEffect(()=>{if(m)return window.addEventListener("mousemove",E),window.addEventListener("mouseup",b),()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",b)}},[m,E,b]);const I=l>0?o/l*100:0;return Dt.jsxs("div",{className:us("vp-seekbar-container",e),children:[r&&g.length>0&&Dt.jsx("div",{className:"vp-seekbar-buffered",children:g.map((T,A)=>Dt.jsx("div",{className:"vp-seekbar-buffered-range",style:{left:`${T.start/l*100}%`,width:`${(T.end-T.start)/l*100}%`}},A))}),Dt.jsxs("div",{ref:p,className:us("vp-seekbar",{"is-dragging":m}),onMouseDown:_,children:[Dt.jsx("div",{className:"vp-seekbar-progress",style:{width:`${I}%`}}),Dt.jsx("div",{className:"vp-seekbar-thumb",style:{left:`${I}%`}})]}),t&&Dt.jsxs("div",{className:"vp-seekbar-times",children:[Dt.jsx("span",{className:"vp-seekbar-current",children:d(o)}),Dt.jsx("span",{className:"vp-seekbar-duration",children:d(l)})]})]})},eI=({id:h,className:e,showMuteToggle:t=!0,vertical:r=!1})=>{const{muted:o,volume:l,toggleMute:f,setVolume:y}=mo(h),[g,p]=wn.useState(!1),m=wn.useCallback(d=>{const S=parseFloat(d.target.value);y(S)},[y]),u=o?0:l;return Dt.jsxs("div",{className:us("vp-volume-control",e,{"is-vertical":r}),onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[t&&Dt.jsx("button",{className:"vp-volume-mute",onClick:f,"aria-label":o?"Unmute":"Mute",children:o||l===0?Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Dt.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})}):l<.5?Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Dt.jsx("path",{d:"M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z"})}):Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Dt.jsx("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})})}),(g||r)&&Dt.jsx("div",{className:us("vp-volume-slider",{"is-vertical":r}),children:Dt.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:u,onChange:m,className:"vp-volume-input"})})]})},tI=({id:h,className:e,targetRef:t})=>{const{isFullscreen:r,toggleFullscreen:o}=mo(h),l=wn.useCallback(async()=>{t.current&&await o(t.current)},[o,t]);return Dt.jsx("button",{className:us("vp-fullscreen-button",e,{"is-active":r}),onClick:l,"aria-label":r?"Exit fullscreen":"Enter fullscreen",children:r?Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Dt.jsx("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"})}):Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Dt.jsx("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})})})},nI=({id:h,className:e,videoRef:t})=>{const{isPictureInPicture:r,togglePictureInPicture:o}=mo(h),l=wn.useCallback(async()=>{t.current&&await o(t.current)},[o,t]);return Dt.jsx("button",{className:us("vp-pip-button",e,{"is-active":r}),onClick:l,"aria-label":r?"Exit picture in picture":"Enter picture in picture",children:Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Dt.jsx("path",{d:"M19 7h-8v6h8V7zm2-4H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H3V5h18v14z"})})})},rI=[.25,.5,.75,1,1.25,1.5,2],iI=({id:h,className:e,showMenu:t=!0})=>{const{playbackRate:r,setPlaybackRate:o}=mo(h),[l,f]=wn.useState(!1),y=wn.useCallback(()=>{t&&f(!l)},[t,l]),g=wn.useCallback(p=>{o(p),f(!1)},[o]);return Dt.jsxs("div",{className:us("vp-playback-rate",e),children:[Dt.jsxs("button",{className:"vp-playback-rate-button",onClick:y,"aria-label":`Playback rate: ${r}x`,"aria-expanded":l,children:[r,"x"]}),t&&l&&Dt.jsx("div",{className:"vp-playback-rate-menu",children:rI.map(p=>Dt.jsxs("button",{className:us("vp-playback-rate-option",{"is-active":p===r}),onClick:()=>g(p),children:[p,"x"]},p))})]})},aI=({id:h,showDuration:e=!0,separator:t=" / "})=>{const{currentTime:r,duration:o}=mo(h),l=wn.useCallback(f=>{const y=Math.floor(f/3600),g=Math.floor(f%3600/60),p=Math.floor(f%60);return y>0?`${y}:${g.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`:`${g}:${p.toString().padStart(2,"0")}`},[]);return Dt.jsxs("div",{className:"vp-time-display",children:[Dt.jsx("span",{className:"vp-time-current",children:l(r)}),e&&Dt.jsxs(Dt.Fragment,{children:[Dt.jsx("span",{className:"vp-time-separator",children:t}),Dt.jsx("span",{className:"vp-time-duration",children:l(o)})]})]})},sI=({id:h,placement:e="bottom",showTime:t=!0,showBuffered:r=!0,showMuteToggle:o=!0,showVolumeSlider:l=!0,showPlaybackRate:f=!0,showPiP:y=!0,showFullscreen:g=!0,children:p,...m})=>{const u=wn.useRef(null),d=wn.useRef(null);return Dt.jsx(D0,{id:h,ref:u,...m,children:Dt.jsxs("div",{className:us("vp-controls",`vp-controls-${e}`,{"is-overlay":e==="overlay"}),children:[Dt.jsx("div",{className:"vp-controls-top",children:p}),Dt.jsxs("div",{className:"vp-controls-bottom",children:[Dt.jsx(JR,{id:h,showTime:t,showBuffered:r}),Dt.jsxs("div",{className:"vp-controls-row",children:[Dt.jsxs("div",{className:"vp-controls-left",children:[Dt.jsx(QR,{id:h}),Dt.jsx(eI,{id:h,showMuteToggle:o,vertical:!l}),Dt.jsx(aI,{id:h,showDuration:t})]}),Dt.jsxs("div",{className:"vp-controls-right",children:[f&&Dt.jsx(iI,{id:h}),y&&Dt.jsx(nI,{id:h,videoRef:u}),g&&Dt.jsx(tI,{id:h,targetRef:d})]})]})]})]})})};const oI=({config:h})=>{const e=wn.useRef(null),t=wn.useRef(null),r=wn.useRef(null),[o,l]=wn.useState(null),[f,y]=wn.useState("");return wn.useEffect(()=>{const g=e.current;if(!g||!h.url)return;const p=()=>{t.current&&(t.current.destroy(),t.current=null),r.current&&(r.current.reset(),r.current=null)};p(),l(null);const m=h.url,u=m.includes(".m3u8")||h.type==="hls",d=m.includes(".mpd")||h.type==="dash",S=m.endsWith(".mp4")||h.type==="mp4";if(u&&ls.isSupported()){const _=new ls({enableWorker:!0,lowLatencyMode:!0});t.current=_,_.loadSource(m),_.attachMedia(g),_.on(ls.Events.MANIFEST_PARSED,()=>{y("HLS"),h.autoPlay&&g.play().catch(()=>{})}),_.on(ls.Events.ERROR,(E,b)=>{b.fatal&&l(`HLS Error: ${b.type}`)})}else if(d&&qv){const _=qv.MediaPlayer().create();r.current=_,_.initialize(g,m,h.autoPlay),_.on("manifestLoaded",()=>{y("DASH")}),_.on("error",E=>{l(`DASH Error: ${E.error.message||"Unknown error"}`)})}else S||g.canPlayType("video/mp4")?(g.src=m,g.load(),y("MP4")):g.canPlayType("application/vnd.apple.mpegurl")?(g.src=m,g.load(),y("HLS (Native)")):l("Unsupported media format");return p},[h.url,h.type,h.autoPlay]),h.url?o?Dt.jsxs("div",{className:"video-error",children:[Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Dt.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),Dt.jsx("p",{children:o})]}):Dt.jsxs("div",{className:"video-player-container",children:[f&&Dt.jsx("div",{className:"media-type-badge",children:f}),Dt.jsx(sI,{id:h.id,src:h.url,autoPlay:h.autoPlay,muted:h.muted,poster:h.poster,placement:"overlay"})]}):Dt.jsx("div",{className:"video-placeholder",children:Dt.jsxs("div",{className:"placeholder-content",children:[Dt.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:Dt.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})}),Dt.jsx("p",{children:"Enter a video URL to get started"}),Dt.jsx("span",{children:"Supports HLS (.m3u8), DASH (.mp4), and MP4"})]})})};function lI(h){const e={url:h.url,type:h.type,autoplay:h.autoPlay?"1":"0",muted:h.muted?"1":"0"},t=new URLSearchParams;return Object.entries(e).forEach(([r,o])=>{o&&t.set(r,o)}),t.toString()}function uI(){const h=new URLSearchParams(window.location.search);return{url:h.get("url")||"",type:h.get("type")||"hls",autoPlay:h.get("autoplay")==="1",muted:h.get("muted")==="1"}}const cI=({config:h,onUpdate:e})=>{const t=wn.useCallback(l=>{e({url:l})},[e]),r=wn.useCallback(()=>{const l=lI(h),f=`${window.location.origin}${window.location.pathname}${l?`?${l}`:""}`;navigator.clipboard.writeText(f)},[h]),o=wn.useCallback(async()=>{try{const l=await navigator.clipboard.readText();l&&t(l)}catch(l){console.error("Failed to read clipboard:",l)}},[t]);return wn.useEffect(()=>{const l=uI();l.url&&e(l)},[]),Dt.jsxs("div",{className:"config-panel",children:[Dt.jsx("h3",{children:"Configuration"}),Dt.jsxs("div",{className:"config-section",children:[Dt.jsx("label",{children:"Manifest URL"}),Dt.jsxs("div",{className:"url-input-group",children:[Dt.jsx("input",{type:"url",placeholder:"https://example.com/manifest.m3u8",value:h.url,onChange:l=>t(l.target.value),className:"url-input"}),Dt.jsx("button",{className:"icon-btn",onClick:o,title:"Paste from clipboard",children:Dt.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[Dt.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2M8 2v2M12 2v2"}),Dt.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1"})]})}),Dt.jsx("button",{className:"icon-btn",onClick:r,title:"Copy shareable URL",children:Dt.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[Dt.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2"}),Dt.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]})]}),Dt.jsxs("div",{className:"config-section",children:[Dt.jsx("label",{children:"Media Type"}),Dt.jsxs("select",{value:h.type,onChange:l=>e({type:l.target.value}),className:"select-input",children:[Dt.jsx("option",{value:"hls",children:"HLS (.m3u8)"}),Dt.jsx("option",{value:"dash",children:"DASH (.mpd)"}),Dt.jsx("option",{value:"mp4",children:"MP4"})]})]}),Dt.jsxs("div",{className:"config-section",children:[Dt.jsx("label",{children:"Player Name"}),Dt.jsx("input",{type:"text",value:h.name,onChange:l=>e({name:l.target.value}),className:"text-input"})]}),Dt.jsxs("div",{className:"config-section",children:[Dt.jsx("label",{children:"Poster URL"}),Dt.jsx("input",{type:"url",value:h.poster,onChange:l=>e({poster:l.target.value}),placeholder:"https://example.com/poster.jpg",className:"url-input"})]}),Dt.jsxs("div",{className:"config-toggles",children:[Dt.jsxs("label",{className:"toggle",children:[Dt.jsx("input",{type:"checkbox",checked:h.autoPlay,onChange:l=>e({autoPlay:l.target.checked})}),Dt.jsx("span",{className:"toggle-slider"}),Dt.jsx("span",{className:"toggle-label",children:"Auto Play"})]}),Dt.jsxs("label",{className:"toggle",children:[Dt.jsx("input",{type:"checkbox",checked:h.muted,onChange:l=>e({muted:l.target.checked})}),Dt.jsx("span",{className:"toggle-slider"}),Dt.jsx("span",{className:"toggle-label",children:"Muted"})]})]}),Dt.jsxs("div",{className:"preset-section",children:[Dt.jsx("label",{children:"Sample Manifests"}),Dt.jsxs("div",{className:"preset-list",children:[Dt.jsx("button",{onClick:()=>t("https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"),children:"Big Buck Bunny (HLS)"}),Dt.jsx("button",{onClick:()=>t("https://dash.akamaized.net/dash264/TestCases/1c/qualcomm/2/MultiRate.mpd"),children:"Multi Rate (DASH)"}),Dt.jsx("button",{onClick:()=>t("https://media.w3.org/2010/05/sintel/trailer.mp4"),children:"Sintel Trailer (MP4)"}),Dt.jsx("button",{onClick:()=>t("https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8"),children:"Sintel (HLS)"})]})]})]})},fI=({playerId:h})=>{const{currentTime:e,duration:t,paused:r,muted:o,volume:l,videoStatus:f,buffered:y,playbackRate:g,isFullscreen:p,error:m}=mo(h),{videoInteractionOnce:u}=Wc(),d=E=>{const b=Math.floor(E/60),I=Math.floor(E%60);return`${b}:${I.toString().padStart(2,"0")}`},S=E=>{switch(E){case"PLAYING":return"#22c55e";case"PAUSED":return"#f59e0b";case"WAITING":case"BUFFERING":return"#f97316";case"ERROR":return"#ef4444";case"ENDED":return"#8b5cf6";default:return"#64748b"}},_=t>0?e/t*100:0;return Dt.jsxs("div",{className:"stats-panel",children:[Dt.jsx("h3",{children:"Video Stats"}),Dt.jsxs("div",{className:"stats-grid",children:[Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"Status"}),Dt.jsx("span",{className:"stat-value status-badge",style:{backgroundColor:S(f)},children:f})]}),Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"Current Time"}),Dt.jsx("span",{className:"stat-value",children:d(e)})]}),Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"Duration"}),Dt.jsx("span",{className:"stat-value",children:d(t)})]}),Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"Progress"}),Dt.jsxs("span",{className:"stat-value",children:[_.toFixed(1),"%"]})]}),Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"Buffered"}),Dt.jsx("span",{className:"stat-value",children:y.length>0?y.map((E,b)=>`${d(E.start)}-${d(E.end)}`).join(", "):"None"})]}),Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"Playback Rate"}),Dt.jsxs("span",{className:"stat-value",children:[g,"x"]})]}),Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"Volume"}),Dt.jsxs("span",{className:"stat-value",children:[(l*100).toFixed(0),"%"]})]}),Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"Muted"}),Dt.jsx("span",{className:"stat-value",children:o?"Yes":"No"})]}),Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"Fullscreen"}),Dt.jsx("span",{className:"stat-value",children:p?"Yes":"No"})]}),Dt.jsxs("div",{className:"stat-item",children:[Dt.jsx("span",{className:"stat-label",children:"User Interacted"}),Dt.jsx("span",{className:"stat-value",children:u?"Yes":"No"})]})]}),m&&Dt.jsxs("div",{className:"error-display",children:[Dt.jsx("span",{className:"error-label",children:"Error:"}),Dt.jsx("span",{className:"error-value",children:m})]}),Dt.jsxs("div",{className:"progress-bar",children:[Dt.jsx("div",{className:"progress-fill",style:{width:`${_}%`}}),y.map((E,b)=>Dt.jsx("div",{className:"buffered-fill",style:{left:`${E.start/t*100}%`,width:`${(E.end-E.start)/t*100}%`}},b))]})]})},dI=[{id:"main-player",name:"Main Player",url:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8",type:"hls",autoPlay:!1,muted:!1,poster:""}];function hI(){const[h,e]=wn.useState(dI),[t,r]=wn.useState("main-player"),o=wn.useCallback((g,p)=>{e(m=>m.map(u=>u.id===g?{...u,...p}:u))},[]),l=wn.useCallback(()=>{const g=`player-${Date.now()}`;e(p=>[...p,{id:g,name:`Player ${p.length+1}`,url:"",type:"hls",autoPlay:!1,muted:!1,poster:""}]),r(g)},[]),f=wn.useCallback(g=>{e(p=>p.filter(m=>m.id!==g)),t===g&&h.length>1&&r(h[0].id)},[t,h]),y=h.find(g=>g.id===t);return Dt.jsxs("div",{className:"app",children:[Dt.jsxs("header",{className:"app-header",children:[Dt.jsx("h1",{children:"Video Player Playground"}),Dt.jsx("p",{children:"Test HLS and DASH streaming with our modern video player library"})]}),Dt.jsxs("main",{className:"app-main",children:[Dt.jsxs("aside",{className:"app-sidebar",children:[Dt.jsxs("div",{className:"player-list",children:[Dt.jsx("h3",{children:"Players"}),h.map(g=>Dt.jsxs("button",{className:`player-tab ${t===g.id?"active":""}`,onClick:()=>r(g.id),children:[g.name,h.length>1&&Dt.jsx("span",{className:"remove-player",onClick:p=>{p.stopPropagation(),f(g.id)},children:""})]},g.id)),Dt.jsx("button",{className:"add-player",onClick:l,children:"+ Add Player"})]}),y&&Dt.jsx(cI,{config:y,onUpdate:g=>o(y.id,g)})]}),Dt.jsxs("div",{className:"app-content",children:[Dt.jsx("div",{className:"players-grid",children:h.map(g=>Dt.jsxs("div",{className:`player-wrapper ${t===g.id?"selected":""}`,onClick:()=>r(g.id),children:[Dt.jsx("div",{className:"player-label",children:g.name}),Dt.jsx(oI,{config:g})]},g.id))}),y&&Dt.jsx(fI,{playerId:y.id})]})]})]})}HT.createRoot(document.getElementById("root")).render(Dt.jsx(MT.StrictMode,{children:Dt.jsx(hI,{})}));
